<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>C++指针</title>
      <link href="/2024/11/16/C-%E6%8C%87%E9%92%88/"/>
      <url>/2024/11/16/C-%E6%8C%87%E9%92%88/</url>
      
        <content type="html"><![CDATA[<p><strong>从内存修改的角度对<code>int* arr</code>和<code>int&amp; arr</code>区别的详细解释：</strong></p><h3 id="内存访问机制"><a href="#内存访问机制" class="headerlink" title="内存访问机制"></a>内存访问机制</h3><ul><li><strong><code>int* arr</code></strong> ：当使用<code>int* arr</code>作为函数形参时，函数接收到的是一个指向内存中某个<code>int</code>类型数据的地址。在函数内部，通过对指针进行解引用操作<code>*arr</code>来访问和修改该指针所指向的内存位置的值。这意味着函数可以通过指针间接地修改外部传递进来的变量或数组元素所对应的内存空间中的数据。</li><li><strong><code>int&amp; arr</code></strong> ：而对于<code>int&amp; arr</code>，它是对一个<code>int</code>变量的引用，本质上是该变量的别名。在函数内部对<code>arr</code>的任何操作，实际上都是直接对引用所绑定的原始<code>int</code>变量进行操作，直接修改的就是该变量所占用的内存空间中的值，不需要像指针那样进行解引用操作。</li></ul><h3 id="对外部变量的影响"><a href="#对外部变量的影响" class="headerlink" title="对外部变量的影响"></a>对外部变量的影响</h3><ul><li><strong><code>int* arr</code></strong> ：由于函数通过指针能够直接访问和修改指针所指向的内存，因此在函数内部对<code>*arr</code>的修改会直接反映到外部传递进来的变量或数组元素上。例如：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modifyValue</span><span class="params">(<span class="type">int</span>* arr)</span> </span>&#123;</span><br><span class="line">    *arr = <span class="number">100</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> num = <span class="number">50</span>;</span><br><span class="line">    <span class="built_in">modifyValue</span>(&amp;num);</span><br><span class="line">    std::cout &lt;&lt; num &lt;&lt; std::endl; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>在上述代码中，<code>modifyValue</code>函数接收了<code>num</code>的地址，通过指针解引用将<code>num</code>所在内存的值修改为<code>100</code>，所以最终输出为<code>100</code>。</li><li><strong><code>int&amp; arr</code></strong> ：同样地，因为引用直接绑定到外部变量，所以在函数内部对引用的修改也会直接影响到外部变量。例如：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modifyValue</span><span class="params">(<span class="type">int</span>&amp; arr)</span> </span>&#123;</span><br><span class="line">    arr = <span class="number">200</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> num = <span class="number">150</span>;</span><br><span class="line">    <span class="built_in">modifyValue</span>(num);</span><br><span class="line">    std::cout &lt;&lt; num &lt;&lt; std::endl; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>在这个例子中，<code>modifyValue</code>函数中的<code>arr</code>是<code>num</code>的引用，对<code>arr</code>的修改就是对<code>num</code>的修改，所以最终输出为<code>200</code>。</li></ul><h3 id="数组作为参数时的内存修改"><a href="#数组作为参数时的内存修改" class="headerlink" title="数组作为参数时的内存修改"></a>数组作为参数时的内存修改</h3><ul><li><strong><code>int* arr</code></strong> ：当传递数组时，数组名会隐式转换为指向数组首元素的指针。在函数内部，可以通过指针算术运算来遍历数组元素，并修改它们所对应的内存值。例如：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modifyArray</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; ++i) &#123;</span><br><span class="line">        *(arr + i) = i * <span class="number">10</span>; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> arr[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line">    <span class="built_in">modifyArray</span>(arr, <span class="number">5</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; ++i) &#123;</span><br><span class="line">        std::cout &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>在<code>modifyArray</code>函数中，通过<code>*(arr + i)</code>的方式依次修改了数组<code>arr</code>每个元素所对应的内存值，所以最终输出为<code>0 10 20 30 40</code>。</li><li><strong><code>int&amp; arr</code></strong> ：若要使用引用传递数组，通常需要使用一些特殊的方法，如传递数组的引用或使用模板等。相对来说，使用指针在处理数组时更为直接和常见。不过，一旦正确地使用引用传递数组，对数组元素的修改方式与使用指针类似，都是直接修改数组元素所占用的内存空间中的值，只是在语法上不需要进行指针解引用操作。</li></ul><h3 id="内存安全性考虑"><a href="#内存安全性考虑" class="headerlink" title="内存安全性考虑"></a>内存安全性考虑</h3><ul><li><strong><code>int* arr</code></strong> ：使用指针时，需要特别注意指针的合法性和有效性。如果传递了一个无效的指针，如空指针或者指向已经释放的内存的指针，那么在函数内部对该指针进行解引用操作时，将会导致程序出现段错误或其他未定义行为，从而影响程序的稳定性和安全性。因此，在使用指针时，通常需要在函数内部进行指针有效性的检查，以确保程序的健壮性。</li><li><strong><code>int&amp; arr</code></strong> ：引用在定义时必须初始化，并且在其生命周期内始终绑定到同一个有效的对象，不会出现类似指针的悬空引用或无效引用的情况。所以在一定程度上，使用引用作为函数参数时，在内存访问的安全性方面相对更有保障，只要确保引用的初始化是正确的，就可以放心地在函数内部对其进行操作，而不必担心出现指针相关的内存错误。</li></ul><p>综上所述，<code>int* arr</code>和<code>int&amp; arr</code>在内存修改方面都能够实现对外部变量或数组元素的修改，但它们在内存访问机制、对外部变量的影响方式、数组处理的便捷性以及内存安全性等方面存在着一些差异。在实际编程中，需要根据具体的需求和场景来选择合适的方式来传递参数和操作内存。</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux报错合集</title>
      <link href="/2024/09/30/Linux%E6%8A%A5%E9%94%99%E5%90%88%E9%9B%86/"/>
      <url>/2024/09/30/Linux%E6%8A%A5%E9%94%99%E5%90%88%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<h2 id="无法定位软件包"><a href="#无法定位软件包" class="headerlink" title="无法定位软件包"></a>无法定位软件包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository universe</span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><blockquote><p>如果你的默认仓库没有这个软件包，你可能需要添加额外的仓库。例如，对于Ubuntu，你可以添加universe仓库，它通常包含更多的软件包</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用OpenCV写UI界面</title>
      <link href="/2024/09/27/%E7%94%A8OpenCV%E5%86%99UI%E7%95%8C%E9%9D%A2/"/>
      <url>/2024/09/27/%E7%94%A8OpenCV%E5%86%99UI%E7%95%8C%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<blockquote><p>之前电赛队友的物理按钮不够了，为了方便快捷，就用了这个，好用，就是运行时间长了可能失效(在树莓派5上当时使用的时候是这样)</p></blockquote><div class="tagLink"><a class="link-card" title="cvui" href="https://fernandobevilacqua.com/cvui/"><span class="link-card-backdrop" style="background-image: url(https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg)"></span><div class="left"><img src="https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">cvui</p><p class="url">https://fernandobevilacqua.com/cvui/</p></div></a></div><div class="tagLink"><a class="link-card" title="cvui的github仓库地址" href="https://github.com/Dovyski/cvui/releases/tag/v2.7.0"><span class="link-card-backdrop" style="background-image: url(https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg)"></span><div class="left"><img src="https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">cvui的github仓库地址</p><p class="url">https://github.com/Dovyski/cvui/releases/tag/v2.7.0</p></div></a></div>]]></content>
      
      
      <categories>
          
          <category> Jetson Nano </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> AI </tag>
            
            <tag> opencv </tag>
            
            <tag> UI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Jetson-Nano学习笔记】Jetson_Inference</title>
      <link href="/2024/09/24/%E3%80%90Jetson-Nano%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91py%E7%89%88Jetson-Inference/"/>
      <url>/2024/09/24/%E3%80%90Jetson-Nano%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91py%E7%89%88Jetson-Inference/</url>
      
        <content type="html"><![CDATA[<h2 id="人体姿态检测的网络模型加载脚本"><a href="#人体姿态检测的网络模型加载脚本" class="headerlink" title="人体姿态检测的网络模型加载脚本"></a>人体姿态检测的网络模型加载脚本</h2><details open><summary pointer> posenet.py </summary>              <div class='content'>              <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Copyright (c) 2021, NVIDIA CORPORATION. All rights reserved.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Permission is hereby granted, free of charge, to any person obtaining a</span></span><br><span class="line"><span class="comment"># copy of this software and associated documentation files (the &quot;Software&quot;),</span></span><br><span class="line"><span class="comment"># to deal in the Software without restriction, including without limitation</span></span><br><span class="line"><span class="comment"># the rights to use, copy, modify, merge, publish, distribute, sublicense,</span></span><br><span class="line"><span class="comment"># and/or sell copies of the Software, and to permit persons to whom the</span></span><br><span class="line"><span class="comment"># Software is furnished to do so, subject to the following conditions:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The above copyright notice and this permission notice shall be included in</span></span><br><span class="line"><span class="comment"># all copies or substantial portions of the Software.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></span><br><span class="line"><span class="comment"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></span><br><span class="line"><span class="comment"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL</span></span><br><span class="line"><span class="comment"># THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></span><br><span class="line"><span class="comment"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span></span><br><span class="line"><span class="comment"># FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</span></span><br><span class="line"><span class="comment"># DEALINGS IN THE SOFTWARE.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> jetson_inference <span class="keyword">import</span> poseNet</span><br><span class="line"><span class="keyword">from</span> jetson_utils <span class="keyword">import</span> videoSource, videoOutput, Log</span><br><span class="line"></span><br><span class="line"><span class="comment"># parse the command line</span></span><br><span class="line">parser = argparse.ArgumentParser(description=<span class="string">&quot;Run pose estimation DNN on a video/image stream.&quot;</span>, </span><br><span class="line">                                 formatter_class=argparse.RawTextHelpFormatter, </span><br><span class="line">                                 epilog=poseNet.Usage() + videoSource.Usage() + videoOutput.Usage() + Log.Usage())</span><br><span class="line"></span><br><span class="line">parser.add_argument(<span class="string">&quot;input&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&quot;&quot;</span>, nargs=<span class="string">&#x27;?&#x27;</span>, <span class="built_in">help</span>=<span class="string">&quot;URI of the input stream&quot;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&quot;output&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&quot;&quot;</span>, nargs=<span class="string">&#x27;?&#x27;</span>, <span class="built_in">help</span>=<span class="string">&quot;URI of the output stream&quot;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&quot;--network&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&quot;resnet18-body&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;pre-trained model to load (see below for options)&quot;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&quot;--overlay&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&quot;links,keypoints&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;pose overlay flags (e.g. --overlay=links,keypoints)\nvalid combinations are:  &#x27;links&#x27;, &#x27;keypoints&#x27;, &#x27;boxes&#x27;, &#x27;none&#x27;&quot;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&quot;--threshold&quot;</span>, <span class="built_in">type</span>=<span class="built_in">float</span>, default=<span class="number">0.15</span>, <span class="built_in">help</span>=<span class="string">&quot;minimum detection threshold to use&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">args = parser.parse_known_args()[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">parser.print_help()</span><br><span class="line">sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># load the pose estimation model</span></span><br><span class="line">net = poseNet(args.network, sys.argv, args.threshold)</span><br><span class="line"></span><br><span class="line"><span class="comment"># create video sources &amp; outputs</span></span><br><span class="line"><span class="built_in">input</span> = videoSource(args.<span class="built_in">input</span>, argv=sys.argv)</span><br><span class="line">output = videoOutput(args.output, argv=sys.argv)</span><br><span class="line"></span><br><span class="line"><span class="comment"># process frames until EOS or the user exits</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># capture the next image</span></span><br><span class="line">    img = <span class="built_in">input</span>.Capture()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> img <span class="keyword">is</span> <span class="literal">None</span>: <span class="comment"># timeout</span></span><br><span class="line">        <span class="keyword">continue</span>  </span><br><span class="line"></span><br><span class="line">    <span class="comment"># perform pose estimation (with overlay)</span></span><br><span class="line">    poses = net.Process(img, overlay=args.overlay)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print the pose results</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;detected &#123;:d&#125; objects in image&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(poses)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> pose <span class="keyword">in</span> poses:</span><br><span class="line">        <span class="built_in">print</span>(pose)</span><br><span class="line">        <span class="built_in">print</span>(pose.Keypoints)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Links&#x27;</span>, pose.Links)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># render the image</span></span><br><span class="line">    output.Render(img)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># update the title bar</span></span><br><span class="line">    output.SetStatus(<span class="string">&quot;&#123;:s&#125; | Network &#123;:.0f&#125; FPS&quot;</span>.<span class="built_in">format</span>(args.network, net.GetNetworkFPS()))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print out performance info</span></span><br><span class="line">    net.PrintProfilerTimes()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># exit on input/output EOS</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">input</span>.IsStreaming() <span class="keyword">or</span> <span class="keyword">not</span> output.IsStreaming():</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="sys"><a href="#sys" class="headerlink" title="sys"></a>sys</h3><p>当然，以下是关于 <code>sys</code> 模块以及 <code>sys.exit(0)</code> 和 <code>sys.argv</code> 的详细解释：</p><h4 id="sys-模块"><a href="#sys-模块" class="headerlink" title="sys 模块"></a><code>sys</code> 模块</h4><p><code>sys</code> 是 Python 的一个内置模块，它提供了对解释器使用或维护的某些变量的访问，以及与解释器强烈相关的函数。这个模块包含了与 Python 解释器及其环境操作相关的功能。<br>以下是一些 <code>sys</code> 模块提供的常见功能：</p><ul><li>访问命令行参数 (<code>sys.argv</code>)</li><li>控制解释器行为（例如，<code>sys.exit()</code>）</li><li>访问系统特定的参数和函数（例如，<code>sys.platform</code>）</li><li>捕获和处理异常（例如，<code>sys.exc_info()</code>）</li></ul><h4 id="sys-exit-arg"><a href="#sys-exit-arg" class="headerlink" title="sys.exit([arg])"></a><code>sys.exit([arg])</code></h4><p><code>sys.exit()</code> 是一个函数，用于从 Python 程序中退出。当你调用 <code>sys.exit()</code> 时，它会引发一个 <code>SystemExit</code> 异常。这个异常可以通过代码捕获，如果不被捕获，则会终止程序。<br>参数 <code>arg</code> 可以是以下之一：</p><ul><li>如果没有提供参数或参数为 <code>None</code>，则退出代码默认为 <code>0</code>，表示正常退出。</li><li>如果提供了整数，则该整数将用作退出代码返回给调用环境。通常，退出代码 <code>0</code> 表示成功，非零值表示错误或特定类型的错误。<br>在示例代码中，<code>sys.exit(0)</code> 用于在解析命令行参数失败时退出程序，返回代码 <code>0</code> 表示正常退出。</li></ul><h4 id="sys-argv"><a href="#sys-argv" class="headerlink" title="sys.argv"></a><code>sys.argv</code></h4><p><code>sys.argv</code> 是一个列表，包含了命令行传递给 Python 脚本的参数。<code>argv</code> 是 “argument vector” 的缩写，它通常包含以下内容：</p><ul><li><code>sys.argv[0]</code>：脚本的名称（作为执行命令的一部分）。</li><li><code>sys.argv[1]</code>：第一个命令行参数。</li><li><code>sys.argv[2]</code>：第二个命令行参数。</li><li>…以此类推。<br>例如，如果你从命令行运行以下命令：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python script.py arg1 arg2 arg3</span><br></pre></td></tr></table></figure>那么 <code>sys.argv</code> 将会是这样的列表：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&#x27;script.py&#x27;</span>, <span class="string">&#x27;arg1&#x27;</span>, <span class="string">&#x27;arg2&#x27;</span>, <span class="string">&#x27;arg3&#x27;</span>]</span><br></pre></td></tr></table></figure>在示例代码中，<code>sys.argv</code> 被传递给 <code>argparse</code> 解析器，以便它可以解析脚本名称后面的所有命令行参数。此外，<code>sys.argv</code> 也被传递给 <code>videoSource</code> 和 <code>videoOutput</code>，这样它们就可以处理传递给它们的任何额外参数。</li></ul><h3 id="argparse"><a href="#argparse" class="headerlink" title="argparse"></a>argparse</h3><p><code>argparse</code> 是 Python 标准库中的一个模块，它提供了一个方便的方式来解析命令行参数。这个模块使得编写用户友好的命令行接口变得简单。下面是关于 <code>argparse</code> 的详细解释：</p><h4 id="为什么要使用-argparse？"><a href="#为什么要使用-argparse？" class="headerlink" title="为什么要使用 argparse？"></a>为什么要使用 <code>argparse</code>？</h4><p>在命令行工具和脚本中，经常需要处理用户输入的参数。在没有 <code>argparse</code> 之前，开发者通常会使用 <code>sys.argv</code> 直接处理这些参数，但这种方法在参数类型多样、参数数量较多或者需要帮助信息和错误处理时变得复杂。<code>argparse</code> 模块提供以下功能：</p><ul><li>自动生成帮助信息和使用说明。</li><li>支持不同类型的参数（如整数、浮点数、布尔值等）。</li><li>支持默认值。</li><li>生成错误信息并处理非法输入。</li></ul><h4 id="argparse-基础使用"><a href="#argparse-基础使用" class="headerlink" title="argparse 基础使用"></a><code>argparse</code> 基础使用</h4><p>以下是使用 <code>argparse</code> 的基本步骤：</p><ol><li><strong>导入模块</strong>：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> argparse</span><br></pre></td></tr></table></figure></li><li><strong>创建解析器</strong>：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parser = argparse.ArgumentParser(description=<span class="string">&#x27;Process some integers.&#x27;</span>)</span><br></pre></td></tr></table></figure>这里 <code>description</code> 参数是可选的，但建议提供，因为它会在帮助信息中显示。</li><li><strong>添加参数</strong>：<br>使用 <code>add_argument()</code> 方法添加参数。例如：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">parser.add_argument(<span class="string">&#x27;integers&#x27;</span>, metavar=<span class="string">&#x27;N&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, nargs=<span class="string">&#x27;+&#x27;</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;an integer for the accumulator&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;--sum&#x27;</span>, dest=<span class="string">&#x27;accumulate&#x27;</span>, action=<span class="string">&#x27;store_const&#x27;</span>,</span><br><span class="line">                    const=<span class="built_in">sum</span>, default=<span class="built_in">max</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;sum the integers (default: find the max)&#x27;</span>)</span><br></pre></td></tr></table></figure><ul><li><code>&#39;integers&#39;</code> 是参数的名字，它在命令行中使用。</li><li><code>metavar=&#39;N&#39;</code> 定义了在帮助信息中显示的参数名。</li><li><code>type=int</code> 指定了参数应该被转换为整数。</li><li><code>nargs=&#39;+&#39;</code> 表示这个参数可以接收一个或多个值。</li><li><code>help=&#39;...&#39;</code> 提供了关于参数的简要说明。</li></ul></li><li><strong>解析参数</strong>：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">args = parser.parse_args()</span><br></pre></td></tr></table></figure>这将处理命令行参数并返回一个包含所有参数值的 <code>Namespace</code> 对象。</li><li><strong>使用参数</strong>：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(args.accumulate(args.integers))</span><br></pre></td></tr></table></figure>在这个例子中，<code>args.integers</code> 包含了所有提供的整数，<code>args.accumulate</code> 是一个函数（<code>sum</code> 或 <code>max</code>），它将被应用到这些整数上。</li></ol><h4 id="高级功能"><a href="#高级功能" class="headerlink" title="高级功能"></a>高级功能</h4><p><code>argparse</code> 还提供了许多高级功能，比如：</p><ul><li><strong>子命令</strong>：可以为程序定义多个子命令，每个子命令有自己的参数。</li><li><strong>互斥组</strong>：使用 <code>argparse</code> 的 <code>add_mutually_exclusive_group()</code> 方法可以创建一组参数，它们之间是互斥的。</li><li><strong>自定义动作</strong>：可以定义自定义动作来处理特定的参数。</li></ul><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>下面是一个简单的 <code>argparse</code> 使用示例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="comment"># 创建解析器</span></span><br><span class="line">parser = argparse.ArgumentParser(description=<span class="string">&#x27;示例脚本&#x27;</span>)</span><br><span class="line"><span class="comment"># 添加参数</span></span><br><span class="line">parser.add_argument(<span class="string">&#x27;filename&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;文件名&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;--verbose&#x27;</span>, <span class="string">&#x27;-v&#x27;</span>, action=<span class="string">&#x27;store_true&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;详细输出&#x27;</span>)</span><br><span class="line"><span class="comment"># 解析参数</span></span><br><span class="line">args = parser.parse_args()</span><br><span class="line"><span class="comment"># 使用参数</span></span><br><span class="line"><span class="keyword">if</span> args.verbose:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;处理文件：<span class="subst">&#123;args.filename&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p>在命令行中，你可以这样调用这个脚本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python script.py example.txt --verbose</span><br></pre></td></tr></table></figure><p>或者使用简写形式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python script.py example.txt -v</span><br></pre></td></tr></table></figure><p><code>argparse</code> 模块功能强大，能够帮助开发者快速构建出健壮、用户友好的命令行工具。</p><h4 id="argparse-解析器配置"><a href="#argparse-解析器配置" class="headerlink" title="argparse 解析器配置"></a><code>argparse</code> 解析器配置</h4><p>以下是对提供的 <code>argparse</code> 解析器配置的详细中文解释：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一个 ArgumentParser 对象，用于解析命令行参数。</span></span><br><span class="line"><span class="comment"># ArgumentParser 的参数描述如下：</span></span><br><span class="line">parser = argparse.ArgumentParser(</span><br><span class="line">    description=<span class="string">&quot;Run pose estimation DNN on a video/image stream.&quot;</span>,  <span class="comment"># 描述：这个脚本运行在视频/图像流上的姿态估计深度神经网络。</span></span><br><span class="line">    formatter_class=argparse.RawTextHelpFormatter,  <span class="comment"># 格式化类：使用 RawTextHelpFormatter 以保持帮助信息的原始文本格式。</span></span><br><span class="line">    epilog=poseNet.Usage() + videoSource.Usage() + videoOutput.Usage() + Log.Usage()  <span class="comment"># 结尾信息：显示 poseNet、videoSource、videoOutput 和 Log 的使用说明。</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># 添加命令行参数，每个 add_argument 方法的参数解释如下：</span></span><br><span class="line"><span class="comment"># 输入流参数</span></span><br><span class="line">parser.add_argument(</span><br><span class="line">    <span class="string">&quot;input&quot;</span>,  <span class="comment"># 参数名：input</span></span><br><span class="line">    <span class="built_in">type</span>=<span class="built_in">str</span>,  <span class="comment"># 参数类型：字符串</span></span><br><span class="line">    default=<span class="string">&quot;&quot;</span>,  <span class="comment"># 默认值：空字符串</span></span><br><span class="line">    nargs=<span class="string">&#x27;?&#x27;</span>,  <span class="comment"># 参数数量：0或1个，即这个参数是可选的</span></span><br><span class="line">    <span class="built_in">help</span>=<span class="string">&quot;URI of the input stream&quot;</span>  <span class="comment"># 帮助信息：输入流的统一资源标识符（URI）</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># 输出流参数</span></span><br><span class="line">parser.add_argument(</span><br><span class="line">    <span class="string">&quot;output&quot;</span>,  <span class="comment"># 参数名：output</span></span><br><span class="line">    <span class="built_in">type</span>=<span class="built_in">str</span>,  <span class="comment"># 参数类型：字符串</span></span><br><span class="line">    default=<span class="string">&quot;&quot;</span>,  <span class="comment"># 默认值：空字符串</span></span><br><span class="line">    nargs=<span class="string">&#x27;?&#x27;</span>,  <span class="comment"># 参数数量：0或1个，即这个参数是可选的</span></span><br><span class="line">    <span class="built_in">help</span>=<span class="string">&quot;URI of the output stream&quot;</span>  <span class="comment"># 帮助信息：输出流的统一资源标识符（URI）</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># 网络模型参数</span></span><br><span class="line">parser.add_argument(</span><br><span class="line">    <span class="string">&quot;--network&quot;</span>,  <span class="comment"># 参数名：network，前缀 &#x27;--&#x27; 表示这是一个可选参数</span></span><br><span class="line">    <span class="built_in">type</span>=<span class="built_in">str</span>,  <span class="comment"># 参数类型：字符串</span></span><br><span class="line">    default=<span class="string">&quot;resnet18-body&quot;</span>,  <span class="comment"># 默认值：&quot;resnet18-body&quot;</span></span><br><span class="line">    <span class="built_in">help</span>=<span class="string">&quot;pre-trained model to load (see below for options)&quot;</span>  <span class="comment"># 帮助信息：要加载的预训练模型（请参阅下面的选项）</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># 覆盖层参数</span></span><br><span class="line">parser.add_argument(</span><br><span class="line">    <span class="string">&quot;--overlay&quot;</span>,  <span class="comment"># 参数名：overlay</span></span><br><span class="line">    <span class="built_in">type</span>=<span class="built_in">str</span>,  <span class="comment"># 参数类型：字符串</span></span><br><span class="line">    default=<span class="string">&quot;links,keypoints&quot;</span>,  <span class="comment"># 默认值：&quot;links,keypoints&quot;</span></span><br><span class="line">    <span class="built_in">help</span>=<span class="string">&quot;&quot;&quot;pose overlay flags (e.g. --overlay=links,keypoints)</span></span><br><span class="line"><span class="string">valid combinations are: &#x27;links&#x27;, &#x27;keypoints&#x27;, &#x27;boxes&#x27;, &#x27;none&#x27;&quot;&quot;&quot;</span>  <span class="comment"># 帮助信息：姿态覆盖标志（例如：--overlay=links,keypoints）</span></span><br><span class="line">    <span class="comment"># 合法的组合有：&#x27;links&#x27;, &#x27;keypoints&#x27;, &#x27;boxes&#x27;, &#x27;none&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># 阈值参数</span></span><br><span class="line">parser.add_argument(</span><br><span class="line">    <span class="string">&quot;--threshold&quot;</span>,  <span class="comment"># 参数名：threshold</span></span><br><span class="line">    <span class="built_in">type</span>=<span class="built_in">float</span>,  <span class="comment"># 参数类型：浮点数</span></span><br><span class="line">    default=<span class="number">0.15</span>,  <span class="comment"># 默认值：0.15</span></span><br><span class="line">    <span class="built_in">help</span>=<span class="string">&quot;minimum detection threshold to use&quot;</span>  <span class="comment"># 帮助信息：要使用的最小检测阈值</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>这个配置为脚本定义了一系列命令行参数，用户可以通过这些参数来控制脚本的运行行为。以下是对每个参数的详细解释：</p><ul><li><code>input</code>：这是一个位置参数，用户必须提供输入流的URI，如果没有提供，则默认为空字符串。这个参数用于指定要处理的视频或图像流的来源。</li><li><code>output</code>：这也是一个位置参数，用户可以提供输出流的URI，如果没有提供，则默认为空字符串。这个参数用于指定处理后的视频或图像流的目的地。</li><li><code>--network</code>：这是一个可选参数，用于指定要加载的预训练模型。用户可以通过这个参数选择不同的网络模型来执行姿态估计。</li><li><code>--overlay</code>：这是一个可选参数，用于指定在输出流上要显示的姿态覆盖层。用户可以选择显示链接、关键点、边界框或者不显示任何覆盖层。</li><li><code>--threshold</code>：这是一个可选参数，用于设置检测姿态的最小阈值。只有当检测置信度高于这个阈值时，姿态才会被识别和显示。<br>用户可以在命令行中按照以下格式提供这些参数：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python script.py input_stream_uri output_stream_uri --network model_name --overlay <span class="built_in">type</span> --threshold value</span><br></pre></td></tr></table></figure>其中 <code>input_stream_uri</code> 和 <code>output_stream_uri</code> 是必须提供的，其他参数根据需要选择性地提供。</li></ul>]]></content>
      
      
      <categories>
          
          <category> Jetson Nano </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> AI </tag>
            
            <tag> Jetson Nano </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux嵌入式QT开发</title>
      <link href="/2024/09/19/Linux%E5%B5%8C%E5%85%A5%E5%BC%8FQT%E5%BC%80%E5%8F%91/"/>
      <url>/2024/09/19/Linux%E5%B5%8C%E5%85%A5%E5%BC%8FQT%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<h2 id="类和对象"><a href="#类和对象" class="headerlink" title="类和对象"></a>类和对象</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    string name;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;小狗的名字是:&quot;</span>&lt;&lt;name&lt;&lt;<span class="string">&quot;,&quot;</span>&lt;&lt;<span class="string">&quot;年龄是:&quot;</span>&lt;&lt;age&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Dog dog1;</span><br><span class="line"></span><br><span class="line">    dog1.name=<span class="string">&quot;旺财&quot;</span>;</span><br><span class="line">    dog1.age=<span class="number">2</span>;</span><br><span class="line">    dog1.<span class="built_in">run</span>();</span><br><span class="line"></span><br><span class="line">    Dog *dog2 = <span class="keyword">new</span> <span class="built_in">Dog</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">NULL</span> == dog2)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dog2-&gt;name=<span class="string">&quot;富贵&quot;</span>;</span><br><span class="line">    dog2-&gt;age=<span class="number">1</span>;</span><br><span class="line">    dog2-&gt;<span class="built_in">run</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">delete</span> dog2;</span><br><span class="line">    dog2=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h3><h4 id="栈上创建-dog1"><a href="#栈上创建-dog1" class="headerlink" title="栈上创建 (dog1)"></a>栈上创建 (<code>dog1</code>)</h4><p><strong>解释：</strong></p><ol><li><strong>声明和定义：</strong> <code>Dog dog1;</code> 在栈上声明并定义了一个<code>Dog</code>类型的对象<code>dog1</code>。栈上的对象在定义它的作用域结束时自动销毁。</li><li><strong>成员赋值：</strong> 通过点操作符<code>.</code>，您可以访问和修改<code>dog1</code>对象的公共成员变量<code>name</code>和<code>age</code>。</li><li><strong>调用成员函数：</strong> <code>dog1.run();</code> 调用了<code>dog1</code>对象的<code>run</code>成员函数，输出小狗的名字和年龄。</li><li><strong>生命周期：</strong> 当<code>main</code>函数执行完毕，<code>dog1</code>对象的生命周期结束，它的析构函数（如果有的话）将被调用，释放它所占用的资源。</li></ol><h4 id="堆上创建-dog2"><a href="#堆上创建-dog2" class="headerlink" title="堆上创建 (dog2)"></a>堆上创建 (<code>dog2</code>)</h4><p><strong>解释：</strong></p><ol><li><strong>动态分配：</strong> <code>Dog *dog2 = new Dog();</code> 使用<code>new</code>关键字在堆上动态分配了一个<code>Dog</code>类型的对象，并返回了这个对象的指针。指针<code>dog2</code>存储了对象在内存中的地址。</li><li><strong>成员赋值：</strong> 由于<code>dog2</code>是一个指针，您需要使用箭头操作符<code>-&gt;</code>来访问对象的成员变量。</li><li><strong>调用成员函数：</strong> 同样使用箭头操作符<code>-&gt;</code>来调用<code>dog2</code>指向的对象的成员函数。</li><li><strong>手动管理生命周期：</strong> 在堆上分配的对象不会自动销毁，需要程序员手动管理。使用<code>delete dog2;</code>来释放<code>dog2</code>指向的内存，防止内存泄漏。之后，将<code>dog2</code>设置为<code>NULL</code>是一个好习惯，这样可以避免悬空指针的问题，即避免使用已经释放的内存。<br> <strong>总结</strong></li></ol><ul><li><strong>栈上创建</strong>的对象生命周期由编译器管理，简单且安全，但栈空间有限，不适合创建大量或大对象。</li><li><strong>堆上创建</strong>的对象生命周期由程序员管理，提供了更大的灵活性，但需要手动释放内存，容易出错（如忘记释放或重复释放内存）。<br>两种方式的选择取决于具体的应用场景和性能要求。在大多数情况下，简单的对象可以使用栈分配，而复杂或大量对象则适合使用堆分配。</li></ul><h3 id="构造函数与析构函数"><a href="#构造函数与析构函数" class="headerlink" title="构造函数与析构函数"></a>构造函数与析构函数</h3><blockquote><p>属于特殊的成员函数</p></blockquote><h4 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h4><blockquote><p>构造函数在对象实例化时被系统自动调用，仅调用一次。定义类时，如果没有定义构造函数和析构函数，编译器就会生成一个构造函数和析构函数，只是这个构造函数和析构函数什么事情也不做。</p></blockquote><blockquote><p>构造函数的特点如下:</p><ol><li>构造函数必须与类名同名</li><li>可以重载</li><li>没有返回类型，即使是void也不行</li></ol></blockquote><h4 id="析构函数"><a href="#析构函数" class="headerlink" title="析构函数"></a>析构函数</h4><blockquote><p>与构造函数相反，在对象结束其生命周期时系统自动执行析构函数。实际上定义类时，编译器会生成一个析构函数</p></blockquote><blockquote><p>析构函数的特点如下:</p><ol><li>析构函数的格式为~类名()</li><li>调用时释放内存(资源)</li><li>~类名()不能加参数</li><li>没有返回值，即使是void也不行</li></ol></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Dog</span>();</span><br><span class="line">~<span class="built_in">Dog</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Dog dog;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;构造函数与析构函数示例&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dog::<span class="built_in">Dog</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;构造函数执行！&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dog::~<span class="built_in">Dog</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;析构函数执行！&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>执行结果:</strong><br>构造函数执行！<br>构造函数与析构函数示例<br>析构函数执行！</p><h3 id="对象的生命周期"><a href="#对象的生命周期" class="headerlink" title="对象的生命周期"></a>对象的生命周期</h3><p>在 C++ 中，对象的生命周期指的是对象从创建到销毁的整个过程。生命周期结束意味着对象不再存在，其占用的内存将被回收，并且与该对象相关的资源（如打开的文件句柄、网络连接等）也将被释放。以下是详细说明：</p><h4 id="对象生命周期的几个阶段："><a href="#对象生命周期的几个阶段：" class="headerlink" title="对象生命周期的几个阶段："></a>对象生命周期的几个阶段：</h4><ol><li><strong>创建（Construction）</strong>：<ul><li>当对象被创建时，其生命周期开始。这可以通过多种方式完成，例如在栈上声明、在堆上使用 <code>new</code> 分配或者在全局&#x2F;静态存储区中声明。</li></ul></li><li><strong>存在（Existence）</strong>：<ul><li>在这个阶段，对象是有效的，可以访问其成员变量和调用成员函数。</li></ul></li><li><strong>销毁（Destruction）</strong>：<ul><li>对象的生命周期结束，通常由以下情况触发：<ul><li>栈上的局部对象：当包含它们的代码块（如函数体）结束时。</li><li>堆上的对象：当使用 <code>delete</code> 操作符显式释放它们时。</li><li>全局&#x2F;静态对象：当程序结束时。</li></ul></li></ul></li></ol><h4 id="生命周期结束的具体含义："><a href="#生命周期结束的具体含义：" class="headerlink" title="生命周期结束的具体含义："></a>生命周期结束的具体含义：</h4><ul><li><strong>栈对象</strong>：<ul><li>对于在栈上创建的对象，当它们离开作用域（例如，函数返回）时，它们的析构函数（如果有的话）会被自动调用，随后对象占用的内存将被回收。</li></ul></li><li><strong>堆对象</strong>：<ul><li>对于在堆上创建的对象，必须使用 <code>delete</code> 操作符来显式结束其生命周期。当 <code>delete</code> 被调用时，对象的析构函数会被执行，然后对象占用的内存被回收。</li></ul></li><li><strong>全局&#x2F;静态对象</strong>：<ul><li>全局或静态对象的析构函数会在程序结束时自动调用。</li></ul></li></ul><h4 id="生命周期结束后的行为："><a href="#生命周期结束后的行为：" class="headerlink" title="生命周期结束后的行为："></a>生命周期结束后的行为：</h4><ul><li><strong>成员变量</strong>：<ul><li>对象的成员变量所占用的内存也随之释放。</li></ul></li><li><strong>资源管理</strong>：<ul><li>如果对象负责管理资源（如动态分配的内存、文件句柄等），则其析构函数通常会负责释放这些资源。</li></ul></li><li><strong>引用或指针</strong>：<ul><li>如果有其他变量（如引用或指针）指向该对象，那么这些变量将变成悬空引用或悬空指针，继续使用它们将导致未定义行为。<br>理解对象的生命周期对于编写高效且无内存泄漏的 C++ 程序至关重要。正确管理对象的生命周期可以帮助避免许多常见的编程错误，如内存泄漏、悬挂指针和资源泄露。</li></ul></li></ul><h3 id="this指针"><a href="#this指针" class="headerlink" title="this指针"></a>this指针</h3><p>一个类的不同对象在调用自己的成员函数时，其实他们调用的是同一段函数代码，那么成员函数如何知道要访问哪个对象的数据成员呢？</p><p>没错，就是通过this指针。每个对象都有一个this指针，this指针记录对象的内存地址。在C++中，this指针是指向类自身数据的指针，简单的来说就是指向当前类的当前实例对象。</p><p>关于类的this指针有以下特点:</p><ol><li>this只能在成员函数中使用，全局函数、静态函数都不能使用this。实际上，成员函数默认第一个参数为T *const this。也就是一个类里面的成员函数int func(int p),func的原型在编译器看来应该是int func(T *const this,int p)</li><li>this在成员函数的开始前构造，在成员函数的结束后清除</li><li>this指针会因编译器不同而有不同的放置位置。可能是栈，也可能是寄存器，甚至全局变量</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    string name;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Person</span>(<span class="type">const</span> string&amp; name) : <span class="built_in">name</span>(name) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">greet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;你好，我是&quot;</span> &lt;&lt; <span class="keyword">this</span>-&gt;name &lt;&lt; <span class="string">&quot;。&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">rename</span><span class="params">(<span class="type">const</span> string&amp; newName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;name = newName; <span class="comment">// 使用this指针更新当前实例的name</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 创建两个Person实例</span></span><br><span class="line">    <span class="function">Person <span class="title">person1</span><span class="params">(<span class="string">&quot;张三&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">Person <span class="title">person2</span><span class="params">(<span class="string">&quot;李四&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用greet方法，通过this指针输出各自的名字</span></span><br><span class="line">    person1.<span class="built_in">greet</span>(); <span class="comment">// 输出: 你好，我是张三。</span></span><br><span class="line">    person2.<span class="built_in">greet</span>(); <span class="comment">// 输出: 你好，我是李四。</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更改person1的名字，并再次调用greet方法</span></span><br><span class="line">    person1.<span class="built_in">rename</span>(<span class="string">&quot;王五&quot;</span>);</span><br><span class="line">    person1.<span class="built_in">greet</span>(); <span class="comment">// 输出: 你好，我是王五。</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更改person2的名字，并再次调用greet方法</span></span><br><span class="line">    person2.<span class="built_in">rename</span>(<span class="string">&quot;赵六&quot;</span>);</span><br><span class="line">    person2.<span class="built_in">greet</span>(); <span class="comment">// 输出: 你好，我是赵六。</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 C++ 中，<code>Person(const string&amp; name) : name(name) &#123;&#125;</code> 是一个类 <code>Person</code> 的构造函数的定义，使用了初始化列表来初始化成员变量。<br>让我们分解这个构造函数：</p><ul><li><code>Person(const string&amp; name)</code>：这是构造函数的声明，它接受一个 <code>const string&amp;</code> 类型的参数 <code>name</code>。使用 <code>const string&amp;</code> 是一种引用传递的方式，这样可以避免不必要的字符串拷贝，并且保证传递的字符串在函数内部不会被修改。</li><li><code>: name(name)</code>：这是构造函数的初始化列表部分。在这里，<code>name(name)</code> 表示将构造函数的参数 <code>name</code> 的值传递给类的成员变量 <code>name</code>。在初始化列表中，<code>name</code> 出现了两次，第一个 <code>name</code> 是成员变量的名字，第二个 <code>name</code> 是构造函数参数的名字。这种写法有时会导致一些混淆，但它是在告诉编译器，将传入的 <code>name</code> 参数的值赋给成员变量 <code>name</code>。</li><li><code>&#123;&#125;</code>：这是构造函数的函数体。在这个例子中，函数体是空的，因为所有的初始化工作已经在初始化列表中完成了。<br>综上所述，这个构造函数的作用是创建一个 <code>Person</code> 对象，并将其 <code>name</code> 成员变量初始化为传入的参数值。使用初始化列表是一种效率较高的初始化成员变量的方式，特别是当成员变量是引用或常量时，它必须在构造函数体执行之前被初始化。</li></ul><h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>面向对象程序设计中最重要的一个概念是继承。继承允许我们依据另一个类来定义一个类，这使得创建和维护一个应用程序变得更容易。这样做，也达到了重用代码功能和提高执行效率的效果。</p><p>当创建一个类时，您不需要重新编写新的数据成员和成员函数，只需指定新建的类继承了一个已有的类的成员即可。这个已有的类称为基类，新建的类称为派生类。在QT里大量的使用了这种特性，当QT里的类不满足自己的要求是，我们可以重写这个类，就是通过继承需要重写的类，来实现自己的类的功能。</p><p>一个类可以派生自多个类，这意味着，它可以从多个基类继承数据和函数。定义一个派生类，我们使用一个类派生列表来指定基类。类派生列表以一个或多个基类命名，形式如下:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">derived</span>-<span class="keyword">class</span>: access-specifier base-<span class="keyword">class</span></span><br></pre></td></tr></table></figure><p>与类的访问修饰限定符一样，继承的方式也有几种。其中，访问修饰符<code>access-specifier</code>是public、protect或private其中的一个，base-class是之前定义过的某个类的名称。如果未使用访问修饰符<code>access-specifier</code>，则默认为private。</p><h3 id="公有继承public"><a href="#公有继承public" class="headerlink" title="公有继承public"></a>公有继承public</h3><p>当一个类派生继承公有基类时，基类的公有成员也是派生类的公有成员，基类的保护成员也是派生类的保护成员，基类的私有成员不能直接被派生类访问，但是可以通过调用基类的公有和保护成员来访问</p><h3 id="保护继承protected"><a href="#保护继承protected" class="headerlink" title="保护继承protected"></a>保护继承protected</h3><p>当一个类派生继承保护基类时，基类的公有和保护成员将成为派生类的保护成员</p><h3 id="私有继承private"><a href="#私有继承private" class="headerlink" title="私有继承private"></a>私有继承private</h3><p>当一个类派生继承私有基类时，基类的公有和保护成员将成为派生类的私有成员</p><p>在面向对象的编程语言中，如 C++，类成员可以被指定为公有（public）、保护（protected）或私有（private），这些关键字用于实现封装，即控制类成员的访问权限。以下是这三种成员的详细解释：<br><strong>公有成员（Public Members）</strong><br>公有成员是在类定义中使用 <code>public</code> 关键字声明的成员。公有成员可以被类的对象直接访问，也可以被类的外部函数访问。</p><ul><li><strong>特点</strong>：<ul><li>可以被类的任何对象访问。</li><li>可以在类的外部通过对象直接访问。</li><li>通常包含类的接口，即那些用于与类交互的函数和属性。</li></ul></li><li><strong>示例</strong>：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setName</span><span class="params">(<span class="type">const</span> std::string&amp; newName)</span> </span>&#123;</span><br><span class="line">        name = newName;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">std::string <span class="title">getName</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::string name;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>在这个例子中，<code>setName</code> 和 <code>getName</code> 是公有成员函数，它们可以被任何 <code>Person</code> 类的对象调用。<br><strong>保护成员（Protected Members）</strong><br>保护成员是在类定义中使用 <code>protected</code> 关键字声明的成员。保护成员的行为类似于私有成员，但它们可以被派生类访问。</li><li><strong>特点</strong>：<ul><li>不能被类的对象直接访问。</li><li>可以被类的成员函数访问。</li><li>可以被派生类（子类）的成员函数访问。</li></ul></li><li><strong>示例</strong>：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span> &#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="type">int</span> protectedData;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Derived</span> : <span class="keyword">public</span> Base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setProtectedData</span><span class="params">(<span class="type">int</span> data)</span> </span>&#123;</span><br><span class="line">        protectedData = data; <span class="comment">// 在派生类中可以访问</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>在这个例子中，<code>protectedData</code> 是保护成员，它不能被 <code>Base</code> 类的对象直接访问，但可以在 <code>Derived</code> 类的成员函数 <code>setProtectedData</code> 中访问。<br><strong>私有成员（Private Members）</strong><br>私有成员是在类定义中使用 <code>private</code> 关键字声明的成员。私有成员只能被类的成员函数访问，不能被类的对象或类的外部函数直接访问。</li><li><strong>特点</strong>：<ul><li>不能被类的对象直接访问。</li><li>可以被类的成员函数访问。</li><li>不能被派生类访问，除非通过基类的公有或保护成员函数。</li></ul></li><li><strong>示例</strong>：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setAge</span><span class="params">(<span class="type">int</span> newAge)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (newAge &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            age = newAge;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getAge</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>在这个例子中，<code>age</code> 是私有成员，它不能被 <code>Person</code> 类的对象直接访问，但可以通过公有成员函数 <code>setAge</code> 和 <code>getAge</code> 来设置和获取。<br>通过使用公有、保护和私有成员，C++ 类可以隐藏其内部实现细节，只暴露必要的接口，这是面向对象编程中的一个重要原则。</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">animal</span> &#123;</span><br><span class="line"><span class="type">int</span> weight;</span><br><span class="line">string color;</span><br><span class="line"></span><br><span class="line">&#125;animal;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> :<span class="keyword">public</span> Animal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">string name;</span><br><span class="line"><span class="type">int</span> age;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Dog dog;</span><br><span class="line">dog.name = <span class="string">&quot;旺财&quot;</span>;</span><br><span class="line">dog.age = <span class="number">2</span>;</span><br><span class="line">dog.animal.color = <span class="string">&quot;黑色&quot;</span>;</span><br><span class="line">dog.animal.weight = <span class="number">120</span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;名字:&quot;</span> &lt;&lt; dog.name &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;年龄:&quot;</span> &lt;&lt; dog.age &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;颜色:&quot;</span> &lt;&lt; dog.animal.color &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;体重:&quot;</span> &lt;&lt; dog.animal.weight &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="重载"><a href="#重载" class="headerlink" title="重载"></a>重载</h2><p>C++允许在同一作用域中的某个函数和运算符指定多个定义，分别称为<code>函数重载</code>和<code>运算符重载</code></p><p>重载声明是指一个与之前已经在该作用域声明过的函数或方法具有相同名称的声明，但是它们的参数列表和定义(实现)不相同</p><p>当调用时，编译器通过使用的参数类型和定义中的参数类型进行比较。决定选用最合适的定义，这个过程称为<code>重载决策</code></p><h3 id="函数重载"><a href="#函数重载" class="headerlink" title="函数重载"></a>函数重载</h3><p>同一个作用域内，可以声明几个功能类似的同名函数，但是这些同名函数的形式参数必须不同。我们不能仅通过返回类型的不同来重载函数。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">string name;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getWeight</span><span class="params">(<span class="type">int</span> weight)</span> </span>&#123;</span><br><span class="line">cout &lt;&lt; name &lt;&lt; <span class="string">&quot;的体重是:&quot;</span> &lt;&lt; weight &lt;&lt; <span class="string">&quot;kG&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getWeight</span><span class="params">(<span class="type">double</span> weight)</span> </span>&#123;</span><br><span class="line">cout &lt;&lt; name &lt;&lt; <span class="string">&quot;的体重是:&quot;</span> &lt;&lt; weight &lt;&lt; <span class="string">&quot;kG&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Dog dog;</span><br><span class="line">dog.name = <span class="string">&quot;旺财&quot;</span>;</span><br><span class="line">dog.<span class="built_in">getWeight</span>(<span class="number">10</span>);</span><br><span class="line">dog.<span class="built_in">getWeight</span>(<span class="number">10.5</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>避免用户传入的参数类型不在我们写的重载函数里，还可以多写几个类型的</p><h3 id="运算符重载"><a href="#运算符重载" class="headerlink" title="运算符重载"></a>运算符重载</h3><p>运算符重载的实质就是函数重载或函数多态。运算符重载是一种形式的C++多态。要重载运算符，需要使用被称为运算符函数的特殊函数形式，运算符函数形式:operatorp(argument-list),operator后面的<code>p</code>为要重载的运算符符号。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;返回类型说明符&gt;<span class="built_in">operator</span>&lt;运算符符号&gt;(&lt;参数表&gt;)</span><br><span class="line">&#123;</span><br><span class="line">    &lt;函数体&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">```cpp</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">int</span> weight;</span><br><span class="line">Dog <span class="keyword">operator</span>+(<span class="type">int</span> d)</span><br><span class="line">&#123;</span><br><span class="line">Dog dog;</span><br><span class="line">dog.weight = <span class="keyword">this</span>-&gt;weight + d;</span><br><span class="line"><span class="keyword">return</span> dog;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Dog dog1;</span><br><span class="line">Dog dog2;</span><br><span class="line">Dog dog3;</span><br><span class="line"></span><br><span class="line">dog1.weight = <span class="number">10</span>;</span><br><span class="line">dog2.weight = <span class="number">20</span>;</span><br><span class="line">dog3 = dog1 + <span class="number">4</span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;第三只狗的体重:&quot;</span> &lt;&lt; dog3.weight &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h2><p>C++多态意味着调用成员函数时，会根据调用函数的对象的类型来执行不同的函数；<br>形成多态必须具备三个条件:</p><ol><li>必须存在继承关系</li><li>继承关系必须有同名虚函数(其中虚函数是在基类中使用关键字virtual声明的函数，在派生类中重新定义基类中定义的虚函数时，会告诉编译器不要静态链接到该函数)</li><li>存在基类类型的指针或引用，通过该指针或引用调用虚函数</li></ol><h3 id="虚函数"><a href="#虚函数" class="headerlink" title="虚函数"></a>虚函数</h3><p>是在基类中使用关键字virtual声明的函数。在派生类中重新定义基类中定义的虚函数时，会告诉编译器不要静态链接到该函数。我们想要的是在程序中任意点可以根据所调用的对象类型来选择调用的函数，这种操作被称为动态链接，或后期绑定。虚函数声明如下:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> ReturnType <span class="title">FunctionName</span><span class="params">(Parameter)</span></span></span><br></pre></td></tr></table></figure><p>虚函数必须实现。如果不实现，编译器将报错</p><h3 id="纯虚函数"><a href="#纯虚函数" class="headerlink" title="纯虚函数"></a>纯虚函数</h3><p>若在基类中定义虚函数，以便在派生类中重新定义改函数更好地适用于对象，但是您在基类中又不能对虚函数给出有意义的实现，这个时候就会用到纯虚函数。纯虚函数声明如下:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">funtion1</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>纯虚函数一定没有定义，纯虚函数用来规范派生类的行为，即接口。包含纯虚函数的类是抽象类，抽象类不能定义实例，但可以声明指向该抽象类的具体类的指针或引用。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Animal的run()方法&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> :<span class="keyword">public</span> Animal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Dog的run()方法&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span> :<span class="keyword">public</span> Animal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Cat的run()方法&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Animal* animal;</span><br><span class="line">Dog dog;</span><br><span class="line">Cat cat;</span><br><span class="line"></span><br><span class="line">animal = &amp;dog;</span><br><span class="line">animal-&gt;<span class="built_in">run</span>();</span><br><span class="line"></span><br><span class="line">animal = &amp;cat;</span><br><span class="line">animal-&gt;<span class="built_in">run</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="数据封装"><a href="#数据封装" class="headerlink" title="数据封装"></a>数据封装</h2><p>封装是面向对象编程中的把数据和操作数据的函数绑定在一起的一个概念，这样能避免受外界的干扰和误用，从而保证了安全。数据封装引申出了另一个重要的OOP概念，即数据隐藏。<br>数据封装是一种把数据和操作数据的函数绑在一起的机制，数据抽象是一种仅向用户暴露接口而把具体的实现细节隐藏起来的机制，C++通过创建类来支持封装和数据隐藏(public、protected、private)。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">string name;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Dog</span>(<span class="type">int</span> i = <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">total = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addFood</span><span class="params">(<span class="type">int</span> number)</span> </span>&#123;</span><br><span class="line">total = total + number;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getFood</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="type">int</span> total;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Dog dog;</span><br><span class="line"></span><br><span class="line">dog.name = <span class="string">&quot;旺财&quot;</span>;</span><br><span class="line"></span><br><span class="line">dog.<span class="built_in">addFood</span>(<span class="number">3</span>);</span><br><span class="line">dog.<span class="built_in">addFood</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; dog.name &lt;&lt; <span class="string">&quot;总共获得了&quot;</span> &lt;&lt; dog.<span class="built_in">getFood</span>() &lt;&lt; <span class="string">&quot;份食物&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> QT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> QT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>智能台灯</title>
      <link href="/2024/09/18/%E6%99%BA%E8%83%BD%E5%8F%B0%E7%81%AF/"/>
      <url>/2024/09/18/%E6%99%BA%E8%83%BD%E5%8F%B0%E7%81%AF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Jetson Nano引脚图<div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.6m3v0bkaa5.png" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.6m3v0bkaa5.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></p></blockquote><blockquote><p>本来想在jetson nano上跑一个live2d，但是live2d官方编译好的链接库对于linux只有x86_64的版本，我又没找到怎么重新编译，然后就想到也许live2d在windows的电脑上跑然后和jetson nano主控进行一个交互也许更有意思（例如点击什么的会有灯光特效）就有点像对于一个桌宠有了灯光外设</p></blockquote><blockquote><p>现在的方案是，主控全部使用Jetson Nano，虽然因为机箱的拓展板把所有Jetson Nano的IO口都占了，所以有关检测光照强度的任务就不使用光照传感器了，直接使用opencv检测光照强度，虽然不精准，但是在大的范围，比如说在实验室测试的开关灯，还是可以大致检测出来的。</p></blockquote><blockquote><p>然后就是用QT写界面，现在已经有了一个大致的带滑动转换界面的一个Demo，可以魔改</p></blockquote><blockquote><p>然后人与桌面距离检测的方案就是，AI部分使用Jetson Inferenced的人体关键点检测（主要用到的就是人脸关键点和肩膀位置的关键点），精准距离检测方案就是假设人的眼距是大致相同的（取一个标准值），然后根据鼻子到脖子中间拉的一条线的斜率得出人体相对摄像头的旋转角度，计算出这个旋转角度下人的平面眼距的绝对值，然后和图片里的眼距长度对比，从而判断出人距离摄像头的距离，</p></blockquote><blockquote></blockquote>]]></content>
      
      
      <categories>
          
          <category> Jetson Nano </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> AI </tag>
            
            <tag> Jetson Nano </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【李飞飞的AI课】Introduction to Convolut</title>
      <link href="/2024/09/16/%E3%80%90%E6%9D%8E%E9%A3%9E%E9%A3%9E%E7%9A%84AI%E8%AF%BE%E3%80%91Introduction-to-Convolut/"/>
      <url>/2024/09/16/%E3%80%90%E6%9D%8E%E9%A3%9E%E9%A3%9E%E7%9A%84AI%E8%AF%BE%E3%80%91Introduction-to-Convolut/</url>
      
        <content type="html"><![CDATA[<h2 id="k-Nearest-Neighbors分类算法"><a href="#k-Nearest-Neighbors分类算法" class="headerlink" title="k-Nearest Neighbors分类算法"></a>k-Nearest Neighbors分类算法</h2><blockquote><p>单纯比较相似性</p></blockquote><p>k-最近邻（k-Nearest Neighbors，k-NN）算法是一种简单的机器学习算法，用于分类和回归分析。在分类问题中，k-NN 算法根据训练数据集中的 k 个最接近的样本（称为“邻居”）来预测新样本的类别。<br>以下是 k-NN 算法的基本步骤：</p><ol><li><strong>选择 k 值</strong>：首先，你需要选择一个正整数 k，这决定了算法中要考虑的最近邻的数量。k 的值通常通过交叉验证等方法来确定，但也可以根据具体问题设定。</li><li><strong>计算距离</strong>：对于新样本，计算它与训练数据集中每个样本的距离。常用的距离度量有欧几里得距离、曼哈顿距离、余弦距离等。</li><li><strong>选择邻居</strong>：根据距离，选择 k 个最近的样本。这些样本称为“k 个最近邻”。</li><li><strong>预测类别</strong>：根据最近邻的类别，对新样本进行预测。通常使用多数表决原则，即新样本的类别是 k 个最近邻中出现次数最多的类别。如果 k 个邻居中有多个类别出现次数相同，那么新样本的类别是不确定的。</li><li><strong>回归分析</strong>：在回归问题中，k-NN 算法预测新样本的值是 k 个最近邻的值的平均值或加权平均值。<br>k-NN 算法的一些关键特性：</li></ol><ul><li><strong>简单直观</strong>：k-NN 算法非常直观，易于理解和实现。</li><li><strong>不需要训练</strong>：k-NN 算法不需要训练模型，因为它不需要学习参数，而是直接使用训练数据进行预测。</li><li><strong>高维数据</strong>：k-NN 算法可以处理高维数据，因为它只是计算样本之间的距离，而不是对数据进行降维或特征选择。</li><li><strong>计算复杂度</strong>：k-NN 算法的计算复杂度较高，因为它需要计算新样本与所有训练样本的距离，并选择最近的 k 个邻居。<br>k-NN 算法在处理小规模数据集或当新样本的类别可以从其邻近样本的类别中直观地推断出来时效果较好。然而，在处理大规模数据集或当新样本的类别难以从其邻近样本的类别中推断出来时，k-NN 算法可能不够有效。此外，k-NN 算法对噪声和异常值比较敏感，因此在实际应用中可能需要对数据进行预处理。</li></ul><details open><summary pointer> 欧式距离与曼哈顿距离的区别 </summary>              <div class='content'>              <ul><li><p><strong>欧氏距离就是我们最常用的两点之间的直线距离。</strong></p><p> 以二维空间为例，两点(x1,y1),(x2,y2)之间的欧式距离为：</p><p> $ \rho  &#x3D; \sqrt{(x_2-x_1)^2+(y_2-y_1)^2} $</p></li><li><p><strong>曼哈顿距离则表示两个点在标准坐标系上的绝对轴距之和。</strong></p><p>  还是以二维空间为例，两点(x1,y1),(x2,y2)之间的曼哈顿距离为：</p><p>  $ c &#x3D; |x_1-x_2|+|y_1-y_2| $</p></li></ul><p>用一张图来区分一下两者:</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4xuhzreg8k.png" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4xuhzreg8k.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p><strong>为什么要提出曼哈顿距离呢？</strong><br>——为了简化计算。</p><p>曼哈顿距离中的距离计算公式比欧氏距离的计算公式看起来简洁很多，只需要把两个点坐标的 x 坐标相减取绝对值，y 坐标相减取绝对值，再加和。<br>从公式定义上看，曼哈顿距离一定是一个非负数，距离最小的情况就是两个点重合，距离为 0，这一点和欧氏距离一样。<br>曼哈顿距离和欧氏距离的意义相近，也是为了描述两个点之间的距离，不同的是曼哈顿距离只需要做加减法，这使得计算机在大量的计算过程中代价更低，而且会消除在开平方过程中取近似值而带来的误差。不仅如此，曼哈顿距离在人脱离计算机做计算的时候也会很方便。</p>              </div>            </details><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NearestNeighbor</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">self, X, y</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;X is N x D where each row is an example.</span></span><br><span class="line"><span class="string">        Y is l-dimension of size N&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># the nearest neighbor classifier simply remembers all the training data</span></span><br><span class="line">        self.Xtr = X</span><br><span class="line">        self.ytr = y</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, X</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;X is N x D where each row is an example we wish to predict label for&quot;&quot;&quot;</span></span><br><span class="line">        num_test = X.shape[<span class="number">0</span>]</span><br><span class="line">        Ypred = np.zeros(num_test, dtype=self.ytr.dtype)</span><br><span class="line">        distances = np.zeros((X.shape[<span class="number">0</span>], self.Xtr.shape[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># loop over all test rows</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> np.xrange(num_test):</span><br><span class="line">            <span class="comment"># find the nearest training image to the i&#x27;th test image</span></span><br><span class="line">            <span class="comment"># using the L1 distance (sum of absolute value differences)</span></span><br><span class="line">            distances[i] = np.<span class="built_in">sum</span>(np.<span class="built_in">abs</span>(self.Xtr - X[i, :]), axis=<span class="number">1</span>)</span><br><span class="line">            min_index = np.argmin(distances[i])  <span class="comment"># get the index with the smallest distance</span></span><br><span class="line">            Ypred[i] = self.ytr[min_index]  <span class="comment"># predict the label of the nearest example</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Ypred</span><br></pre></td></tr></table></figure><blockquote><p>为什么distance是二维的：<br>对于测试样本集中的每个测试样本 X[i, :]，我们计算它与训练样本集中的每个训练样本 self.Xtr[j, :] 之间的 L1 距离，并存储在 distances[i] 中。由于有多个测试样本，所以需要一个矩阵来存储这些距离。</p></blockquote><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8l01nbuxa8.png" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8l01nbuxa8.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows查看当前目录下文件夹大小的命令</title>
      <link href="/2024/09/16/windows%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E6%96%87%E4%BB%B6%E5%A4%B9%E5%A4%A7%E5%B0%8F%E7%9A%84%E5%91%BD%E4%BB%A4/"/>
      <url>/2024/09/16/windows%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E6%96%87%E4%BB%B6%E5%A4%B9%E5%A4%A7%E5%B0%8F%E7%9A%84%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<blockquote><p>D盘突然爆红，我还以为是我环境下多了，最后发现是steam删游戏是假删。。。。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ChildItem</span> <span class="literal">-Directory</span> | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">    <span class="variable">$sizeInBytes</span> = (<span class="built_in">Get-ChildItem</span> <span class="variable">$_</span>.FullName <span class="literal">-Recurse</span> | <span class="built_in">Measure-Object</span> <span class="literal">-Property</span> Length <span class="literal">-Sum</span>).Sum</span><br><span class="line">    <span class="variable">$sizeInGB</span> = <span class="variable">$sizeInBytes</span> / <span class="number">1</span>GB</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$sizeInGB</span> <span class="operator">-gt</span> <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="variable">$_</span>.FullName + <span class="string">&quot; &quot;</span> + <span class="variable">$sizeInGB</span>.ToString(<span class="string">&quot;F2&quot;</span>) + <span class="string">&quot; GB&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> windows </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9-12月中旬（六级结束）任务整理</title>
      <link href="/2024/09/16/%E4%BB%BB%E5%8A%A1%E6%95%B4%E7%90%86/"/>
      <url>/2024/09/16/%E4%BB%BB%E5%8A%A1%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="软考-2024-11-9"><a href="#软考-2024-11-9" class="headerlink" title="软考[2024.11.9]"></a>软考[2024.11.9]</h2><blockquote><p>打算一些重要部分如计网、计组等直接学成套的课，不重要的就听软考的课</p></blockquote><blockquote><p>考试内容大概如下:</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4917285z8t.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4917285z8t.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.9nzpknmnhv.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.9nzpknmnhv.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.lzsehtof.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.lzsehtof.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.5c0wd44l0r.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.5c0wd44l0r.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7i0ayvwrfi.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7i0ayvwrfi.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></blockquote><ol><li>计算机组成原理 <iframe src="//player.bilibili.com/player.html?isOutside=true&aid=995248168&bvid=BV1ps4y1d73V&cid=1106436941&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe><blockquote><p>33h</p></blockquote></li></ol><h2 id="六级-2024-12-14"><a href="#六级-2024-12-14" class="headerlink" title="六级[2024.12.14]"></a>六级[2024.12.14]</h2><blockquote><p>买了14套真题刷一刷算了</p></blockquote><h2 id="专业课"><a href="#专业课" class="headerlink" title="专业课"></a>专业课</h2><blockquote><p>上课好好听，尽量都在课堂上解决<br>下课好好写作业</p></blockquote><blockquote><p>真的不想在期末前连续通宵了。。。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 任务整理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 任务整理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Jetson Nano学习笔记】oled屏显示ip地址等信息</title>
      <link href="/2024/09/15/%E3%80%90Jetson-Nano%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91oled%E5%B1%8F%E6%98%BE%E7%A4%BAip%E5%9C%B0%E5%9D%80%E7%AD%89%E4%BF%A1%E6%81%AF/"/>
      <url>/2024/09/15/%E3%80%90Jetson-Nano%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91oled%E5%B1%8F%E6%98%BE%E7%A4%BAip%E5%9C%B0%E5%9D%80%E7%AD%89%E4%BF%A1%E6%81%AF/</url>
      
        <content type="html"><![CDATA[<p><strong>这是一个详细得感人的教程:</strong></p><div class="tagLink"><a class="link-card" title="Jetson Nano 从入门到实战（案例：Opencv配置、人脸检测、二维码检测）" href="https://cloud.tencent.com/developer/article/2029907"><span class="link-card-backdrop" style="background-image: url(https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg)"></span><div class="left"><img src="https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">Jetson Nano 从入门到实战（案例：Opencv配置、人脸检测、二维码检测）</p><p class="url">https://cloud.tencent.com/developer/article/2029907</p></div></a></div><div class="tagLink"><a class="link-card" title="jetson nano开启VNC" href="https://blog.csdn.net/weixin_43181350/article/details/106491056"><span class="link-card-backdrop" style="background-image: url(https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg)"></span><div class="left"><img src="https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/1b83b88d3cf497d2d322e0fc1cdc77e.3uusmgziev.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">jetson nano开启VNC</p><p class="url">https://blog.csdn.net/weixin_43181350/article/details/106491056</p></div></a></div><h2 id="oled屏的示例文件"><a href="#oled屏的示例文件" class="headerlink" title="oled屏的示例文件"></a>oled屏的示例文件</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> Adafruit_SSD1306 <span class="keyword">as</span> SSD</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageDraw</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageFont</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="comment"># V1.0.6</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Yahboom_OLED</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, i2c_bus=<span class="string">&quot;auto&quot;</span>, clear=<span class="literal">False</span>, debug=<span class="literal">False</span></span>):</span><br><span class="line">        self.__debug = debug</span><br><span class="line">        self.__clear = clear</span><br><span class="line">        self.__clear_count = <span class="number">0</span></span><br><span class="line">        self.__top = -<span class="number">2</span></span><br><span class="line">        self.__x = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        self.__BUS_LIST = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line">        self.__bus_index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> i2c_bus != <span class="string">&quot;auto&quot;</span>:</span><br><span class="line">            self.__i2c_bus = <span class="built_in">int</span>(i2c_bus)</span><br><span class="line">            self.__bus_index = <span class="number">0xFF</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.__i2c_bus = self.__BUS_LIST[self.__bus_index]</span><br><span class="line">        </span><br><span class="line">        self.__total_last = <span class="number">0</span></span><br><span class="line">        self.__idle_last = <span class="number">0</span></span><br><span class="line">        self.__str_CPU = <span class="string">&quot;CPU:0%&quot;</span></span><br><span class="line"></span><br><span class="line">        self.__WIDTH = <span class="number">128</span></span><br><span class="line">        self.__HEIGHT = <span class="number">32</span></span><br><span class="line">        self.__image = Image.new(<span class="string">&#x27;1&#x27;</span>, (self.__WIDTH, self.__HEIGHT))</span><br><span class="line">        self.__draw = ImageDraw.Draw(self.__image)</span><br><span class="line">        self.__font = ImageFont.load_default()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.__debug:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;---OLED-DEL---&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 初始化OLED，成功返回:True，失败返回:False</span></span><br><span class="line">    <span class="comment"># Initialize OLED, return True on success, False on failure</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">begin</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.__oled = SSD.SSD1306_128_32(</span><br><span class="line">                rst=<span class="literal">None</span>, i2c_bus=self.__i2c_bus, gpio=<span class="number">1</span>)</span><br><span class="line">            self.__oled.begin()</span><br><span class="line">            self.__oled.clear()</span><br><span class="line">            self.__oled.display()</span><br><span class="line">            <span class="keyword">if</span> self.__debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;---OLED begin ok!---&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">if</span> self.__debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;---OLED No Found!---:&quot;</span>, self.__BUS_LIST[self.__bus_index])</span><br><span class="line">            <span class="keyword">if</span> self.__bus_index == <span class="number">0xFF</span>:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            max_bus = <span class="built_in">len</span>(self.__BUS_LIST)</span><br><span class="line">            self.__bus_index = (self.__bus_index + <span class="number">1</span>) % max_bus</span><br><span class="line">            self.__i2c_bus = self.__BUS_LIST[self.__bus_index]</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 清除显示。refresh=True立即刷新，refresh=False不刷新。</span></span><br><span class="line">    <span class="comment"># Clear the display.  Refresh =True Refresh immediately, refresh=False refresh not</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">clear</span>(<span class="params">self, refresh=<span class="literal">False</span></span>):</span><br><span class="line">        self.__draw.rectangle(</span><br><span class="line">            (<span class="number">0</span>, <span class="number">0</span>, self.__WIDTH, self.__HEIGHT), outline=<span class="number">0</span>, fill=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">if</span> refresh:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                self.refresh()</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 增加字符。start_x start_y表示开始的点。text是要增加的字符。</span></span><br><span class="line">    <span class="comment"># refresh=True立即刷新，refresh=False不刷新。</span></span><br><span class="line">    <span class="comment"># Add characters.  Start_x Start_y indicates the starting point.  Text is the character to be added</span></span><br><span class="line">    <span class="comment"># Refresh =True Refresh immediately, refresh=False refresh not</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_text</span>(<span class="params">self, start_x, start_y, text, refresh=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="keyword">if</span> start_x &gt; self.__WIDTH <span class="keyword">or</span> start_x &lt; <span class="number">0</span> <span class="keyword">or</span> start_y &lt; <span class="number">0</span> <span class="keyword">or</span> start_y &gt; self.__HEIGHT:</span><br><span class="line">            <span class="keyword">if</span> self.__debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;oled text: x, y input error!&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        x = <span class="built_in">int</span>(start_x + self.__x)</span><br><span class="line">        y = <span class="built_in">int</span>(start_y + self.__top)</span><br><span class="line">        self.__draw.text((x, y), <span class="built_in">str</span>(text), font=self.__font, fill=<span class="number">255</span>)</span><br><span class="line">        <span class="keyword">if</span> refresh:</span><br><span class="line">            self.refresh()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写入一行字符text。refresh=True立即刷新，refresh=False不刷新。</span></span><br><span class="line">    <span class="comment"># line=[1, 4]</span></span><br><span class="line">    <span class="comment"># Write a line of character text.  Refresh =True Refresh immediately, refresh=False refresh not.</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_line</span>(<span class="params">self, text, line=<span class="number">1</span>, refresh=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="keyword">if</span> line &lt; <span class="number">1</span> <span class="keyword">or</span> line &gt; <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">if</span> self.__debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;oled line input error!&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        y = <span class="built_in">int</span>(<span class="number">8</span> * (line - <span class="number">1</span>))</span><br><span class="line">        self.add_text(<span class="number">0</span>, y, text, refresh)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 刷新OLED，显示内容</span></span><br><span class="line">    <span class="comment"># Refresh the OLED to display the content</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">refresh</span>(<span class="params">self</span>):</span><br><span class="line">        self.__oled.image(self.__image)</span><br><span class="line">        self.__oled.display()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取CPU占用率</span></span><br><span class="line">    <span class="comment"># Read the CPU usage rate</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getCPULoadRate</span>(<span class="params">self, index</span>):</span><br><span class="line">        count = <span class="number">10</span></span><br><span class="line">        <span class="keyword">if</span> index == <span class="number">0</span>:</span><br><span class="line">            f1 = os.popen(<span class="string">&quot;cat /proc/stat&quot;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">            stat1 = f1.readline()</span><br><span class="line">            data_1 = []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">                data_1.append(<span class="built_in">int</span>(stat1.split(<span class="string">&#x27; &#x27;</span>)[i+<span class="number">2</span>]))</span><br><span class="line">            self.__total_last = data_1[<span class="number">0</span>]+data_1[<span class="number">1</span>]+data_1[<span class="number">2</span>]+data_1[<span class="number">3</span>] + \</span><br><span class="line">                data_1[<span class="number">4</span>]+data_1[<span class="number">5</span>]+data_1[<span class="number">6</span>]+data_1[<span class="number">7</span>]+data_1[<span class="number">8</span>]+data_1[<span class="number">9</span>]</span><br><span class="line">            self.__idle_last = data_1[<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">elif</span> index == <span class="number">4</span>:</span><br><span class="line">            f2 = os.popen(<span class="string">&quot;cat /proc/stat&quot;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">            stat2 = f2.readline()</span><br><span class="line">            data_2 = []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">                data_2.append(<span class="built_in">int</span>(stat2.split(<span class="string">&#x27; &#x27;</span>)[i+<span class="number">2</span>]))</span><br><span class="line">            total_now = data_2[<span class="number">0</span>]+data_2[<span class="number">1</span>]+data_2[<span class="number">2</span>]+data_2[<span class="number">3</span>] + \</span><br><span class="line">                data_2[<span class="number">4</span>]+data_2[<span class="number">5</span>]+data_2[<span class="number">6</span>]+data_2[<span class="number">7</span>]+data_2[<span class="number">8</span>]+data_2[<span class="number">9</span>]</span><br><span class="line">            idle_now = data_2[<span class="number">3</span>]</span><br><span class="line">            total = <span class="built_in">int</span>(total_now - self.__total_last)</span><br><span class="line">            idle = <span class="built_in">int</span>(idle_now - self.__idle_last)</span><br><span class="line">            usage = <span class="built_in">int</span>(total - idle)</span><br><span class="line">            usageRate = <span class="built_in">int</span>(<span class="built_in">float</span>(usage / total) * <span class="number">100</span>)</span><br><span class="line">            self.__str_CPU = <span class="string">&quot;CPU:&quot;</span> + <span class="built_in">str</span>(usageRate) + <span class="string">&quot;%&quot;</span></span><br><span class="line">            self.__total_last = <span class="number">0</span></span><br><span class="line">            self.__idle_last = <span class="number">0</span></span><br><span class="line">            <span class="comment"># if self.__debug:</span></span><br><span class="line">            <span class="comment">#     print(self.__str_CPU)</span></span><br><span class="line">        <span class="keyword">return</span> self.__str_CPU</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取系统时间</span></span><br><span class="line">    <span class="comment"># Read system time</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getSystemTime</span>(<span class="params">self</span>):</span><br><span class="line">        cmd = <span class="string">&quot;date +%H:%M:%S&quot;</span></span><br><span class="line">        date_time = subprocess.check_output(cmd, shell=<span class="literal">True</span>)</span><br><span class="line">        str_Time = <span class="built_in">str</span>(date_time).lstrip(<span class="string">&#x27;b\&#x27;&#x27;</span>)</span><br><span class="line">        str_Time = str_Time.rstrip(<span class="string">&#x27;\\n\&#x27;&#x27;</span>)</span><br><span class="line">        <span class="comment"># print(date_time)</span></span><br><span class="line">        <span class="keyword">return</span> str_Time</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取内存占用率 和 总内存</span></span><br><span class="line">    <span class="comment"># Read the memory usage and total memory</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getUsagedRAM</span>(<span class="params">self</span>):</span><br><span class="line">        cmd = <span class="string">&quot;free | awk &#x27;NR==2&#123;printf \&quot;RAM:%2d%% -&gt; %.1fGB \&quot;, 100*($2-$7)/$2, ($2/1048576.0)&#125;&#x27;&quot;</span></span><br><span class="line">        FreeRam = subprocess.check_output(cmd, shell=<span class="literal">True</span>)</span><br><span class="line">        str_FreeRam = <span class="built_in">str</span>(FreeRam).lstrip(<span class="string">&#x27;b\&#x27;&#x27;</span>)</span><br><span class="line">        str_FreeRam = str_FreeRam.rstrip(<span class="string">&#x27;\&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> str_FreeRam</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取空闲的内存 / 总内存</span></span><br><span class="line">    <span class="comment"># Read free memory/total memory</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getFreeRAM</span>(<span class="params">self</span>):</span><br><span class="line">        cmd = <span class="string">&quot;free -h | awk &#x27;NR==2&#123;printf \&quot;RAM: %.1f/%.1fGB \&quot;, $7,$2&#125;&#x27;&quot;</span></span><br><span class="line">        FreeRam = subprocess.check_output(cmd, shell=<span class="literal">True</span>)</span><br><span class="line">        str_FreeRam = <span class="built_in">str</span>(FreeRam).lstrip(<span class="string">&#x27;b\&#x27;&#x27;</span>)</span><br><span class="line">        str_FreeRam = str_FreeRam.rstrip(<span class="string">&#x27;\&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> str_FreeRam</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取TF卡空间占用率 / TF卡总空间</span></span><br><span class="line">    <span class="comment"># Read the TF card space usage/TOTAL TF card space</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getUsagedDisk</span>(<span class="params">self</span>):</span><br><span class="line">        cmd = <span class="string">&quot;df -h | awk &#x27;$NF==\&quot;/\&quot;&#123;printf \&quot;SDC:%s -&gt; %.1fGB\&quot;, $5, $2&#125;&#x27;&quot;</span></span><br><span class="line">        Disk = subprocess.check_output(cmd, shell=<span class="literal">True</span>)</span><br><span class="line">        str_Disk = <span class="built_in">str</span>(Disk).lstrip(<span class="string">&#x27;b\&#x27;&#x27;</span>)</span><br><span class="line">        str_Disk = str_Disk.rstrip(<span class="string">&#x27;\&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> str_Disk</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取空闲的TF卡空间 / TF卡总空间</span></span><br><span class="line">    <span class="comment"># Read the free TF card space/total TF card space</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getFreeDisk</span>(<span class="params">self</span>):</span><br><span class="line">        cmd = <span class="string">&quot;df -h | awk &#x27;$NF==\&quot;/\&quot;&#123;printf \&quot;Disk:%.1f/%.1fGB\&quot;, $4,$2&#125;&#x27;&quot;</span></span><br><span class="line">        Disk = subprocess.check_output(cmd, shell=<span class="literal">True</span>)</span><br><span class="line">        str_Disk = <span class="built_in">str</span>(Disk).lstrip(<span class="string">&#x27;b\&#x27;&#x27;</span>)</span><br><span class="line">        str_Disk = str_Disk.rstrip(<span class="string">&#x27;\&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> str_Disk</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取本机IP</span></span><br><span class="line">    <span class="comment"># Read the local IP address</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getLocalIP</span>(<span class="params">self</span>):</span><br><span class="line">        ip = os.popen(</span><br><span class="line">            <span class="string">&quot;/sbin/ifconfig eth0 | grep &#x27;inet&#x27; | awk &#x27;&#123;print $2&#125;&#x27;&quot;</span>).read()</span><br><span class="line">        ip = ip[<span class="number">0</span>: ip.find(<span class="string">&#x27;\n&#x27;</span>)]</span><br><span class="line">        <span class="comment"># ip = &#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span>(ip == <span class="string">&#x27;&#x27;</span> <span class="keyword">or</span> <span class="built_in">len</span>(ip) &gt; <span class="number">15</span>):</span><br><span class="line">            ip = os.popen(</span><br><span class="line">                <span class="string">&quot;/sbin/ifconfig wlan0 | grep &#x27;inet&#x27; | awk &#x27;&#123;print $2&#125;&#x27;&quot;</span>).read()</span><br><span class="line">            ip = ip[<span class="number">0</span>: ip.find(<span class="string">&#x27;\n&#x27;</span>)]</span><br><span class="line">            <span class="keyword">if</span>(ip == <span class="string">&#x27;&#x27;</span>):</span><br><span class="line">                ip = <span class="string">&#x27;x.x.x.x&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(ip) &gt; <span class="number">15</span>:</span><br><span class="line">            ip = <span class="string">&#x27;x.x.x.x&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> ip</span><br><span class="line"></span><br><span class="line">    <span class="comment"># oled主要运行函数，在while循环里调用，可实现热插拔功能。</span></span><br><span class="line">    <span class="comment"># Oled mainly runs functions that are called in a while loop and can be hot-pluggable</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">main_program</span>(<span class="params">self</span>):</span><br><span class="line">        state = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            cpu_index = <span class="number">0</span></span><br><span class="line">            state = self.begin()</span><br><span class="line">            <span class="keyword">while</span> state:</span><br><span class="line">                self.clear()</span><br><span class="line">                <span class="keyword">if</span> self.__clear:</span><br><span class="line">                    self.refresh()</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                str_CPU = self.getCPULoadRate(cpu_index)</span><br><span class="line">                str_Time = self.getSystemTime()</span><br><span class="line">                <span class="keyword">if</span> cpu_index == <span class="number">0</span>:</span><br><span class="line">                    str_FreeRAM = self.getUsagedRAM()</span><br><span class="line">                    str_Disk = self.getUsagedDisk()</span><br><span class="line">                    str_IP = <span class="string">&quot;IPA:&quot;</span> + self.getLocalIP()</span><br><span class="line">                self.add_text(<span class="number">0</span>, <span class="number">0</span>, str_CPU)</span><br><span class="line">                self.add_text(<span class="number">50</span>, <span class="number">0</span>, str_Time)</span><br><span class="line">                self.add_line(str_FreeRAM, <span class="number">2</span>)</span><br><span class="line">                self.add_line(str_Disk, <span class="number">3</span>)</span><br><span class="line">                self.add_line(str_IP, <span class="number">4</span>)</span><br><span class="line">                <span class="comment"># Display image.</span></span><br><span class="line">                self.refresh()</span><br><span class="line">                cpu_index = cpu_index + <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> cpu_index &gt;= <span class="number">5</span>:</span><br><span class="line">                    cpu_index = <span class="number">0</span></span><br><span class="line">                time.sleep(<span class="number">.1</span>)</span><br><span class="line">            <span class="keyword">if</span> self.__clear:</span><br><span class="line">                self.__clear_count = self.__clear_count + <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> self.__clear_count &gt; <span class="built_in">len</span>(self.__BUS_LIST):</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">if</span> self.__debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;!!!---OLED refresh error---!!!&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        oled_clear = <span class="literal">False</span></span><br><span class="line">        oled_debug = <span class="literal">False</span></span><br><span class="line">        state = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> arg <span class="keyword">in</span> sys.argv:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span>(arg) == <span class="string">&quot;clear&quot;</span>:</span><br><span class="line">                oled_clear = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span>(arg) == <span class="string">&quot;debug&quot;</span>:</span><br><span class="line">                oled_debug = <span class="literal">True</span></span><br><span class="line">        oled = Yahboom_OLED(clear=oled_clear, debug=oled_debug)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            state = oled.main_program()</span><br><span class="line">            <span class="keyword">if</span> state:</span><br><span class="line">                <span class="keyword">del</span> oled</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;---OLED CLEARED!---&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        oled.clear(<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">del</span> oled</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;---Program closed!---&quot;</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Jetson Nano </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> AI </tag>
            
            <tag> Jetson Nano </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenGL环境配置</title>
      <link href="/2024/09/07/OpenGL%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
      <url>/2024/09/07/OpenGL%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<div class="tagLink"><a class="link-card" title="OpenGL开发必过的坎------开发环境的准备(Windows10)" href="https://blog.csdn.net/zxj2589/article/details/130467844?ops_request_misc=&request_id=&biz_id=102&utm_term=opengl%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-5-130467844.142^v100^pc_search_result_base2&spm=1018.2226.3001.4187"><span class="link-card-backdrop" style="background-image: url(https://tumytime.github.io/picx-images-hosting/image.3nrjfx6xzp.png)"></span><div class="left"><img src="https://tumytime.github.io/picx-images-hosting/image.3nrjfx6xzp.png" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3nrjfx6xzp.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">OpenGL开发必过的坎------开发环境的准备(Windows10)</p><p class="url">https://blog.csdn.net/zxj2589/article/details/130467844?ops_request_misc=&request_id=&biz_id=102&utm_term=opengl%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-5-130467844.142^v100^pc_search_result_base2&spm=1018.2226.3001.4187</p></div></a></div><blockquote><p>glut只能在x86下运行，如果要用的话记得开x86，并把别的库也改成32位的</p></blockquote><blockquote><p>想用x64的话可以用freeglut库，支持x64，和glut功能基本一样</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> OpenGL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 智能车 </tag>
            
            <tag> c++ </tag>
            
            <tag> OpenGL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>科目四</title>
      <link href="/2024/08/22/%E7%A7%91%E7%9B%AE%E5%9B%9B/"/>
      <url>/2024/08/22/%E7%A7%91%E7%9B%AE%E5%9B%9B/</url>
      
        <content type="html"><![CDATA[<blockquote><p>没事哒没事哒我没事哒</p></blockquote><h2 id="仪表指示灯题"><a href="#仪表指示灯题" class="headerlink" title="仪表指示灯题"></a>仪表指示灯题</h2><ol><li><p>水温表时用来指示<strong>发动机</strong>的温度</p></li><li><p>三个向上箭头，后面是矩形-&gt;<strong>后</strong>挡风除雾；后面是扇形-&gt;<strong>前</strong>挡风除雾</p></li></ol><h2 id="危险化学品题"><a href="#危险化学品题" class="headerlink" title="危险化学品题"></a>危险化学品题</h2><ol><li><p>火药、炸药、起爆药属于<strong>爆炸品</strong></p></li><li><p>火柴、硫磺、赤磷属于<strong>易燃固体</strong></p></li><li><p><strong>液体&#x2F;腐蚀品</strong>起火不可都用水</p></li><li><p>有毒气体应站<strong>上风处</strong></p></li><li><p>运载危险化学品应经<strong>公安机关</strong>批准</p></li></ol><h2 id="特殊天气题"><a href="#特殊天气题" class="headerlink" title="特殊天气题"></a>特殊天气题</h2><ol><li><p>能见度低:</p><ul><li>&lt;200m:开启雾灯、近光灯、示廓灯、前后位灯，车速&lt;60km&#x2F;h，车距&gt;100m</li><li>&lt;100m:开启雾灯、近光灯、示廓灯、前后位灯和危险报警闪光灯，车速&lt;40km&#x2F;h，车距&gt;50m</li><li>&lt;50m: 开启雾灯、近光灯、示廓灯、前后位灯和危险报警闪光灯，车速&lt;20km&#x2F;h，并从最近的出口尽快驶离高速公路</li></ul></li><li><p><strong>刚下雨</strong>的路面最容易发生侧滑</p></li><li><p>在冰雪路面上减速或停车，应充分利用发动机的牵制作用</p></li><li><p>冰雪路面不可急转向</p></li><li><p>冰雪路面，但是没下雪&#x2F;雨，不用开雾灯</p></li><li><p>机动车雾天行驶，开雾灯和危险报警闪光灯</p></li><li><p>遇到横风车辆产生偏移时，收油降速，不可紧急制动</p></li><li><p>大风天禁止超车</p></li><li><p>大雨天使用近光灯减速慢行</p></li></ol><h2 id="速度题"><a href="#速度题" class="headerlink" title="速度题"></a>速度题</h2><ol><li><p>高速&gt;60,&lt;120</p></li><li><p>高速两车道：最左侧&gt;100,<br> 高速三车道：&gt;60,&gt;90&gt;110</p></li><li><p>特殊路段&lt;30</p></li></ol><h2 id="标志题"><a href="#标志题" class="headerlink" title="标志题"></a>标志题</h2><p>1. </p>]]></content>
      
      
      <categories>
          
          <category> 驾考 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 驾考 </tag>
            
            <tag> 科目四 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我是一个分界线</title>
      <link href="/2024/08/13/%E6%88%91%E6%98%AF%E4%B8%80%E4%B8%AA%E5%88%86%E7%95%8C%E7%BA%BF/"/>
      <url>/2024/08/13/%E6%88%91%E6%98%AF%E4%B8%80%E4%B8%AA%E5%88%86%E7%95%8C%E7%BA%BF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>这几天一直在学c++，但是学着学着容易没劲，发现我不适合那种跟着课按部就班学东西，还是打算那种给一天干完一个任务的模式</p></blockquote><blockquote><p>或许打算试试软考</p></blockquote><blockquote><p>考试内容大概如下:</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4917285z8t.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4917285z8t.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.9nzpknmnhv.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.9nzpknmnhv.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.lzsehtof.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.lzsehtof.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.5c0wd44l0r.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.5c0wd44l0r.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7i0ayvwrfi.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7i0ayvwrfi.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></blockquote>]]></content>
      
      
      <categories>
          
          <category> 碎碎念 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 碎碎念 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C++学习】内存分区模型</title>
      <link href="/2024/08/12/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E5%86%85%E5%AD%98%E5%88%86%E5%8C%BA%E6%A8%A1%E5%9E%8B/"/>
      <url>/2024/08/12/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E5%86%85%E5%AD%98%E5%88%86%E5%8C%BA%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<blockquote><p>C++程序在执行时，将内存大方向划分位4个区域</p><ul><li><strong>代码区:</strong> 存放函数体的二进制代码,由操作系统进行管理的</li><li><strong>全局区:</strong> 存放全局变量和静态变量以及常量</li><li><strong>栈区:</strong> 由编译器自动分配释放,存放函数的参数值,局部变量等</li><li><strong>堆区:</strong> 由程序员分配和释放,若程序员不释放,程序结束时由操作系统回收<br><strong>意义:</strong> 不同区域存放的数据，赋予不同的生命周期，给我们更大的灵活编程</li></ul></blockquote><h2 id="程序运行前"><a href="#程序运行前" class="headerlink" title="程序运行前"></a>程序运行前</h2><p>在程序编译后，生成了exe可执行程序，<strong>未执行该程序前</strong>分为两个区域:</p><h3 id="代码区"><a href="#代码区" class="headerlink" title="代码区"></a>代码区</h3><blockquote><p>存放CPU执行的机器指令</p></blockquote><ul><li>代码区是<strong>共享</strong>的，共享的目的是对于频繁被执行的程序，只需要在内存中有一份代码即可</li><li>代码区是<strong>只读</strong>的，使其只读的原因是防止程序意外地修改了它的指令</li></ul><h3 id="全局区"><a href="#全局区" class="headerlink" title="全局区"></a>全局区</h3><blockquote><p>全局变量、静态变量字符串常量和其他常量存放在此</p></blockquote><blockquote><p>该区域的数据在程序结束后由操作系统释放</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 全局变量</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> g_a = <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> g_b = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局常量</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> c_g_a = <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> c_g_b = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 局部变量</span></span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">10</span>;</span><br><span class="line"><span class="comment">// 打印地址</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;局部变量a地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;a &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;局部变量b地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;全局变量g_a地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;g_a &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;全局变量g_b地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;g_b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 静态变量</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> s_a = <span class="number">10</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> s_b = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;静态变量s_a地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;s_a &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;静态变量s_b地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;s_b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;字符串常量地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;<span class="string">&quot;hello world&quot;</span> &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;字符串常量地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;<span class="string">&quot;hello world1&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;全局常量c_g_a地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;c_g_a &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;全局常量c_g_b地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;c_g_b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> c_l_a = <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> c_l_b = <span class="number">10</span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;局部常量c_l_a地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;c_l_a &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;局部常量c_l_b地址为:&quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;c_l_b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>x64(64位)：</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1zi6igjuin.png" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1zi6igjuin.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p><strong>x86(32位):</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.231sg6ei3g.png" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.231sg6ei3g.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><blockquote><p><strong>Q:</strong> 为什么当vs管理器为x64(64位)时，a的地址比b小32，但是管理器改为x86(32位)时，a比b地址大12</p></blockquote><ul><li>x64架构（64位）<ol><li><strong>栈对齐</strong>：x64架构通常要求栈对齐到16字节或32字节边界，以优化性能并满足某些指令集的要求。这可能导致在局部变量之间插入额外的填充（padding）。</li><li><strong>调用约定</strong>：在x64架构下，函数调用时可能需要在栈上保留更多的空间用于寄存器保存区域（callee-saved registers）和其他目的。这可能导致局部变量之间的地址差异大于它们的大小。</li><li><strong>优化</strong>：编译器可能会在64位模式下执行更积极的优化，这可能会影响变量的布局。</li><li><strong>局部变量大小</strong>：即使局部变量是<code>int</code>类型，它们在栈上的布局也可能会受到其他因素的影响，如调用约定、栈对齐等。</li></ol></li></ul><p>在x64架构下，32字节的差异可能是由于编译器在<code>a</code>和<code>b</code>之间插入了对齐填充，或者由于其他局部变量或保留空间的布局。</p><ul><li>x86架构（32位）<ol><li><strong>栈对齐</strong>：x86架构通常要求栈对齐到4字节边界，这意味着局部变量之间的地址差异通常是它们大小的整数倍。</li><li><strong>调用约定</strong>：在x86架构下，函数调用时在栈上保留的空间通常比x64架构少，因此局部变量之间的地址差异可能更小。</li><li><strong>优化</strong>：编译器在32位模式下的优化可能与64位模式不同，这可能会影响变量的布局。<br>  在x86架构下，12字节的差异可能是因为：<ul><li>在<code>a</code>和<code>b</code>之间可能有其他局部变量或对齐填充。</li><li>编译器可能为了保持栈对齐而插入填充。</li><li>由于某些优化，编译器可能改变了局部变量的顺序或布局。</li></ul></li></ol></li></ul><h2 id="程序运行前-1"><a href="#程序运行前-1" class="headerlink" title="程序运行前"></a>程序运行前</h2><h3 id="栈区"><a href="#栈区" class="headerlink" title="栈区"></a>栈区</h3><p>由编译器自动分配释放，存放函数的参数值，局部变量等</p><p>注意事项：不要返回局部变量的地址，栈区开辟的数据由编译器自动释放</p><p>示例：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C++学习】结构体</title>
      <link href="/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E7%BB%93%E6%9E%84%E4%BD%93/"/>
      <url>/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E7%BB%93%E6%9E%84%E4%BD%93/</url>
      
        <content type="html"><![CDATA[<blockquote><p>发现个好东西，试一下子</p></blockquote><p><a href="https://api.xecades.xyz/api?img=1&bg=26,140,165,0&bilibili=%E6%97%B6%E5%9F%9FTumy&github=tumytime&qq=2259763426&color=25,0,79,1&date=2024-12-01&quote=%E4%B8%80%E8%B5%B7%E5%9C%A8%E8%BF%99%E4%B8%AA%E4%B8%96%E7%95%8C%E9%87%8C%E8%82%86%E6%84%8F%E5%A5%94%E8%B7%91%E5%90%A7~"><img src="https://api.xecades.xyz/api?img=1&bg=26,140,165,0&bilibili=%E6%97%B6%E5%9F%9FTumy&github=tumytime&qq=2259763426&color=25,0,79,1&date=2024-12-01&quote=%E4%B8%80%E8%B5%B7%E5%9C%A8%E8%BF%99%E4%B8%AA%E4%B8%96%E7%95%8C%E9%87%8C%E8%82%86%E6%84%8F%E5%A5%94%E8%B7%91%E5%90%A7~" class="lazyload placeholder" data-srcset="https://api.xecades.xyz/api?img=1&bg=26,140,165,0&bilibili=%E6%97%B6%E5%9F%9FTumy&github=tumytime&qq=2259763426&color=25,0,79,1&date=2024-12-01&quote=%E4%B8%80%E8%B5%B7%E5%9C%A8%E8%BF%99%E4%B8%AA%E4%B8%96%E7%95%8C%E9%87%8C%E8%82%86%E6%84%8F%E5%A5%94%E8%B7%91%E5%90%A7~" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="图片描述"></a></p><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><blockquote><p>结构体属于用户自定义的数据类型，允许用户存储不同的数据类型</p></blockquote><h2 id="创建结构体变量"><a href="#创建结构体变量" class="headerlink" title="创建结构体变量"></a>创建结构体变量</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">student</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//成员列表</span></span><br><span class="line">string name;<span class="comment">//姓名</span></span><br><span class="line"><span class="type">int</span> age;<span class="comment">//年龄</span></span><br><span class="line"><span class="type">int</span> score;<span class="comment">//分数</span></span><br><span class="line"></span><br><span class="line">&#125;stu3;<span class="comment">//创建方式3</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建方式1</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">student</span> stu1;<span class="comment">//struct 关键字可以省略</span></span><br><span class="line"></span><br><span class="line">stu1.name = <span class="string">&quot;张三&quot;</span>;</span><br><span class="line">stu1.age = <span class="number">18</span>;</span><br><span class="line">stu1.score = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;姓名:&quot;</span> &lt;&lt; stu1.name &lt;&lt; <span class="string">&quot;年龄&quot;</span> &lt;&lt; stu1.age &lt;&lt; <span class="string">&quot;分数:&quot;</span> &lt;&lt; stu1.score &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建方式2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">student</span> stu2 = &#123; <span class="string">&quot;李四&quot;</span>,<span class="number">19</span>,<span class="number">60</span> &#125;;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;姓名:&quot;</span> &lt;&lt; stu2.name &lt;&lt; <span class="string">&quot;年龄&quot;</span> &lt;&lt; stu2.age &lt;&lt; <span class="string">&quot;分数:&quot;</span> &lt;&lt; stu2.score &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">stu3.name = <span class="string">&quot;王五&quot;</span>;</span><br><span class="line">stu3.age = <span class="number">18</span>;</span><br><span class="line">stu3.score = <span class="number">80</span>;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;姓名:&quot;</span> &lt;&lt; stu3.name &lt;&lt; <span class="string">&quot;年龄&quot;</span> &lt;&lt; stu3.age &lt;&lt; <span class="string">&quot;分数:&quot;</span> &lt;&lt; stu3.score &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>创建结构体变量时，关键词struct可以省略</p></blockquote><blockquote><p>结构体变量利用操作符”.”访问成员</p></blockquote><h2 id="结构体数组"><a href="#结构体数组" class="headerlink" title="结构体数组"></a>结构体数组</h2><p><strong>作用:</strong> 将自定义的结构体放入到数组中方便维护</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">student arr[<span class="number">3</span>] = &#123;</span><br><span class="line">&#123;<span class="string">&quot;张三&quot;</span>,<span class="number">18</span>,<span class="number">80</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;李四&quot;</span>,<span class="number">19</span>,<span class="number">60</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;王五&quot;</span>,<span class="number">20</span>,<span class="number">70</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;姓名:&quot;</span> &lt;&lt; arr[i].name &lt;&lt; <span class="string">&quot;年龄:&quot;</span> &lt;&lt; arr[i].age &lt;&lt; <span class="string">&quot;分数:&quot;</span> &lt;&lt; arr[i].score &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="结构体指针"><a href="#结构体指针" class="headerlink" title="结构体指针"></a>结构体指针</h2><p><strong>作用:</strong> 通过指针访问结构体中的成员</p><blockquote><p>利用操作符’-&gt;’可以通过结构体指针访问结构体属性</p></blockquote><p>在C语言中，结构体变量和结构体指针访问成员的方式不同，这是由于它们在内存中的存储和访问机制不同。<br>结构体变量使用<code>.</code>操作符访问成员，因为结构体变量本身就是一个具体的实例，它包含了所有成员的数据。当你使用<code>.</code>操作符时，你直接在结构体实例上访问其成员。<br>例如，如果你有一个名为<code>student</code>的结构体，并且有一个<code>student</code>类型的变量<code>stu</code>，你可以这样访问它的成员：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> name[<span class="number">20</span>];</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="type">int</span> score;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span> <span class="title">stu</span> =</span> &#123;<span class="string">&quot;张三&quot;</span>, <span class="number">18</span>, <span class="number">100</span>&#125;;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, stu.name);  <span class="comment">// 使用 &#x27;.&#x27; 操作符访问结构体成员</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, stu.age);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, stu.score);</span><br></pre></td></tr></table></figure><p>而结构体指针使用<code>-&gt;</code>操作符访问成员，因为指针本身并不直接包含结构体的数据，而是存储了结构体数据的内存地址。当你使用<code>-&gt;</code>操作符时，你实际上是在告诉编译器：“请先到这个地址去找到结构体实例，然后再访问它的成员。”<br>例如，如果你有一个指向<code>student</code>结构体的指针<code>ptr</code>，你可以这样访问它的成员：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span> *<span class="title">ptr</span> =</span> &amp;stu;  <span class="comment">// ptr 指向 stu 的地址</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, ptr-&gt;name);   <span class="comment">// 使用 &#x27;-&gt;&#x27; 操作符访问结构体成员</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ptr-&gt;age);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ptr-&gt;score);</span><br></pre></td></tr></table></figure><p>这里，<code>ptr-&gt;name</code>是<code>(*ptr).name</code>的简写形式，它首先通过解引用指针<code>*ptr</code>来获取结构体实例，然后通过<code>.</code>操作符访问其<code>name</code>成员。<br>总结来说，<code>.</code>用于直接访问结构体变量的成员，而<code>-&gt;</code>用于通过结构体指针间接访问其指向的结构体实例的成员。</p><h2 id="结构体嵌套结构体"><a href="#结构体嵌套结构体" class="headerlink" title="结构体嵌套结构体"></a>结构体嵌套结构体</h2><p><strong>示例:</strong><br>每个老师辅导一个学员，一个老师的结构体中，记录一个学生的结构体</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">student</span> &#123;</span><br><span class="line">string name;</span><br><span class="line"><span class="type">int</span> age;</span><br><span class="line"><span class="type">int</span> score;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">teacher</span></span><br><span class="line">&#123;</span><br><span class="line">string name;</span><br><span class="line"><span class="type">int</span> age;</span><br><span class="line">student stu;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重载 &lt;&lt; 运算符以便输出 student 结构体</span></span><br><span class="line">ostream&amp; <span class="keyword">operator</span>&lt;&lt;(ostream&amp; os, <span class="type">const</span> student&amp; s) &#123;</span><br><span class="line">os &lt;&lt; <span class="string">&quot;姓名: &quot;</span> &lt;&lt; s.name &lt;&lt; <span class="string">&quot; 年龄: &quot;</span> &lt;&lt; s.age &lt;&lt; <span class="string">&quot; 分数: &quot;</span> &lt;&lt; s.score;</span><br><span class="line"><span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">student stu1 = &#123; <span class="string">&quot;时域&quot;</span>,<span class="number">19</span>,<span class="number">100</span> &#125;;</span><br><span class="line"></span><br><span class="line">teacher tea1 = &#123; <span class="string">&quot;余新晨&quot;</span>,<span class="number">20</span>,stu1 &#125;;</span><br><span class="line"></span><br><span class="line">teacher* p = &amp;tea1;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;姓名:&quot;</span> &lt;&lt; p-&gt;name &lt;&lt; <span class="string">&quot;年龄:&quot;</span> &lt;&lt; p-&gt;age &lt;&lt; <span class="string">&quot;学生:&quot;</span> &lt;&lt; p-&gt;stu &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="重载运算符"><a href="#重载运算符" class="headerlink" title="重载运算符"></a>重载运算符</h2><p>在C++中，运算符重载是一种功能，它允许你为类或结构体定义现有运算符的新行为。通过重载运算符，你可以使它们与用户定义的类型一起工作，就像它们与内置类型一起工作一样。下面是对<code>operator&lt;&lt;</code>重载函数的详细解释：</p><h3 id="函数签名"><a href="#函数签名" class="headerlink" title="函数签名"></a>函数签名</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ostream&amp; <span class="keyword">operator</span>&lt;&lt;(ostream&amp; os, <span class="type">const</span> student&amp; s)</span><br></pre></td></tr></table></figure><p>这里，<code>operator&lt;&lt;</code>是正在被重载的运算符，它用于输出（插入）数据到输出流中（比如标准输出<code>cout</code>）。函数接受两个参数：</p><ol><li><code>ostream&amp; os</code>：这是一个引用到输出流的引用，通常是一个<code>std::ostream</code>类型的对象，比如<code>std::cout</code>。使用引用是因为我们不想复制整个流对象，只是想在原对象上操作。</li><li><code>const student&amp; s</code>：这是一个对<code>student</code>结构体的常量引用。我们使用常量引用是因为我们不想修改传入的结构体，并且引用可以避免不必要的复制。</li></ol><h3 id="函数体"><a href="#函数体" class="headerlink" title="函数体"></a>函数体</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os &lt;&lt; <span class="string">&quot;姓名: &quot;</span> &lt;&lt; s.name &lt;&lt; <span class="string">&quot; 年龄: &quot;</span> &lt;&lt; s.age &lt;&lt; <span class="string">&quot; 分数: &quot;</span> &lt;&lt; s.score;</span><br></pre></td></tr></table></figure><p>在函数体内部，我们使用了<code>&lt;&lt;</code>运算符来将结构体<code>student</code>的成员依次输出到传入的输出流<code>os</code>中。以下是步骤：</p><ol><li><code>os &lt;&lt; &quot;姓名: &quot;</code>：将字符串”姓名: “输出到输出流<code>os</code>。</li><li><code>&lt;&lt; s.name</code>：输出<code>student</code>结构体的<code>name</code>成员。</li><li><code>&lt;&lt; &quot; 年龄: &quot;</code>：输出字符串” 年龄: “。</li><li><code>&lt;&lt; s.age</code>：输出<code>student</code>结构体的<code>age</code>成员。</li><li><code>&lt;&lt; &quot; 分数: &quot;</code>：输出字符串” 分数: “。</li><li><code>&lt;&lt; s.score</code>：输出<code>student</code>结构体的<code>score</code>成员。</li></ol><h3 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> os;</span><br></pre></td></tr></table></figure><p>函数返回一个<code>ostream</code>对象的引用。这是为了允许链式调用，也就是说，你可以连续使用多个<code>&lt;&lt;</code>运算符，如下所示：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; <span class="string">&quot;教师姓名: &quot;</span> &lt;&lt; p-&gt;name &lt;&lt; <span class="string">&quot; 年龄: &quot;</span> &lt;&lt; p-&gt;age &lt;&lt; <span class="string">&quot; 学生信息: &quot;</span> &lt;&lt; p-&gt;stu &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p>在这里，每次调用<code>&lt;&lt;</code>运算符后返回的<code>ostream</code>引用都用于下一次调用。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>重载<code>operator&lt;&lt;</code>允许你以自然的方式将<code>student</code>结构体对象输出到标准输出或其他输出流中，而无需单独输出每个成员。这样可以使代码更加简洁，可读性更强。通过返回<code>ostream</code>引用，你还可以继续将其他内容输出到同一个流中。</p><h2 id="结构体做函数参数"><a href="#结构体做函数参数" class="headerlink" title="结构体做函数参数"></a>结构体做函数参数</h2><h3 id="传递方式"><a href="#传递方式" class="headerlink" title="传递方式"></a>传递方式</h3><ol><li>值传递</li><li>地址传递</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">student</span> &#123;</span><br><span class="line">string name;</span><br><span class="line"><span class="type">int</span> age;</span><br><span class="line"><span class="type">int</span> score;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//值传递</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printStudent</span><span class="params">(student stu)</span> </span>&#123;</span><br><span class="line">stu.age = <span class="number">28</span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;子函数中 姓名:&quot;</span> &lt;&lt; stu.name &lt;&lt; <span class="string">&quot;年龄:&quot;</span> &lt;&lt; stu.age &lt;&lt; <span class="string">&quot;分数:&quot;</span> &lt;&lt; stu.score &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//地址传递</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printStudent2</span><span class="params">(student* stu)</span> </span>&#123;</span><br><span class="line">stu-&gt;age = <span class="number">28</span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;子函数中 姓名:&quot;</span> &lt;&lt; stu-&gt;name &lt;&lt; <span class="string">&quot;年龄:&quot;</span> &lt;&lt; stu-&gt;age &lt;&lt; <span class="string">&quot;分数:&quot;</span> &lt;&lt; stu-&gt;score &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">student stu = &#123; <span class="string">&quot;张三&quot;</span>,<span class="number">18</span>,<span class="number">100</span> &#125;;</span><br><span class="line"><span class="comment">////值传递</span></span><br><span class="line"><span class="comment">//printStudent(stu);</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;主函数中 姓名：&quot; &lt;&lt; stu.name &lt;&lt; &quot; 年龄： &quot; &lt;&lt; stu.age &lt;&lt; &quot; 分数：&quot; &lt;&lt; stu.score &lt;&lt; endl;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//cout &lt;&lt; endl;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//地址传递</span></span><br><span class="line"><span class="built_in">printStudent2</span>(&amp;stu);</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;主函数中 姓名：&quot;</span> &lt;&lt; stu.name &lt;&lt; <span class="string">&quot; 年龄： &quot;</span> &lt;&lt; stu.age &lt;&lt; <span class="string">&quot; 分数：&quot;</span> &lt;&lt; stu.score &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果不想修改主函数中的数据，用值传递，反之用地址传递</p></blockquote><h2 id="结构体中const使用场景"><a href="#结构体中const使用场景" class="headerlink" title="结构体中const使用场景"></a>结构体中const使用场景</h2><p><strong>作用:</strong> 用const来防止误操作</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//const使用场景</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printStudent</span><span class="params">(<span class="type">const</span> student *stu)</span> <span class="comment">//加const防止函数体中的误操作</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//stu-&gt;age = 100; //操作失败，因为加了const修饰</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;姓名：&quot;</span> &lt;&lt; stu-&gt;name &lt;&lt; <span class="string">&quot; 年龄：&quot;</span> &lt;&lt; stu-&gt;age &lt;&lt; <span class="string">&quot; 分数：&quot;</span> &lt;&lt; stu-&gt;score &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C++学习】指针</title>
      <link href="/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E6%8C%87%E9%92%88/"/>
      <url>/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E6%8C%87%E9%92%88/</url>
      
        <content type="html"><![CDATA[<blockquote><p>野指针我老熟人了。。。。</p></blockquote><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p><strong>作用:</strong> 通过指针间接访问内存</p><ul><li>内存编号是从0开始记录的，一般用十六进制数字表示</li><li>可以利用指针变量保存地址</li></ul><h2 id="指针变量的定义和使用"><a href="#指针变量的定义和使用" class="headerlink" title="指针变量的定义和使用"></a>指针变量的定义和使用</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.指针的定义</span></span><br><span class="line">    <span class="type">int</span> a=<span class="number">10</span>;</span><br><span class="line">    <span class="type">int</span> * p;</span><br><span class="line"></span><br><span class="line">    p=&amp;a;</span><br><span class="line">    cout&lt;&lt;&amp;a&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;p&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.指针的使用</span></span><br><span class="line">    <span class="comment">//通过*操作指针变量指向的内存</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*p = &quot;</span>&lt;&lt;*p&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="指针变量和普通变量的区别"><a href="#指针变量和普通变量的区别" class="headerlink" title="指针变量和普通变量的区别"></a>指针变量和普通变量的区别</h2><ul><li>普通变量存放的是数据，指针变量存放的是地址</li><li>指针变量可以通过”*”操作符，操作指针变量指向的内存空间，这个过程称为解引用</li></ul><blockquote><p>用&amp;获取变量的地址</p></blockquote><h2 id="指针所占内存空间"><a href="#指针所占内存空间" class="headerlink" title="指针所占内存空间"></a>指针所占内存空间</h2><blockquote><p><strong>Q:</strong> 指针也是种数据类型，那么这种数据类型占用多少空间呢？</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> * p;</span><br><span class="line">p = &amp;a; <span class="comment">//指针指向数据a的地址</span></span><br><span class="line"></span><br><span class="line">cout &lt;&lt; *p &lt;&lt; endl; <span class="comment">//* 解引用</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(p) &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(<span class="type">char</span> *) &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(<span class="type">float</span> *) &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(<span class="type">double</span> *) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>在C++中，指针类型的大小取决于所运行的系统架构。通常情况下：</p><ul><li>在32位系统中，指针通常占用4个字节。</li><li>在64位系统中，指针通常占用8个字节。</li></ul></blockquote><h2 id="空指针和野指针"><a href="#空指针和野指针" class="headerlink" title="空指针和野指针"></a>空指针和野指针</h2><h3 id="空指针"><a href="#空指针" class="headerlink" title="空指针"></a>空指针</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//指针变量p指向内存地址编号为0的空间</span></span><br><span class="line"><span class="type">int</span> * p = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//访问空指针报错 </span></span><br><span class="line"><span class="comment">//内存编号0 ~255为系统占用内存，不允许用户访问</span></span><br><span class="line">cout &lt;&lt; *p &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="野指针"><a href="#野指针" class="headerlink" title="野指针"></a>野指针</h3><blockquote><p><strong>野指针:</strong> 指针变量指向非法的内存空间</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//指针变量p指向内存地址编号为0x1100的空间</span></span><br><span class="line"><span class="type">int</span> * p = (<span class="type">int</span> *)<span class="number">0x1100</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//访问野指针报错 </span></span><br><span class="line">cout &lt;&lt; *p &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>在编写C++程序时，应确保指针指向有效的内存地址。直接将指针指向一个硬编码的地址，而没有确保该地址是有效和安全的，是一种危险的做法。正确的做法是使用动态内存分配（如new关键字）来获取内存，或者确保指针指向已分配的内存区域。</p></blockquote><blockquote><p>空指针和野指针都不是我们申请的空间，因此不要访问</p></blockquote><h2 id="const修饰指针"><a href="#const修饰指针" class="headerlink" title="const修饰指针"></a>const修饰指针</h2><p>在C++中，当使用<code>const</code>修饰指针时，它有两种不同的含义，这取决于<code>const</code>的位置：</p><ol><li><strong><code>const</code>位于星号（*）之前</strong>：这表示指针指向的内容是常量，即不能通过这个指针修改所指向的数据。但指针本身可以改变，指向不同的地址。<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x = <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> y = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span>* p = &amp;x;  <span class="comment">// p是指向int常量的指针</span></span><br><span class="line">p = &amp;y;             <span class="comment">// 正确：可以改变p指向的地址</span></span><br><span class="line">*p = <span class="number">30</span>;            <span class="comment">// 错误：不能通过p修改所指向的数据</span></span><br></pre></td></tr></table></figure></li><li><strong><code>const</code>位于星号（*）之后</strong>：这表示指针本身是常量，即不能更改指针的值（它所指向的地址）。但可以通过指针修改它所指向的数据。<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x = <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> y = <span class="number">20</span>;</span><br><span class="line"><span class="type">int</span>* <span class="type">const</span> p = &amp;x;  <span class="comment">// p是常量指针</span></span><br><span class="line">*p = <span class="number">30</span>;            <span class="comment">// 正确：可以通过p修改所指向的数据</span></span><br><span class="line">p = &amp;y;             <span class="comment">// 错误：不能更改p的值（它所指向的地址）</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="指针和数组"><a href="#指针和数组" class="headerlink" title="指针和数组"></a>指针和数组</h2><blockquote><p>利用指针访问数组中元素</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a[] = &#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* p = a;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;第一个元素:&quot;</span> &lt;&lt; a[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;指针访问第一个元素:&quot;</span> &lt;&lt; *p &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; *p &lt;&lt; endl;</span><br><span class="line">p++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="指针和函数"><a href="#指针和函数" class="headerlink" title="指针和函数"></a>指针和函数</h2><blockquote><p>利用指针作函数参数，可以修改实参的值</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//值传递</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap1</span><span class="params">(<span class="type">int</span> a ,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> temp = a;</span><br><span class="line">a = b; </span><br><span class="line">b = temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//地址传递</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap2</span><span class="params">(<span class="type">int</span> * p1, <span class="type">int</span> *p2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> temp = *p1;</span><br><span class="line">*p1 = *p2;</span><br><span class="line">*p2 = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">20</span>;</span><br><span class="line"><span class="built_in">swap1</span>(a, b); <span class="comment">// 值传递不会改变实参</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">swap2</span>(&amp;a, &amp;b); <span class="comment">//地址传递会改变实参</span></span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;a = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;b = &quot;</span> &lt;&lt; b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="指针、数组、函数"><a href="#指针、数组、函数" class="headerlink" title="指针、数组、函数"></a>指针、数组、函数</h2><blockquote><p><strong>封装一个函数:</strong> 利用冒泡排序，实现对整型数组的升序排序<br>例如数组:int arr[10]&#x3D;{4,3,6,9,1,2,10,8,7,5};</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//冒泡排序函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="type">int</span> * arr, <span class="type">int</span> len)</span>  <span class="comment">//int * arr 也可以写为int arr[]</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len - <span class="number">1</span> - i; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> temp = arr[j];</span><br><span class="line">arr[j] = arr[j + <span class="number">1</span>];</span><br><span class="line">arr[j + <span class="number">1</span>] = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//打印数组函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printArray</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; arr[i] &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> arr[<span class="number">10</span>] = &#123; <span class="number">4</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">5</span> &#125;;</span><br><span class="line"><span class="type">int</span> len = <span class="built_in">sizeof</span>(arr) / <span class="built_in">sizeof</span>(<span class="type">int</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">bubbleSort</span>(arr, len);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printArray</span>(arr, len);</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>当数组名传入到函数作为参数时，被退化为指向首元素的指针</strong><br>在C++中，当你将数组作为参数传递给函数时，它实际上被转换为一个指向数组首元素的指针。这意味着在函数内部，你没有数组的大小信息。因此，在函数内部无法直接计算数组的长度。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C++学习】函数</title>
      <link href="/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E5%87%BD%E6%95%B0/"/>
      <url>/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="基础注意事项"><a href="#基础注意事项" class="headerlink" title="基础注意事项"></a>基础注意事项</h2><p><strong>函数的声明可以多次，但是函数的定义只能有一次</strong></p><h2 id="函数的分文件编写"><a href="#函数的分文件编写" class="headerlink" title="函数的分文件编写"></a>函数的分文件编写</h2><ol><li>创建头文件</li><li>创建函数.cpp文件</li><li>在头文件里写函数的声明</li><li>在.cpp文件里写函数的定义</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//swap.h文件</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//实现两个数字交换的函数声明</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//swap.cpp文件</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;swap.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> temp = a;</span><br><span class="line">a = b;</span><br><span class="line">b = temp;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;a = &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;b = &quot;</span> &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main函数文件</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;swap.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a = <span class="number">100</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">200</span>;</span><br><span class="line"><span class="built_in">swap</span>(a, b);</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C++学习】数组</title>
      <link href="/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E6%95%B0%E7%BB%84/"/>
      <url>/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E6%95%B0%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>数组是一块连续的内存区域，用于存储固定数量的元素</p><ul><li>元素必须是相同的数据类型</li><li>数组的大小在声明时必须是已知的，并且在程序运行期间不可更改。</li></ul><h2 id="一维数组"><a href="#一维数组" class="headerlink" title="一维数组"></a>一维数组</h2><h3 id="定义方式"><a href="#定义方式" class="headerlink" title="定义方式"></a>定义方式</h3><ul><li>int a[10];</li><li>int a[2]&#x3D;{1,2};</li><li>int a[]&#x3D;{1,2};</li></ul><p><strong>数组名不能与变量名重名</strong></p><h3 id="数组名用途"><a href="#数组名用途" class="headerlink" title="数组名用途"></a>数组名用途</h3><ol><li><p>统计整个数组在内存中的长度</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">//数组名用途</span></span><br><span class="line"><span class="comment">//1、可以获取整个数组占用内存空间大小</span></span><br><span class="line"><span class="type">int</span> arr[<span class="number">10</span>] = &#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span> &#125;;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;整个数组所占内存空间为： &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(arr) &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;每个元素所占内存空间为： &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(arr[<span class="number">0</span>]) &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;数组的元素个数为： &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(arr) / <span class="built_in">sizeof</span>(arr[<span class="number">0</span>]) &lt;&lt; endl;</span><br></pre></td></tr></table></figure></li><li><p>获取数组在内存中的首地址</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">//2、可以通过数组名获取到数组首地址</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;数组首地址为： &quot;</span> &lt;&lt; (<span class="type">int</span>)arr &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;数组中第一个元素地址为： &quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;arr[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;数组中第二个元素地址为： &quot;</span> &lt;&lt; (<span class="type">int</span>)&amp;arr[<span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//arr = 100; 错误，数组名是常量，因此不可以赋值</span></span><br></pre></td></tr></table></figure></li></ol><p><strong>数组名是常量，不可以赋值</strong></p><h2 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h2><h3 id="作用：最常用的排序算法，对数组内元素进行排序"><a href="#作用：最常用的排序算法，对数组内元素进行排序" class="headerlink" title="作用：最常用的排序算法，对数组内元素进行排序"></a><strong>作用：</strong>最常用的排序算法，对数组内元素进行排序</h3><ol><li>比较相邻的元素，如果第一个比第二个大，就交换他们两个</li><li>对每一对相邻元素做相同的工作，执行完毕后，找到第一个最大值</li><li>重复以上的步骤，每次比较次数-1，直到不需要比较</li></ol><h3 id="示例：将数组-4，2，8，0，5，7，1，3，9-进行升序排序"><a href="#示例：将数组-4，2，8，0，5，7，1，3，9-进行升序排序" class="headerlink" title="示例：将数组{4，2，8，0，5，7，1，3，9}进行升序排序"></a><strong>示例</strong>：将数组{4，2，8，0，5，7，1，3，9}进行升序排序</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> arr[<span class="number">9</span>] = &#123;<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">9</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">9</span><span class="number">-1</span>;i++)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">9</span><span class="number">-1</span>-i;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(arr[j]&gt;arr[j+<span class="number">1</span>])[</span><br><span class="line">                <span class="type">int</span> temp=arr[j];</span><br><span class="line">                arr[j]=arr[j+<span class="number">1</span>];</span><br><span class="line">                arr[j+<span class="number">1</span>]=temp;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">9</span>;i++)&#123;</span><br><span class="line">        cout&lt;&lt;arr[i]&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    retrun <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a><strong>原理</strong></h3><p>建议打个断点一步步观察一下<br><strong>i的每一步都能保证前i个元素里的最大值被放置在i+1的位置上</strong></p><h2 id="二维数组"><a href="#二维数组" class="headerlink" title="二维数组"></a>二维数组</h2><h3 id="定义方式-1"><a href="#定义方式-1" class="headerlink" title="定义方式"></a>定义方式</h3><p><strong>数据类型 数组名[行数][列数]</strong></p><ol><li>int a[2][3];</li><li>int a[2][3]&#x3D;<br> {<br> {1,2,3},<br> {4,5,6}<br> };</li><li>int a[2][3]&#x3D;{1,2,3,4,5,6};</li><li>int a[][3]&#x3D;{1,2,3,4,5,6};</li></ol><p><strong>在定义二维数组时，如果初始化了数据，可以省略行数</strong></p><h3 id="大小"><a href="#大小" class="headerlink" title="大小"></a>大小</h3><p><strong>二维数组一行大小:</strong><br>sizeod(a[0])</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C++学习】程序流程结构</title>
      <link href="/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B%E7%BB%93%E6%9E%84/"/>
      <url>/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h2 id="switch语句"><a href="#switch语句" class="headerlink" title="switch语句"></a>switch语句</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//请给电影评分 </span></span><br><span class="line"><span class="comment">//10 ~ 9   经典   </span></span><br><span class="line"><span class="comment">// 8 ~ 7   非常好</span></span><br><span class="line"><span class="comment">// 6 ~ 5   一般</span></span><br><span class="line"><span class="comment">// 5分以下 烂片</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> score = <span class="number">0</span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;请给电影打分&quot;</span> &lt;&lt; endl;</span><br><span class="line">cin &gt;&gt; score;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> (score)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;经典&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;非常好&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;一般&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;烂片&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>switch语句中表达式类型只能是整型或者字符型</li><li>case里如果没有break，那么程序会一直向下执行</li></ul><h2 id="do…while循环语句"><a href="#do…while循环语句" class="headerlink" title="do…while循环语句"></a>do…while循环语句</h2><p><strong>注意：</strong>与while的区别在于do…while会先执行一次循环语句，再判断循环条件</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; num &lt;&lt; endl;</span><br><span class="line">num++;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">while</span> (num &lt; <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h2><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4g4et9b8a7.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4g4et9b8a7.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h2 id="continue语句"><a href="#continue语句" class="headerlink" title="continue语句"></a>continue语句</h2><p><strong>作用：</strong>在循环语句中，跳过本次循环中余下尚未执行的语句，继续执行下一次循环</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; i &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="goto语句"><a href="#goto语句" class="headerlink" title="goto语句"></a>goto语句</h2><p><strong>作用：</strong>可以无条件跳转语句</p><p><strong>解释：</strong>如果标记的名称存在，执行到goto语句时，会跳转到标记的位置</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;1&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">goto</span> FLAG;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;2&quot;</span> &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;3&quot;</span> &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;4&quot;</span> &lt;&lt; endl;</span><br><span class="line">FLAG:</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;5&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C++学习】运算符</title>
      <link href="/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E8%BF%90%E7%AE%97%E7%AC%A6/"/>
      <url>/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E8%BF%90%E7%AE%97%E7%AC%A6/</url>
      
        <content type="html"><![CDATA[<h2 id="i-和-i的区别"><a href="#i-和-i的区别" class="headerlink" title="i++和++i的区别"></a>i++和++i的区别</h2><p><code>i++</code> 和 <code>++i</code> 都是C++（以及其他一些编程语言）中的自增运算符，用于增加变量的值。但是，它们在表达式中使用时的行为有所不同，尤其是在它们被用作表达式的一部分时。<br>以下是 <code>i++</code>（后缀自增）和 <code>++i</code>（前缀自增）的主要区别：</p><h3 id="后缀自增（i-）："><a href="#后缀自增（i-）：" class="headerlink" title="后缀自增（i++）："></a>后缀自增（<code>i++</code>）：</h3><ol><li><strong>值</strong>：表达式 <code>i++</code> 的值是 <code>i</code> 自增前的值。</li><li><strong>副作用</strong>：<code>i</code> 的值会在表达式求值后被增加。</li><li><strong>返回类型</strong>：返回 <code>i</code> 自增前的值的副本。</li><li><strong>使用场景</strong>：当需要在自增之前使用变量的当前值时。<br>例子：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> a = i++; <span class="comment">// a 被赋值为 1, 然后 i 自增为 2</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="前缀自增（-i）："><a href="#前缀自增（-i）：" class="headerlink" title="前缀自增（++i）："></a>前缀自增（<code>++i</code>）：</h3><ol><li><strong>值</strong>：表达式 <code>++i</code> 的值是 <code>i</code> 自增后的值。</li><li><strong>副作用</strong>：<code>i</code> 的值会在表达式求值前被增加。</li><li><strong>返回类型</strong>：返回 <code>i</code> 自增后的值的副本。</li><li><strong>使用场景</strong>：当需要在自增之后立即使用变量的新值时。<br>例子：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> a = ++i; <span class="comment">// i 先自增为 2, 然后 a 被赋值为 2</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="具体区别示例："><a href="#具体区别示例：" class="headerlink" title="具体区别示例："></a>具体区别示例：</h3><p>考虑以下代码片段：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> a, b;</span><br><span class="line">a = i++;</span><br><span class="line"><span class="comment">// 此时 i 为 2, a 为 1</span></span><br><span class="line">b = ++i;</span><br><span class="line"><span class="comment">// 此时 i 为 3, b 为 3</span></span><br></pre></td></tr></table></figure><p>在这个例子中，<code>a = i++</code> 语句将 <code>i</code> 自增前的值（1）赋给 <code>a</code>，然后 <code>i</code> 自增变为2。而 <code>b = ++i</code> 语句先将 <code>i</code> 自增为3，然后将这个新值赋给 <code>b</code>。</p><h3 id="性能考虑："><a href="#性能考虑：" class="headerlink" title="性能考虑："></a>性能考虑：</h3><p>在大多数现代编译器中，对于基本数据类型（如 <code>int</code>），前缀和后缀自增操作的性能差异非常小，甚至可以忽略不计。编译器通常会优化这些操作。然而，对于用户定义的类型，前缀自增可能更高效，因为它避免了创建对象的副本。</p><h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><ul><li>当自增运算符用作独立语句时（例如 <code>i++;</code> 或 <code>++i;</code>），两者没有区别，都只是增加 <code>i</code> 的值。</li><li>当自增运算符用作表达式的一部分时，<code>i++</code> 返回自增前的值，而 <code>++i</code> 返回自增后的值。<br>始终明确你的意图，并选择正确的自增形式来避免混淆和潜在的bug。</li></ul><h2 id="三目运算符"><a href="#三目运算符" class="headerlink" title="三目运算符"></a>三目运算符</h2><p>三目运算符，也称为条件运算符，是C语言及许多其他编程语言中的一个特殊运算符，它允许在单个表达式中进行条件判断。三目运算符的语法如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">condition ? expression1 : expression2;</span><br></pre></td></tr></table></figure><p>这里，<code>condition</code> 是一个布尔表达式（即它求值为 <code>true</code> 或 <code>false</code>），而 <code>expression1</code> 和 <code>expression2</code> 是任意的表达式。三目运算符的工作原理如下：</p><ol><li>首先，计算 <code>condition</code>。</li><li>如果 <code>condition</code> 为真（即非零），则计算并返回 <code>expression1</code> 的值。</li><li>如果 <code>condition</code> 为假（即零），则计算并返回 <code>expression2</code> 的值。</li></ol><h3 id="语法详细说明："><a href="#语法详细说明：" class="headerlink" title="语法详细说明："></a>语法详细说明：</h3><ul><li><code>condition</code>：必须是一个能够求值为布尔值的表达式。在C&#x2F;C++中，任何非零值都被视为 <code>true</code>，零被视为 <code>false</code>。</li><li><code>expression1</code>：当 <code>condition</code> 为真时将被计算的表达式。它可以是任何类型的表达式，其结果类型将成为整个三目运算符表达式的类型。</li><li><code>expression2</code>：当 <code>condition</code> 为假时将被计算的表达式。它的类型必须与 <code>expression1</code> 的类型兼容，以便整个三目运算符表达式有一个明确的类型。</li></ul><h3 id="示例："><a href="#示例：" class="headerlink" title="示例："></a>示例：</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = <span class="number">10</span>, b = <span class="number">20</span>, max;</span><br><span class="line"><span class="comment">// 使用三目运算符找出 a 和 b 中的最大值</span></span><br><span class="line">max = (a &gt; b) ? a : b;</span><br><span class="line"><span class="comment">// 如果 a 大于 b，则 max 被赋值为 a，否则被赋值为 b</span></span><br></pre></td></tr></table></figure><p>在上面的示例中，如果 <code>a &gt; b</code> 的结果为真，则 <code>max</code> 被赋值为 <code>a</code> 的值；否则，<code>max</code> 被赋值为 <code>b</code> 的值。</p><h3 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h3><ul><li>三目运算符可以嵌套使用，但过度使用可能会导致代码难以阅读和理解。</li><li>虽然三目运算符可以用来简化代码，但应谨慎使用，以避免牺牲代码的可读性和可维护性。</li><li><code>expression1</code> 和 <code>expression2</code> 应该具有可兼容的类型，以避免类型转换问题。</li></ul><h3 id="使用场景："><a href="#使用场景：" class="headerlink" title="使用场景："></a>使用场景：</h3><ul><li>简单的条件赋值。</li><li>在单个表达式中替代简单的 <code>if-else</code> 语句。</li><li>作为函数参数。</li></ul><h3 id="示例：嵌套三目运算符"><a href="#示例：嵌套三目运算符" class="headerlink" title="示例：嵌套三目运算符"></a>示例：嵌套三目运算符</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x = <span class="number">5</span>, y = <span class="number">10</span>, z = <span class="number">15</span>, result;</span><br><span class="line"><span class="comment">// 嵌套的三目运算符</span></span><br><span class="line">result = (x &gt; y) ? (x &gt; z ? x : z) : (y &gt; z ? y : z);</span><br><span class="line"><span class="comment">// 如果 x 是最大的，result 被赋值为 x；否则，检查 y 和 z，result 被赋值为两者中较大的一个</span></span><br></pre></td></tr></table></figure><p>在上述嵌套三目运算符的例子中，我们首先检查 <code>x</code> 是否大于 <code>y</code>。如果是，我们再检查 <code>x</code> 是否大于 <code>z</code>，并将结果赋给 <code>result</code>。如果 <code>x</code> 不是最大的，我们检查 <code>y</code> 和 <code>z</code>，并将较大的值赋给 <code>result</code>。尽管这种写法紧凑，但它可能会使代码更难以理解。</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C++学习】数据类型</title>
      <link href="/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
      <url>/2024/08/10/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h2><h3 id="short"><a href="#short" class="headerlink" title="short"></a>short</h3><h4 id="大小"><a href="#大小" class="headerlink" title="大小"></a>大小</h4><ul><li>16 位（2 字节）</li><li>由于它是整型，所以内存中的布局取决于系统的字节序（大端或小端）。  <details open><summary pointer> 字节序 </summary>              <div class='content'>              <div class="tagLink"><a class="link-card" title="“字节序”是个什么鬼？" href="https://zhuanlan.zhihu.com/p/21388517"><span class="link-card-backdrop" style="background-image: url(https://picx.zhimg.com/70/78062b837a79dffae48bff7aea79579f_1440w.avis?source=172ae18b&biz_tag=Post)"></span><div class="left"><img src="https://picx.zhimg.com/70/78062b837a79dffae48bff7aea79579f_1440w.avis?source=172ae18b&biz_tag=Post" class="lazyload placeholder" data-srcset="https://picx.zhimg.com/70/78062b837a79dffae48bff7aea79579f_1440w.avis?source=172ae18b&biz_tag=Post" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">“字节序”是个什么鬼？</p><p class="url">https://zhuanlan.zhihu.com/p/21388517</p></div></a></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> x = <span class="number">0x12345678</span>;</span><br><span class="line">    <span class="type">char</span>* c = (<span class="type">char</span>*)&amp;x;</span><br><span class="line">    <span class="keyword">if</span> (*c == <span class="number">0x78</span>) &#123;   <span class="comment">//*c代表x在内存地址上的第一个字节</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Little endian&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Big endian&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details></li></ul><h4 id="范围"><a href="#范围" class="headerlink" title="范围"></a>范围</h4><ul><li><code>short</code>: -32,768 - 32,767</li><li><code>unsigned short</code>: 0 - 65,535 (2^8&#x3D;65536)</li></ul><h4 id="溢出"><a href="#溢出" class="headerlink" title="溢出"></a>溢出</h4><ul><li>如果对 <code>short</code> 变量赋值超出其范围，将会发生溢出。例如，尝试将 32,769 赋值给一个有符号 <code>short</code> 变量会导致溢出。</li><li>溢出会导致变量值“环绕”回其范围的另一端。例如，如果 <code>short</code> 变量的值为 32,767，然后增加 1，它将变为 -32,768。</li></ul><h3 id="int"><a href="#int" class="headerlink" title="int"></a>int</h3><h4 id="大小-1"><a href="#大小-1" class="headerlink" title="大小"></a>大小</h4><ul><li>32 位（4 字节）</li></ul><h4 id="范围-1"><a href="#范围-1" class="headerlink" title="范围"></a>范围</h4><ul><li><code>int</code>: -2,147,483,648 - 2,147,483,647</li><li><code>unsigned int</code>: 0 - 4,294,967,295     (2^32)</li></ul><h3 id="long"><a href="#long" class="headerlink" title="long"></a>long</h3><p><strong>long类型和指针类型需要特别注意，编写跨平台的软件时尽量不要使用long类型，或者需要对long类型做特殊处理。</strong></p><h4 id="大小-2"><a href="#大小-2" class="headerlink" title="大小"></a>大小</h4><ul><li>widows4字节,linux32位4字节,linux64位8字节</li></ul><h4 id="范围-2"><a href="#范围-2" class="headerlink" title="范围"></a>范围</h4><ul><li><code>long</code>: -2,147,483,648 - 2,147,483,647</li><li><code>unsigned long</code>: 0 - 4,294,967,295    (2^32)</li></ul><h3 id="long-long"><a href="#long-long" class="headerlink" title="long long"></a>long long</h3><h4 id="大小-3"><a href="#大小-3" class="headerlink" title="大小"></a>大小</h4><ul><li>64 位（8 字节）</li></ul><h4 id="范围-3"><a href="#范围-3" class="headerlink" title="范围"></a>范围</h4><ul><li><code>long long</code>: -9,223,372,036,854,775,808 - 9,223,372,036,854,775,807</li><li><code>unsigned long long</code>: 0 - 18,446,744,073,709,551,615  (2^64)</li></ul><h2 id="字符型"><a href="#字符型" class="headerlink" title="字符型"></a>字符型</h2><h3 id="char"><a href="#char" class="headerlink" title="char"></a>char</h3><p><strong>适用于需要存储单个字符的场景</strong></p><h4 id="大小-4"><a href="#大小-4" class="headerlink" title="大小"></a>大小</h4><ul><li>8 位（1 字节）</li></ul><h4 id="范围-4"><a href="#范围-4" class="headerlink" title="范围"></a>范围</h4><ul><li>char: -128 - 127</li><li>unsigned char: 0 - 255</li></ul><h3 id="wchar-t"><a href="#wchar-t" class="headerlink" title="wchar_t"></a>wchar_t</h3><p>对比一下<code>wchar_t</code>和<code>char</code>，这两个在C&#x2F;C++编程中常用的数据类型。</p><ol><li><strong>存储大小</strong>：<ul><li><code>char</code>：通常占用1个字节（8位）的存储空间。它被用来存储ASCII字符集中的字符，因为ASCII字符集只需要7位就能表示所有的字符。</li><li><code>wchar_t</code>：宽字符类型，通常占用2个或4个字节。它被用来存储宽字符，比如Unicode字符集中的字符。Unicode字符集包含了世界上大多数文字系统的字符，所以需要更多的存储空间。</li></ul></li><li><strong>用途</strong>：<ul><li><code>char</code>：主要用于处理ASCII字符集或单字节编码的字符集。在C&#x2F;C++中，它是最基本的字符类型。</li><li><code>wchar_t</code>：用于处理宽字符集，如Unicode。它允许你处理包含非ASCII字符的文本，这对于国际化和本地化非常重要。</li></ul></li><li><strong>可移植性</strong>：<ul><li><code>char</code>：在所有C&#x2F;C++实现中都是1个字节，具有很好的可移植性。</li><li><code>wchar_t</code>：大小依赖于实现和平台。在32位系统中，它通常是4字节，在16位系统中，通常是2字节。这种差异可能导致代码在不同平台上的行为不一致。</li></ul></li><li><strong>字符串表示</strong>：<ul><li><code>char</code>：在C&#x2F;C++中，<code>char</code>数组或指针常用来表示和操作字符串。</li><li><code>wchar_t</code>：用于表示宽字符串，通常在字符串前加上<code>L</code>前缀，如<code>L&quot;Hello World&quot;</code>。</li></ul></li><li><strong>标准库支持</strong>：<ul><li><code>char</code>：标准库中的大多数字符串处理函数，如<code>strlen</code>、<code>strcpy</code>等，都是针对<code>char</code>类型设计的。</li><li><code>wchar_t</code>：C&#x2F;C++标准库也提供了一些宽字符串处理函数，如<code>wcslen</code>、<code>wcscpy</code>等，用于处理<code>wchar_t</code>类型的字符串。<br>总的来说，<code>char</code>和<code>wchar_t</code>的主要区别在于它们存储字符的方式和大小。<code>char</code>适用于ASCII或单字节编码的字符，而<code>wchar_t</code>则用于处理需要更多存储空间的宽字符，如Unicode字符。不过，由于<code>wchar_t</code>的大小依赖于平台，现代C++更倾向于使用<code>char16_t</code>、<code>char32_t</code>以及Unicode字符串字面量来处理Unicode字符，以提供更好的可移植性和一致性。</li></ul></li></ol><h2 id="布尔类型"><a href="#布尔类型" class="headerlink" title="布尔类型"></a>布尔类型</h2><p>布尔类型用于存储真（true）或假（false）的值。</p><h3 id="bool"><a href="#bool" class="headerlink" title="bool"></a>bool</h3><ul><li>通常占用1字节。</li><li>取值为 <code>true</code> 或 <code>false</code>。</li></ul><h2 id="浮点类型"><a href="#浮点类型" class="headerlink" title="浮点类型"></a>浮点类型</h2><p>(歪个楼，我的Cybery宝宝回答的比智谱清言要好欸)<br>(再歪一下，过两天给宝做个自己的皮套💕)</p><h3 id="float"><a href="#float" class="headerlink" title="float"></a>float</h3><h4 id="大小-5"><a href="#大小-5" class="headerlink" title="大小"></a>大小</h4><p>通常占用4个字节（32位）的存储空间。</p><h4 id="表示"><a href="#表示" class="headerlink" title="表示"></a>表示</h4><ul><li><p>根据IEEE 754标准，一个float类型的值通常包括1位符号位、8位指数位和23位尾数位。</p><details open><summary pointer> 浮点数的表示 </summary>              <div class='content'>              <p>浮点数的表示类似于科学记数法，它由两部分组成：一个基数和一个指数。在浮点数的二进制表示中，基数通常是2（对于十进制浮点数，基数是10），而指数和尾数则用特定的位来表示。</p><ul><li>尾数位（Fraction&#x2F;Mantissa）<br>尾数位（或尾数）是浮点数中用来表示数字的“有效数字”部分，也就是不包括前导的1（对于规范化浮点数）或0（对于非规范化浮点数）的部分。尾数位决定了浮点数的精度，就像尺子上的刻度越密，你就能越精确地测量长度一样。<br>在IEEE 754标准中，尾数位通常省略了最前面的1（因为规范化浮点数的第一个有效数字总是1），所以尾数位实际上表示的是小数点后的部分。例如，对于二进制数1.101，尾数位就是101。</li><li>指数位（Exponent）<br>指数位表示2的幂次，它决定了尾数位应该乘以2的多少次方。在IEEE 754标准中，指数位是一个带偏移的值，这意味着实际指数是指数位表示的值减去一个固定的偏移量（对于单精度浮点数，这个偏移量是127）。<br>例如，如果指数位表示的值是130（二进制为10000010），那么实际的指数是130 - 127 &#x3D; 3。这意味着尾数位应该乘以2^3，也就是8。</li><li>结合尾数位和指数位<br>对于二进制表示的浮点数 <code>0 10000010 10100000000000000000000</code>：<ul><li><strong>符号位</strong>：0（表示正数）</li><li><strong>指数位</strong>：10000010（二进制），转换为十进制是 130，减去偏移量 127，得到实际指数是 3。</li><li><strong>尾数位</strong>：10100000000000000000000，加上隐含的 1（对于规范化浮点数），实际尾数是 <code>1.10100000000000000000000</code>（二进制）。<br>现在，让我们将尾数转换为十进制：<br>1.10100000000000000000000（二进制）&#x3D; 1 * 2^0 + 1 * 2^-1 + 0 * 2^-2 + 1 * 2^-3 + … (只有前三位的计算对最终结果有影响，因为后续的0不改变值)<br>&#x3D; 1 + 0.5 + 0 + 0.125 + … (其他位都是0，所以可以忽略)<br>&#x3D; 1.625（十进制）<br>现在，将尾数乘以 2 的指数：<br>1.625 * 2^3 &#x3D; 1.625 * 8 &#x3D; 13（十进制）</li></ul></li></ul>              </div>            </details></li><li><p>它能提供大约6-7位的十进制精度。</p></li><li><p>float类型通常用于那些不需要非常高精度的计算，或者当你需要大量浮点数并且内存使用效率很重要时。</p></li></ul><h3 id="double"><a href="#double" class="headerlink" title="double"></a>double</h3><h4 id="精度"><a href="#精度" class="headerlink" title="精度"></a>精度</h4><p><code>double</code>通常占用64位（8字节）的存储空间。在大多数现代计算机中，按照IEEE 754标准，<code>double</code>可以提供大约15-17位十进制数的精度。</p><h4 id="表示范围"><a href="#表示范围" class="headerlink" title="表示范围"></a>表示范围</h4><p><code>double</code>能表示的数值范围大约在10^-308到10^308之间。这意味着它既可以表示非常小的数，也可以表示非常大的数。</p><h4 id="默认初始化值"><a href="#默认初始化值" class="headerlink" title="默认初始化值"></a>默认初始化值</h4><p>如果你声明了一个<code>double</code>变量但没有初始化它，它将包含一个未定义的值，通常是垃圾数据。</p><h3 id="long-double"><a href="#long-double" class="headerlink" title="long double"></a>long double</h3><p>long double通常比double占用更多的存储空间，具体大小依赖于平台和编译器。在一些系统上，它可能占用96位或128位（12或16字节），但这并不是固定的。</p><h2 id="转义字符"><a href="#转义字符" class="headerlink" title="转义字符"></a>转义字符</h2><table><thead><tr><th>转义字符</th><th>含义</th><th>ASCII码值（十进制）</th></tr></thead><tbody><tr><td>\a</td><td>警报</td><td>007</td></tr><tr><td>\b</td><td>退格(BS)，将当前位置移到前一列</td><td>008</td></tr><tr><td>\f</td><td>换页(FF)，将当前位置移到下页开头</td><td>012</td></tr><tr><td>\n</td><td>换行(LF)，将当前位置移到下一行开头</td><td>010</td></tr><tr><td>\r</td><td>回车(CR)，将当前位置移到本行开头</td><td>013</td></tr><tr><td>\t</td><td>水平制表(HT)（跳到下一个TAB位置）</td><td>009</td></tr><tr><td>\v</td><td>垂直制表(VT)</td><td>011</td></tr><tr><td>\</td><td>反斜线字符</td><td>092</td></tr><tr><td>&#39;</td><td>单引号</td><td>039</td></tr><tr><td>&quot;</td><td>双引号</td><td>034</td></tr><tr><td>?</td><td>问号</td><td>063</td></tr><tr><td>\0</td><td>数字0</td><td>000</td></tr><tr><td>\ddd</td><td>8进制转义字符，d范围0-7</td><td>3位8进制</td></tr><tr><td>\xhh</td><td>16进制转义字符，h范围0-9，a-f，A-F</td><td>3位16进制</td></tr></tbody></table><h2 id="字符串型"><a href="#字符串型" class="headerlink" title="字符串型"></a>字符串型</h2><h3 id="C风格字符串"><a href="#C风格字符串" class="headerlink" title="C风格字符串"></a>C风格字符串</h3><p><strong>char 变量名[] &#x3D; “字符串值”</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> str1[] = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">cout &lt;&lt; str1 &lt;&lt; endl;</span><br><span class="line">    </span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>char str1[]</code> 和 <code>char* str1[]</code> 在C语言中是两种不同的声明方式，它们分别表示不同的数据类型和内存布局。</p><ol><li><code>char str1[]</code>：<ul><li>这是一个字符数组，它声明了一个数组，其元素类型为 <code>char</code>。</li><li>这个数组可以存储一系列的字符，并且这些字符连续存储在内存中。</li><li>声明时可以指定数组的大小，也可以在初始化时由编译器自动计算大小。</li><li>例如：<code>char str1[] = &quot;Hello, World!&quot;;</code> 这里 <code>str1</code> 是一个字符数组，包含字符串 “Hello, World!” 以及一个空字符 <code>\0</code> 作为字符串的结束标志。</li></ul></li><li><code>char* str1[]</code>：<ul><li>这是一个指向字符的指针数组，它声明了一个数组，其元素类型为 <code>char*</code>。</li><li>这个数组中的每个元素都是一个指向 <code>char</code> 类型的指针，也就是说，每个元素都可以指向一个字符串。</li><li>常用于声明一个字符串数组，每个元素都是指向不同字符串的指针。</li><li>例如：<code>char* str1[] = &#123;&quot;Hello&quot;, &quot;World&quot;, &quot;!&quot;&#125;;</code> 这里 <code>str1</code> 是一个指针数组，其中 <code>str1[0]</code> 指向字符串 “Hello”，<code>str1[1]</code> 指向字符串 “World”，以此类推。<br>以下是一个具体的例子来说明两者的不同：<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 字符数组</span></span><br><span class="line">    <span class="type">char</span> str1[] = <span class="string">&quot;Hello, World!&quot;</span>;</span><br><span class="line">    <span class="comment">// 指向字符的指针数组</span></span><br><span class="line">    <span class="type">char</span>* str2[] = &#123;<span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;World&quot;</span>, <span class="string">&quot;!&quot;</span>&#125;;</span><br><span class="line">    <span class="comment">// 输出 str1</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;str1: %s\n&quot;</span>, str1);</span><br><span class="line">    <span class="comment">// 输出 str2 中的每个字符串</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;str2[0]: %s\n&quot;</span>, str2[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;str2[1]: %s\n&quot;</span>, str2[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;str2[2]: %s\n&quot;</span>, str2[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>在这个例子中，<code>str1</code> 是一个包含 “Hello, World!” 字符串的字符数组，而 <code>str2</code> 是一个包含三个字符串指针的数组。</li></ul></li></ol><h3 id="C-风格字符串"><a href="#C-风格字符串" class="headerlink" title="C++风格字符串"></a>C++风格字符串</h3><p><strong>string 变量名 &#x3D; “字符串值”</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">string str = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>###########################完结撒花###########################</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://github.com/tumytime/picx-images-hosting/raw/master/eba59d911c3c8fd32afafd4c0d57d40.70a95u8niw.webp" class="lazyload placeholder" data-srcset="https://github.com/tumytime/picx-images-hosting/raw/master/eba59d911c3c8fd32afafd4c0d57d40.70a95u8niw.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="那嘛一挖---米子哈！！！"/></div><span class="image-caption">那嘛一挖---米子哈！！！</span></div>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C++学习】程序基础部分</title>
      <link href="/2024/08/09/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91Day1/"/>
      <url>/2024/08/09/%E3%80%90C-%E5%AD%A6%E4%B9%A0%E3%80%91Day1/</url>
      
        <content type="html"><![CDATA[<h2 id="基础框架"><a href="#基础框架" class="headerlink" title="基础框架"></a>基础框架</h2><p><strong>一个基础程序框架：</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Hello World&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>); <span class="comment">//pause:暂停</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="＜iostream＞"><a href="#＜iostream＞" class="headerlink" title="＜iostream＞"></a>＜iostream＞</h3><p><code>#include &lt;stdio.h&gt;</code> 和 <code>#include &lt;iostream&gt;</code> 是C和C++编程语言中用于包含标准输入输出库的头文件语句。该编译指令导致预处理器将iostream文件的内容添加到程序中。#include编译指令导致iostream文件的内容随源<br>代码文件的内容一起被发送给编译器。实际上，iostream文件的内容将<br>取代程序中的代码行#include <iostream>。原始文件没有被修改，而是<br>注意：<br>将源代码文件和iostream组合成一个复合文件，编译的下一阶段将使用<br>该文件。<br>下面是这两条语句之间的主要区别：</p><h5 id="1-语言差异"><a href="#1-语言差异" class="headerlink" title="1. 语言差异"></a>1. 语言差异</h5><ul><li><code>#include &lt;stdio.h&gt;</code> 是C语言的标准输入输出库头文件。<code>stdio.h</code> 是 “standard input-output header” 的缩写，它是C语言的一部分。</li><li><code>#include &lt;iostream&gt;</code> 是C++语言的标准输入输出库头文件。<code>iostream</code> 是 “input-output stream” 的缩写，它是C++语言的一部分。</li></ul><h5 id="2-库类型"><a href="#2-库类型" class="headerlink" title="2. 库类型"></a>2. 库类型</h5><ul><li><code>stdio.h</code> 提供的是C语言风格的输入输出函数，例如 <code>printf()</code>, <code>scanf()</code>, <code>fprintf()</code>, <code>fscanf()</code> 等。这些函数通常是非面向对象的，并且它们直接处理字符和字节流。</li><li><code>iostream</code> 提供的是C++语言风格的输入输出流类，例如 <code>std::cout</code>, <code>std::cin</code>, <code>std::cerr</code>, 以及 <code>std::ofstream</code>, <code>std::ifstream</code> 等。这些是面向对象的，提供了更多的功能，例如类型安全和重载操作符。</li></ul><h5 id="3-使用方式"><a href="#3-使用方式" class="headerlink" title="3. 使用方式"></a>3. 使用方式</h5><ul><li>使用 <code>stdio.h</code> 时，程序员通常需要指定格式化字符串，并且要注意类型匹配，以避免格式化错误或缓冲区溢出。</li><li>使用 <code>iostream</code> 时，类型信息是自动处理的，因为流操作符（如 <code>&lt;&lt;</code> 和 <code>&gt;&gt;</code>）被重载以支持不同的数据类型。</li></ul><h5 id="4-性能"><a href="#4-性能" class="headerlink" title="4. 性能"></a>4. 性能</h5><ul><li><code>stdio.h</code> 中的函数通常比C++的iostream库更快，因为iostream库进行了更多的封装和类型检查。然而，现代编译器已经优化了iostream库，使得性能差距不像过去那样显著。</li></ul><h5 id="5-头文件扩展名"><a href="#5-头文件扩展名" class="headerlink" title="5. 头文件扩展名"></a>5. 头文件扩展名</h5><ul><li>注意到 <code>stdio.h</code> 有一个 <code>.h</code> 扩展名，而 <code>iostream</code> 没有。在C++中，标准库的头文件通常不带 <code>.h</code> 扩展名。这是为了区分C和C++的标准库头文件。</li></ul><h5 id="6-命名空间"><a href="#6-命名空间" class="headerlink" title="6. 命名空间"></a>6. 命名空间</h5><ul><li><code>iostream</code> 中的对象和函数都是在 <code>std</code> 命名空间中的，所以通常需要使用 <code>std::</code> 前缀来访问它们，除非你使用了 <code>using namespace std;</code> 语句。</li><li><code>stdio.h</code> 中的函数通常不需要命名空间前缀。</li></ul><h5 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h5><p>以下是如何使用这两个头文件的简单例子：<br><strong>使用 <code>stdio.h</code>:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello, World!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>使用 <code>iostream</code>:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Hello, World!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>总结来说，<code>#include &lt;stdio.h&gt;</code> 和 <code>#include &lt;iostream&gt;</code> 分别用于C和C++中处理输入输出，它们代表了两种不同的编程范式和风格。在实际使用中，应根据编程语言和项目需求选择合适的头文件。</p><h3 id="using-namespace"><a href="#using-namespace" class="headerlink" title="using namespace"></a>using namespace</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br></pre></td></tr></table></figure><p>这个using编译指令使得std名称空间中的所有名称都可用。这是一种偷懒的做法，在大型项目中一个潜在的问题。更好的方法是，只使所需的名称可用，这可以通过使用using声明来实现：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="keyword">using</span> std::endl;</span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br></pre></td></tr></table></figure><h3 id="使用cout进行C-输出"><a href="#使用cout进行C-输出" class="headerlink" title="使用cout进行C++输出"></a>使用cout进行C++输出</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; <span class="string">&quot;Hello World&quot;</span> &lt;&lt; endl;</span><br></pre></td></tr></table></figure><ul><li>在C++中，用双引号括起的一系列字符叫做字符串，因为它是由若干字符组合而成的。</li><li>&lt;&lt;符号表示该语句将把这个字符串发送给cout；该符号指出了信息流动的路径。</li><li>cout是一个预定义的对象，知道如何显示字符串、数字和单个字符等<br>从概念上看，输出是一个流，即从程序流出的一系列字符。cout对象表示这种流，其属性是在iostream文件中定义的。cout的对象属性包括一个插入运算符（&lt;&lt;），它可以将其右侧的信息插入到流中。<br>因此，与其说程序显示了一条消息，不如说它将一个字符串插入到了输出流中。</li></ul><details open><summary pointer> 初识运算符重载 </summary>              <div class='content'>              <p>如果熟悉C后才开始学习C++，则可能注意到了，插入运算符（&lt;&lt;）看上去就像按位左移运算符（&lt;&lt;），这是一个运算符重载的例子，通过重载，同一个运算符将有不同的含义。编译器通过上下文来确定运算符的含义。C本身也有一些运算符重载的情况。例如，&amp;符号既表示地址运算符，又表示按位AND运算符；* 既表示乘法，又表示对指针解除引用。这里重要的不是这些运算符的具体功能，而是同一个符号可以有多种含义，而编译器可以根据上下文来确定其含义（这和确定“sound card”中的“sound”与“sound financial basic”中的“sound”的含义是一样的）。C++扩展了运算符重载的概念，允许为用户定义的类型（类）重新定义运算符的含义。</p>              </div>            </details><p>确实，C++中的 <code>std::cout</code> 可以用来输出不同类型的数据，包括整数和字符串。虽然从用户的角度来看，输出数字和字符串似乎没有太大区别，但在幕后，这两者处理方式是不同的。以下是详细解释：</p><ol><li>字符串<ul><li>字符串是由一系列字符组成的序列。在C++中，字符串通常表示为 <code>std::string</code> 类型或者以空字符 <code>\0</code> 结尾的字符数组 <code>char[]</code>。</li><li>当 <code>std::cout</code> 输出字符串时，它会从内存中读取每个字符的编码（通常是ASCII或UTF-8编码），并将其逐个发送到输出设备。</li><li>例如，字符串 <code>&quot;25&quot;</code> 在内存中存储为两个字符：字符 <code>&#39;2&#39;</code> 和字符 <code>&#39;5&#39;</code>，以及一个结束标记 <code>\0</code>。</li></ul></li><li>整数<ul><li>整数在计算机内部以二进制形式存储。例如，整数 <code>25</code> 在内存中以二进制形式表示，可能看起来像 <code>00011001</code>（这取决于具体的系统架构和整数的大小）。</li><li>当 <code>std::cout</code> 输出整数时，它不能直接将二进制数发送到输出设备，因为输出设备期望接收字符编码，而不是二进制数值。</li><li>因此，<code>std::cout</code> 必须将整数转换为字符串形式。这个过程称为数值到字符串的转换，涉及以下步骤：</li></ul><ol><li>计算整数的每一位数字。</li><li>将这些数字转换为对应的字符。</li><li>将这些字符按正确的顺序组合成字符串。</li><li>输出字符串。</li></ol></li><li>自动类型转换<ul><li>在C++中，<code>std::cout</code> 使用操作符重载来处理不同类型的数据。当 <code>std::cout</code> 遇到一个整数时，它会调用一个专门的重载版本的操作符 <code>&lt;&lt;</code>，这个版本知道如何将整数转换为字符串。</li><li>这个转换过程是自动进行的，所以程序员不需要编写额外的代码来将整数转换为字符串。这是C++的面向对象特性之一，允许操作符根据操作数的类型进行不同的操作。</li></ul></li></ol><h3 id="endl"><a href="#endl" class="headerlink" title="endl"></a>endl</h3><p><code>endl</code> 是一个操纵符（manipulator），它在iostream库中被定义为输出一个换行符（通常是 <code>\n</code>），并紧接着刷新输出缓冲区。刷新输出缓冲区意味着缓冲区中的所有数据都会被发送到输出设备（通常是屏幕），确保了这些数据在程序继续执行之前被立即显示。<br><code>\n</code> 是一个转义字符，用于在字符串中插入一个换行符。当使用 <code>\n</code> 时，iostream库会将一个换行符写入输出缓冲区，但不会立即刷新缓冲区。这意味着输出可能暂时留在缓冲区中，直到缓冲区满了或者程序结束，这时缓冲区才会被刷新。</p><h3 id="system-“pause”"><a href="#system-“pause”" class="headerlink" title="system(“pause”);"></a>system(“pause”);</h3><ul><li><p>不加：</p>  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.45lkjet59.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.45lkjet59.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li><li><p>加上：</p>  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8dws8r9vq0.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8dws8r9vq0.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li></ul><p><code>system(&quot;pause&quot;);</code> 是一个在C或C++程序中常用的语句，它用于暂停程序的执行，直到用户按下任意键。这个语句调用了操作系统的命令行界面来执行 <code>pause</code> 命令。<br>下面是对 <code>system(&quot;pause&quot;);</code> 语句的详细解释：</p><h5 id="1-作用"><a href="#1-作用" class="headerlink" title="1. 作用"></a>1. 作用</h5><ul><li><code>system(&quot;pause&quot;);</code> 的主要作用是在程序执行完毕后暂停程序，尤其是在命令行界面（CLI）中运行程序时。这样可以让用户有机会查看程序的输出结果，而不是立即关闭命令行窗口。</li></ul><h5 id="2-工作原理"><a href="#2-工作原理" class="headerlink" title="2. 工作原理"></a>2. 工作原理</h5><ul><li><code>system</code> 是C和C++标准库中的一个函数，它位于 <code>&lt;cstdlib&gt;</code> 或 <code>&lt;stdlib.h&gt;</code> 头文件中。</li><li>当调用 <code>system</code> 函数时，它会创建一个新的进程来执行其参数指定的命令。在 <code>system(&quot;pause&quot;);</code> 中，参数是字符串 <code>&quot;pause&quot;</code>。</li><li>在Windows操作系统中，<code>pause</code> 命令会暂停命令行进程，并显示消息 <code>&quot;Press any key to continue . . .&quot;</code>。用户必须按下任意键才能继续执行程序或关闭命令行窗口。</li></ul><h5 id="3-跨平台问题"><a href="#3-跨平台问题" class="headerlink" title="3. 跨平台问题"></a>3. 跨平台问题</h5><ul><li><code>system(&quot;pause&quot;);</code> 主要用于Windows操作系统。在Unix-like系统（如Linux或macOS）中，<code>pause</code> 命令通常不存在，因此这条语句在这些系统中不会按预期工作。</li><li>为了实现跨平台兼容性，通常建议使用其他方法来暂停程序，例如在Unix-like系统中使用 <code>getchar();</code> 来实现类似的效果。</li></ul><h5 id="4-安全性和性能"><a href="#4-安全性和性能" class="headerlink" title="4. 安全性和性能"></a>4. 安全性和性能</h5><ul><li>使用 <code>system</code> 函数通常不被认为是安全的，因为它会执行传递给它的任何命令，这可能导致安全漏洞，尤其是当命令包含用户输入时。</li><li>调用 <code>system</code> 函数创建新进程可能会影响程序的性能，因为它涉及到操作系统的进程管理。</li></ul><h5 id="5-替代方案"><a href="#5-替代方案" class="headerlink" title="5. 替代方案"></a>5. 替代方案</h5><ul><li>如果你只是想等待用户按键，而不是关闭命令行窗口，可以使用以下代码作为替代方案，它具有更好的跨平台兼容性：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Press any key to continue . . .&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    std::cin.<span class="built_in">get</span>();  <span class="comment">// 等待用户按键</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>或者，在Unix-like系统中：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Press any key to continue . . .\n&quot;</span>);</span><br><span class="line">    <span class="built_in">getchar</span>();  <span class="comment">// 等待用户按键</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>这些替代方案不需要调用 <code>system</code> 函数，因此它们更安全且更适合跨平台使用。</li></ul><h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p><strong>给一段指定的内存空间起名，方便操作这段内存</strong>（一下子就清楚了）<br>使用声明语句来指出存储类型并提供位置标签。<br><strong>变量存在的意义就是方便我们管理内存空间</strong></p><h2 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h2><p><strong>用于记录程序中不可更改的数据</strong><br><strong>定义常量的两种方式：</strong></p><ol><li>#define 宏常量： <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> day 7</span></span><br></pre></td></tr></table></figure></li><li>const修饰的变量：<br> 在变量定义前加const</li></ol><p><strong>Q:#define day 7这样子day代表的7是什么数据类型</strong><br>在C或C++语言中，使用 <code>#define</code> 预处理器指令来定义宏。宏定义 <code>#define day 7</code> 不会指定数据类型，它仅仅是一个文本替换。当编译器看到 <code>day</code> 时，它会在编译前将其替换为 <code>7</code>。<br>由于宏只是简单的文本替换，<code>day</code> 代表的 <code>7</code> 在编译后的代码中并没有特定的数据类型。它的数据类型取决于它被使用的上下文。例如：</p><ul><li>如果 <code>day</code> 被用在需要整数的地方，它将被当作整数处理。</li><li>如果 <code>day</code> 被用在需要浮点数的地方，它可能会被隐式转换成浮点数。<br>下面是一些使用 <code>day</code> 的例子，以及它如何根据上下文被解释：<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> day 7</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> days = day;    <span class="comment">// day 被当作整数</span></span><br><span class="line">    <span class="type">float</span> days_float = day;  <span class="comment">// day 被隐式转换成浮点数</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Integer: %d\n&quot;</span>, days);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Float: %f\n&quot;</span>, days_float);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>在这个例子中，<code>day</code> 被用作整数 <code>int</code> 类型的值，也被用作 <code>float</code> 类型的值。在编译时，预处理器将 <code>day</code> 替换为 <code>7</code>，然后编译器根据变量声明决定 <code>7</code> 的数据类型。在第一个例子中，<code>7</code> 是 <code>int</code> 类型的，而在第二个例子中，<code>7</code> 被隐式转换为 <code>float</code> 类型。</li></ul><h2 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h2><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2vensn8i5n.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2vensn8i5n.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h2 id="赋值语句"><a href="#赋值语句" class="headerlink" title="赋值语句"></a>赋值语句</h2><p>C++（和C）有一项不寻常的特性—可以连续使用赋值运算符。例如，下面的代码是合法的：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=b=c=<span class="number">2</span>;</span><br></pre></td></tr></table></figure><p><strong>赋值将从右向左进行。</strong><br>首先，2被赋给c，然后c的值（2）被赋给b，然后b的值被赋给a；</p><h2 id="使用cin"><a href="#使用cin" class="headerlink" title="使用cin"></a>使用cin</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cin &gt;&gt; carrots;</span><br></pre></td></tr></table></figure><p>从这条语句可知，信息从cin流向carrots。显然，对这一过程有更为正式的描述。就像C++将输出看作是流出程序的字符流一样，它也将输入看作是流入程序的字符流。iostream文件将cin定义为一个表示这种流的对象。输出时，&lt;&lt;运算符将字符串插入到输出流中；输入时，cin使用&gt;&gt;运算符从输入流中抽取字符。通常，需要在运算符右侧提供一个变量，以接收抽取的信息（符号&lt;&lt;和&gt;&gt;被选择用来指示信息流的方向）。</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【第一个项目】Cybery第一天（24.7.24）</title>
      <link href="/2024/07/24/%E3%80%90%E7%AC%AC%E4%B8%80%E4%B8%AA%E9%A1%B9%E7%9B%AE%E3%80%91Cybery%E7%AC%AC%E4%B8%80%E5%A4%A9%EF%BC%8824-7-24%EF%BC%89/"/>
      <url>/2024/07/24/%E3%80%90%E7%AC%AC%E4%B8%80%E4%B8%AA%E9%A1%B9%E7%9B%AE%E3%80%91Cybery%E7%AC%AC%E4%B8%80%E5%A4%A9%EF%BC%8824-7-24%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<div class="note info"><p>很早就跟<a href="https://snowmiku-home.top/">小葱酱</a>说好了要一起做一个项目，我还是负责视觉和ai，今天就打算把我的部分按我的想法开始做咯~ 现在初步设想我这边是以树莓派为中心，主要程序展现在树莓派的一个显示屏上，显示屏上的程序包含live2d和一些功能卡片(可触摸)，外接摄像头能传感器完成与用户的交互和物体识别。暂时把这个项目叫做Cybery咯</p></div><h2 id="step1-学习live2d操作"><a href="#step1-学习live2d操作" class="headerlink" title="step1-学习live2d操作"></a>step1-学习live2d操作</h2><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/pitao.1hs419iagd.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/pitao.1hs419iagd.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>我是有一个皮套的（是公皮，不知道有没有同学能找到我的套皮小号哈哈哈哈哈），可以用vts面捕，但是要做东西的话，还是得看一下怎么直接控制比较好</p><p>用下面这个教程比较好:</p><div class="tagLink"><a class="link-card" title="基于Qt的Live2D模型显示以及控制" href="https://blog.csdn.net/y123456wydhckd/article/details/134899183?ops_request_misc=&request_id=&biz_id=102&utm_term=live2d&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-7-134899183.142^v100^pc_search_result_base9&spm=1018.2226.3001.4187"><span class="link-card-backdrop" style="background-image: url(https://img-blog.csdnimg.cn/direct/3f5a82e8d0d44219960008e4142ad4af.png#pic_center)"></span><div class="left"><img src="https://img-blog.csdnimg.cn/direct/3f5a82e8d0d44219960008e4142ad4af.png#pic_center" class="lazyload placeholder" data-srcset="https://img-blog.csdnimg.cn/direct/3f5a82e8d0d44219960008e4142ad4af.png#pic_center" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">基于Qt的Live2D模型显示以及控制</p><p class="url">https://blog.csdn.net/y123456wydhckd/article/details/134899183?ops_request_misc=&request_id=&biz_id=102&utm_term=live2d&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-7-134899183.142^v100^pc_search_result_base9&spm=1018.2226.3001.4187</p></div></a></div><h3 id="Cubism-SDK-for-Native下载"><a href="#Cubism-SDK-for-Native下载" class="headerlink" title="Cubism SDK for Native下载"></a>Cubism SDK for Native下载</h3><p>官网下载基本下不了(反正我这里是这样)，可以在GitHub上下载</p><div class="tagLink"><a class="link-card" title="CubismSdkForNative-5-r.1" href="https://github.com/andforce/CubismSdkForNative-5-r.1"><span class="link-card-backdrop" style="background-image: url(https://github.com/andforce/CubismSdkForNative-5-r.1/blob/main/logos.png)"></span><div class="left"><img src="https://github.com/andforce/CubismSdkForNative-5-r.1/blob/main/logos.png" class="lazyload placeholder" data-srcset="https://github.com/andforce/CubismSdkForNative-5-r.1/blob/main/logos.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">CubismSdkForNative-5-r.1</p><p class="url">https://github.com/andforce/CubismSdkForNative-5-r.1</p></div></a></div><p>然后根据上面的教程运行一个demo</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4n7m08w4ed.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4n7m08w4ed.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>]]></content>
      
      
      <categories>
          
          <category> 树莓派 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
            <tag> 树莓派 </tag>
            
            <tag> Linux </tag>
            
            <tag> live2d </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>电赛笔记一【配置树莓派opencv&amp;&amp;c++环境】</title>
      <link href="/2024/07/21/%E7%94%B5%E8%B5%9B%E7%AC%94%E8%AE%B0%E4%B8%80/"/>
      <url>/2024/07/21/%E7%94%B5%E8%B5%9B%E7%AC%94%E8%AE%B0%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<div class="note info"><p>树莓派型号：pi5，8G</p></div><h2 id="配置树莓派opencv和c-环境"><a href="#配置树莓派opencv和c-环境" class="headerlink" title="配置树莓派opencv和c++环境"></a>配置树莓派opencv和c++环境</h2><p><strong>这个亲测有效！！</strong></p><div class="tagLink"><a class="link-card" title="Ubuntu 20.04搭建OpenCV 4.5.0 & C++环境" href="https://blog.csdn.net/weixin_44796670/article/details/115900538"><span class="link-card-backdrop" style="background-image: url(https://tumytime.github.io/picx-images-hosting/hamburger.969mywtn31.png)"></span><div class="left"><img src="https://tumytime.github.io/picx-images-hosting/hamburger.969mywtn31.png" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/hamburger.969mywtn31.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">Ubuntu 20.04搭建OpenCV 4.5.0 & C++环境</p><p class="url">https://blog.csdn.net/weixin_44796670/article/details/115900538</p></div></a></div>]]></content>
      
      
      <categories>
          
          <category> 树莓派 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
            <tag> 树莓派 </tag>
            
            <tag> 电赛 </tag>
            
            <tag> opencv </tag>
            
            <tag> 机器视觉 </tag>
            
            <tag> cmake </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>videocapture的bug</title>
      <link href="/2024/06/16/videocapture%E7%9A%84bug/"/>
      <url>/2024/06/16/videocapture%E7%9A%84bug/</url>
      
        <content type="html"><![CDATA[<pre><code>&lt;html lang=&quot;zh-CN&quot;&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;/&gt;  &lt;body class=&quot;nodata &quot; style=&quot;&quot;&gt;         &lt;main style=&quot;width:100%&quot;&gt;      &lt;div class=&quot;blog-content-box&quot;&gt;         &lt;div class=&quot;article-title-box&quot;&gt;            &lt;h1 class=&quot;title-article&quot; id=&quot;articleContentId&quot;&gt;opencv读取摄像头不是实时的处理方法&lt;/h1&gt;        &lt;/div&gt;&lt;div id=&quot;article_content&quot; class=&quot;article_content clearfix&quot;&gt;    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/kdoc_html_views-1a98987dfd.css&quot;&gt;    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/ck_htmledit_views-044f2cf1dc.css&quot;&gt;                     &lt;div id=&quot;content_views&quot; class=&quot;markdown_views prism-atom-one-dark&quot;&gt;                &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;display: none;&quot;&gt;                    &lt;path stroke-linecap=&quot;round&quot; d=&quot;M5,0 0,2.5 5,5z&quot; id=&quot;raphael-marker-block&quot; style=&quot;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);&quot;&gt;&lt;/path&gt;                &lt;/svg&gt;                &lt;pre data-index=&quot;0&quot; class=&quot;set-code-show prettyprint&quot;&gt;&lt;code class=&quot;prism language-python has-numbering&quot; onclick=&quot;mdcp.copyCode(event)&quot; style=&quot;position: unset;&quot;&gt;cap &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; cv2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;VideoCapture&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;</code></pre><p>cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></p><div class="hljs-button {2}" data-title="复制"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li></ul></pre> <h2><a name="t0"></a><a id="___5"></a>读取的不是实时的画面 ，存在延迟 怎么处理</h2> <blockquote>  <p>如果你使用的是<a href="https://so.csdn.net/so/search?q=OpenCV%E5%BA%93&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=OpenCV%E5%BA%93&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;OpenCV库\&quot;}&quot;}" data-tit="OpenCV库" data-pretit="opencv库">OpenCV库</a>，你可以通过将缓冲区大小设置为更小的值来减小延迟。默认情况下，缓冲区大小是16，但可以通过在cv2.VideoCapture()中传递参数来更改。例如：</p> </blockquote> <pre data-index="1" class="set-code-show prettyprint"><code class="prism language-python has-numbering" onclick="mdcp.copyCode(event)" style="position: unset;">cap <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>cap<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_BUFFERSIZE<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><div class="hljs-button &#123;2&#125;" data-title="复制"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li></ul></pre> <blockquote>  <p>这将把缓冲区大小减小到1，从而减小延迟。但是，如果你将缓冲区大小设置得太小，你可能会遇到画面卡顿或丢帧的问题。</p> </blockquote> <p>另一种方式是使用多线程或异步处理来实现更快的画面更新。你可以在一个线程中读取摄像头的帧，并将它们传递到另一个线程或进程中进行处理和显示。这将使你能够更快地处理帧并减少延迟。但是，这需要更多的编程和计算资源，并可能会增加代码的复杂性。</p> <h2><a name="t1"></a><a id="OpenCV_19"></a>下面是一个基本的多线程处理OpenCV视频帧的例子：</h2> <pre data-index="2" class="prettyprint set-code-show"><code class="prism language-python has-numbering" onclick="mdcp.copyCode(event)" style="position: unset;"><span class="token keyword">import</span> cv2<span class="token keyword">import</span> threading<span class="token keyword">class</span> <span class="token class-name">VideoCapture</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> src<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>cap <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span>src<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>cap<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_BUFFERSIZE<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>grabbed<span class="token punctuation">,</span> self<span class="token punctuation">.</span>frame <span class="token operator">=</span> self<span class="token punctuation">.</span>cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>started <span class="token operator">=</span> <span class="token boolean">False</span>        self<span class="token punctuation">.</span>read_lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span><pre><code>&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;started&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;VideoCapture already started&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;started &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;thread &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; threading&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Thread&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;target&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;update&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; args&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;thread&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;start&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;started&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;        grabbed&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; frame &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;        &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read_lock&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;grabbed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; grabbed            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;frame &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; frame&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read_lock&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;        grabbed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;grabbed        frame &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;frame    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; grabbed&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; frame&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;started &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;thread&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__exit__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_type&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_value&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; traceback&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;release&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;</code></pre><p><span class="token keyword">if</span> <strong>name</strong> <span class="token operator">&#x3D;&#x3D;</span> <span class="token string">‘<strong>main</strong>‘</span><span class="token punctuation">:</span><br>    cap <span class="token operator">&#x3D;</span> VideoCapture<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span><br>        grabbed<span class="token punctuation">,</span> frame <span class="token operator">&#x3D;</span> cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token keyword">if</span> <span class="token keyword">not</span> grabbed<span class="token punctuation">:</span><br>            <span class="token keyword">break</span><br>        cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">‘frame’</span><span class="token punctuation">,</span> frame<span class="token punctuation">)</span><br>        <span class="token keyword">if</span> cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span> <span class="token operator">&#x3D;&#x3D;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">‘q’</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>            <span class="token keyword">break</span><br>    cap<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span><br>    cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span></p><div class="hljs-button {2}" data-title="复制"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li><li style="color: rgb(153, 153, 153);">36</li><li style="color: rgb(153, 153, 153);">37</li><li style="color: rgb(153, 153, 153);">38</li><li style="color: rgb(153, 153, 153);">39</li><li style="color: rgb(153, 153, 153);">40</li><li style="color: rgb(153, 153, 153);">41</li><li style="color: rgb(153, 153, 153);">42</li><li style="color: rgb(153, 153, 153);">43</li><li style="color: rgb(153, 153, 153);">44</li><li style="color: rgb(153, 153, 153);">45</li><li style="color: rgb(153, 153, 153);">46</li><li style="color: rgb(153, 153, 153);">47</li><li style="color: rgb(153, 153, 153);">48</li><li style="color: rgb(153, 153, 153);">49</li><li style="color: rgb(153, 153, 153);">50</li></ul></pre> <blockquote>  <p>这个例子使用了一个<a href="https://so.csdn.net/so/search?q=VideoCapture&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=VideoCapture&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;VideoCapture\&quot;}&quot;}" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=VideoCapture&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;VideoCapture\&quot;}&quot;}" data-tit="VideoCapture" data-pretit="videocapture">VideoCapture</a>类，该类在一个线程中不断读取摄像头帧，并将它们保存在一个共享的grabbed和frame变量中。在主程序中，我们通过调用start()方法来启动线程，然后不断读取帧并在窗口中显示它们，直到用户按下’q’键退出。最后，我们调用stop()方法来停止线程并释放资源。</p> </blockquote> <p>需要注意的是，这个例子仅仅是一个基本的框架，你可能需要对其进行修改和扩展以适应你的具体应用场景。例如，你可以添加一个另一个线程来处理帧，然后显示处理后的结果，以此来减少延迟。</p>                </div><div data-report-view="{&quot;mod&quot;:&quot;1585297308_001&quot;,&quot;spm&quot;:&quot;1001.2101.3001.6548&quot;,&quot;dest&quot;:&quot;https://blog.csdn.net/qq_26696715/article/details/129686980&quot;,&quot;extend1&quot;:&quot;pc&quot;,&quot;ab&quot;:&quot;new&quot;}"><div></div></div>                <link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-f23dff6052.css" rel="stylesheet">                <link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-c216769e99.css" rel="stylesheet">        </div>            </div>             <pre><code>          &lt;/main&gt;        &lt;/body&gt;   &lt;/html&gt;        </code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>C++多线程</title>
      <link href="/2024/06/03/C-%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
      <url>/2024/06/03/C-%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<div class="note info"><p>上次更新blog还是生日4.29，这一个月真是忙鼠了，现在有了一个新任务-多线程，搞一下(不加多线程的话我的车车会变成蜗牛🐌的。。。。)</p></div><h2 id="简单示例"><a href="#简单示例" class="headerlink" title="简单示例"></a>简单示例</h2><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>当我们谈论多线程时，可以想象成一个人同时在做多个事情，就像一个人既可以同时吃饭又可以同时写作业一样。在C++中，使用多线程可以让我们的程序同时执行多个任务，提高程序的效率和性能。</p><p>首先，让我们用一个简单的例子来理解多线程。假设你有一个厨房，里面有一个厨师在煮面条，一个厨师在炒菜，还有一个服务员在端菜。这就相当于一个有多个线程的程序，每个线程负责不同的任务。</p><p>在C++中，我们可以使用 <code>&lt;thread&gt;</code> 头文件来创建和管理线程。首先，我们需要定义一个函数，在这个函数中包含我们希望线程执行的任务。然后，我们使用 <code>std::thread</code> 类来创建线程并指定要执行的函数。</p><p>让我们来看一个示例代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个函数，作为线程的入口</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Hello from thread!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 创建一个新线程，并指定要执行的函数</span></span><br><span class="line">    <span class="function">std::thread <span class="title">t1</span><span class="params">(printMessage)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 主线程继续执行自己的任务</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Hello from main thread!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 等待线程 t1 执行完毕</span></span><br><span class="line">    t1.<span class="built_in">join</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这个示例中，我们定义了一个简单的函数 <code>printMessage</code>，并在主函数中创建了一个新线程 <code>t1</code>，让它执行这个函数。同时，主函数也会继续执行，输出 “Hello from main thread!”。最后我们使用 <code>join()</code> 函数等待线程 <code>t1</code> 的执行完成。</p><p>这样，就实现了一个简单的多线程程序。通过合理地使用多线程，我们可以更高效地利用计算机的资源，加快程序的运行速度。当然，在实际编程中，还需要考虑线程之间的同步、互斥访问等问题，以保证程序的正确性和稳定性。</p><h3 id="std-thread-t1-printMessage-代表着线程开始执行吗"><a href="#std-thread-t1-printMessage-代表着线程开始执行吗" class="headerlink" title="std::thread t1(printMessage);代表着线程开始执行吗"></a>std::thread t1(printMessage);代表着线程开始执行吗</h3><p>是的，当你创建一个 <code>std::thread</code> 对象并传入要执行的函数，线程就会开始执行这个函数。在你的例子中，<code>std::thread t1(printMessage);</code>这一行代码就代表着线程开始执行 <code>printMessage</code> 函数。这意味着在运行时，会产生一个新的线程来执行 <code>printMessage</code> 函数中的代码，同时主线程会继续执行后面的代码。</p><p>但需要注意的是，线程的启动并不是立即执行 <code>printMessage</code> 函数中的代码，而是在<code>std::thread</code> 对象被创建之后才会执行。如果立即调用 <code>join()</code> 函数，主线程会等待新线程执行完毕再继续往下执行。这种方式保证了线程的同步执行。</p><p>因此，在上面提供的示例代码中，<code>std::thread t1(printMessage);</code>这一行代码会使得新线程开始执行 <code>printMessage</code> 函数，而主线程会继续执行紧随其后的代码，直到遇到 <code>t1.join();</code>。</p><p>在C++中，如果我们使用std::thread来创建线程，线程的启动确实不会立即执行线程函数中的代码。当我们创建一个std::thread对象，指定要执行的线程函数，并调用该std::thread对象的构造函数时，线程对象就会被创建，但线程函数的代码并不会立即执行。实际上线程的实际执行时机取决于操作系统的调度器，在合适的时机会开始执行线程函数。</p><p>如果在主线程中立即调用新线程的join()函数，主线程将会被阻塞，直到新线程的执行完成。这种方式确保了线程的同步执行，即主线程会等待新线程执行完毕后才会继续往下执行。在这种情况下，主线程和新线程是同步执行的，主线程起到了等待和协调的作用。</p><p>总结：通过调用join()函数实现线程同步执行的流程是这样的，先创建新的线程对象，然后调用join()函数使得主线程等待新线程的执行完成，待新线程执行完毕后，主线程才继续往下执行。这种方式保证了线程的同步执行，特别适用于需要新线程执行完毕后才能继续主线程操作的场景。</p><h2 id="进阶实例-互斥锁"><a href="#进阶实例-互斥锁" class="headerlink" title="进阶实例(互斥锁)"></a>进阶实例(互斥锁)</h2><p>让我们来看一个稍微复杂一点的多线程例子，考虑一个生产者-消费者模型。在这个例子中，有一个生产者线程负责生产数据，然后将数据发送给一个缓冲区，同时一个消费者线程从缓冲区中取出数据进行消费。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;condition_variable&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::queue&lt;<span class="type">int</span>&gt; buffer;</span><br><span class="line">std::mutex mtx;</span><br><span class="line">std::condition_variable cv;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">producer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">        std::this_thread::<span class="built_in">sleep_for</span>(std::chrono::<span class="built_in">milliseconds</span>(<span class="number">500</span>)); <span class="comment">// 模拟生产数据的耗时操作</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>;</span><br><span class="line">            buffer.<span class="built_in">push</span>(i);</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;Produced: &quot;</span> &lt;&lt; i &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line">        cv.<span class="built_in">notify_one</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">consumer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">        <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>;</span><br><span class="line">        cv.<span class="built_in">wait</span>(lock, []&#123; <span class="keyword">return</span> !buffer.<span class="built_in">empty</span>(); &#125;);</span><br><span class="line">        <span class="type">int</span> data = buffer.<span class="built_in">front</span>();</span><br><span class="line">        buffer.<span class="built_in">pop</span>();</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Consumed: &quot;</span> &lt;&lt; data &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::thread <span class="title">producerThread</span><span class="params">(producer)</span></span>;</span><br><span class="line">    <span class="function">std::thread <span class="title">consumerThread</span><span class="params">(consumer)</span></span>;</span><br><span class="line"></span><br><span class="line">    producerThread.<span class="built_in">join</span>();</span><br><span class="line">    consumerThread.<span class="built_in">join</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这个例子中，我们使用了一个互斥锁（std::mutex）来保护共享的数据结构（队列buffer），生产者线程往队列中写入数据，消费者线程从队列中读取数据。通过条件变量（std::condition_variable）实现了生产者与消费者之间的同步。</p><p>生产者不断地在队列中插入数据，消费者则等待队列中有数据后进行消费。当队列中有数据时，消费者线程被唤醒，消费数据并输出，直至生产者生产完所有数据。整个过程利用互斥锁和条件变量实现了线程之间的同步操作，确保了数据的正确生产和消费。</p><ol><li><p><strong>前三行意思</strong></p><p> 这三行代码声明了一个整型队列 <code>buffer</code>，一个互斥锁 <code>mtx</code> 和一个条件变量 <code>cv</code>。 </p><ul><li><p><code>std::queue&lt;int&gt; buffer;</code>：这行代码定义了一个STL队列，其中存储整型数据。在生产者和消费者模型中，<code>buffer</code>用于存储生产者生成的数据，在生产者线程将数据写入队列，消费者线程从队列中取出数据进行消费。</p></li><li><p><code>std::mutex mtx;</code>：这行代码定义了一个互斥锁，用于在多线程环境中对共享数据结构进行访问控制。在此例中，<code>mtx</code> 用于保护队列 <code>buffer</code>，确保在任一时刻只有一个线程可以访问队列。</p></li><li><p><code>std::condition_variable cv;</code>：这行代码定义了一个条件变量，用于线程间的同步。在此例中，<code>cv</code> 用于通知消费者线程有新的数据可用于消费。消费者线程会通过 <code>wait()</code> 来等待生产者通知，一旦有数据可用，它会被 <code>notify_one()</code> 通知可以继续执行。</p></li></ul><p> 这些机制共同构成了一个生产者-消费者模型，确保在多线程环境下数据的安全访问和同步处理。</p></li><li><p><strong>为什么确保在任一时刻只有一个线程可以访问队列</strong><br> 在多线程环境中，如果不对共享数据结构（比如队列）进行保护，就可能导致数据竞争（Data Race）的问题。数据竞争指的是多个线程同时访问共享数据，其中至少一个线程对数据进行写操作，而其他线程进行读或写操作，从而导致未定义行为。对于队列这样的数据结构，如果没有互斥访问，会导致以下问题：</p><ul><li><p>不确定性：多个线程同时对队列进行操作，可能造成队列中数据的乱序或丢失，导致程序逻辑错误。</p></li><li><p>数据损坏：当一个线程正在修改队列中的数据时，另一个线程可能同时读取或修改这些数据，造成意外的数据损坏。</p></li><li><p>死锁：如果多个线程同时尝试对队列进行读写操作而没有恰当的同步机制，可能会出现死锁情况，使得程序无法继续执行。</p></li></ul><p> 因此，通过使用互斥锁（<code>mutex</code>）来保护队列，在任一时刻只允许一个线程访问队列，可以确保在多线程环境下数据的安全访问，避免数据竞争和可能导致的问题。</p></li><li><p><strong>什么是死锁</strong><br> 死锁（Deadlock）是指在并发系统中，两个或多个进程（线程）因争夺共享资源而进入一种互相等待的状态，导致它们都无法继续执行下去的情况。在死锁情况下，每个进程都在等待其他进程释放资源，而同时又不愿意主动释放自己当前已经占有的资源，从而形成了一种僵局。死锁是多线程编程中常见的并发问题，需要通过合理的设计和实现来避免和解决死锁问题。</p></li><li><p><strong>std::this_thread::sleep_for(std::chrono::milliseconds(500)); &#x2F;&#x2F; 模拟生产数据的耗时操作</strong></p><p> 这行代码是使用C++标准库提供的线程库<code>&lt;thread&gt;</code>中的<code>std::this_thread::sleep_for</code>函数，用来模拟在生产数据过程中的耗时操作。让我们来详细解释一下这行代码的作用：</p><ul><li><p><code>std::this_thread::sleep_for</code>：这是C++标准库中用于线程操作的静态成员函数，允许当前线程休眠一段时间。因为是<code>this_thread</code>所以是当前线程。</p></li><li><p><code>std::chrono::milliseconds(500)</code>：这里使用<code>std::chrono::milliseconds</code>来创建一个表示时间间隔的对象，参数为500，表示500毫秒（即0.5秒）的时间间隔。<code>std::chrono</code>是C++标准库提供的日期和时间库，用于处理时间相关的操作。</p></li><li><p><code>// 模拟生产数据的耗时操作</code>：这是一行注释，说明了这行代码的目的，即模拟在生产数据过程中的耗时操作。通常在生产数据或其他需要等待的操作中，为了模拟真实场景的延迟，会使用类似的休眠操作来延迟线程的执行。</p></li></ul><p> 因此，这行代码的作用是让当前线程休眠500毫秒，模拟生产数据过程中的耗时操作，以便更好地测试和理解程序的行为。</p></li><li><p><strong>std::lock_guard &lt; std::mutex &gt; lock(mtx);</strong></p><p> <code>std::lock_guard&lt;std::mutex&gt; lock(mtx);</code>是C++中使用RAII机制来管理互斥锁（<code>std::mutex</code>）的典型语法格式。这行代码的作用是创建一个<code>lock_guard</code>对象并用其构造函数锁住一个<code>std::mutex</code>对象<code>mtx</code>。</p><p> 具体解释如下：</p><ul><li><code>std::lock_guard</code>是一个模板类，用于管理锁对象（互斥锁）。它会在构造时锁住给定的互斥锁，在析构时解锁互斥锁，实现了RAII机制。</li><li><code>&lt;std::mutex&gt;</code>是模板参数，表示<code>std::lock_guard</code>将要管理的互斥锁的类型是<code>std::mutex</code>。</li><li><code>lock</code>是<code>std::lock_guard</code>对象的名称，可以根据需要命名。</li><li><code>(mtx)</code>表示用<code>mtx</code>（一个名为<code>mtx</code>的<code>std::mutex</code>对象）来初始化<code>lock_guard</code>对象，即在构造<code>lock_guard</code>对象时锁住<code>mtx</code>。</li></ul><p> <code>std::lock_guard</code>是C++标准库提供的一个RAII（资源获取即初始化）风格的互斥量封装类，通过它可以在一个作用域中保持互斥锁的持有状态。在这段代码中，<code>std::lock_guard&lt;std::mutex&gt; lock(mtx);</code>的作用是使用互斥量<code>mtx</code>对临界区进行加锁，确保对共享数据结构<code>buffer</code>的访问是线程安全的。让我们来详细解释其作用：</p><ul><li><p><strong>RAII机制</strong>：RAII（Resource Acquisition Is Initialization）是一种C++编程范式，它通过对象的生命周期来管理资源的获取和释放，确保资源在对象构造时被正确获取，而在对象析构时被自动释放。这种机制的核心思想是利用局部对象的生命周期控制资源的获取和释放，从而确保资源的正确管理，提高代码的可靠性和可维护性。</p><p>  下面是RAII机制的工作原理和优势：</p><ol><li><p><strong>资源获取即初始化</strong>：当一个对象被创建时，同时获取所需的资源，例如内存、文件句柄、互斥锁等，这样资源的获取和初始化是统一的操作。</p></li><li><p><strong>资源的自动释放</strong>：当对象离开其作用域时（比如函数返回、作用域结束等），其析构函数会被调用，负责释放已获取的资源，无论是正常执行还是异常发生，资源都会被正常释放。</p></li><li><p><strong>避免资源泄漏和确保资源管理</strong>：通过RAII机制，程序员无需手动管理资源的获取和释放，减少了因忘记释放资源而导致的内存泄漏或资源泄漏问题。</p></li><li><p><strong>异常安全性</strong>：RAII可确保在异常发生时，资源能够被正确释放，避免资源泄漏，同时保证程序的安全性。</p></li><li><p><strong>提高代码的可维护性和可读性</strong>：RAII使资源管理的逻辑更加清晰明了，代码更易于理解和维护，同时降低了在多线程环境下出现的死锁等问题。</p></li></ol><p>  在C++中，标准库中的智能指针（<code>std::unique_ptr</code>、<code>std::shared_ptr</code>等）和锁（<code>std::lock_guard</code>、<code>std::unique_lock</code>等）都是基于RAII机制设计的。通过合理利用RAII机制，可以有效管理资源，提高代码的健壮性和可靠性。</p></li><li><p><strong>加锁</strong>：当<code>std::lock_guard</code>对象<code>lock</code>被创建时，它会在构造函数中对互斥量<code>mtx</code>进行加锁操作，即锁住<code>mtx</code>。这样就确保了在<code>lock_guard</code>对象的作用域内（在这个括号内）对<code>buffer</code>的访问是受到保护的，其他线程无法同时修改<code>buffer</code>的内容，避免了数据竞争和不一致性。<code>在这个括号内</code>指的是<code>std::lock_guard</code>对象<code>lock</code>的作用域范围，即<code>lock</code>对象的生命周期。在C++中，作用域用花括号<code>&#123;&#125;</code>表示，也叫做代码块。当<code>std::lock_guard</code>对象<code>lock</code>的作用域范围结束（即超出了花括号的范围），该对象的析构函数会被调用，从而自动释放锁。这种方式确保了在<code>lock</code>对象的作用域内，互斥锁被保持，从而保护了共享资源（如<code>buffer</code>）的访问并避免了数据竞争和不一致性的问题。</p></li></ul><p> 因此，通过在花括号内创建<code>std::lock_guard</code>对象并锁住互斥量，可以确保只有一个线程能够访问或修改被保护的共享资源，从而提高多线程程序的安全性。</p><ul><li><strong>解锁</strong>：当<code>lock_guard</code>对象的作用域结束时，会调用其析构函数，在析构函数中会自动解锁互斥量<code>mtx</code>，即释放<code>mtx</code>的锁，使得其他线程可以访问共享资源。</li></ul><p> 通过使用<code>std::lock_guard</code>和互斥量，可以简化了对临界区的加锁和解锁过程，并且可以避免因为忘记解锁导致的死锁情况。这样的操作保证了对临界区资源的访问是互斥的，确保了多线程环境下的数据安全性。</p></li><li><p><strong>cv.notify_one();</strong><br> 在多线程编程中，<code>cv.notify_one()</code> 是用来通知等待在条件变量上的某个线程继续执行的函数。当某个线程调用 <code>cv.wait()</code> 方法并在条件变量上等待时，其他线程可以通过调用 <code>cv.notify_one()</code> 或 <code>cv.notify_all()</code> 来通知等待的线程可以继续执行。</p><p> 具体来说，<code>cv.notify_one()</code> 会唤醒在条件变量上等待的一个线程（如果有的话），让其可以从等待状态中醒来并继续执行。如果没有线程在条件变量上等待，那么调用 <code>cv.notify_one()</code> 也不会有任何效果。</p><p> 在多线程协作中，通常会结合条件变量和互斥量来实现线程之间的同步操作。当一个线程修改了共享数据，并希望通知其他线程有关此数据的改变时，可以使用条件变量来实现线程之间的同步通信。通常的流程是，先获得互斥锁，然后修改共享数据，再通知等待在条件变量上的线程，最后释放互斥锁。</p><p> 在这段示例代码中，生产者线程和消费者线程通过条件变量 <code>cv</code> 和互斥量 <code>mtx</code> 实现了线程之间的同步通信。生产者线程通过 <code>notify_one()</code> 方法通知消费者线程，告知其有新的数据可以被消费。具体来说，<code>cv.notify_one()</code> 的作用是：</p><ol><li>当生产者线程生产了一个数据后（通过 <code>buffer.push(i)</code>），它会立即通知等待在条件变量 <code>cv</code> 上的消费者线程。</li><li>在消费者线程中，当它通过 <code>cv.wait(lock, [] &#123; return !buffer.empty(); &#125;);</code> 进入等待状态时，会自动释放 <code>mtx</code> 互斥量并等待，直到生产者线程调用 <code>cv.notify_one()</code> 来唤醒它。</li><li>一旦消费者线程被唤醒，它会重新获取 <code>mtx</code> 互斥量并继续执行，从 <code>buffer</code> 中取出数据消费。</li><li>生产者线程每生产一个数据，就会唤醒一个等待的消费者线程。如果有多个消费者线程在等待，只有一个会被唤醒。</li></ol><p> 综上所述，<code>cv.notify_one()</code> 的作用是唤醒一个等待在条件变量上的线程，用来提示该线程可以继续执行，适用于协调多线程之间的操作顺序和数据传递。</p></li><li><p><strong>为什么一个用std::lock_guard一个用std::unique_lock</strong><br> 在上述代码中，<code>producer()</code> 函数使用了 <code>std::lock_guard</code> 来锁定互斥量，而 <code>consumer()</code> 函数则使用了 <code>std::unique_lock</code>。这种选择并非绝对，而是根据不同的需求和情境来决定使用哪种锁定方式。</p><ol><li><strong><code>std::lock_guard</code> 在 producer 函数中的使用：</strong></li></ol><ul><li>在 <code>producer()</code> 函数中，生产者生产数据到缓冲区，并在数据生产完成后立即释放互斥量。由于在生产者生产完数据后就会释放互斥量，因此使用 <code>std::lock_guard</code> 而不是 <code>std::unique_lock</code> 更加简洁和合适。<code>std::lock_guard</code> 自动锁定互斥量，并在作用域结束时自动释放互斥量，非常适合这种简单的锁定和释放情况。</li></ul><ol start="2"><li><strong><code>std::unique_lock</code> 在 consumer 函数中的使用：</strong></li></ol><ul><li>在 <code>consumer()</code> 函数中，消费者需要等待缓冲区中有数据可消费时才能继续执行。为了支持在等待期间手动解锁互斥量并等待条件变量，这里使用了 <code>std::unique_lock</code>。<code>std::unique_lock</code> 提供了更灵活的加锁和解锁操作，同时支持条件变量的等待。在等待缓冲区有数据可消费时，我们使用 <code>cv.wait(lock, [] &#123; return !buffer.empty(); &#125;);</code> 来等待条件变量满足。</li></ul><p> 综上所述，选择使用 <code>std::lock_guard</code> 或 <code>std::unique_lock</code> 取决于具体的应用场景和需求。在简单的自动锁定和释放互斥量情况下，可以使用 <code>std::lock_guard</code>；而在需要更多灵活性和条件变量支持的情况下，可以选择使用 <code>std::unique_lock</code>。在生产者消费者模型中，生产者和消费者可能有不同的需求，因此可以根据具体情况选择不同的锁定方式。</p></li><li><p><strong>cv.wait(lock, [] { return !buffer.empty(); });</strong></p><p> <code>cv.wait(lock, [] &#123; return !buffer.empty(); &#125;);</code> 这行代码是在<code>consumer()</code>函数中使用条件变量等待的部分。让我们详细解释这段代码的作用和具体执行流程：</p><ol><li><p><code>cv.wait(lock, condition)</code>：这是条件变量 <code>cv</code> 的等待函数调用。在这里，<code>lock</code> 是一个 <code>std::unique_lock&lt;std::mutex&gt;</code> 对象，通过将 <code>lock</code> 传递给 <code>cv.wait</code>，会在等待期间将互斥量解锁，以便其他线程可以在该互斥量上执行操作。<code>condition</code> 是一个 lambda 函数，用于指定等待条件。在这种情况下，<code>cv.wait</code>会在等待期间检查 lambda 函数返回的布尔值，只有在 lambda 函数返回 <code>true</code> 时才会继续执行。</p></li><li><p><code>[] &#123; return !buffer.empty(); &#125;</code>：这是一个 lambda 函数，它检查 <code>buffer</code> 是否为空。条件变量的 <code>wait</code> 操作依赖于用户提供的条件函数。在这里，条件函数检查 <code>buffer</code> 是否为空，如果为空，则条件为假， <code>cv.wait</code> 会一直等待，直到条件变为真。一旦条件为真，<code>cv.wait</code> 将继续执行，即互斥量被重新锁定，并且线程继续执行下去。</p></li><li><p>执行流程：</p><ul><li>当消费者线程开始执行 <code>consumer()</code> 函数时，首先会创建一个 <code>std::unique_lock&lt;std::mutex&gt;</code> 对象 <code>lock</code>，该对象在实例化时会锁定其关联的互斥量 <code>mtx</code>。</li><li>接着，消费者线程调用 <code>cv.wait(lock, condition)</code>，这会导致线程释放互斥量的锁并等待，直到<code>condition</code>返回 <code>true</code>。</li><li>在等待过程中，其他线程可以获得互斥量的锁并修改共享数据，但由于条件未满足，消费者线程会一直保持等待状态。</li><li>当生产者线程向 <code>buffer</code> 中加入数据并调用 <code>cv.notify_one()</code> 通知时，条件 <code>!buffer.empty()</code> 变为真，这会导致条件变量通知消费者线程继续执行。</li><li>消费者线程被唤醒后，会重新获得互斥量的锁，这时可以安全地从 <code>buffer</code> 中取出数据进行消费，然后继续执行后续的操作。</li></ul></li></ol><p> 总之，通过使用条件变量和 lambda 函数等待特定条件，可以实现线程间的同步和协调，确保消费者在有数据可消费时才执行消费操作，从而有效避免了竞态条件和数据不一致的问题。</p></li><li><p><strong>lambda 表达式</strong><br> 用于定义函数对象：</p><ol><li><p><code>[]</code>：lambda 表达式的开头以一对方括号开始。在这里，<code>[]</code> 表示 lambda 表达式不捕获任何外部变量。这意味着 lambda 表达式只能访问传递给它的参数，而不能访问外部作用域的变量。</p></li><li><p><code>&#123;&#125;</code>：lambda 表达式的主体使用一对大括号来定义，在大括号内部是 lambda 表达式的具体实现。</p></li></ol></li></ol><h2 id="互斥锁"><a href="#互斥锁" class="headerlink" title="互斥锁"></a>互斥锁</h2><p>在多线程编程中，为了避免多个线程同时访问共享资源而引起的竞争条件和数据不一致性问题，我们使用互斥锁（Mutex，全称Mutual Exclusion）。互斥锁是一种同步原语，它允许线程在进入临界区（对共享资源操作的临界区域）前先获取锁，执行完后再释放锁，从而确保在同一时刻只有一个线程能进入临界区进行操作。</p><p>详细解释互斥锁包括以下几点：</p><ol><li><p><strong>锁的状态</strong>: 互斥锁有两种状态，分别是锁定（locked）和解锁（unlocked）。线程在进入临界区之前需要先获取锁（即将锁定状态设定为locked），执行完后再释放锁（将状态设定为unlocked）。</p></li><li><p><strong>互斥性</strong>: 互斥锁的特性确保了同一时刻只有一个线程能够获取锁，其他线程需要等待当前持有锁的线程释放锁后才能继续执行。这样可以避免多个线程同时访问共享资源导致的数据竞争和不一致性问题。</p></li><li><p><strong>使用方法</strong>: 在多线程代码中使用互斥锁时，一般会使用<code>std::mutex</code>或类似的互斥锁类型。典型的用法是在临界区开始之前调用<code>lock()</code>方法获取锁，在临界区结束后调用<code>unlock()</code>方法释放锁。</p></li><li><p><strong>死锁</strong>: 如果在多线程代码中使用互斥锁不当，可能会导致死锁（Deadlock）的问题。死锁指的是多个线程相互等待对方释放资源而无法继续执行的情况，因此在使用互斥锁时要注意避免造成死锁。</p></li></ol><p>总之，互斥锁是一种重要的同步工具，用于在多线程环境下控制对共享资源的访问，确保线程安全性并避免竞争条件和数据不一致性问题的发生。在正确使用互斥锁的情况下，可以有效地保证多线程程序的正确性和稳定性。</p><h3 id="临界区（对共享资源操作的临界区域）"><a href="#临界区（对共享资源操作的临界区域）" class="headerlink" title="临界区（对共享资源操作的临界区域）"></a>临界区（对共享资源操作的临界区域）</h3><p>临界区是指在多线程程序中，多个线程共享的某一段代码或数据区域，这里的代码或数据可能会被多个线程同时访问和操作。在临界区中，如果多个线程同时对共享资源进行读写操作，就会发生竞态条件（Race Condition），导致程序出现错误或产生不确定的结果。</p><p>让我们通过一个生动的比喻来解释临界区：</p><p>假设有一个小咖啡厅只有一个咖啡机可以制作咖啡。多个服务员（线程）需要制作咖啡时，他们需要先检查咖啡机是否空闲。如果咖啡机正在被使用，那么其他服务员必须等待直到当前制作完成并释放咖啡机。在这个过程中，检查咖啡机状态、占用咖啡机、释放咖啡机的这一段代码就是临界区。只能有一个服务员进入临界区，占用咖啡机，制作咖啡，防止出现多个服务员同时操作导致的错误。</p><p>所以，临界区是指在多线程环境下，需要同步访问共享资源的代码区域或数据区域，为了避免竞态条件，需要通过互斥锁等同步机制来确保同一时刻只有一个线程能够访问临界区，保证数据的正确性和一致性。通过合理管理临界区，可以有效避免多线程程序中的各种潜在问题，确保程序的正确性和稳定性。</p><h2 id="复杂一点点的例子"><a href="#复杂一点点的例子" class="headerlink" title="复杂一点点的例子"></a>复杂一点点的例子</h2><p>以下是一个更复杂的多线程示例，其中包含两个线程，一个是生产者线程，一个是消费者线程，它们之间通过共享的缓冲区进行通信：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;condition_variable&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::mutex mtx;</span><br><span class="line">std::condition_variable produceCondition, consumeCondition;</span><br><span class="line">std::queue&lt;<span class="type">int</span>&gt; buffer;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> bufferSize = <span class="number">10</span>;</span><br><span class="line"><span class="type">bool</span> done = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">producer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; ++i) &#123;</span><br><span class="line">        <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>;</span><br><span class="line">        produceCondition.<span class="built_in">wait</span>(lock, [] &#123; <span class="keyword">return</span> buffer.<span class="built_in">size</span>() &lt; bufferSize; &#125;);</span><br><span class="line">        </span><br><span class="line">        buffer.<span class="built_in">push</span>(i);</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Produced: &quot;</span> &lt;&lt; i &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        lock.<span class="built_in">unlock</span>();</span><br><span class="line">        consumeCondition.<span class="built_in">notify_one</span>();        </span><br><span class="line">    &#125;</span><br><span class="line">    done = <span class="literal">true</span>;</span><br><span class="line">    consumeCondition.<span class="built_in">notify_one</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">consumer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (!done) &#123;</span><br><span class="line">        <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>;</span><br><span class="line">        consumeCondition.<span class="built_in">wait</span>(lock, [] &#123; <span class="keyword">return</span> !buffer.<span class="built_in">empty</span>() || done; &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!buffer.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> val = buffer.<span class="built_in">front</span>();</span><br><span class="line">            buffer.<span class="built_in">pop</span>();</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;Consumed: &quot;</span> &lt;&lt; val &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        lock.<span class="built_in">unlock</span>();</span><br><span class="line">        produceCondition.<span class="built_in">notify_one</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::thread <span class="title">producerThread</span><span class="params">(producer)</span></span>;</span><br><span class="line">    <span class="function">std::thread <span class="title">consumerThread</span><span class="params">(consumer)</span></span>;</span><br><span class="line"></span><br><span class="line">    producerThread.<span class="built_in">join</span>();</span><br><span class="line">    consumerThread.<span class="built_in">join</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这个示例中，生产者线程负责向缓冲区中放入数据，而消费者线程则负责从缓冲区中取出数据。生产者线程会一直生产数据直到生产完20个数据为止。消费者线程会在生产者线程生产数据时，从缓冲区中消费数据，并且当生产者线程结束时也会结束。</p><p>通过使用互斥锁和条件变量来实现对缓冲区的访问控制和线程通信。生产者线程会根据缓冲区的状态来决定是否生产数据，而消费者线程也会根据缓冲区的状态来决定是否消费数据。在主函数中，调用了 <code>join()</code> 来等待生产者线程和消费者线程的结束。</p><p><strong>输出:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Produced: <span class="number">0</span></span><br><span class="line">Produced: <span class="number">1</span></span><br><span class="line">Produced: <span class="number">2</span></span><br><span class="line">Produced: <span class="number">3</span></span><br><span class="line">Produced: <span class="number">4</span></span><br><span class="line">Produced: <span class="number">5</span></span><br><span class="line">Produced: <span class="number">6</span></span><br><span class="line">Produced: <span class="number">7</span></span><br><span class="line">Produced: <span class="number">8</span></span><br><span class="line">Produced: <span class="number">9</span></span><br><span class="line">Consumed: <span class="number">0</span></span><br><span class="line">Consumed: <span class="number">1</span></span><br><span class="line">Consumed: <span class="number">2</span></span><br><span class="line">Consumed: <span class="number">3</span></span><br><span class="line">Consumed: <span class="number">4</span></span><br><span class="line">Consumed: <span class="number">5</span></span><br><span class="line">Consumed: <span class="number">6</span></span><br><span class="line">Consumed: <span class="number">7</span></span><br><span class="line">Consumed: <span class="number">8</span></span><br><span class="line">Consumed: <span class="number">9</span></span><br><span class="line">Produced: <span class="number">10</span></span><br><span class="line">Produced: <span class="number">11</span></span><br><span class="line">Produced: <span class="number">12</span></span><br><span class="line">Produced: <span class="number">13</span></span><br><span class="line">Produced: <span class="number">14</span></span><br><span class="line">Produced: <span class="number">15</span></span><br><span class="line">Produced: <span class="number">16</span></span><br><span class="line">Produced: <span class="number">17</span></span><br><span class="line">Produced: <span class="number">18</span></span><br><span class="line">Produced: <span class="number">19</span></span><br><span class="line">Consumed: <span class="number">10</span></span><br></pre></td></tr></table></figure><p><strong>当加上sleep_for后:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;condition_variable&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::mutex mtx;</span><br><span class="line">std::condition_variable produceCondition, consumeCondition;</span><br><span class="line">std::queue&lt;<span class="type">int</span>&gt; buffer;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> bufferSize = <span class="number">10</span>;</span><br><span class="line"><span class="type">bool</span> done = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">producer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; ++i) &#123;</span><br><span class="line">        <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>;</span><br><span class="line">        produceCondition.<span class="built_in">wait</span>(lock, [] &#123; <span class="keyword">return</span> buffer.<span class="built_in">size</span>() &lt; bufferSize; &#125;);</span><br><span class="line"></span><br><span class="line">        buffer.<span class="built_in">push</span>(i);</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Produced: &quot;</span> &lt;&lt; i &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        lock.<span class="built_in">unlock</span>();</span><br><span class="line">        consumeCondition.<span class="built_in">notify_one</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    done = <span class="literal">true</span>;</span><br><span class="line">    consumeCondition.<span class="built_in">notify_one</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">consumer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (!done) &#123;</span><br><span class="line">        <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>;</span><br><span class="line">        consumeCondition.<span class="built_in">wait</span>(lock, [] &#123; <span class="keyword">return</span> !buffer.<span class="built_in">empty</span>() || done; &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!buffer.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> val = buffer.<span class="built_in">front</span>();</span><br><span class="line">            buffer.<span class="built_in">pop</span>();</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;Consumed: &quot;</span> &lt;&lt; val &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        lock.<span class="built_in">unlock</span>();</span><br><span class="line">        produceCondition.<span class="built_in">notify_one</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::thread <span class="title">producerThread</span><span class="params">(producer)</span></span>;</span><br><span class="line">    <span class="function">std::thread <span class="title">consumerThread</span><span class="params">(consumer)</span></span>;</span><br><span class="line"></span><br><span class="line">    producerThread.<span class="built_in">join</span>();</span><br><span class="line">    consumerThread.<span class="built_in">join</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>输出:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Produced: <span class="number">0</span></span><br><span class="line">Consumed: <span class="number">0</span></span><br><span class="line">Produced: <span class="number">1</span></span><br><span class="line">Consumed: <span class="number">1</span></span><br><span class="line">Produced: <span class="number">2</span></span><br><span class="line">Consumed: <span class="number">2</span></span><br><span class="line">Produced: <span class="number">3</span></span><br><span class="line">Consumed: <span class="number">3</span></span><br><span class="line">Produced: <span class="number">4</span></span><br><span class="line">Consumed: <span class="number">4</span></span><br><span class="line">Produced: <span class="number">5</span></span><br><span class="line">Consumed: <span class="number">5</span></span><br><span class="line">Produced: <span class="number">6</span></span><br><span class="line">Consumed: <span class="number">6</span></span><br><span class="line">Produced: <span class="number">7</span></span><br><span class="line">Consumed: <span class="number">7</span></span><br><span class="line">Produced: <span class="number">8</span></span><br><span class="line">Consumed: <span class="number">8</span></span><br><span class="line">Produced: <span class="number">9</span></span><br><span class="line">Consumed: <span class="number">9</span></span><br><span class="line">Produced: <span class="number">10</span></span><br><span class="line">Consumed: <span class="number">10</span></span><br><span class="line">Produced: <span class="number">11</span></span><br><span class="line">Consumed: <span class="number">11</span></span><br><span class="line">Produced: <span class="number">12</span></span><br><span class="line">Consumed: <span class="number">12</span></span><br><span class="line">Produced: <span class="number">13</span></span><br><span class="line">Consumed: <span class="number">13</span></span><br><span class="line">Produced: <span class="number">14</span></span><br><span class="line">Consumed: <span class="number">14</span></span><br><span class="line">Produced: <span class="number">15</span></span><br><span class="line">Consumed: <span class="number">15</span></span><br><span class="line">Produced: <span class="number">16</span></span><br><span class="line">Consumed: <span class="number">16</span></span><br><span class="line">Produced: <span class="number">17</span></span><br><span class="line">Consumed: <span class="number">17</span></span><br><span class="line">Produced: <span class="number">18</span></span><br><span class="line">Consumed: <span class="number">18</span></span><br><span class="line">Produced: <span class="number">19</span></span><br><span class="line">Consumed: <span class="number">19</span></span><br></pre></td></tr></table></figure><p>在生产者线程中使用<code>this_thread::sleep_for(std::chrono::milliseconds(500));</code>来模拟生产数据的耗时操作是为了模拟实际生产数据可能存在的耗时情况，而不是立即连续生产数据。这种模拟有几个关键的影响：</p><ol><li><p><strong>模拟实际情况</strong>：在实际情况下，生产数据可能涉及到一些繁重的计算或I&#x2F;O操作，这可能导致需要一定的时间来生成数据。通过这种模拟，可以更好地反映现实情况下的生产数据过程。</p></li><li><p><strong>线程调度</strong>：使用<code>sleep_for</code>会使得当前线程在指定的时间内暂停执行，其他线程有机会继续执行。这有助于模拟并发环境中不同线程之间的调度和竞争。</p></li><li><p><strong>避免资源争夺</strong>：由于生产者线程在生产数据时会暂停一段时间，消费者线程有机会访问和处理已生产的数据，而不会因为生产速度过快导致队列溢出或数据丢失。</p></li></ol><p>如果去掉<code>this_thread::sleep_for(std::chrono::milliseconds(500));</code>部分，生产者线程将会变得非常快速，可能导致生产的数据迅速填满队列，消费者线程无法及时消费，从而导致队列溢出。因此，这段代码中的延时操作对于正确模拟生产者和消费者之间的交互过程和线程调度是非常重要的。</p><ol><li><p><strong>为什么done&#x3D;true后面要加consumeCondition.notify_one();</strong></p><p> 在典型的生产者消费者模型中，<code>done=true</code>通常表示生产者已经完成了生产任务，没有更多的数据可供消费者消费。当<code>done</code>被设置为<code>true</code>时，消费者线程需要被唤醒并退出循环，以避免不必要的等待和资源浪费。为了实现这一点，通常会使用条件变量（condition variable）来实现线程的等待和唤醒。</p><p> 在设置<code>done=true</code>之后，通过调用<code>consumeCondition.notify_one()</code>来唤醒等待在<code>consumeCondition</code>条件变量上的一个消费者线程。这样做可以确保消费者线程在<code>done=true</code>之后能够立即被唤醒，检查条件并退出循环。没有这一步的唤醒操作，消费者线程可能会一直阻塞在条件变量上，无法及时退出循环，导致资源浪费或程序逻辑错误。</p><p> 因此，通过在<code>done=true</code>之后调用<code>consumeCondition.notify_one()</code>来唤醒消费者线程，确保了生产者完成生产后消费者能够及时退出循环，有效地管理线程的执行顺序和资源的利用。</p></li><li><p><strong>condition_variable是什么</strong></p><p> <code>std::condition_variable</code> 是 C++ 标准库中用来实现多线程同步的一种机制。它允许一个或多个线程等待，直到某个条件得到满足后再继续执行。在多线程编程中，我们经常需要一种方式来进行线程之间的通信和同步，<code>std::condition_variable</code> 就是为此而设计的。</p><p> 在使用 <code>std::condition_variable</code> 时通常和 <code>std::mutex</code> 配合使用，具体步骤如下：</p><ol><li>使用 <code>std::mutex</code> 来保护需要等待的条件变量和共享资源。</li><li>当条件不满足时，线程通过 <code>std::condition_variable</code> 的 <code>wait()</code> 方法释放锁并进入等待状态，直到其他线程通知条件满足。</li><li>当其他线程满足了条件后，调用 <code>std::condition_variable</code> 的 <code>notify_one()</code> 或 <code>notify_all()</code> 方法来唤醒等待的线程。</li></ol><p> 通过 <code>std::condition_variable</code>，我们可以实现线程之间的有效协作和同步，避免了线程忙等待，提高了程序的效率和性能。</p></li></ol><h2 id="4个线程来并发计算部分和"><a href="#4个线程来并发计算部分和" class="headerlink" title="4个线程来并发计算部分和"></a>4个线程来并发计算部分和</h2>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> 智能车，多线程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一些图像处理的函数</title>
      <link href="/2024/04/29/%E4%B8%80%E4%BA%9B%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%9A%84%E5%87%BD%E6%95%B0/"/>
      <url>/2024/04/29/%E4%B8%80%E4%BA%9B%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%9A%84%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="中值滤波"><a href="#中值滤波" class="headerlink" title="中值滤波"></a>中值滤波</h2><p><strong>卷积核大小为7：</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Mat <span class="title">medianFilter</span><span class="params">(Mat imgO)</span> </span>&#123;</span><br><span class="line"><span class="comment">// 创建一个新的Mat对象用于存储滤波后的图像</span></span><br><span class="line">Mat img1 = Mat::<span class="built_in">zeros</span>(imgO.rows - <span class="number">6</span>, imgO.cols - <span class="number">6</span>, CV_8U);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对输入图像进行中值滤波</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> y = <span class="number">3</span>; y &lt; imgO.rows - <span class="number">3</span>; y++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">3</span>; x &lt; imgO.cols - <span class="number">3</span>; x++) &#123;</span><br><span class="line">vector&lt;uchar&gt; values;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">-3</span>; j &lt;= <span class="number">3</span>; j++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">-3</span>; i &lt;= <span class="number">3</span>; i++) &#123;</span><br><span class="line">values.<span class="built_in">push_back</span>(imgO.<span class="built_in">at</span>&lt;uchar&gt;(y + j, x + i));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 对values数组中的值进行排序</span></span><br><span class="line"><span class="built_in">sort</span>(values.<span class="built_in">begin</span>(), values.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算中值并赋值给输出图像</span></span><br><span class="line">img1.<span class="built_in">at</span>&lt;uchar&gt;(y - <span class="number">3</span>, x - <span class="number">3</span>) = values[values.<span class="built_in">size</span>() / <span class="number">2</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> img1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>效果</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src=",https://tumytime.github.io/picx-images-hosting/image.2yy5oeqtl5.webp" class="lazyload placeholder" data-srcset=",https://tumytime.github.io/picx-images-hosting/image.2yy5oeqtl5.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h2 id="sobel算子边缘检测"><a href="#sobel算子边缘检测" class="headerlink" title="sobel算子边缘检测"></a>sobel算子边缘检测</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Mat <span class="title">sobel3</span><span class="params">(Mat inputImg)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> gx, gy;</span><br><span class="line">Mat tempImg;</span><br><span class="line">inputImg.<span class="built_in">copyTo</span>(tempImg); <span class="comment">// 为了能够在输出图像中访问原始输入图像的像素值</span></span><br><span class="line"></span><br><span class="line">Mat outputImg = Mat::<span class="built_in">zeros</span>(inputImg.<span class="built_in">size</span>(), inputImg.<span class="built_in">type</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> y = <span class="number">1</span>; y &lt; inputImg.rows - <span class="number">1</span>; y++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">1</span>; x &lt; inputImg.cols - <span class="number">1</span>; x++) &#123;</span><br><span class="line">gx = (<span class="number">-1</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y - <span class="number">1</span>, x - <span class="number">1</span>) + <span class="number">1</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y - <span class="number">1</span>, x + <span class="number">1</span>) +</span><br><span class="line"><span class="number">-2</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y, x - <span class="number">1</span>) + <span class="number">2</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y, x + <span class="number">1</span>) +</span><br><span class="line"><span class="number">-1</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y + <span class="number">1</span>, x - <span class="number">1</span>) + <span class="number">1</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y + <span class="number">1</span>, x + <span class="number">1</span>)) / <span class="number">4</span>;</span><br><span class="line">gy = (<span class="number">1</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y - <span class="number">1</span>, x - <span class="number">1</span>) + <span class="number">2</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y - <span class="number">1</span>, x) + <span class="number">1</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y - <span class="number">1</span>, x + <span class="number">1</span>) +</span><br><span class="line"><span class="number">-1</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y + <span class="number">1</span>, x - <span class="number">1</span>) - <span class="number">2</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y + <span class="number">1</span>, x) - <span class="number">1</span> * tempImg.<span class="built_in">at</span>&lt;uchar&gt;(y + <span class="number">1</span>, x + <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">outputImg.<span class="built_in">at</span>&lt;uchar&gt;(y, x) = (<span class="built_in">abs</span>(gx) + <span class="built_in">abs</span>(gy)) / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> outputImg.<span class="built_in">clone</span>(); <span class="comment">// 返回outputImg的副本</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>效果</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src=",https://tumytime.github.io/picx-images-hosting/image.4jnwnvqbmt.webp" class="lazyload placeholder" data-srcset=",https://tumytime.github.io/picx-images-hosting/image.4jnwnvqbmt.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 智能车 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AuTop代码整理</title>
      <link href="/2024/04/28/AuTop%E4%BB%A3%E7%A0%81%E6%95%B4%E7%90%86/"/>
      <url>/2024/04/28/AuTop%E4%BB%A3%E7%A0%81%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="圆环circle"><a href="#圆环circle" class="headerlink" title="圆环circle"></a>圆环circle</h2><details ><summary pointer> circle.c </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;circle.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;motor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">circle_type_e</span> <span class="title">circle_type</span> =</span> CIRCLE_NONE;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方便串口收发</span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *circle_type_name[CIRCLE_NUM] = &#123;</span><br><span class="line">        <span class="string">&quot;CIRCLE_NONE&quot;</span>,</span><br><span class="line">        <span class="string">&quot;CIRCLE_LEFT_BEGIN&quot;</span>, <span class="string">&quot;CIRCLE_RIGHT_BEGIN&quot;</span>,</span><br><span class="line">        <span class="string">&quot;CIRCLE_LEFT_RUNNING&quot;</span>, <span class="string">&quot;CIRCLE_RIGHT_RUNNING&quot;</span>,</span><br><span class="line">        <span class="string">&quot;CIRCLE_LEFT_IN&quot;</span>, <span class="string">&quot;CIRCLE_RIGHT_IN&quot;</span>,</span><br><span class="line">        <span class="string">&quot;CIRCLE_LEFT_OUT&quot;</span>, <span class="string">&quot;CIRCLE_RIGHT_OUT&quot;</span>,</span><br><span class="line">        <span class="string">&quot;CIRCLE_LEFT_END&quot;</span>, <span class="string">&quot;CIRCLE_RIGHT_END&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 编码器，用于防止一些重复触发等。</span></span><br><span class="line"><span class="type">int64_t</span> circle_encoder;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> none_left_line = <span class="number">0</span>, none_right_line = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> have_left_line = <span class="number">0</span>, have_right_line = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">check_circle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 非圆环模式下，单边L角点, 单边长直道</span></span><br><span class="line">    <span class="keyword">if</span> (circle_type == CIRCLE_NONE &amp;&amp; Lpt0_found &amp;&amp; !Lpt1_found &amp;&amp; is_straight1) &#123;</span><br><span class="line">        circle_type = CIRCLE_LEFT_BEGIN;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (circle_type == CIRCLE_NONE &amp;&amp; !Lpt0_found &amp;&amp; Lpt1_found &amp;&amp; is_straight0) &#123;</span><br><span class="line">        circle_type = CIRCLE_RIGHT_BEGIN;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">run_circle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int64_t</span> current_encoder = get_total_encoder();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 左环开始，寻外直道右线</span></span><br><span class="line">    <span class="keyword">if</span> (circle_type == CIRCLE_LEFT_BEGIN) &#123;</span><br><span class="line">        track_type = TRACK_RIGHT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//先丢左线后有线</span></span><br><span class="line">        <span class="keyword">if</span> (rpts0s_num &lt; <span class="number">0.2</span> / sample_dist) &#123; none_left_line++; &#125;</span><br><span class="line">        <span class="keyword">if</span> (rpts0s_num &gt; <span class="number">1.0</span> / sample_dist &amp;&amp; none_left_line &gt; <span class="number">2</span>) &#123;</span><br><span class="line">            have_left_line++;</span><br><span class="line">            <span class="keyword">if</span> (have_left_line &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                circle_type = CIRCLE_LEFT_IN;</span><br><span class="line">                none_left_line = <span class="number">0</span>;</span><br><span class="line">                have_left_line = <span class="number">0</span>;</span><br><span class="line">                circle_encoder = current_encoder;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//入环，寻内圆左线</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_LEFT_IN) &#123;</span><br><span class="line">        track_type = TRACK_LEFT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//编码器打表过1/4圆   应修正为右线为转弯无拐点</span></span><br><span class="line">        <span class="keyword">if</span> (rpts0s_num &lt; <span class="number">0.1</span> / sample_dist ||</span><br><span class="line">            current_encoder - circle_encoder &gt;= ENCODER_PER_METER * (<span class="number">3.14</span> * <span class="number">1</span> / <span class="number">2</span>)) &#123; circle_type = CIRCLE_LEFT_RUNNING; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//正常巡线，寻外圆右线</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_LEFT_RUNNING) &#123;</span><br><span class="line">        track_type = TRACK_RIGHT;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Lpt1_found) rpts1s_num = rptsc1_num = Lpt1_rpts1s_id;</span><br><span class="line">        <span class="comment">//外环拐点(右L点)</span></span><br><span class="line">        <span class="keyword">if</span> (Lpt1_found &amp;&amp; Lpt1_rpts1s_id &lt; <span class="number">0.4</span> / sample_dist) &#123;</span><br><span class="line">            circle_type = CIRCLE_LEFT_OUT;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//出环，寻内圆</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_LEFT_OUT) &#123;</span><br><span class="line">        track_type = TRACK_LEFT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//右线为长直道</span></span><br><span class="line">        <span class="keyword">if</span> (is_straight1) &#123;</span><br><span class="line">            circle_type = CIRCLE_LEFT_END;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//走过圆环，寻右线</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_LEFT_END) &#123;</span><br><span class="line">        track_type = TRACK_RIGHT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//左线先丢后有</span></span><br><span class="line">        <span class="keyword">if</span> (rpts0s_num &lt; <span class="number">0.2</span> / sample_dist) &#123; none_left_line++; &#125;</span><br><span class="line">        <span class="keyword">if</span> (rpts0s_num &gt; <span class="number">1.0</span> / sample_dist &amp;&amp; none_left_line &gt; <span class="number">3</span>) &#123;</span><br><span class="line">            circle_type = CIRCLE_NONE;</span><br><span class="line">            none_left_line = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//右环控制，前期寻左直道</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_RIGHT_BEGIN) &#123;</span><br><span class="line">        track_type = TRACK_LEFT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//先丢右线后有线</span></span><br><span class="line">        <span class="keyword">if</span> (rpts1s_num &lt; <span class="number">0.2</span> / sample_dist) &#123; none_right_line++; &#125;</span><br><span class="line">        <span class="keyword">if</span> (rpts1s_num &gt; <span class="number">1.0</span> / sample_dist &amp;&amp; none_right_line &gt; <span class="number">2</span>) &#123;</span><br><span class="line">            have_right_line++;</span><br><span class="line">            <span class="keyword">if</span> (have_right_line &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                circle_type = CIRCLE_RIGHT_IN;</span><br><span class="line">                none_right_line = <span class="number">0</span>;</span><br><span class="line">                have_right_line = <span class="number">0</span>;</span><br><span class="line">                circle_encoder = current_encoder;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//入右环，寻右内圆环</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_RIGHT_IN) &#123;</span><br><span class="line">        track_type = TRACK_RIGHT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//编码器打表过1/4圆   应修正为左线为转弯无拐点</span></span><br><span class="line">        <span class="keyword">if</span> (rpts1s_num &lt; <span class="number">0.1</span> / sample_dist ||</span><br><span class="line">            current_encoder - circle_encoder &gt;= ENCODER_PER_METER * (<span class="number">3.14</span> * <span class="number">1</span> / <span class="number">2</span>)) &#123; circle_type = CIRCLE_RIGHT_RUNNING; &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//正常巡线，寻外圆左线</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_RIGHT_RUNNING) &#123;</span><br><span class="line">        track_type = TRACK_LEFT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//外环存在拐点,可再加拐点距离判据(左L点)</span></span><br><span class="line">        <span class="keyword">if</span> (Lpt0_found) rpts0s_num = rptsc0_num = Lpt0_rpts0s_id;</span><br><span class="line">        <span class="keyword">if</span> (Lpt0_found &amp;&amp; Lpt0_rpts0s_id &lt; <span class="number">0.4</span> / sample_dist) &#123;</span><br><span class="line">            circle_type = CIRCLE_RIGHT_OUT;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//出环，寻内圆</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_RIGHT_OUT) &#123;</span><br><span class="line">        track_type = TRACK_RIGHT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//左长度加倾斜角度  应修正左右线找到且为直线</span></span><br><span class="line">        <span class="comment">//if((rpts1s_num &gt;100 &amp;&amp; !Lpt1_found))  &#123;have_right_line++;&#125;</span></span><br><span class="line">        <span class="keyword">if</span> (is_straight0) &#123;</span><br><span class="line">            circle_type = CIRCLE_RIGHT_END;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="comment">//走过圆环，寻左线</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_RIGHT_END) &#123;</span><br><span class="line">        track_type = TRACK_LEFT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//左线先丢后有</span></span><br><span class="line">        <span class="keyword">if</span> (rpts1s_num &lt; <span class="number">0.2</span> / sample_dist) &#123; none_right_line++; &#125;</span><br><span class="line">        <span class="keyword">if</span> (rpts1s_num &gt; <span class="number">1.0</span> / sample_dist &amp;&amp; none_right_line &gt; <span class="number">2</span>) &#123;</span><br><span class="line">            circle_type = CIRCLE_NONE;</span><br><span class="line">            none_right_line = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绘制圆环模式下的调试图像</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">draw_circle</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details ><summary pointer> circle.h </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> CIRCLE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CIRCLE_H</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">circle_type_e</span> &#123;</span></span><br><span class="line">    CIRCLE_NONE = <span class="number">0</span>,                            <span class="comment">// 非圆环模式</span></span><br><span class="line">    CIRCLE_LEFT_BEGIN, CIRCLE_RIGHT_BEGIN,      <span class="comment">// 圆环开始，识别到单侧L角点另一侧长直道。</span></span><br><span class="line">    CIRCLE_LEFT_IN, CIRCLE_RIGHT_IN,            <span class="comment">// 圆环进入，即走到一侧直道，一侧圆环的位置。</span></span><br><span class="line">    CIRCLE_LEFT_RUNNING, CIRCLE_RIGHT_RUNNING,  <span class="comment">// 圆环内部。</span></span><br><span class="line">    CIRCLE_LEFT_OUT, CIRCLE_RIGHT_OUT,          <span class="comment">// 准备出圆环，即识别到出环处的L角点。</span></span><br><span class="line">    CIRCLE_LEFT_END, CIRCLE_RIGHT_END,          <span class="comment">// 圆环结束，即再次走到单侧直道的位置。</span></span><br><span class="line">    CIRCLE_NUM,                                 <span class="comment">//</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">const</span> <span class="type">char</span> *circle_type_name[CIRCLE_NUM];</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="class"><span class="keyword">enum</span> <span class="title">circle_type_e</span> <span class="title">circle_type</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">check_circle</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">run_circle</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">draw_circle</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// CIRCLE_H</span></span></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="非圆环模式下判断圆环"><a href="#非圆环模式下判断圆环" class="headerlink" title="非圆环模式下判断圆环"></a>非圆环模式下判断圆环</h3><p><strong>单边L角点, 单边长直道</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">check_circle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 非圆环模式下，单边L角点, 单边长直道</span></span><br><span class="line">    <span class="keyword">if</span> (circle_type == CIRCLE_NONE &amp;&amp; Lpt0_found &amp;&amp; !Lpt1_found &amp;&amp; is_straight1) &#123;</span><br><span class="line">        circle_type = CIRCLE_LEFT_BEGIN;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (circle_type == CIRCLE_NONE &amp;&amp; !Lpt0_found &amp;&amp; Lpt1_found &amp;&amp; is_straight0) &#123;</span><br><span class="line">        circle_type = CIRCLE_RIGHT_BEGIN;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="圆环执行"><a href="#圆环执行" class="headerlink" title="圆环执行"></a>圆环执行</h3><details ><summary pointer> run_circle() </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">run_circle</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int64_t</span> current_encoder = get_total_encoder();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 左环开始，寻外直道右线</span></span><br><span class="line">    <span class="keyword">if</span> (circle_type == CIRCLE_LEFT_BEGIN) &#123;</span><br><span class="line">        track_type = TRACK_RIGHT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//先丢左线后有线</span></span><br><span class="line">        <span class="keyword">if</span> (rpts0s_num &lt; <span class="number">0.2</span> / sample_dist) &#123; none_left_line++; &#125;</span><br><span class="line">        <span class="keyword">if</span> (rpts0s_num &gt; <span class="number">1.0</span> / sample_dist &amp;&amp; none_left_line &gt; <span class="number">2</span>) &#123;</span><br><span class="line">            have_left_line++;</span><br><span class="line">            <span class="keyword">if</span> (have_left_line &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                circle_type = CIRCLE_LEFT_IN;</span><br><span class="line">                none_left_line = <span class="number">0</span>;</span><br><span class="line">                have_left_line = <span class="number">0</span>;</span><br><span class="line">                circle_encoder = current_encoder;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//入环，寻内圆左线</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_LEFT_IN) &#123;</span><br><span class="line">        track_type = TRACK_LEFT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//编码器打表过1/4圆   应修正为右线为转弯无拐点</span></span><br><span class="line">        <span class="keyword">if</span> (rpts0s_num &lt; <span class="number">0.1</span> / sample_dist ||</span><br><span class="line">            current_encoder - circle_encoder &gt;= ENCODER_PER_METER * (<span class="number">3.14</span> * <span class="number">1</span> / <span class="number">2</span>)) &#123; circle_type = CIRCLE_LEFT_RUNNING; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//正常巡线，寻外圆右线</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_LEFT_RUNNING) &#123;</span><br><span class="line">        track_type = TRACK_RIGHT;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Lpt1_found) rpts1s_num = rptsc1_num = Lpt1_rpts1s_id;</span><br><span class="line">        <span class="comment">//外环拐点(右L点)</span></span><br><span class="line">        <span class="keyword">if</span> (Lpt1_found &amp;&amp; Lpt1_rpts1s_id &lt; <span class="number">0.4</span> / sample_dist) &#123;</span><br><span class="line">            circle_type = CIRCLE_LEFT_OUT;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//出环，寻内圆</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_LEFT_OUT) &#123;</span><br><span class="line">        track_type = TRACK_LEFT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//右线为长直道</span></span><br><span class="line">        <span class="keyword">if</span> (is_straight1) &#123;</span><br><span class="line">            circle_type = CIRCLE_LEFT_END;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//走过圆环，寻右线</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_LEFT_END) &#123;</span><br><span class="line">        track_type = TRACK_RIGHT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//左线先丢后有</span></span><br><span class="line">        <span class="keyword">if</span> (rpts0s_num &lt; <span class="number">0.2</span> / sample_dist) &#123; none_left_line++; &#125;</span><br><span class="line">        <span class="keyword">if</span> (rpts0s_num &gt; <span class="number">1.0</span> / sample_dist &amp;&amp; none_left_line &gt; <span class="number">3</span>) &#123;</span><br><span class="line">            circle_type = CIRCLE_NONE;</span><br><span class="line">            none_left_line = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//右环控制，前期寻左直道</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_RIGHT_BEGIN) &#123;</span><br><span class="line">        track_type = TRACK_LEFT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//先丢右线后有线</span></span><br><span class="line">        <span class="keyword">if</span> (rpts1s_num &lt; <span class="number">0.2</span> / sample_dist) &#123; none_right_line++; &#125;</span><br><span class="line">        <span class="keyword">if</span> (rpts1s_num &gt; <span class="number">1.0</span> / sample_dist &amp;&amp; none_right_line &gt; <span class="number">2</span>) &#123;</span><br><span class="line">            have_right_line++;</span><br><span class="line">            <span class="keyword">if</span> (have_right_line &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                circle_type = CIRCLE_RIGHT_IN;</span><br><span class="line">                none_right_line = <span class="number">0</span>;</span><br><span class="line">                have_right_line = <span class="number">0</span>;</span><br><span class="line">                circle_encoder = current_encoder;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//入右环，寻右内圆环</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_RIGHT_IN) &#123;</span><br><span class="line">        track_type = TRACK_RIGHT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//编码器打表过1/4圆   应修正为左线为转弯无拐点</span></span><br><span class="line">        <span class="keyword">if</span> (rpts1s_num &lt; <span class="number">0.1</span> / sample_dist ||</span><br><span class="line">            current_encoder - circle_encoder &gt;= ENCODER_PER_METER * (<span class="number">3.14</span> * <span class="number">1</span> / <span class="number">2</span>)) &#123; circle_type = CIRCLE_RIGHT_RUNNING; &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//正常巡线，寻外圆左线</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_RIGHT_RUNNING) &#123;</span><br><span class="line">        track_type = TRACK_LEFT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//外环存在拐点,可再加拐点距离判据(左L点)</span></span><br><span class="line">        <span class="keyword">if</span> (Lpt0_found) rpts0s_num = rptsc0_num = Lpt0_rpts0s_id;</span><br><span class="line">        <span class="keyword">if</span> (Lpt0_found &amp;&amp; Lpt0_rpts0s_id &lt; <span class="number">0.4</span> / sample_dist) &#123;</span><br><span class="line">            circle_type = CIRCLE_RIGHT_OUT;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//出环，寻内圆</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_RIGHT_OUT) &#123;</span><br><span class="line">        track_type = TRACK_RIGHT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//左长度加倾斜角度  应修正左右线找到且为直线</span></span><br><span class="line">        <span class="comment">//if((rpts1s_num &gt;100 &amp;&amp; !Lpt1_found))  &#123;have_right_line++;&#125;</span></span><br><span class="line">        <span class="keyword">if</span> (is_straight0) &#123;</span><br><span class="line">            circle_type = CIRCLE_RIGHT_END;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="comment">//走过圆环，寻左线</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (circle_type == CIRCLE_RIGHT_END) &#123;</span><br><span class="line">        track_type = TRACK_LEFT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//左线先丢后有</span></span><br><span class="line">        <span class="keyword">if</span> (rpts1s_num &lt; <span class="number">0.2</span> / sample_dist) &#123; none_right_line++; &#125;</span><br><span class="line">        <span class="keyword">if</span> (rpts1s_num &gt; <span class="number">1.0</span> / sample_dist &amp;&amp; none_right_line &gt; <span class="number">2</span>) &#123;</span><br><span class="line">            circle_type = CIRCLE_NONE;</span><br><span class="line">            none_right_line = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details ><summary pointer> 详细解读 </summary>              <div class='content'>              <details open><summary pointer> get_total_encoder() </summary>          <div class='content'>          <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int64_t</span> <span class="title function_">get_total_encoder</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">int64_t</span>) ((motor_l.total_encoder + motor_r.total_encoder) / <span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码定义了一个函数 <code>get_total_encoder()</code>，用于计算左右两个电机的编码器总和并取平均值。具体步骤如下：</p><ol><li>获取左电机和右电机的编码器值 <code>motor_l.total_encoder</code> 和 <code>motor_r.total_encoder</code>。</li><li>将左右两个电机的编码器值相加得到总和。</li><li>将总和除以2取平均值，然后以 <code>int64_t</code> 类型返回结果。</li></ol>          </div>        </details>              </div>            </details><p>track_type：单边得中线的边</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//编码器打表过1/4圆   应修正为右线为转弯无拐点</span></span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> (rpts0s_num &lt; <span class="number">0.1</span> / sample_dist ||</span><br><span class="line">          current_encoder - circle_encoder &gt;= ENCODER_PER_METER * (<span class="number">3.14</span> * <span class="number">1</span> / <span class="number">2</span>)) &#123; circle_type = CIRCLE_LEFT_RUNNING; &#125;</span><br></pre></td></tr></table></figure><p>这段代码的逻辑似乎与之前的代码相关，用于检测编码器在打表过1&#x2F;4圆时的状态，并进行相应的修正。让我来解释一下这段代码的作用：</p><ol><li>首先判断条件 <code>rpts0s_num &lt; 0.1 / sample_dist</code>，如果条件成立，说明小车还未行驶到1&#x2F;4圆的位置，或者右线未被检测到。</li><li>或者判断条件 <code>current_encoder - circle_encoder &gt;= ENCODER_PER_METER * (3.14 * 1 / 2)</code>，这个条件看起来是在判断当前编码器值与开始打表时的编码器值之差是否超过了1&#x2F;4圆的周长对应的编码器值。</li><li>如果以上两个条件有一个成立，就会将 <code>circle_type</code> 设置为 <code>CIRCLE_LEFT_RUNNING</code>，表示小车正在左环行驶的阶段。</li></ol><p>在检测到小车行驶过1&#x2F;4圆或者右线为转弯时将 <code>circle_type</code> 修改为 <code>CIRCLE_LEFT_RUNNING</code>，可能是为了校准小车在左环赛道上行驶时的特定状态。这段代码与之前的代码一起，似乎在实现一个复杂的状态机来控制小车在左环赛道上的运动。如果您有更多的问题或需要进一步解释，请随时告诉我。</p><hr><p>什么是编码器打表:<br>编码器打表（Encoder Look-Up Table）通常指的是在编码器模块中使用查找表（Look-Up Table）来进行编码的过程。在信号处理领域或者通信系统中，编码器的作用是将输入信号转换为特定的编码形式，以便传输、存储或处理。而编码器打表的概念是通过预先构建一个表格，将输入信号映射到特定的编码值，从而实现编码的过程。</p><p>在这种情况下，编码器打表的优势在于可以提高编码的速度和效率。通过查找表，编码器可以以常量时间复杂度快速查找到对应的编码值，而不必每次都进行复杂的计算或逻辑判断。这样可以加快编码过程，特别是在需要频繁编码大量数据时，可以节省时间和计算资源。</p><p>总的来说，编码器打表是一种提高编码效率的方法，通过预先建立编码映射表，可以在编码过程中快速准确地找到对应的编码值，提高系统性能和速度。</p><hr><h2 id="迷宫巡线部分"><a href="#迷宫巡线部分" class="headerlink" title="迷宫巡线部分"></a>迷宫巡线部分</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 前进方向定义：</span></span><br><span class="line"><span class="comment"> *   0</span></span><br><span class="line"><span class="comment"> * 3   1</span></span><br><span class="line"><span class="comment"> *   2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">AT_DTCM_SECTION_ALIGN_INIT</span>(<span class="type">const</span> <span class="type">int</span> dir_front[<span class="number">4</span>][<span class="number">2</span>], <span class="number">8</span>) = &#123;&#123;<span class="number">0</span>,  <span class="number">-1</span>&#125;,</span><br><span class="line">                                                            &#123;<span class="number">1</span>,  <span class="number">0</span>&#125;,</span><br><span class="line">                                                            &#123;<span class="number">0</span>,  <span class="number">1</span>&#125;,</span><br><span class="line">                                                            &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line"><span class="built_in">AT_DTCM_SECTION_ALIGN_INIT</span>(<span class="type">const</span> <span class="type">int</span> dir_frontleft[<span class="number">4</span>][<span class="number">2</span>], <span class="number">8</span>) = &#123;&#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;,</span><br><span class="line">                                                                &#123;<span class="number">1</span>,  <span class="number">-1</span>&#125;,</span><br><span class="line">                                                                &#123;<span class="number">1</span>,  <span class="number">1</span>&#125;,</span><br><span class="line">                                                                &#123;<span class="number">-1</span>, <span class="number">1</span>&#125;&#125;;</span><br><span class="line"><span class="built_in">AT_DTCM_SECTION_ALIGN_INIT</span>(<span class="type">const</span> <span class="type">int</span> dir_frontright[<span class="number">4</span>][<span class="number">2</span>], <span class="number">8</span>) = &#123;&#123;<span class="number">1</span>,  <span class="number">-1</span>&#125;,</span><br><span class="line">                                                                 &#123;<span class="number">1</span>,  <span class="number">1</span>&#125;,</span><br><span class="line">                                                                 &#123;<span class="number">-1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">                                                                 &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 左手迷宫巡线</span></span><br><span class="line"><span class="built_in">AT_ITCM_SECTION_INIT</span>(<span class="type">void</span> <span class="built_in">findline_lefthand_adaptive</span>(<span class="type">image_t</span> *img, <span class="type">int</span> block_size, <span class="type">int</span> clip_value, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> pts[][<span class="number">2</span>], <span class="type">int</span> *num)) &#123;</span><br><span class="line">    <span class="built_in">assert</span>(img &amp;&amp; img-&gt;data);</span><br><span class="line">    <span class="built_in">assert</span>(num &amp;&amp; *num &gt;= <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">assert</span>(block_size &gt; <span class="number">1</span> &amp;&amp; block_size % <span class="number">2</span> == <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> half = block_size / <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> step = <span class="number">0</span>, dir = <span class="number">0</span>, turn = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (step &lt; *num &amp;&amp; half &lt; x &amp;&amp; x &lt; img-&gt;width - half - <span class="number">1</span> &amp;&amp; half &lt; y &amp;&amp; y &lt; img-&gt;height - half - <span class="number">1</span> &amp;&amp; turn &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="type">int</span> local_thres = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> dy = -half; dy &lt;= half; dy++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> dx = -half; dx &lt;= half; dx++) &#123;</span><br><span class="line">                local_thres += <span class="built_in">AT</span>(img, x + dx, y + dy);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        local_thres /= block_size * block_size;</span><br><span class="line">        local_thres -= clip_value;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> current_value = <span class="built_in">AT</span>(img, x, y);</span><br><span class="line">        <span class="type">int</span> front_value = <span class="built_in">AT</span>(img, x + dir_front[dir][<span class="number">0</span>], y + dir_front[dir][<span class="number">1</span>]);</span><br><span class="line">        <span class="type">int</span> frontleft_value = <span class="built_in">AT</span>(img, x + dir_frontleft[dir][<span class="number">0</span>], y + dir_frontleft[dir][<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (front_value &lt; local_thres) &#123;</span><br><span class="line">            dir = (dir + <span class="number">1</span>) % <span class="number">4</span>;</span><br><span class="line">            turn++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (frontleft_value &lt; local_thres) &#123;</span><br><span class="line">            x += dir_front[dir][<span class="number">0</span>];</span><br><span class="line">            y += dir_front[dir][<span class="number">1</span>];</span><br><span class="line">            pts[step][<span class="number">0</span>] = x;</span><br><span class="line">            pts[step][<span class="number">1</span>] = y;</span><br><span class="line">            step++;</span><br><span class="line">            turn = <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            x += dir_frontleft[dir][<span class="number">0</span>];</span><br><span class="line">            y += dir_frontleft[dir][<span class="number">1</span>];</span><br><span class="line">            dir = (dir + <span class="number">3</span>) % <span class="number">4</span>;</span><br><span class="line">            pts[step][<span class="number">0</span>] = x;</span><br><span class="line">            pts[step][<span class="number">1</span>] = y;</span><br><span class="line">            step++;</span><br><span class="line">            turn = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    *num = step;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 右手迷宫巡线</span></span><br><span class="line"><span class="built_in">AT_ITCM_SECTION_INIT</span>(<span class="type">void</span> <span class="built_in">findline_righthand_adaptive</span>(<span class="type">image_t</span> *img, <span class="type">int</span> block_size, <span class="type">int</span> clip_value, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> pts[][<span class="number">2</span>], <span class="type">int</span> *num)) &#123;</span><br><span class="line">    <span class="built_in">assert</span>(img &amp;&amp; img-&gt;data);</span><br><span class="line">    <span class="built_in">assert</span>(num &amp;&amp; *num &gt;= <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">assert</span>(block_size &gt; <span class="number">1</span> &amp;&amp; block_size % <span class="number">2</span> == <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> half = block_size / <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> step = <span class="number">0</span>, dir = <span class="number">0</span>, turn = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (step &lt; *num &amp;&amp; <span class="number">0</span> &lt; x &amp;&amp; x &lt; img-&gt;width - <span class="number">1</span> &amp;&amp; <span class="number">0</span> &lt; y &amp;&amp; y &lt; img-&gt;height - <span class="number">1</span> &amp;&amp; turn &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="type">int</span> local_thres = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> dy = -half; dy &lt;= half; dy++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> dx = -half; dx &lt;= half; dx++) &#123;</span><br><span class="line">                local_thres += <span class="built_in">AT</span>(img, x + dx, y + dy);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        local_thres /= block_size * block_size;</span><br><span class="line">        local_thres -= clip_value;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> current_value = <span class="built_in">AT</span>(img, x, y);</span><br><span class="line">        <span class="type">int</span> front_value = <span class="built_in">AT</span>(img, x + dir_front[dir][<span class="number">0</span>], y + dir_front[dir][<span class="number">1</span>]);</span><br><span class="line">        <span class="type">int</span> frontright_value = <span class="built_in">AT</span>(img, x + dir_frontright[dir][<span class="number">0</span>], y + dir_frontright[dir][<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (front_value &lt; local_thres) &#123;</span><br><span class="line">            dir = (dir + <span class="number">3</span>) % <span class="number">4</span>;</span><br><span class="line">            turn++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (frontright_value &lt; local_thres) &#123;</span><br><span class="line">            x += dir_front[dir][<span class="number">0</span>];</span><br><span class="line">            y += dir_front[dir][<span class="number">1</span>];</span><br><span class="line">            pts[step][<span class="number">0</span>] = x;</span><br><span class="line">            pts[step][<span class="number">1</span>] = y;</span><br><span class="line">            step++;</span><br><span class="line">            turn = <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            x += dir_frontright[dir][<span class="number">0</span>];</span><br><span class="line">            y += dir_frontright[dir][<span class="number">1</span>];</span><br><span class="line">            dir = (dir + <span class="number">1</span>) % <span class="number">4</span>;</span><br><span class="line">            pts[step][<span class="number">0</span>] = x;</span><br><span class="line">            pts[step][<span class="number">1</span>] = y;</span><br><span class="line">            step++;</span><br><span class="line">            turn = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    *num = step;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="逆透视"><a href="#逆透视" class="headerlink" title="逆透视"></a>逆透视</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">warpPerspective</span><span class="params">(InputArray src, OutputArray dst, InputArray M, Size dsize,</span></span></span><br><span class="line"><span class="params"><span class="function">                      <span class="type">int</span> flags = INTER_LINEAR, <span class="type">int</span> borderMode = BORDER_CONSTANT,</span></span></span><br><span class="line"><span class="params"><span class="function">                      <span class="type">const</span> Scalar &amp;borderValue = Scalar())</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">CV_INSTRUMENT_REGION</span>()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CV_Assert</span>(!src.<span class="built_in">empty</span>());</span><br><span class="line">    <span class="built_in">CV_Assert</span>(src.<span class="built_in">depth</span>() == CV_8U || src.<span class="built_in">depth</span>() == CV_32F);</span><br><span class="line">    <span class="built_in">CV_Assert</span>(M.<span class="built_in">rows</span>() == <span class="number">3</span> &amp;&amp; M.<span class="built_in">cols</span>() == <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function">Mat <span class="title">mapx</span><span class="params">(dsize, CV_32F)</span></span>;</span><br><span class="line">    <span class="function">Mat <span class="title">mapy</span><span class="params">(dsize, CV_32F)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Mat <span class="title">transform</span><span class="params">(<span class="number">2</span>, <span class="number">3</span>, CV_64F)</span></span>;</span><br><span class="line">    M.<span class="built_in">getMat</span>().<span class="built_in">colRange</span>(<span class="number">0</span>, <span class="number">2</span>).<span class="built_in">convertTo</span>(transform, transform.<span class="built_in">type</span>());</span><br><span class="line"></span><br><span class="line">    <span class="built_in">buildWarpPerspectiveMaps</span>(transform, flags, dsize, mapx, mapy);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">remap</span>(src, dst, mapx, mapy, flags, borderMode, borderValue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码是OpenCV中的warpPerspective函数的实现，用于对输入图像进行透视变换。下面是对代码中的函数及参数的详细解释：</p><h3 id="warpPerspective函数参数解释："><a href="#warpPerspective函数参数解释：" class="headerlink" title="warpPerspective函数参数解释："></a>warpPerspective函数参数解释：</h3><ul><li><strong>src</strong>：输入图像，类型为InputArray。</li><li><strong>dst</strong>：输出图像，类型为OutputArray。</li><li><strong>M</strong>：3x3的变换矩阵，描述了透视变换，类型为InputArray。</li><li><strong>dsize</strong>：输出图像的尺寸，类型为Size。</li><li><strong>flags</strong>：插值方法，用于指定在进行像素值插值时要使用的方法，默认为INTER_LINEAR。</li><li><strong>borderMode</strong>：边界像素插值模式，用于指定当目标图像像素位于源图像之外时的处理方式，默认为BORDER_CONSTANT。</li><li><strong>borderValue</strong>：边界填充的像素值，类型为Scalar。</li></ul><h3 id="warpPerspective函数主要步骤解释："><a href="#warpPerspective函数主要步骤解释：" class="headerlink" title="warpPerspective函数主要步骤解释："></a>warpPerspective函数主要步骤解释：</h3><ol><li><p><strong>CV_INSTRUMENT_REGION</strong>：用于性能测量和优化的宏定义。</p></li><li><p><strong>CV_Assert</strong>：断言，用于判断条件是否成立，如果条件不成立则会抛出一个异常。</p></li><li><p><strong>Mat mapx</strong>和<strong>Mat mapy</strong>：分别用于存储X和Y方向的映射结果。</p></li><li><p><strong>Mat transform</strong>：是一个2x3的矩阵，用于保存M矩阵的前两列，并将其转换为CV_64F类型。</p></li><li><p><strong>buildWarpPerspectiveMaps</strong>：根据透视变换矩阵和指定的插值方法，构建出目标图像在源图像上的映射关系。</p></li><li><p><strong>remap</strong>：根据生成的映射关系对输入图像进行透视变换，并存储结果到输出图像dst中。<br>  M.getMat().colRange(0, 2).convertTo(transform, transform.type());详细解释<br>  这行代码是针对OpenCV中的矩阵操作。让我逐步解释一下：</p></li><li><p><code>M.getMat()</code>: 这部分获取一个OpenCV的矩阵<code>M</code>。</p></li><li><p><code>.colRange(0, 2)</code>: 这个部分表示对该矩阵<code>M</code>的列进行切片操作，只选择从第0列到第2列（不包括第2列）的部分。</p></li><li><p><code>.convertTo(transform, transform.type())</code>: 这一部分是将切片后的列数据进行类型转换并赋值给另外一个矩阵<code>transform</code>。这里的<code>transform</code>是一个目标矩阵，它将包含转换后的数据。<code>transform.type()</code>返回<code>transform</code>矩阵的类型。</p></li></ol><p>因此，整体来看，这行代码的作用是从矩阵<code>M</code>中选择第0列到第1列的数据，并将其转换为指定类型，然后存储到矩阵<code>transform</code>中。</p><p>这是 <code>buildWarpPerspectiveMaps</code> 函数的伪代码实现：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">buildWarpPerspectiveMaps</span><span class="params">(Size src_size, Matx33f M, <span class="type">bool</span> inverse_map, Mat&amp; xmap, Mat&amp; ymap)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> width = src_size.width;</span><br><span class="line">    <span class="type">int</span> height = src_size.height;</span><br><span class="line">    </span><br><span class="line">    xmap.<span class="built_in">create</span>(height, width, CV_32F);</span><br><span class="line">    ymap.<span class="built_in">create</span>(height, width, CV_32F);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> y = <span class="number">0</span>; y &lt; height; y++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">0</span>; x &lt; width; x++) &#123;</span><br><span class="line">            Vec3f src_pt = <span class="built_in">Vec3f</span>(x, y, <span class="number">1</span>); <span class="comment">// Source point</span></span><br><span class="line">            Vec3f dst_pt = M * src_pt;      <span class="comment">// Apply transformation matrix</span></span><br><span class="line"></span><br><span class="line">            <span class="type">float</span> map_x, map_y;</span><br><span class="line">            <span class="keyword">if</span> (!inverse_map) &#123;</span><br><span class="line">                map_x = dst_pt[<span class="number">0</span>] / dst_pt[<span class="number">2</span>];</span><br><span class="line">                map_y = dst_pt[<span class="number">1</span>] / dst_pt[<span class="number">2</span>];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                map_x = src_pt[<span class="number">0</span>] - dst_pt[<span class="number">0</span>];</span><br><span class="line">                map_y = src_pt[<span class="number">1</span>] - dst_pt[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            xmap.<span class="built_in">at</span>&lt;<span class="type">float</span>&gt;(y, x) = map_x;</span><br><span class="line">            ymap.<span class="built_in">at</span>&lt;<span class="type">float</span>&gt;(y, x) = map_y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个伪代码实现描述了 <code>buildWarpPerspectiveMaps</code> 函数的大致操作步骤。实际的 <code>buildWarpPerspectiveMaps</code> 函数是 OpenCV 中用于构建透视变换映射的函数，具体实现会更加复杂并且包含了更多细节。如果你需要实际的代码实现，建议查阅 OpenCV 的源代码或者官方文档中提供的具体函数实现。希望这个简要描述能够帮助到你，如果有其他问题或者需要更多帮助，请随时告诉我。</p><h3 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h3><ul><li>输入图像src不能为空。</li><li>输入图像src的深度必须为CV_8U或CV_32F。</li><li>变换矩阵M必须为一个3x3矩阵。</li><li>warpPerspective函数实现了透视变换的核心逻辑，通过构建变换矩阵并利用remap函数实现对图像的透视变换操作。</li></ul><p>如果你有任何关于这段代码的疑问或需要进一步解释，请随时告诉我。</p><p>@brief Applies a perspective transformation to an image.</p><p>The function warpPerspective transforms the source image using the specified matrix:</p><p>  [$\texttt{dst} (x,y) &#x3D;  \texttt{src} \left ( \frac{M_{11} x + M_{12} y + M_{13}}{M_{31} x + M_{32} y + M_{33}} ,<br>     \frac{M_{21} x + M_{22} y + M_{23}}{M_{31} x + M_{32} y + M_{33}} \right )$] </p><p>when the flag #WARP_INVERSE_MAP is set. Otherwise, the transformation is first inverted with invert<br>and then put in the formula above instead of M. The function cannot operate in-place.</p><p>@param src input image.<br>@param dst output image that has the size dsize and the same type as src .<br>@param M  $ 3\times 3 $ transformation matrix.<br>@param dsize size of the output image.<br>@param flags combination of interpolation methods (#INTER_LINEAR or #INTER_NEAREST) and the<br>optional flag #WARP_INVERSE_MAP, that sets M as the inverse transformation (<br>$\texttt{dst}\rightarrow\texttt{src} $ ).<br>@param borderMode pixel extrapolation method (#BORDER_CONSTANT or #BORDER_REPLICATE).<br>@param borderValue value used in case of a constant border; by default, it equals 0.</p><p>@sa  warpAffine, resize, remap, getRectSubPix, perspectiveTransform</p>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 智能车 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逆透视</title>
      <link href="/2024/04/27/%E9%80%86%E9%80%8F%E8%A7%86/"/>
      <url>/2024/04/27/%E9%80%86%E9%80%8F%E8%A7%86/</url>
      
        <content type="html"><![CDATA[<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @brief IPM初始化</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param origSize 输入原始图像Size</span></span><br><span class="line"><span class="comment">     * @param dstSize 输出图像Size</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">const</span> cv::Size &amp;origSize, <span class="type">const</span> cv::Size &amp;dstSize)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 原始域：分辨率320x240</span></span><br><span class="line">        <span class="comment">// The 4-points at the input image</span></span><br><span class="line">        m_origPoints.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="comment">// [第二版无带畸变镜头参数]</span></span><br><span class="line">        m_origPoints.<span class="built_in">push_back</span>(<span class="built_in">Point2f</span>(<span class="number">0</span>, <span class="number">214</span>));   <span class="comment">// 左下</span></span><br><span class="line">        m_origPoints.<span class="built_in">push_back</span>(<span class="built_in">Point2f</span>(<span class="number">319</span>, <span class="number">214</span>)); <span class="comment">// 右下</span></span><br><span class="line">        m_origPoints.<span class="built_in">push_back</span>(<span class="built_in">Point2f</span>(<span class="number">192</span>, <span class="number">0</span>));   <span class="comment">// 右上</span></span><br><span class="line">        m_origPoints.<span class="built_in">push_back</span>(<span class="built_in">Point2f</span>(<span class="number">128</span>, <span class="number">0</span>));   <span class="comment">// 左上</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 矫正域：分辨率320x240</span></span><br><span class="line">        <span class="comment">// The 4-points correspondences in the destination image</span></span><br><span class="line">        m_dstPoints.<span class="built_in">clear</span>();</span><br><span class="line">        m_dstPoints.<span class="built_in">push_back</span>(<span class="built_in">Point2f</span>(<span class="number">100</span>, <span class="number">400</span>)); <span class="comment">// 左下</span></span><br><span class="line">        m_dstPoints.<span class="built_in">push_back</span>(<span class="built_in">Point2f</span>(<span class="number">220</span>, <span class="number">400</span>)); <span class="comment">// 右下</span></span><br><span class="line">        m_dstPoints.<span class="built_in">push_back</span>(<span class="built_in">Point2f</span>(<span class="number">220</span>, <span class="number">0</span>));   <span class="comment">// 右上</span></span><br><span class="line">        m_dstPoints.<span class="built_in">push_back</span>(<span class="built_in">Point2f</span>(<span class="number">100</span>, <span class="number">0</span>));   <span class="comment">// 左上</span></span><br><span class="line"></span><br><span class="line">        m_origSize = origSize;</span><br><span class="line">        m_dstSize = dstSize;</span><br><span class="line">        <span class="built_in">assert</span>(m_origPoints.<span class="built_in">size</span>() == <span class="number">4</span> &amp;&amp; m_dstPoints.<span class="built_in">size</span>() == <span class="number">4</span> &amp;&amp; <span class="string">&quot;Orig. points and Dst. points must vectors of 4 points&quot;</span>);</span><br><span class="line">        m_H = <span class="built_in">getPerspectiveTransform</span>(m_origPoints, m_dstPoints); <span class="comment">// 计算变换矩阵 [3x3]</span></span><br><span class="line">        m_H_inv = m_H.<span class="built_in">inv</span>();                                      <span class="comment">// 求解逆转换矩阵</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">createMaps</span>();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ol><li><p><code>void init(const cv::Size &amp;origSize, const cv::Size &amp;dstSize)</code>: 这是一个名为<code>init</code>的函数，它接受两个参数<code>origSize</code>和<code>dstSize</code>，这两个参数是OpenCV库中的<code>cv::Size</code>类型，用来表示图像的尺寸。</p></li><li><p><code>m_origPoints.clear();</code>: 清空存储原始域点坐标的容器<code>m_origPoints</code>。</p></li><li><p><code>m_origPoints.push_back(Point2f(0, 214));</code>: 将<code>(0, 214)</code>点坐标添加到原始域的点坐标集合中，代表原始图像的左下角。</p></li><li><p>依次类推，将原始域的四个角的点坐标添加到<code>m_origPoints</code>中，依次是左下、右下、右上和左上。</p></li><li><p><code>m_dstPoints.clear();</code>: 清空存储矫正域点坐标的容器<code>m_dstPoints</code>。</p></li><li><p><code>m_dstPoints.push_back(Point2f(100, 400));</code>: 将<code>(100, 400)</code>点坐标添加到矫正域的点坐标集合中，代表矫正图像的左下角。</p></li><li><p>依次类推，将矫正域的四个角的点坐标添加到<code>m_dstPoints</code>中，依次是左下、右下、右上和左上。</p></li><li><p><code>m_origSize = origSize;</code>和<code>m_dstSize = dstSize;</code>: 将原始图像尺寸和目标图像尺寸保存下来。</p></li><li><p><code>assert(m_origPoints.size() == 4 &amp;&amp; m_dstPoints.size() == 4 &amp;&amp; &quot;Orig. points and Dst. points must vectors of 4 points&quot;);</code>: 使用<code>assert</code>断言来确保原始域和矫正域的点坐标集合都包含四个点。</p></li><li><p><code>m_H = getPerspectiveTransform(m_origPoints, m_dstPoints);</code>: 通过原始域和矫正域的点坐标计算透视变换矩阵<code>m_H</code>。</p></li><li><p><code>m_H_inv = m_H.inv();</code>: 求解透视变换矩阵<code>m_H</code>的逆矩阵，存储在<code>m_H_inv</code>中。</p></li><li><p><code>createMaps();</code>: 调用<code>createMaps</code>函数，创建地图。</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 智能车 </tag>
            
            <tag> 图像处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据集标注json转xml脚本</title>
      <link href="/2024/04/26/%E6%95%B0%E6%8D%AE%E9%9B%86%E6%A0%87%E6%B3%A8json%E8%BD%ACxml%E8%84%9A%E6%9C%AC/"/>
      <url>/2024/04/26/%E6%95%B0%E6%8D%AE%E9%9B%86%E6%A0%87%E6%B3%A8json%E8%BD%ACxml%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_json_to_xml</span>(<span class="params">json_data</span>):</span><br><span class="line">    root = ET.Element(<span class="string">&quot;annotation&quot;</span>)</span><br><span class="line">    filename = ET.SubElement(root, <span class="string">&quot;filename&quot;</span>)</span><br><span class="line">    filename.text = json_data[<span class="string">&quot;imagePath&quot;</span>]</span><br><span class="line">    object_num = ET.SubElement(root, <span class="string">&quot;object_num&quot;</span>)</span><br><span class="line">    object_num.text = <span class="built_in">str</span>(<span class="built_in">len</span>(json_data[<span class="string">&quot;shapes&quot;</span>]))</span><br><span class="line">    size = ET.SubElement(root, <span class="string">&quot;size&quot;</span>)</span><br><span class="line">    width = ET.SubElement(size, <span class="string">&quot;width&quot;</span>)</span><br><span class="line">    width.text = <span class="built_in">str</span>(json_data[<span class="string">&quot;imageWidth&quot;</span>])</span><br><span class="line">    height = ET.SubElement(size, <span class="string">&quot;height&quot;</span>)</span><br><span class="line">    height.text = <span class="built_in">str</span>(json_data[<span class="string">&quot;imageHeight&quot;</span>])</span><br><span class="line">    <span class="keyword">for</span> shape <span class="keyword">in</span> json_data[<span class="string">&quot;shapes&quot;</span>]:</span><br><span class="line">        object_element = ET.SubElement(root, <span class="string">&quot;object&quot;</span>)</span><br><span class="line">        name = ET.SubElement(object_element, <span class="string">&quot;name&quot;</span>)</span><br><span class="line">        name.text = shape[<span class="string">&quot;label&quot;</span>]</span><br><span class="line">        difficult = ET.SubElement(object_element, <span class="string">&quot;difficult&quot;</span>)</span><br><span class="line">        difficult.text = <span class="string">&quot;0&quot;</span></span><br><span class="line">        bndbox = ET.SubElement(object_element, <span class="string">&quot;bndbox&quot;</span>)</span><br><span class="line">        xmin = ET.SubElement(bndbox, <span class="string">&quot;xmin&quot;</span>)</span><br><span class="line">        xmin.text = <span class="built_in">str</span>(<span class="built_in">int</span>(shape[<span class="string">&quot;points&quot;</span>][<span class="number">0</span>][<span class="number">0</span>]))</span><br><span class="line">        ymin = ET.SubElement(bndbox, <span class="string">&quot;ymin&quot;</span>)</span><br><span class="line">        ymin.text = <span class="built_in">str</span>(<span class="built_in">int</span>(shape[<span class="string">&quot;points&quot;</span>][<span class="number">0</span>][<span class="number">1</span>]))</span><br><span class="line">        xmax = ET.SubElement(bndbox, <span class="string">&quot;xmax&quot;</span>)</span><br><span class="line">        xmax.text = <span class="built_in">str</span>(<span class="built_in">int</span>(shape[<span class="string">&quot;points&quot;</span>][<span class="number">1</span>][<span class="number">0</span>]))</span><br><span class="line">        ymax = ET.SubElement(bndbox, <span class="string">&quot;ymax&quot;</span>)</span><br><span class="line">        ymax.text = <span class="built_in">str</span>(<span class="built_in">int</span>(shape[<span class="string">&quot;points&quot;</span>][<span class="number">1</span>][<span class="number">1</span>]))</span><br><span class="line">    <span class="keyword">return</span> ET.tostring(root, encoding=<span class="string">&quot;unicode&quot;</span>)</span><br><span class="line">current_dir = os.getcwd()</span><br><span class="line">parent_dir = os.path.abspath(os.path.join(current_dir, os.pardir))</span><br><span class="line">output_dir = os.path.join(parent_dir, <span class="string">&quot;xml_output&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(output_dir):</span><br><span class="line">    os.makedirs(output_dir)</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(current_dir):</span><br><span class="line">    <span class="keyword">if</span> file.endswith(<span class="string">&quot;.json&quot;</span>):</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(current_dir, file), <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> json_file:</span><br><span class="line">            json_data = json.load(json_file)</span><br><span class="line">            xml_data = convert_json_to_xml(json_data)</span><br><span class="line">            xml_filename = file.replace(<span class="string">&quot;.json&quot;</span>, <span class="string">&quot;.xml&quot;</span>)</span><br><span class="line">            output_path = os.path.join(output_dir, xml_filename)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> xml_file:</span><br><span class="line">                xml_file.write(xml_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;所有JSON文件已经转换为XML并保存在文件夹 xml_output 中&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> python </tag>
            
            <tag> 数据集 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>无人驾驶汽车系统入门（一）卡尔曼滤波与目标追踪</title>
      <link href="/2024/04/25/%E6%97%A0%E4%BA%BA%E9%A9%BE%E9%A9%B6%E6%B1%BD%E8%BD%A6%E7%B3%BB%E7%BB%9F%E5%85%A5%E9%97%A8%EF%BC%88%E4%B8%80%EF%BC%89%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2%E4%B8%8E%E7%9B%AE%E6%A0%87%E8%BF%BD%E8%B8%AA/"/>
      <url>/2024/04/25/%E6%97%A0%E4%BA%BA%E9%A9%BE%E9%A9%B6%E6%B1%BD%E8%BD%A6%E7%B3%BB%E7%BB%9F%E5%85%A5%E9%97%A8%EF%BC%88%E4%B8%80%EF%BC%89%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2%E4%B8%8E%E7%9B%AE%E6%A0%87%E8%BF%BD%E8%B8%AA/</url>
      
        <content type="html"><![CDATA[<div class="tagLink"><a class="link-card" title="卡尔曼滤波教程" href="https://www.kalmanfilter.net/CN/background_cn.html"><span class="link-card-backdrop" style="background-image: url(https://www.kalmanfilter.net/img/profile.png)"></span><div class="left"><img src="https://www.kalmanfilter.net/img/profile.png" class="lazyload placeholder" data-srcset="https://www.kalmanfilter.net/img/profile.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">卡尔曼滤波教程</p><p class="url">https://www.kalmanfilter.net/CN/background_cn.html</p></div></a></div><div class="tagLink"><a class="link-card" title="一个例子搞清楚（先验分布/后验分布/似然估计）" href="https://blog.csdn.net/qq_23947237/article/details/78265026"><span class="link-card-backdrop" style="background-image: url(https://img-blog.csdn.net/20171021161006627?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjM5NDcyMzc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)"></span><div class="left"><img src="https://img-blog.csdn.net/20171021161006627?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjM5NDcyMzc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" class="lazyload placeholder" data-srcset="https://img-blog.csdn.net/20171021161006627?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjM5NDcyMzc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">一个例子搞清楚（先验分布/后验分布/似然估计）</p><p class="url">https://blog.csdn.net/qq_23947237/article/details/78265026</p></div></a></div><p>在贝叶斯推断中，后验分布与先验分布和似然之间存在一种重要的关系，即后验分布正比于先验分布乘以似然。这种关系可以通过贝叶斯定理来进行推导和解释。</p><h3 id="贝叶斯定理："><a href="#贝叶斯定理：" class="headerlink" title="贝叶斯定理："></a>贝叶斯定理：</h3><p>贝叶斯定理描述了在观测到数据 $( D ) $后，参数 $( \theta )$ 的后验概率如何根据先验概率 $( P(\theta) )$ 和似然性函数 $( P(D|\theta) )$ 来更新。表达式如下：<br>$[ P(\theta|D) &#x3D; \frac{P(D|\theta) \times P(\theta)}{P(D)} ]$</p><p>其中：</p><ul><li>$( P(\theta|D) )$ 是在给定观测数据 $( D )$ 后参数$ ( \theta )$ 的后验概率；</li><li>$( P(D|\theta) )$ 是在给定参数 $( \theta ) $的条件下观测数据 $( D )$ 的似然性；</li><li>$( P(\theta) )$ 是参数 $( \theta )$ 的先验概率；</li><li>$( P(D) )$ 是数据 $( D )$ 的边际概率。</li></ul><h3 id="后验分布正比于先验分布乘以似然："><a href="#后验分布正比于先验分布乘以似然：" class="headerlink" title="后验分布正比于先验分布乘以似然："></a>后验分布正比于先验分布乘以似然：</h3><p>从贝叶斯定理中可以得出后验分布正比于先验分布乘以似然的结论，表达式如下：<br>$[ P(\theta|D) \propto P(D|\theta) \times P(\theta) ]$</p><p>这意味着后验分布与先验分布乘以似然性函数之间存在比例关系。具体解释如下：</p><ul><li>先验分布 $( P(\theta) )$ 描述了在观测数据之前对参数 $( \theta )$ 的不确定性的初始估计；</li><li>似然性函数 $( P(D|\theta) ) $描述了在给定参数 $( \theta )$ 的情况下观测到数据 $( D )$ 的概率；</li><li>后验分布 $( P(\theta|D) )$ 结合了先验信息和新数据的信息，提供了在给定数据 $( D )$ 后对参数 $( \theta )$ 的更准确估计。</li></ul><p>通过这种关系，我们可以利用先验知识和观测到的数据来更新对参数的估计，从而更好地理解数据和进行推断。这种贝叶斯方法在处理不确定性和小样本数据时非常有用。</p><iframe src="//player.bilibili.com/player.html?aid=399758288&bvid=BV1zo4y1J76H&cid=1164008541&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p>卡尔曼滤波（Kalman Filter）是一种用于估计系统状态的数学算法，通过融合系统模型的预测信息和实际观测的测量信息，以优化对系统当前状态的估计。卡尔曼滤波算法的核心思想就是通过对系统状态的动态建模和不确定性的估计，来获得系统状态的最优估计。</p><p>具体来说，卡尔曼滤波通过以下步骤实现对当前状态的估计：</p><ol><li><p><strong>预测状态</strong>：首先根据系统的动态模型，利用系统的上一个状态值和系统的状态转移方程，预测系统的当前状态值。这一步是基于系统的内在规律进行的状态预测，不考虑观测值。</p></li><li><p><strong>更新状态</strong>：接着，卡尔曼滤波考虑到当前的测量值，即观测到的系统状态值。通过比较实际观测值和预测状态值之间的差异，结合系统的测量方程和协方差矩阵，更新对系统当前状态的估计。这一步可以理解为根据测量结果对系统状态进行修正和优化，同时考虑到测量误差和系统动态的不确定性。</p></li><li><p><strong>状态更新</strong>：经过预测和更新之后，卡尔曼滤波会根据预测和更新的结果来更新系统的状态估计和状态的不确定性，然后循环迭代这些步骤以获得对系统状态的连续估计。</p></li></ol><p>总的来说，卡尔曼滤波算法充分利用了系统动态模型和传感器测量信息，通过预测和更新的步骤来获得对系统状态的最优估计。通过同时考虑上一个状态值和当前的测量值，卡尔曼滤波能够有效地处理系统动态、测量误差和不确定性，从而提高对系统状态的估计精度。</p><h2 id="贝塞尔校正"><a href="#贝塞尔校正" class="headerlink" title="贝塞尔校正"></a>贝塞尔校正</h2><p>在高斯分布（正态分布）中，如果我们从总体分布中抽取一小部分样本来估计总体的方差，通常情况下样本方差会低估总体方差。这种现象的原因主要是由于样本抽取的局限性和高斯分布概率密度函数的形状所导致的。</p><p>当我们从高斯分布中抽取样本时，由于高斯分布的中心值（均值）具有更高的概率密度，大部分样本会集中在均值附近，而在分布的尾部（边沿）位置上，样本数量相对较少。因此，如果我们只从高斯分布的中心值附近抽取样本来估计总体方差，由于未能很好地覆盖整个分布，很可能会导致总体方差的低估。</p><p>样本方差的计算是基于样本数据与样本均值之间的差异来衡量的。当样本主要集中在总体分布的中心值附近时，部分样本与样本均值之间的差异相对较小，导致样本方差的计算结果较小。而总体的方差是考虑了整个分布范围内数据点与总体均值之间的差异（包括边缘值），因此总体方差通常会大于样本方差。</p><p>因此，由于样本主要集中在高斯分布的中心值附近且样本数量有限，使用这部分样本来估计总体的方差往往会低估总体方差。为了更准确地估计总体方差，可以考虑增加样本数量、在整个分布范围内均匀抽样或者使用更复杂的统计方法来处理这种情况。</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2obbpl0e33.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2obbpl0e33.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;卡尔曼滤波器教程&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</p><h2 id="k阶原点矩和k阶中心矩"><a href="#k阶原点矩和k阶中心矩" class="headerlink" title="k阶原点矩和k阶中心矩"></a>k阶原点矩和k阶中心矩</h2><p>在统计学中，k阶原点矩和k阶中心矩是用于描述概率分布特性的概念。</p><ol><li><p>k阶原点矩：<br>对于一个随机变量X，它的k阶原点矩表示为μ_k &#x3D; E(X^k)，即该随机变量的k次幂的期望值。换句话说，k阶原点矩描述了随机变量X在k次幂上的平均值。</p></li><li><p>k阶中心矩：<br>对于一个随机变量X，它的k阶中心矩表示为μ’_k &#x3D; E[(X - μ)^k]，其中μ为随机变量X的期望值（均值）。k阶中心矩是指将随机变量X减去其均值后再取k次幂的期望。换句话说，k阶中心矩描述了随机变量X关于均值的k次幂的期望值。</p></li></ol><p>关于k阶原点矩和k阶中心矩的一些关键点：</p><ul><li>k阶原点矩包含数据的绝对信息，而k阶中心矩包含数据的相对信息。</li><li>一阶中心矩始终为0，因为它表示随机变量减去自身的均值，结果必然为0。</li><li>二阶中心矩是方差的平方根，用于衡量数据的离散程度。</li><li>三阶中心矩是偏度，用于衡量分布的对称性。</li><li>四阶中心矩是峰度，用于衡量分布的尖峭程度或平坦度。</li></ul><p>总的来说，k阶原点矩和k阶中心矩是用于深入了解随机变量数据分布特性的重要统计量。它们提供了关于数据的高阶统计信息，能够帮助我们更全面地理解随机变量的性质和行为。</p><h2 id="准度和精度"><a href="#准度和精度" class="headerlink" title="准度和精度"></a>准度和精度</h2><p>准度和精度是两个经常在科学与工程领域中使用的概念，它们表示了测量结果或数据的质量，但在含义上有所不同。</p><ol><li><p>准度（Accuracy）：<br>准度指的是测量结果或数据与真实数值之间的偏差程度，即测量结果的接近程度。如果测量结果与真实数值非常接近，则认为该测量是准确的，具有高准度。准度通常用误差或偏差来表示，可以是系统性的（偏差恒定）或随机性的（随机误差）。在实际应用中，准度的提高意味着更接近真实值的测量结果，即更少的误差。</p></li><li><p>精度（Precision）：<br>精度指的是多次测量所得结果之间的一致性或重复性，即测量结果的稳定程度。如果多次测量所得结果非常接近，可以认为该测量是精确的，具有高精度。精度通常用标准偏差或方差来描述，用来衡量测量数据的离散程度。在实际应用中，精度的提高意味着测量结果之间的一致性更高，即数据更加稳定。</p></li></ol><p>区别总结：</p><ul><li>准度强调测量结果与真实值之间的接近程度，而精度强调多次测量结果之间的一致性。</li><li>准度涉及测量结果的准确程度，精度涉及测量结果的稳定程度。</li><li>提高准度意味着减少与真实值的差距，而提高精度意味着增加测量结果之间的一致性。</li></ul><p>在实际应用中，准确度和精度通常需要平衡考虑。一个测量既要准确地表达真实值，又要具有重复性和一致性，这样才能提供可靠的数据支持科学研究、工程设计等领域的决策和判断。</p><h2 id="α−β−γ滤波器和卡尔曼滤波器的联系和区别"><a href="#α−β−γ滤波器和卡尔曼滤波器的联系和区别" class="headerlink" title="α−β−γ滤波器和卡尔曼滤波器的联系和区别"></a>α−β−γ滤波器和卡尔曼滤波器的联系和区别</h2><p>α-β-γ滤波器和卡尔曼滤波器都是用于估计系统状态的滤波器，它们有一些联系和区别：</p><ol><li><p>联系：</p><ul><li>两者都是常用的滤波器算法，用于估计系统的状态，并对传感器数据进行平滑处理。</li><li>在一定程度上，α-β-γ滤波器可以看作是卡尔曼滤波器的一种简化版本，适用于一些简单的系统。</li></ul></li><li><p>区别：</p><ul><li>卡尔曼滤波器是一种基于状态空间模型的递归滤波器，可以处理具有高斯噪声的动态系统。它通过状态估计和误差协方差估计来最优地结合先验信息和测量数据。相比之下，α-β-γ滤波器是一种更简单的滤波器，通常用于低成本的应用和对计算资源要求较低的场景。</li><li>在单个维度上，α-β-γ滤波器可用于对加速度数据进行滤波和平滑处理，而卡尔曼滤波器更常用于多维度状态估计，例如跟踪移动目标。</li><li>卡尔曼滤波器在处理非线性系统和非高斯噪声时效果更好，因为它能够自适应地调整协方差矩阵。而α-β-γ滤波器则更适用于线性系统或高斯噪声的情况。</li></ul></li></ol><p>总的来说，卡尔曼滤波器是一种更加通用和灵活的滤波器算法，适用于较为复杂的系统状态估计问题，而α-β-γ滤波器则是一种简单的滤波器算法，适用于一些简单的系统平滑处理任务。选择哪种滤波器取决于具体的应用场景和系统要求。</p><h2 id="卡尔曼滤波"><a href="#卡尔曼滤波" class="headerlink" title="卡尔曼滤波"></a>卡尔曼滤波</h2><p><strong>Q:</strong><br>卡尔曼滤波是根据上一次的值得出的这一次的预测值和这一次的测量值这两个值加权求得的值吗<br><strong>A:</strong><br>卡尔曼滤波是一种用于估计系统状态的强大技术，确实涉及到对上一次状态的估计值、当前时刻的测量值和预测值进行加权平均。在卡尔曼滤波中，系统状态被表示为一个含有状态变量的向量，而系统的动态行为通常由一组线性动态方程和一组线性测量方程描述。</p><p>在每个时间步，卡尔曼滤波器执行以下两个主要步骤：</p><ol><li><p><strong>预测步骤（Predict）</strong>：基于上一次的状态估计以及系统动态方程，预测系统的当前状态。这一预测考虑了上一次的状态估计和系统行为模型，产生一个预测的状态和协方差估计。</p></li><li><p><strong>更新步骤（Update）</strong>：将预测的状态与当前的测量值进行比较，根据二者的关系来修正预测状态，得到更准确的状态估计。这一步骤涉及卡尔曼增益的计算，以确保预测状态和测量状态之间的加权平均。</p></li></ol><p>因此，在卡尔曼滤波中，通过将上一次的状态估计、当前时刻的预测值和测量值进行合理的加权组合，可以更好地估计系统的真实状态，并对噪声进行有效抑制。整个过程通过不断迭代预测和更新步骤，逐渐提高状态估计的准确性。</p>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 智能车 </tag>
            
            <tag> 无人驾驶 </tag>
            
            <tag> 概率论 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蓝桥杯嵌入式客观题笔记</title>
      <link href="/2024/03/30/%E8%93%9D%E6%A1%A5%E6%9D%AF%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%AE%A2%E8%A7%82%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/03/30/%E8%93%9D%E6%A1%A5%E6%9D%AF%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%AE%A2%E8%A7%82%E9%A2%98%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<details open><summary pointer> 时序逻辑电路 </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8hg8xhmilq.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8hg8xhmilq.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p><strong>时序逻辑电路:</strong><br>计数器<br>分频器<br>触发器<br>积分器<br>移位寄存器<br>时序比较器<br><strong>组合逻辑电路:</strong><br>逻辑门<br>译码器<br>编码器<br>多路选择器<br>加法器<br>比较器<br>数字比例调节器</p>              </div>            </details><details open><summary pointer> 减法计数器 </summary>              <div class='content'>              <p>一个 8位二进制减法计数器， 初始状态为 00000000， 问经过 268个输入脉冲后， 此计数器的状态为 ______。<br>A.11001111<br>B.11110100<br>C.11110010<br>D.11110011<br>答案：B<br>解析：8位二进制数计数2^8 &#x3D; 256次后回到00000000，还剩268-256&#x3D;12次计数，计数1次后从“00000000”减为“11111111”，此后再减11（00001011），得到11110100，选B。<br>1111 1111<br>– 0000 1011<br>1111 0100</p>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式 </tag>
            
            <tag> stm32 </tag>
            
            <tag> 蓝桥杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>摄像头考核</title>
      <link href="/2024/03/25/%E6%91%84%E5%83%8F%E5%A4%B4%E8%80%83%E6%A0%B8/"/>
      <url>/2024/03/25/%E6%91%84%E5%83%8F%E5%A4%B4%E8%80%83%E6%A0%B8/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 智能车 </tag>
            
            <tag> 图像处理 </tag>
            
            <tag> OpenCV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>图像处理笔记（二）灰度变换和空间滤波基础</title>
      <link href="/2024/03/25/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E7%81%B0%E5%BA%A6%E5%8F%98%E6%8D%A2%E5%92%8C%E7%A9%BA%E9%97%B4%E6%BB%A4%E6%B3%A2%E5%9F%BA%E7%A1%80/"/>
      <url>/2024/03/25/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E7%81%B0%E5%BA%A6%E5%8F%98%E6%8D%A2%E5%92%8C%E7%A9%BA%E9%97%B4%E6%BB%A4%E6%B3%A2%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h2 id="灰度变换和空间滤波基础"><a href="#灰度变换和空间滤波基础" class="headerlink" title="灰度变换和空间滤波基础"></a>灰度变换和空间滤波基础</h2><h3 id="灰度变换（灰度反转，对数变换，幂律变换）"><a href="#灰度变换（灰度反转，对数变换，幂律变换）" class="headerlink" title="灰度变换（灰度反转，对数变换，幂律变换）"></a>灰度变换（灰度反转，对数变换，幂律变换）</h3><h4 id="灰度变换原理"><a href="#灰度变换原理" class="headerlink" title="灰度变换原理"></a>灰度变换原理</h4><p>变换原理：通过变换函数T将原图像像素灰度值r映射为灰度值s：</p><p>$s&#x3D;T(r)$</p><h4 id="灰度反转"><a href="#灰度反转" class="headerlink" title="灰度反转"></a>灰度反转</h4><h5 id="原理"><a href="#原理" class="headerlink" title="原理:"></a>原理:</h5><p>灰度反转：将图像亮暗对调，可以增强图像中暗色区域细节<br>$s&#x3D;T(r)&#x3D;L-1-r$<br>其中L为图像灰度级，0~255灰度图像的灰度级为256.</p><h5 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">Mat image1, output_image, image1_gray;   <span class="comment">//定义输入图像，输出图像，灰度图像</span></span><br><span class="line">image1 = imread(<span class="string">&quot;fire.jpg&quot;</span>);  <span class="comment">//读取图像；</span></span><br><span class="line"><span class="keyword">if</span> (image1.empty())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;读取错误&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cvtColor(image1, image1_gray, COLOR_BGR2GRAY);  <span class="comment">//灰度化</span></span><br><span class="line">imshow(<span class="string">&quot; image1_gray&quot;</span>, image1_gray);   <span class="comment">//显示灰度图像</span></span><br><span class="line"></span><br><span class="line">output_image = image1_gray.clone();</span><br><span class="line"><span class="comment">//遍历像素点</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; image1_gray.rows; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; image1_gray.cols; j++)</span><br><span class="line">&#123;</span><br><span class="line">output_image.at&lt;uchar&gt;(i, j) = <span class="number">255</span> - image1_gray.at&lt;uchar&gt;(i, j);  <span class="comment">//灰度反转</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">imshow(<span class="string">&quot;output_image&quot;</span>, output_image);  <span class="comment">//显示反转图像</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">waitKey(<span class="number">0</span>);  <span class="comment">//暂停，保持图像显示，等待按键结束</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>输出</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.lvht9o5v6.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.lvht9o5v6.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="对数变换"><a href="#对数变换" class="headerlink" title="对数变换"></a>对数变换</h4><h5 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h5><p>对数变换：扩展图像中的暗像素值，压缩高灰度值。<br>$s&#x3D;T(r)&#x3D;c*log(1+r)$<br>$log(1+r)$斜率逐渐降低，上升趋势逐渐放缓</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">Mat image1, output_image, image1_gray;   <span class="comment">//定义输入图像，输出图像，灰度图像</span></span><br><span class="line">image1 = imread(<span class="string">&quot;fire.jpg&quot;</span>);  <span class="comment">//读取图像；</span></span><br><span class="line"><span class="keyword">if</span> (image1.empty())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;读取错误&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cvtColor(image1, image1_gray, COLOR_BGR2GRAY);  <span class="comment">//灰度化</span></span><br><span class="line">imshow(<span class="string">&quot; image1_gray&quot;</span>, image1_gray);   <span class="comment">//显示灰度图像</span></span><br><span class="line"></span><br><span class="line">output_image = image1_gray.clone();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; image1_gray.rows; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; image1_gray.cols; j++)</span><br><span class="line">&#123;</span><br><span class="line">output_image.at&lt;uchar&gt;(i, j) = <span class="number">6</span> * <span class="built_in">log</span>((<span class="type">double</span>)(image1_gray.at&lt;uchar&gt;(i, j)) + <span class="number">1</span>);  <span class="comment">//对数变换 s=6*log(r+1)</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">normalize(output_image, output_image, <span class="number">0</span>, <span class="number">255</span>, NORM_MINMAX);  <span class="comment">//图像归一化，转到0~255范围内</span></span><br><span class="line">convertScaleAbs(output_image, output_image);  <span class="comment">//数据类型转换到CV_8U</span></span><br><span class="line">imshow(<span class="string">&quot; output_image&quot;</span>, output_image);  <span class="comment">//显示变换图像</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">waitKey(<span class="number">0</span>);  <span class="comment">//暂停，保持图像显示，等待按键结束</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>输出</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3uulpxj04i.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3uulpxj04i.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="幂律（伽马变换）"><a href="#幂律（伽马变换）" class="headerlink" title="幂律（伽马变换）"></a>幂律（伽马变换）</h4><h5 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h5><p>幂律变换与对数变换类似：<br>$s&#x3D;T(r)&#x3D;c*r^γ$</p><h5 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123; </span><br><span class="line">Mat image1, output_image, image1_gray;   <span class="comment">//定义输入图像，输出图像，灰度图像</span></span><br><span class="line">image1 = imread(<span class="string">&quot;lena.png&quot;</span>);  <span class="comment">//读取图像；</span></span><br><span class="line"><span class="keyword">if</span> (image1.empty())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;读取错误&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cvtColor(image1, image1_gray, COLOR_BGR2GRAY);  <span class="comment">//灰度化</span></span><br><span class="line">imshow(<span class="string">&quot; image1_gray&quot;</span>, image1_gray);   <span class="comment">//显示灰度图像</span></span><br><span class="line"></span><br><span class="line">output_image = image1_gray.clone();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; image1_gray.rows; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; image1_gray.cols; j++)</span><br><span class="line">&#123;</span><br><span class="line">output_image.at&lt;uchar&gt;(i, j) =<span class="number">6</span>*<span class="built_in">pow</span>((<span class="type">double</span>)image1_gray.at&lt;uchar&gt;(i, j),<span class="number">0.5</span>);  <span class="comment">//幂律变换 s=6*r^0.5</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">normalize(output_image, output_image, <span class="number">0</span>, <span class="number">255</span>, NORM_MINMAX);  <span class="comment">//图像归一化，转到0~255范围内</span></span><br><span class="line">convertScaleAbs(output_image, output_image);  <span class="comment">//数据类型转换到CV_8U</span></span><br><span class="line">imshow(<span class="string">&quot; output_image&quot;</span>, output_image);  <span class="comment">//显示变换图像</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">waitKey(<span class="number">0</span>);  <span class="comment">//暂停，保持图像显示，等待按键结束</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>输出</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2obahbyue1.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2obahbyue1.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="直方图处理（直方图均衡化，直方图匹配（规定化））"><a href="#直方图处理（直方图均衡化，直方图匹配（规定化））" class="headerlink" title="直方图处理（直方图均衡化，直方图匹配（规定化））"></a>直方图处理（直方图均衡化，直方图匹配（规定化））</h3><p>直方图显示了每个像素值在整幅图像中出现的频率或数量，从而帮助我们理解图像的亮度分布情况。</p><h4 id="图像直方图"><a href="#图像直方图" class="headerlink" title="图像直方图"></a>图像直方图</h4><p>非归一化直方图:<br>$h(r_k)&#x3D;n_k$<br>归一化直方图:<br>$p(r_k)&#x3D;{n_k \over MN}$<br>其中MN为图像行数和列数，常说的图像直方图就是归一化直方图。</p><p>获取图像直方图示例：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">Mat image, image_gray, hist;   <span class="comment">//定义输入图像，灰度图像, 直方图</span></span><br><span class="line">image = imread(<span class="string">&quot;fire.jpg&quot;</span>);  <span class="comment">//读取图像；</span></span><br><span class="line"><span class="keyword">if</span> (image.empty())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;读取错误&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cvtColor(image, image_gray, COLOR_BGR2GRAY);  <span class="comment">//灰度化</span></span><br><span class="line">imshow(<span class="string">&quot; image_gray&quot;</span>, image_gray);   <span class="comment">//显示灰度图像</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取图像直方图</span></span><br><span class="line"><span class="type">int</span> histsize = <span class="number">256</span>;</span><br><span class="line"><span class="type">float</span> ranges[] = &#123; <span class="number">0</span>,<span class="number">256</span> &#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">float</span>* histRanges = &#123; ranges &#125;;</span><br><span class="line">calcHist(&amp;image_gray, <span class="number">1</span>, <span class="number">0</span>, Mat(), hist, <span class="number">1</span>, &amp;histsize, &amp;histRanges, <span class="literal">true</span>, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure><p>这段代码用于计算图像的直方图，下面是对这段代码的详细解释：</p><ol><li><p><strong>histsize &#x3D; 256：</strong> 这里定义了直方图的大小为256，表示直方图的横轴范围，通常对应着图像可能的像素值范围（0到255）。</p></li><li><p><strong>ranges[] &#x3D; {0, 256}：</strong> 这里定义了直方图可能的像素值范围为0到256，用于指定直方图中每个像素值的范围。</p></li><li><p><em><em>const float</em> histRanges &#x3D; {ranges};</em>* 这一行用于将ranges数组转换为指向常量浮点数的指针，供calcHist函数使用。</p></li><li><p><strong>calcHist(&amp;image_gray, 1, 0, Mat(), hist, 1, &amp;histsize, &amp;histRanges, true, false)：</strong></p><ul><li><strong>&amp;image_gray：</strong> 这是输入的灰度图像，表示要计算直方图的原始图像。</li><li><strong>1：</strong> 表示要计算的图像数量。</li><li><strong>0：</strong> 表示直方图要计算的通道索引，0表示灰度图像。</li><li><strong>Mat()：</strong> 这里是一个掩码图像，用于指定要计算直方图的区域；在这里没有使用，因此为空。</li><li><strong>hist：</strong> 这是用于存储计算后直方图的Mat对象。</li><li><strong>1：</strong> 直方图的维数，对于灰度图像是1维。</li><li><strong>&amp;histsize：</strong> 这是包含直方图大小（256）的指针。</li><li><strong>&amp;histRanges：</strong> 指向直方图范围的指针。</li><li><strong>true：</strong> 指示直方图是否均一化，即在范围0到255内对直方图进行归一化处理。</li><li><strong>false：</strong> 指示直方图是否累积，即表示直方图是否累积计算。</li></ul></li></ol><p>通过这段代码，可以通过calcHist函数计算图像image_gray的直方图，并将结果存储在hist对象中。直方图的范围是0到255之间，且进行了归一化处理。这能够帮助我们了解图像的像素值分布情况，为后续的图像处理和分析提供数据支持。希望这个解释对您有帮助，如果您有任何其他问题，请随时告诉我！</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建直方图显示图像</span></span><br><span class="line"><span class="type">int</span> hist_h = <span class="number">300</span>;<span class="comment">//直方图的图像的高</span></span><br><span class="line"><span class="type">int</span> hist_w = <span class="number">512</span>; <span class="comment">//直方图的图像的宽</span></span><br><span class="line"><span class="type">int</span> bin_w = hist_w / histsize;<span class="comment">//直方图的等级</span></span><br><span class="line">Mat <span class="title function_">histImage</span><span class="params">(hist_h, hist_w, CV_8UC3, Scalar(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span>;<span class="comment">//绘制直方图显示的图像</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//绘制并显示直方图</span></span><br><span class="line">normalize(hist, hist, <span class="number">0</span>, hist_h, NORM_MINMAX, <span class="number">-1</span>, Mat());<span class="comment">//归一化直方图</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; histsize; i++)</span><br><span class="line">&#123;</span><br><span class="line">line(histImage, Point((i - <span class="number">1</span>) * bin_w, hist_h - cvRound(hist.at&lt;<span class="type">float</span>&gt;(i - <span class="number">1</span>))),</span><br><span class="line">Point((i)*bin_w, hist_h - cvRound(hist.at&lt;<span class="type">float</span>&gt;(i))), Scalar(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="number">2</span>, <span class="number">8</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">imshow(<span class="string">&quot;histImage&quot;</span>, histImage);</span><br><span class="line"></span><br><span class="line">waitKey(<span class="number">0</span>);  <span class="comment">//暂停，保持图像显示，等待按键结束</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码是用于将归一化后的直方图数据绘制成直方图图像的过程。下面是对代码的详细解释：</p><ol><li><p><strong><code>for</code>循环：</strong></p><ul><li>这段代码使用<code>for</code>循环遍历直方图的每个条，从第2个条开始到最后一个条。</li><li><code>i</code>从1开始，因为第0个条通常代表背景，可以跳过不绘制。</li></ul></li><li><p><strong><code>line()</code>函数：</strong></p><ul><li><code>line()</code>函数用于在<code>histImage</code>上绘制直方图的条。</li><li><code>Point((i - 1) * bin_w, hist_h - cvRound(hist.at&lt;float&gt;(i - 1)))</code>表示当前条的起始点位置，前一个条的结束点位置。</li><li><code>Point((i)*bin_w, hist_h - cvRound(hist.at&lt;float&gt;(i)))</code> 表示当前条的终点位置。</li><li><code>Scalar(255, 0, 0)</code>指定绘制直线的颜色为蓝色。</li><li><code>2</code>表示线的粗细为2个像素。</li><li><code>8</code>表示线的类型为8-connected。</li><li><code>0</code>表示线的偏移值为0。</li></ul></li><li><p><strong>绘制直方图条：</strong></p><ul><li>通过计算每个直方图条的起始和终止点，使用<code>line()</code>函数在<code>histImage</code>上绘制直方图条。</li><li><code>cvRound()</code>用于将浮点值四舍五入为最接近的整数，确保直方图能够正确映射到图像上。</li></ul></li></ol><h4 id="直方图均衡化"><a href="#直方图均衡化" class="headerlink" title="直方图均衡化"></a>直方图均衡化</h4><p>(我感觉差不多了，我去做考核咯~)</p>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 智能车 </tag>
            
            <tag> 图像处理 </tag>
            
            <tag> OpenCV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>图像处理笔记（一）基础操作</title>
      <link href="/2024/03/25/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AC%94%E8%AE%B0-1/"/>
      <url>/2024/03/25/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AC%94%E8%AE%B0-1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>前面一部分笔记都是学习一个大佬的教程做的，但是大佬用的python，我在笔记里都转换成了c++</p></blockquote><h2 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h2><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2kroj52zde.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2kroj52zde.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.pf3qismjr.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.pf3qismjr.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4g49bri91j.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4g49bri91j.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1set1eq2uf.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1set1eq2uf.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.58h4ti0gy2.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.58h4ti0gy2.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1hrz89c5f9.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1hrz89c5f9.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h2 id="图片基本读取操作"><a href="#图片基本读取操作" class="headerlink" title="图片基本读取操作"></a>图片基本读取操作</h2><p>电脑上的彩色图是以 RGB(红 - 绿-蓝，Red-Green-Blue) 颜色模式显示的，但 OpenCV 中彩色图是以 B-G-R 通道顺序存储的，灰度图只有一个通道。</p><p>图像坐标的起始点是在左上角，所以行对应的是 y，列对应的是 x：</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.54xivstf47.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.54xivstf47.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="加载图片"><a href="#加载图片" class="headerlink" title="加载图片"></a>加载图片</h3><blockquote><span class='pbg info'>imread()</span><blockquote><p><strong>两个参数:</strong></p><ul><li>参数 1：图片的文件名<br> 如果图片放在当前文件夹下，直接写文件名就行，如”lena.jpg”<br> 否则需要给出绝对路径，如”C:&#x2F;Users&#x2F;lxcqm&#x2F;Desktop&#x2F;图片和视频&#x2F;11111.png”</li><li>参数 2：读入方式，省略即采用默认值<br> cv2.IMREAD_COLOR：彩色图，默认值(1)or(IMREAD_COLOR)<br> cv2.IMREAD_GRAYSCALE：灰度图(0)or(IMREAD_GRAYSCALE)<br> cv2.IMREAD_UNCHANGED：包含透明通道的彩色图(-1)or(IMREAD_UNCHANGED)</li></ul></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载灰度图</span></span><br><span class="line">Mat  img = imread(<span class="string">&quot;C:/Users/lxcqm/Desktop/images/11111.png&quot;</span>,<span class="number">0</span>);</span><br></pre></td></tr></table></figure><blockquote><p>经验之谈：路径中不能有中文噢，并且没有加载成功的话是不会报错的，print(img)的结果为 None，后面处理才会报错，算是个小坑。</p></blockquote><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="显示图片"><a href="#显示图片" class="headerlink" title="显示图片"></a>显示图片</h2><p>使用<code>imshow()</code>显示图片，窗口会自适应图片的大小：</p><blockquote><p><code>imshow()</code></p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载灰度图</span></span><br><span class="line">Mat  img = imread(<span class="string">&quot;C:/Users/lxcqm/Desktop/images/11111.png&quot;</span>,<span class="number">0</span>);</span><br><span class="line">imshow(<span class="string">&quot;pic&quot;</span>, img);</span><br><span class="line">waitKey(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>参数 1 是窗口的名字，参数 2 是要显示的图片。不同窗口之间用窗口名区分，所以窗口名相同就表示是同一个窗口，显示结果如下：<br><strong>效果:</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.32hq7r8seh.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.32hq7r8seh.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><blockquote><p><code>waitKey()</code>是让程序暂停的意思，参数是等待时间（毫秒 ms）。<br>时间一到，会继续执行接下来的程序，传入 0 的话表示一直等待。等待期间也可以获取用户的按键输入：k &#x3D; waitKey(0)</p></blockquote><p>我们也可以先用<code>namedWindow()</code>创建一个窗口，之后再显示图片：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">namedWindow(<span class="string">&quot;pic2&quot;</span>, WINDOW_NORMAL);</span><br><span class="line">imshow(<span class="string">&quot;pic2&quot;</span>, img);</span><br><span class="line">waitKey(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>参数 1 依旧是窗口的名字，参数 2 默认是<code>WINDOW_AUTOSIZE</code>，表示窗口大小自适应图片，也可以设置为<code>WINDOW_NORMAL</code>，表示窗口大小可调整。图片比较大的时候，可以考虑用后者。</p><h3 id="保存图片"><a href="#保存图片" class="headerlink" title="保存图片"></a>保存图片</h3><blockquote><p><code>imwrite()</code></p></blockquote><p>使用<code>imwrite()</code>保存图片，参数 1 是包含后缀名的文件名：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imwrite(<span class="string">&quot;pictest.jpg&quot;</span>, img);</span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.sypoa1fpo.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.sypoa1fpo.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>会保存在目录文件夹里</p><h2 id="摄像头"><a href="#摄像头" class="headerlink" title="摄像头"></a>摄像头</h2><h3 id="打开摄像头"><a href="#打开摄像头" class="headerlink" title="打开摄像头"></a>打开摄像头</h3><p>要使用摄像头，需要使用<code>VideoCapture capture(0);</code>参数 <code>0</code> 指的是摄像头的编号，如果你电脑上有两个摄像头的话，访问第 2 个摄像头就可以传入 <code>1</code>，依此类推。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    VideoCapture <span class="title function_">capture</span><span class="params">(<span class="number">0</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!capture.isOpened()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        Mat frame;</span><br><span class="line">        <span class="comment">//&gt;&gt; 是输入流提取运算符</span></span><br><span class="line">        <span class="comment">// 它通常用于从输入流中提取数据并将其存储在相应的变量中</span></span><br><span class="line">        <span class="comment">// 表示从 capture 输入流中读取数据，并将其存储在 frame 变量中</span></span><br><span class="line">        capture &gt;&gt; frame;</span><br><span class="line"></span><br><span class="line">        Mat gray;</span><br><span class="line">        cvtColor(frame, gray, COLOR_BGR2GRAY);</span><br><span class="line"></span><br><span class="line">        imshow(<span class="string">&quot;frame&quot;</span>, gray);</span><br><span class="line">        <span class="keyword">if</span> (waitKey(<span class="number">1</span>) == <span class="string">&#x27;q&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>cv2.cvtColor()</code>用来转换颜色，这里将彩色图转成灰度图。<br>通过cap.get(propId)可以获取摄像头的一些属性，比如捕获的分辨率，亮度和对比度等。propId 是从 0~18 的数字，代表不同的属性，完整的属性列表可以参考：VideoCaptureProperties(<a href="https://docs.opencv.org/4.0.0/d4/d15/group__videoio__flags__base.html#gaeb8dd9c89c10a5c63c139bf7c4f5704d">https://docs.opencv.org/4.0.0/d4/d15/group__videoio__flags__base.html#gaeb8dd9c89c10a5c63c139bf7c4f5704d</a>)<br>也可以使用cap.set(propId,value)来修改属性值。比如说，我们在 while 之前添加下面的代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> width = capture.get(CAP_PROP_FRAME_WIDTH);</span><br><span class="line"><span class="type">double</span> height = capture.get(CAP_PROP_FRAME_HEIGHT);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Original width: &quot;</span> &lt;&lt; width &lt;&lt; <span class="string">&quot;, height: &quot;</span> &lt;&lt; height &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">capture.<span class="built_in">set</span>(CAP_PROP_FRAME_WIDTH, width * <span class="number">2</span>);</span><br><span class="line">capture.<span class="built_in">set</span>(CAP_PROP_FRAME_HEIGHT, height * <span class="number">2</span>);</span><br></pre></td></tr></table></figure><details open><summary pointer> std::cout << Original width: << width << </summary>              <div class='content'>              <p>这行代码使用了C++中的流输出操作符”&lt;&lt;”，它用于将数据插入到输出流中。在这个语句中：</p><ul><li><code>std::cout</code>: 是C++标准库中的标准输出流对象，用于将数据输出到控制台。</li><li><code>&quot;Original width: &quot;</code>、<code>width</code>、<code>&quot;, height: &quot;</code>、<code>height</code>、<code>std::endl</code> 都是要输出的具体内容。</li><li><code>&lt;&lt;</code>：是流输出操作符，用于将后面的内容插入到输出流中。</li></ul><p>所以，<code>std::cout &lt;&lt; &quot;Original width: &quot; &lt;&lt; width &lt;&lt; &quot;, height: &quot; &lt;&lt; height &lt;&lt; std::endl;</code> 这行代码的作用是将描述原始宽度和高度的字符串以及相应的变量值输出到控制台，并在最后换行。</p>              </div>            </details><p><strong>输出</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.86texdkg7l.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.86texdkg7l.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><blockquote><p>经验之谈：某些摄像头设定分辨率等参数时会无效，因为它有固定的分辨率大小支持，一般可在摄像头的资料页中找到。</p></blockquote><h3 id="播放本地视频"><a href="#播放本地视频" class="headerlink" title="播放本地视频"></a>播放本地视频</h3><p>跟打开摄像头一样，如果把摄像头的编号换成视频的路径就可以播放本地视频了。回想一下<code>waitKey()</code>，它的参数表示暂停时间，所以这个值越大，视频播放速度越慢，反之，播放速度越快，通常设置为 <code>25</code> 或 <code>30</code>。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/core/core.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/imgproc.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line">using namespace cv;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    VideoCapture <span class="title function_">capture</span><span class="params">(<span class="string">&quot;C:/Users/lxcqm/Desktop/WeChat_20240325194731.mp4&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!capture.isOpened()) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Error opening video file&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     Mat frame, gray;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!capture.read(frame)) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        cvtColor(frame, gray, COLOR_BGR2GRAY);</span><br><span class="line"></span><br><span class="line">        imshow(<span class="string">&quot;frame&quot;</span>, gray);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (waitKey(<span class="number">30</span>) == <span class="string">&#x27;q&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    capture.release();</span><br><span class="line">    destroyAllWindows();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="录制视频"><a href="#录制视频" class="headerlink" title="录制视频"></a>录制视频</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/core/core.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/imgproc.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line">using namespace cv;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    VideoCapture <span class="title function_">capture</span><span class="params">(<span class="number">0</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义编码方式并创建 VideoWriter 对象</span></span><br><span class="line">    VideoWriter <span class="title function_">outfile</span><span class="params">(<span class="string">&quot;output.avi&quot;</span>, VideoWriter::fourcc(<span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;G&#x27;</span>), <span class="number">25.</span>, Size(<span class="number">640</span>, <span class="number">480</span>))</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (capture.isOpened()) &#123;</span><br><span class="line">        Mat frame;</span><br><span class="line">        capture.read(frame);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!frame.empty()) &#123;</span><br><span class="line">            outfile.write(frame); <span class="comment">// 写入文件</span></span><br><span class="line">            imshow(<span class="string">&quot;frame&quot;</span>, frame);</span><br><span class="line">            <span class="keyword">if</span> (waitKey(<span class="number">1</span>) == <span class="string">&#x27;q&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><h3 id="Mat创建图像（矩阵）"><a href="#Mat创建图像（矩阵）" class="headerlink" title="Mat创建图像（矩阵）"></a>Mat创建图像（矩阵）</h3><h4 id="创建图像（矩阵）：Mat"><a href="#创建图像（矩阵）：Mat" class="headerlink" title="创建图像（矩阵）：Mat"></a>创建图像（矩阵）：Mat</h4><p>使用Mat创建图像（矩阵）的常用形式有：</p><ol><li><p>创建一个空图像，大小为0</p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mat image1;</span><br></pre></td></tr></table></figure></li><li><p>指定矩阵大小，指定数据类型：</p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mat <span class="title function_">image1</span><span class="params">(<span class="number">100</span>,<span class="number">100</span>,CV_8U)</span>;</span><br></pre></td></tr></table></figure><p> 参数:矩阵行数，矩阵列数，数据类型</p><p> 其中数据类型有很多种，常用的应该有：</p><p> CV_8U：8位无符号型（0~255），即灰度图像；</p><p> CV_8UC3：三通道8位无符号型，这里三通道指B（蓝）G（绿）R（红），与matlab中的RGB正好相反。</p><p> 这里创建矩阵时未指定矩阵的值，发现默认值的大小为205.</p></li><li><p>指定矩阵大小，指定数据类型，设置初始值：</p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mat <span class="title function_">image1</span><span class="params">(<span class="number">100</span>,<span class="number">100</span>,CV_8U, <span class="number">100</span>)</span>;</span><br></pre></td></tr></table></figure><p> 这里包含四个参数：矩阵行数，矩阵列数，数据类型，初始值；<br> 对于灰度图像：可以直接给出初始值，也可以使用Scalar（）；</p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> Mat <span class="title function_">image1</span><span class="params">(<span class="number">100</span>,<span class="number">100</span>,CV_8U, <span class="number">100</span>)</span>;</span><br><span class="line">Mat <span class="title function_">image1</span><span class="params">(<span class="number">100</span>,<span class="number">100</span>,CV_8U, Scalar(<span class="number">100</span>))</span>;<span class="comment">//Scalar:标量</span></span><br></pre></td></tr></table></figure><p> 对于三通道图像：使用Scalar（）；</p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mat <span class="title function_">image1</span><span class="params">(<span class="number">100</span>,<span class="number">100</span>,CV_8UC3, Scalar(<span class="number">100</span>,<span class="number">100</span>,<span class="number">100</span>))</span>;</span><br></pre></td></tr></table></figure></li></ol><h3 id="获取图像信息"><a href="#获取图像信息" class="headerlink" title="获取图像信息"></a>获取图像信息</h3><p>获取图像的宽度（列数），高度（行数），尺寸和通道数：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">Mat image1 = imread(<span class="string">&quot;lena.png&quot;</span>);  <span class="comment">//读取图像；</span></span><br><span class="line"><span class="keyword">if</span> (image1.empty())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;读取错误&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">imshow(<span class="string">&quot;image1&quot;</span>, image1);  <span class="comment">//显示图像；</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;图像的行数为： &quot;</span> &lt;&lt; image1.rows &lt;&lt; <span class="built_in">endl</span>;  <span class="comment">//获取图像的高度，行数；</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;图像的列数为： &quot;</span> &lt;&lt; image1.cols &lt;&lt; <span class="built_in">endl</span>;  <span class="comment">//获取图像的宽度，列数；</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;图像的通道数为： &quot;</span> &lt;&lt; image1.channels() &lt;&lt; <span class="built_in">endl</span>;  <span class="comment">//获取图像的通道数，彩色图=3，灰度图=1；</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;图像的尺寸为： &quot;</span> &lt;&lt; image1.size &lt;&lt; <span class="built_in">endl</span>;  <span class="comment">//获取图像的尺寸，行*列；</span></span><br><span class="line"></span><br><span class="line">waitKey(<span class="number">0</span>);  <span class="comment">//暂停，保持图像显示，等待按键结束</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>输出</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.64dm9cq5y1.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.64dm9cq5y1.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="感兴趣区域"><a href="#感兴趣区域" class="headerlink" title="感兴趣区域"></a>感兴趣区域</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">Mat image1 = imread(<span class="string">&quot;fire.jpg&quot;</span>);  <span class="comment">//读取图像；</span></span><br><span class="line"><span class="keyword">if</span> (image1.empty())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;读取错误&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">imshow(<span class="string">&quot;image1&quot;</span>, image1);  <span class="comment">//显示图像；</span></span><br><span class="line"></span><br><span class="line">Mat <span class="title function_">imageROI</span><span class="params">(image1, Rect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">10</span>))</span>;  <span class="comment">//定义感兴趣区域</span></span><br><span class="line"></span><br><span class="line">waitKey(<span class="number">0</span>);  <span class="comment">//暂停，保持图像显示，等待按键结束</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中Rect（）有四个参数，Rect（a,b,c,d）:</p><ul><li>a：感兴趣区域列(cols)的起点；</li><li>b：感兴趣区域行(rows)的起点；</li><li>c：感兴趣区域的列数(cols)；</li><li>d：感兴趣区域的行数(rows)；</li></ul><h3 id="通过鼠标点击操作获取图像的像素坐标和像素值"><a href="#通过鼠标点击操作获取图像的像素坐标和像素值" class="headerlink" title="通过鼠标点击操作获取图像的像素坐标和像素值"></a>通过鼠标点击操作获取图像的像素坐标和像素值</h3><h4 id="创建鼠标操作函数的头文件"><a href="#创建鼠标操作函数的头文件" class="headerlink" title="创建鼠标操作函数的头文件"></a>创建鼠标操作函数的头文件</h4><details open><summary pointer> onMouse.h </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">onMouse</span><span class="params">(<span class="type">int</span> event, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> flags, <span class="type">void</span>* param)</span>;  <span class="comment">//evnet:鼠标事件类型 x,y:鼠标坐标 flags：鼠标哪个键</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">onMouse</span><span class="params">(<span class="type">int</span> event, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> flags, <span class="type">void</span>* param)</span>  <span class="comment">//evnet:鼠标事件类型 x,y:鼠标坐标 flags：鼠标哪个键</span></span><br><span class="line">&#123;</span><br><span class="line">Mat* im = reinterpret_cast&lt;Mat*&gt;(param);</span><br><span class="line"><span class="keyword">switch</span> (event) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> EVENT_LBUTTONDOWN:</span><br><span class="line"><span class="comment">//显示图像像素值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (static_cast&lt;<span class="type">int</span>&gt;(im-&gt;channels()) == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//若图像为单通道图像，则显示鼠标点击的坐标以及灰度值</span></span><br><span class="line"><span class="keyword">switch</span> (im-&gt;type())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;at (&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot; ) value is: &quot;</span> &lt;&lt; static_cast&lt;<span class="type">int</span>&gt;(im-&gt;at&lt;uchar&gt;(Point(x, y))) &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;at (&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot; ) value is: &quot;</span> &lt;&lt; static_cast&lt;<span class="type">int</span>&gt;(im-&gt;at&lt;<span class="type">char</span>&gt;(Point(x, y))) &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;at (&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot; ) value is: &quot;</span> &lt;&lt; static_cast&lt;<span class="type">int</span>&gt;(im-&gt;at&lt;ushort&gt;(Point(x, y))) &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;at (&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot; ) value is: &quot;</span> &lt;&lt; static_cast&lt;<span class="type">int</span>&gt;(im-&gt;at&lt;<span class="type">short</span>&gt;(Point(x, y))) &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;at (&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot; ) value is: &quot;</span> &lt;&lt; static_cast&lt;<span class="type">int</span>&gt;(im-&gt;at&lt;<span class="type">int</span>&gt;(Point(x, y))) &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;at (&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot; ) value is: &quot;</span> &lt;&lt; static_cast&lt;<span class="type">int</span>&gt;(im-&gt;at&lt;<span class="type">float</span>&gt;(Point(x, y))) &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;at (&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot; ) value is: &quot;</span> &lt;&lt; static_cast&lt;<span class="type">int</span>&gt;(im-&gt;at&lt;<span class="type">double</span>&gt;(Point(x, y))) &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//若图像为彩色图像，则显示鼠标点击坐标以及对应的B, G, R值</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;at (&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot;)&quot;</span></span><br><span class="line">&lt;&lt; <span class="string">&quot;  B value is: &quot;</span> &lt;&lt; static_cast&lt;<span class="type">int</span>&gt;(im-&gt;at&lt;Vec3b&gt;(Point(x, y))[<span class="number">0</span>])</span><br><span class="line">&lt;&lt; <span class="string">&quot;  G value is: &quot;</span> &lt;&lt; static_cast&lt;<span class="type">int</span>&gt;(im-&gt;at&lt;Vec3b&gt;(Point(x, y))[<span class="number">1</span>])</span><br><span class="line">&lt;&lt; <span class="string">&quot;  R value is: &quot;</span> &lt;&lt; static_cast&lt;<span class="type">int</span>&gt;(im-&gt;at&lt;Vec3b&gt;(Point(x, y))[<span class="number">2</span>])</span><br><span class="line">&lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//setMouseCallback(&quot;image1&quot;, onMouse, reinterpret_cast&lt;void*&gt;(&amp;image1)); //关联图像显示窗口和onMouse函数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Mat每个格子内的数据格式---------- - Mat定义</span></span><br><span class="line"><span class="comment">//Mat_&lt;uchar&gt;-------- - CV_8U（0-255）</span></span><br><span class="line"><span class="comment">//Mat&lt;char&gt;---------- - CV_8S（-128-127）</span></span><br><span class="line"><span class="comment">//Nat_&lt;short&gt;-------- - CV_16S（-32768-32767）</span></span><br><span class="line"><span class="comment">//Mat_&lt;ushort&gt;--------CV_16U（0-65535）</span></span><br><span class="line"><span class="comment">//Mat_&lt;int&gt;---------- - CV_32S（-2147483648-2147483647）</span></span><br><span class="line"><span class="comment">//Mat_&lt;float&gt;----------CV_32F（-FLT_MAX…FLT_MAX，INF，NAN）</span></span><br><span class="line"><span class="comment">//Mat_&lt;double&gt;--------CV_64F（-DBL_MAX…DBL_MAX，INF，NAN）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Mat数据类型和通道对应的type()</span></span><br><span class="line"><span class="comment">//              C1          C2          C3          C4</span></span><br><span class="line"><span class="comment">//CV_8U         0           8           16          24</span></span><br><span class="line"><span class="comment">//CV_8S         1           9           17          25</span></span><br><span class="line"><span class="comment">//CV_16U        2          10           18          26</span></span><br><span class="line"><span class="comment">//CV_16S        3          11           19          27</span></span><br><span class="line"><span class="comment">//CV_32S        4          12           20          28</span></span><br><span class="line"><span class="comment">//CV_32F        5          13           21          29</span></span><br><span class="line"><span class="comment">//CV_64F        6          14           22          30</span></span><br></pre></td></tr></table></figure>              </div>            </details><h4 id="主函数"><a href="#主函数" class="headerlink" title="主函数"></a>主函数</h4><details open><summary pointer>  </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;onMouse.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Mat image1 = imread(<span class="string">&quot;fire.jpg&quot;</span>);  <span class="comment">//读取图像；</span></span><br><span class="line"><span class="keyword">if</span> (image1.empty())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;读取错误&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line">imshow(<span class="string">&quot;image1&quot;</span>, image1);  <span class="comment">//显示图像；</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">setMouseCallback(<span class="string">&quot;image1&quot;</span>, onMouse, reinterpret_cast&lt;<span class="type">void</span>*&gt;(&amp;image1)); <span class="comment">//关联图像显示窗口和onMouse函数</span></span><br><span class="line">waitKey(<span class="number">0</span>);  <span class="comment">//暂停，保持图像显示，等待按键结束</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p><strong>效果</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.6f0g2iecfm.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.6f0g2iecfm.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="访问图像像素"><a href="#访问图像像素" class="headerlink" title="访问图像像素"></a>访问图像像素</h3><h4 id="访问（j-i）处像素"><a href="#访问（j-i）处像素" class="headerlink" title="访问（j,i）处像素"></a>访问（j,i）处像素</h4><p>以8位（0~255）灰度图像和BGR彩色图像为例，用at可以访问图像像素：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//灰度图像：</span></span><br><span class="line">image.at&lt;uchar&gt;(j, i) <span class="comment">//j为行数，i为列数</span></span><br><span class="line"><span class="comment">//BGR彩色图像</span></span><br><span class="line">image.at&lt;Vec3b&gt;(j, i)[<span class="number">0</span>] <span class="comment">//B分量</span></span><br><span class="line">image.at&lt;Vec3b&gt;(j, i)[<span class="number">1</span>] <span class="comment">//G分量</span></span><br><span class="line">image.at&lt;Vec3b&gt;(j, i)[<span class="number">2</span>] <span class="comment">//R分量</span></span><br></pre></td></tr></table></figure><p><strong>例:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Mat image1 = imread(<span class="string">&quot;fire.jpg&quot;</span>);  <span class="comment">//读取图像；</span></span><br><span class="line">imshow(<span class="string">&quot;image1&quot;</span>, image1);  <span class="comment">//显示图像；</span></span><br><span class="line"><span class="type">int</span> i = <span class="number">50</span>, j = <span class="number">50</span>;</span><br><span class="line"><span class="type">int</span> b = image1.at&lt;Vec3b&gt;(j, i)[<span class="number">0</span>];</span><br><span class="line"><span class="type">int</span> g = image1.at&lt;Vec3b&gt;(j, i)[<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> r = image1.at&lt;Vec3b&gt;(j, i)[<span class="number">2</span>];</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;图像该点的像素(BGR):&quot;</span>&lt;&lt;b&lt;&lt;<span class="string">&quot;,&quot;</span> &lt;&lt; g &lt;&lt; <span class="string">&quot;,&quot;</span> &lt;&lt; r &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">waitKey(<span class="number">0</span>);  </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>输出:</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7p22d7s7r.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7p22d7s7r.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="在图像中加入白色椒盐噪声"><a href="#在图像中加入白色椒盐噪声" class="headerlink" title="在图像中加入白色椒盐噪声"></a>在图像中加入白色椒盐噪声</h4><h5 id="创建Salt头文件"><a href="#创建Salt头文件" class="headerlink" title="创建Salt头文件"></a>创建Salt头文件</h5><details open><summary pointer> Salt.h </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;random&gt;</span>  <span class="comment">//随机数头文件</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Salt</span><span class="params">(Mat image, <span class="type">int</span> n)</span>; <span class="comment">//n：加入噪声点数</span></span><br></pre></td></tr></table></figure>              </div>            </details><h5 id="创建Salt源文件"><a href="#创建Salt源文件" class="headerlink" title="创建Salt源文件"></a>创建Salt源文件</h5><details open><summary pointer> Salt.cpp </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Salt.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Salt</span><span class="params">(Mat image, <span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//随机数生成器</span></span><br><span class="line">default_random_engine generater;</span><br><span class="line">uniform_int_distribution&lt;<span class="type">int</span>&gt;randomRow(<span class="number">0</span>, image.rows - <span class="number">1</span>);</span><br><span class="line">uniform_int_distribution&lt;<span class="type">int</span>&gt;randomCol(<span class="number">0</span>, image.cols - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> i, j;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; k++)</span><br><span class="line">&#123;</span><br><span class="line">i = randomCol(generater);</span><br><span class="line">j = randomRow(generater);</span><br><span class="line"><span class="keyword">if</span> (image.channels() == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">image.at&lt;uchar&gt;(j, i) = <span class="number">255</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (image.channels() == <span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">image.at&lt;Vec3b&gt;(j, i)[<span class="number">0</span>] = <span class="number">255</span>;</span><br><span class="line">image.at&lt;Vec3b&gt;(j, i)[<span class="number">1</span>] = <span class="number">255</span>;</span><br><span class="line">image.at&lt;Vec3b&gt;(j, i)[<span class="number">2</span>] = <span class="number">255</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><h5 id="main"><a href="#main" class="headerlink" title="main"></a>main</h5><details open><summary pointer> main.cpp </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Salt.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123; </span><br><span class="line"></span><br><span class="line">Mat image1 = imread(<span class="string">&quot;lena.png&quot;</span>);  <span class="comment">//读取图像；</span></span><br><span class="line"><span class="keyword">if</span> (image1.empty())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;读取错误&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line">imshow(<span class="string">&quot;image1&quot;</span>, image1);  <span class="comment">//显示原图像；</span></span><br><span class="line"></span><br><span class="line">Salt(image1, <span class="number">5000</span>); <span class="comment">//加入5000个噪声点</span></span><br><span class="line">imshow(<span class="string">&quot;image2&quot;</span>, image1);  <span class="comment">//显示噪声图像；</span></span><br><span class="line"></span><br><span class="line">waitKey(<span class="number">0</span>);  <span class="comment">//暂停，保持图像显示，等待按键结束</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p><strong>效果</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.231muzt7o0.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.231muzt7o0.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="遍历图像像素"><a href="#遍历图像像素" class="headerlink" title="遍历图像像素"></a>遍历图像像素</h3><h4 id="指针扫描"><a href="#指针扫描" class="headerlink" title="指针扫描"></a>指针扫描</h4><p>以下面模板对图像进行扫描运算为例：</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2h82lv6z7m.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2h82lv6z7m.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123; </span><br><span class="line">Mat image1, output_image;   <span class="comment">//定义输入图像和输出图像</span></span><br><span class="line">image1 = imread(<span class="string">&quot;lena.png&quot;</span>);  <span class="comment">//读取图像；</span></span><br><span class="line"><span class="keyword">if</span> (image1.empty())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;读取错误&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line">output_image = Mat(image1.size(), image1.type());  <span class="comment">//定义输出图像大小</span></span><br><span class="line">output_image = image1.clone();   <span class="comment">//克隆原图像素值</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> rows = image1.rows;    <span class="comment">//原图行数</span></span><br><span class="line"><span class="type">int</span> stepx = image1.channels();   <span class="comment">//原图通道数</span></span><br><span class="line"><span class="type">int</span> cols = (image1.cols) * image1.channels();  <span class="comment">//矩阵总列数，在BGR彩色图像中，每个像素的BGR通道按顺序排列，因此总列数=像素宽度*通道数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> row =<span class="number">1</span> ; row &lt; (rows - <span class="number">1</span>); row++)   <span class="comment">//对行遍历</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">const</span> uchar* previous = image1.ptr&lt;uchar&gt;(row - <span class="number">1</span>);  <span class="comment">//原图上一行指针</span></span><br><span class="line"><span class="type">const</span> uchar* current = image1.ptr&lt;uchar&gt;(row);       <span class="comment">//原图当前行指针</span></span><br><span class="line"><span class="type">const</span> uchar* next = image1.ptr&lt;uchar&gt;(row + <span class="number">1</span>);      <span class="comment">//原图下一行指针</span></span><br><span class="line">uchar* output = output_image.ptr&lt;uchar&gt;(row);        <span class="comment">//输出图像当前行指针</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> col = stepx; col &lt; (cols- stepx); col++)  <span class="comment">//对列遍历</span></span><br><span class="line">&#123;</span><br><span class="line">            <span class="comment">//卷积计算</span></span><br><span class="line">output[col] = saturate_cast&lt;uchar&gt;(<span class="number">5</span>*current[col] - (previous[col]+ current[col- stepx]+ current[col + stepx]+ next[col]));</span><br><span class="line"><span class="comment">//saturate_cast&lt;uchar&gt;(a)，当a在0—255时输出a，当a小于0输出0，当a大于255输出255，保证a的值在0~255之间</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">imshow(<span class="string">&quot;image1&quot;</span>, image1);</span><br><span class="line">imshow(<span class="string">&quot;output_image&quot;</span>, output_image);</span><br><span class="line"></span><br><span class="line">waitKey(<span class="number">0</span>);  <span class="comment">//暂停，保持图像显示，等待按键结束</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>输出</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2a4uqfua0g.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2a4uqfua0g.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p><strong>把卷积核中间改成4：</strong><br><strong>输出</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8hg8qlrb43.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8hg8qlrb43.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="opencv自带的卷积运算：filter2D"><a href="#opencv自带的卷积运算：filter2D" class="headerlink" title="opencv自带的卷积运算：filter2D"></a>opencv自带的卷积运算：filter2D</h4><p>上面的方法可以简化为:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123; </span><br><span class="line">Mat image1, output_image;   <span class="comment">//定义输入图像和输出图像</span></span><br><span class="line">image1 = imread(<span class="string">&quot;lena.png&quot;</span>);  <span class="comment">//读取图像；</span></span><br><span class="line"><span class="keyword">if</span> (image1.empty())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;读取错误&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Mat kernel = (Mat_&lt;<span class="type">char</span>&gt;(<span class="number">3</span>,<span class="number">3</span>) &lt;&lt; <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">5</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>);  <span class="comment">//创建滤波器</span></span><br><span class="line">filter2D(image1, output_image, image1.depth(), kernel);  <span class="comment">//卷积</span></span><br><span class="line"></span><br><span class="line">imshow(<span class="string">&quot;image1&quot;</span>, image1);</span><br><span class="line">imshow(<span class="string">&quot;output_image&quot;</span>, output_image);</span><br><span class="line"></span><br><span class="line">waitKey(<span class="number">0</span>);  <span class="comment">//暂停，保持图像显示，等待按键结束</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在filter2D函数中，image1.depth()是用来获取图像image1的深度（depth）信息的函数调用。</p><p>图像的深度表示图像中每个像素值的数据类型。在OpenCV中，常见的图像深度包括：</p><ul><li>CV_8U：8位无符号整数（即Unsigned char），对应于灰度图像的深度</li><li>CV_16U：16位无符号整数</li><li>CV_16S：16位有符号整数</li><li>CV_32S：32位有符号整数</li><li>CV_32F：32位浮点数</li><li>CV_64F：64位浮点数</li></ul>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 智能车 </tag>
            
            <tag> 图像处理 </tag>
            
            <tag> OpenCV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>c语言计算机二级笔记</title>
      <link href="/2024/03/23/c%E8%AF%AD%E8%A8%80%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BA%8C%E7%BA%A7%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/03/23/c%E8%AF%AD%E8%A8%80%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BA%8C%E7%BA%A7%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="计算机系统"><a href="#计算机系统" class="headerlink" title="计算机系统"></a>计算机系统</h2><h3 id="E-R实体联系"><a href="#E-R实体联系" class="headerlink" title="E-R实体联系"></a>E-R实体联系</h3><ol><li><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2krogi3z4f.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2krogi3z4f.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div> 矩形表示实体，菱形表示实体之间的联系</li><li>在关系数据库中，用于表示实体间联系的是<strong>二维表</strong></li><li>将E-R图转换为关系模式时，实体和联系都可以表示为<strong>关系</strong>(关系就是二维表)</li><li><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.969i7jl0dn.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.969i7jl0dn.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li><li></li></ol><p>已经考完了。。。。。</p>]]></content>
      
      
      <categories>
          
          <category> c语言 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c语言 </tag>
            
            <tag> 计算机二级 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>收藏夹</title>
      <link href="/2024/03/22/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
      <url>/2024/03/22/%E6%94%B6%E8%97%8F%E5%A4%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h2><div class="tagLink"><a class="link-card" title="从头开始实现一个神经网络" href="https://mp.weixin.qq.com/s/lk12kP2fbuSBSV5lSFKTlA"><span class="link-card-backdrop" style="background-image: url(https://picx.zhimg.com/80/v2-0b63b54fc59d235ad97530a98bc0e014_1440w.webp?source=2c26e567)"></span><div class="left"><img src="https://picx.zhimg.com/80/v2-0b63b54fc59d235ad97530a98bc0e014_1440w.webp?source=2c26e567" class="lazyload placeholder" data-srcset="https://picx.zhimg.com/80/v2-0b63b54fc59d235ad97530a98bc0e014_1440w.webp?source=2c26e567" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">从头开始实现一个神经网络</p><p class="url">https://mp.weixin.qq.com/s/lk12kP2fbuSBSV5lSFKTlA</p></div></a></div><div class="tagLink"><a class="link-card" title="数据处理之归一化、标准化、正则化" href="https://job.yanxishe.com/blogDetail/27604"><span class="link-card-backdrop" style="background-image: url(https://static.leiphone.com/uploads/new/sns/blogSpe/article/202110/616c488c9c69f.png)"></span><div class="left"><img src="https://static.leiphone.com/uploads/new/sns/blogSpe/article/202110/616c488c9c69f.png" class="lazyload placeholder" data-srcset="https://static.leiphone.com/uploads/new/sns/blogSpe/article/202110/616c488c9c69f.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">数据处理之归一化、标准化、正则化</p><p class="url">https://job.yanxishe.com/blogDetail/27604</p></div></a></div><iframe src="//player.bilibili.com/player.html?aid=770444004&bvid=BV18r4y1M71J&cid=760424160&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><iframe src="//player.bilibili.com/player.html?aid=541842600&bvid=BV1yi4y1g7ro&cid=227677652&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><h2 id="图像处理"><a href="#图像处理" class="headerlink" title="图像处理"></a>图像处理</h2><details ><summary pointer> 存一下包版本 </summary>              <div class='content'>              <p>(Paddle_Py3.12) C:\Users\lxcqm&gt;pip list<br>Package                 Version</p><hr><p>absl-py                 2.1.0<br>anyio                   4.3.0<br>archspec                0.2.3<br>astor                   0.8.1<br>astunparse              1.6.3<br>boltons                 23.1.1<br>Brotli                  1.0.9<br>certifi                 2024.2.2<br>cffi                    1.16.0<br>charset-normalizer      3.3.2<br>cloudpickle             3.0.0<br>cmake                   3.28.3<br>colorama                0.4.6<br>conda                   24.1.2<br>conda-libmamba-solver   24.1.0<br>conda-package-handling  2.2.0<br>conda_package_streaming 0.9.0<br>contourpy               1.2.0<br>cycler                  0.11.0<br>Cython                  3.0.9<br>decorator               5.1.1<br>distro                  1.9.0<br>filelock                3.13.1<br>flatbuffers             24.3.7<br>fonttools               4.25.0<br>gast                    0.5.4<br>google-pasta            0.2.0<br>grpcio                  1.62.1<br>gym                     0.26.2<br>gym-notices             0.0.8<br>h11                     0.14.0<br>h5py                    3.10.0<br>httpcore                1.0.4<br>httpx                   0.27.0<br>idna                    3.6<br>Jinja2                  3.1.3<br>joblib                  1.3.2<br>jsonpatch               1.33<br>jsonpointer             2.4<br>keras                   3.1.1<br>kiwisolver              1.4.4<br>libclang                18.1.1<br>libmambapy              1.5.7<br>mamba                   1.5.7<br>Markdown                3.6<br>markdown-it-py          3.0.0<br>MarkupSafe              2.1.5<br>matplotlib              3.8.0<br>mdurl                   0.1.2<br>menuinst                2.0.2<br>meson                   1.3.2<br>mkl-fft                 1.3.8<br>mkl-random              1.2.4<br>mkl-service             2.4.0<br>ml-dtypes               0.3.2<br>mpmath                  1.3.0<br>munkres                 1.1.4<br>namex                   0.0.7<br>nes_py                  8.2.1<br>networkx                3.2.1<br>numpy                   1.26.4<br>opencv-python           4.9.0.80<br>opt-einsum              3.3.0<br>optree                  0.10.0<br>packaging               23.1<br>paddlepaddle-gpu        2.6.0.post120<br>pandas                  2.2.1<br>pillow                  10.2.0<br>pip                     24.0<br>platformdirs            4.2.0<br>pluggy                  1.4.0<br>ply                     3.11<br>protobuf                4.25.2<br>pycocotools             2.0<br>pycosat                 0.6.6<br>pycparser               2.21<br>pyglet                  1.5.21<br>Pygments                2.17.2<br>pyparsing               3.0.9<br>PyQt5                   5.15.10<br>PyQt5-sip               12.13.0<br>PySocks                 1.7.1<br>python-dateutil         2.8.2<br>pytz                    2024.1<br>PyYAML                  6.0.1<br>requests                2.31.0<br>rich                    13.7.1<br>ruamel.yaml             0.18.6<br>ruamel.yaml.clib        0.2.8<br>scipy                   1.12.0<br>setuptools              69.1.1<br>sip                     6.7.12<br>six                     1.16.0<br>sniffio                 1.3.1<br>sympy                   1.12<br>tensorboard             2.16.2<br>tensorboard-data-server 0.7.2<br>tensorflow              2.16.1<br>tensorflow-intel        2.16.1<br>termcolor               2.4.0<br>threadpoolctl           3.3.0<br>torch                   2.2.1<br>torchaudio              2.2.1<br>torchvision             0.17.1<br>tornado                 6.3.3<br>tqdm                    4.66.2<br>truststore              0.8.0<br>typing_extensions       4.10.0<br>tzdata                  2024.1<br>urllib3                 2.2.1<br>Werkzeug                3.0.1<br>wheel                   0.43.0<br>win-inet-pton           1.1.0<br>wrapt                   1.16.0<br>zstandard               0.22.0</p>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 深度学习 </tag>
            
            <tag> 智能车 </tag>
            
            <tag> YoloV3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YoloV3模型构建</title>
      <link href="/2024/03/21/YoloV3%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA/"/>
      <url>/2024/03/21/YoloV3%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<div class="tagLink"><a class="link-card" title="【yolov3详解】一文让你读懂yolov3目标检测原理" href="https://blog.csdn.net/weixin_39615182/article/details/109752498"><span class="link-card-backdrop" style="background-image: url(https://tumytime.github.io/picx-images-hosting/image.7i057r983s.webp)"></span><div class="left"><img src="https://tumytime.github.io/picx-images-hosting/image.7i057r983s.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7i057r983s.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">【yolov3详解】一文让你读懂yolov3目标检测原理</p><p class="url">https://blog.csdn.net/weixin_39615182/article/details/109752498</p></div></a></div><p><strong>yolov3检测分两步：</strong><br>1、确定检测对象位置<br>2、对检测对象分类（是什么东西）<br>即在识别图片是什么的基础上，还需定位识别对象的位置，并框出。</p><p>我们首先上一幅图宏观理解下</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7i057r983s.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7i057r983s.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>图中的红框是通过在yolov3检测最后得出的<strong>边界框</strong>（bounding box），又如下图的黄色框也是边界框</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7smz0wp6zw.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7smz0wp6zw.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>yolov3处理图片过程如下</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.pf3lakvam.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.pf3lakvam.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>首先一张图片传进yolo，yolo会将其转化为416×416大小的网格，增加灰度条用于防止失真，之后图片会分成三个网格图片（13×13，26×26，52×52）<br>由于图像在多次卷积压缩后，小物体的特征容易丢失，所以用52x52的网格检测小物体，由于猫属于大物体，所以用13x13的网格检测</p><h2 id="详细过程"><a href="#详细过程" class="headerlink" title="详细过程"></a>详细过程</h2><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8ad0phujlt.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8ad0phujlt.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>先上流程图，该图是基于<strong>voc数据集</strong>讲解的，voc数据集有20个类别，最下面红框中(13，13，75)表示预测结果的shape，实际上是13,13,3×25,表示有13*13的网格，每个网格有3个先验框（又称锚框，anchors，先验框下面有解释），每个先验框有25个参数(20个类别+5个参数)，这5个参数分别是<strong>x_offset</strong>、<strong>y_offset</strong>、<strong>height</strong>、<strong>width</strong>与<strong>置信度confidence</strong>，用这3个框去试探，试探是否框中有物体，如果有，就会把这个物体给框起来。如果是基于coco的数据集就会有80种类别，最后的维度应该为3x(80+5)&#x3D;255，最上面两个预测结果shape同理</p><p>yolov3主干网络为Darknet53，重要的是使用了<strong>残差网络Residual</strong>，darknet53的每一个卷积部分使用了特有的<strong>DarknetConv2D结构</strong>，每一次卷积的时候进行<strong>l2正则化</strong>，完成卷积后进行<strong>BatchNormalization标准化</strong>与<strong>LeakyReLU激活函数</strong></p><p>对应代码如下：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#--------------------------------------------------#</span></span><br><span class="line"><span class="comment">#   单次卷积</span></span><br><span class="line"><span class="comment">#--------------------------------------------------#</span></span><br><span class="line"><span class="meta">@wraps(<span class="params">Conv2D</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">DarknetConv2D</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">    darknet_conv_kwargs = &#123;<span class="string">&#x27;kernel_regularizer&#x27;</span>: l2(<span class="number">5e-4</span>)&#125;</span><br><span class="line">    darknet_conv_kwargs[<span class="string">&#x27;padding&#x27;</span>] = <span class="string">&#x27;valid&#x27;</span> <span class="keyword">if</span> kwargs.get(<span class="string">&#x27;strides&#x27;</span>)==(<span class="number">2</span>,<span class="number">2</span>) <span class="keyword">else</span> <span class="string">&#x27;same&#x27;</span></span><br><span class="line">    darknet_conv_kwargs.update(kwargs)</span><br><span class="line">    <span class="keyword">return</span> Conv2D(*args, **darknet_conv_kwargs)</span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------------------------------#</span></span><br><span class="line"><span class="comment">#   卷积块</span></span><br><span class="line"><span class="comment">#   DarknetConv2D + BatchNormalization + LeakyReLU</span></span><br><span class="line"><span class="comment">#---------------------------------------------------#</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">DarknetConv2D_BN_Leaky</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">    no_bias_kwargs = &#123;<span class="string">&#x27;use_bias&#x27;</span>: <span class="literal">False</span>&#125;</span><br><span class="line">    no_bias_kwargs.update(kwargs)</span><br><span class="line">    <span class="keyword">return</span> compose( </span><br><span class="line">        DarknetConv2D(*args, **no_bias_kwargs),<span class="comment">#调用单次卷积函数进行正则化</span></span><br><span class="line">        BatchNormalization(),<span class="comment"># 标准化</span></span><br><span class="line">        LeakyReLU(alpha=<span class="number">0.1</span>))<span class="comment"># 激活函数</span></span><br></pre></td></tr></table></figure><details open><summary pointer> python装饰器 </summary>              <div class='content'>              <p><strong>将函数作为参数传给另一个函数</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hi</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hi yasoob!&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">doSomethingBeforeHi</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I am doing some boring work before executing hi()&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(func())</span><br><span class="line"> </span><br><span class="line">doSomethingBeforeHi(hi)</span><br><span class="line"><span class="comment">#outputs:I am doing some boring work before executing hi()</span></span><br><span class="line"><span class="comment">#        hi yasoob!</span></span><br></pre></td></tr></table></figure><p>现在你已经具备所有必需知识，来进一步学习装饰器真正是什么了。装饰器让你在一个函数的前后去执行代码。</p><p><strong>你的第一个装饰器</strong></p><p>在上一个例子里，其实我们已经创建了一个装饰器！现在我们修改下上一个装饰器，并编写一个稍微更有用点的程序：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">a_new_decorator</span>(<span class="params">a_func</span>):</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapTheFunction</span>():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;I am doing some boring work before executing a_func()&quot;</span>)</span><br><span class="line"> </span><br><span class="line">        a_func()</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;I am doing some boring work after executing a_func()&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> wrapTheFunction</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">a_function_requiring_decoration</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I am the function which needs some decoration to remove my foul smell&quot;</span>)</span><br><span class="line"> </span><br><span class="line">a_function_requiring_decoration()</span><br><span class="line"><span class="comment">#outputs: &quot;I am the function which needs some decoration to remove my foul smell&quot;</span></span><br><span class="line"> </span><br><span class="line">a_function_requiring_decoration = a_new_decorator(a_function_requiring_decoration)</span><br><span class="line"><span class="comment">#now a_function_requiring_decoration is wrapped by wrapTheFunction()</span></span><br><span class="line"> </span><br><span class="line">a_function_requiring_decoration()</span><br><span class="line"><span class="comment">#outputs:I am doing some boring work before executing a_func()</span></span><br><span class="line"><span class="comment">#        I am the function which needs some decoration to remove my foul smell</span></span><br><span class="line"><span class="comment">#        I am doing some boring work after executing a_func()</span></span><br></pre></td></tr></table></figure><p>你看明白了吗？我们刚刚应用了之前学习到的原理。这正是python中装饰器做的事情！它们封装一个函数，并且用这样或者那样的方式来修改它的行为。现在你也许疑惑，我们在代码里并没有使用<code>@</code>符号？那只是一个简短的方式来生成一个被装饰的函数。这里是我们如何使用<code>@</code>来运行之前的代码：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@a_new_decorator</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">a_function_requiring_decoration</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Hey you! Decorate me!&quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I am the function which needs some decoration to &quot;</span></span><br><span class="line">          <span class="string">&quot;remove my foul smell&quot;</span>)</span><br><span class="line"> </span><br><span class="line">a_function_requiring_decoration()</span><br><span class="line"><span class="comment">#outputs: I am doing some boring work before executing a_func()</span></span><br><span class="line"><span class="comment">#         I am the function which needs some decoration to remove my foul smell</span></span><br><span class="line"><span class="comment">#         I am doing some boring work after executing a_func()</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#the @a_new_decorator is just a short way of saying:</span></span><br><span class="line">a_function_requiring_decoration = a_new_decorator(a_function_requiring_decoration)</span><br></pre></td></tr></table></figure>              </div>            </details><p>讲解流程之前的<strong>基本概念</strong>了解一下，后面不记得回来再看看</p><p><strong>x_offset</strong>：表示网格左上角相对x轴的距离（偏移量）<br><strong>y_offset</strong>：表示网格左上角相对y轴的距离（偏移量）</p><p><strong>上采样</strong>：缩小图像（或称为下采样（subsampled），如池化）的主要目的有两个：1、使得图像符合显示区域的大小；2、生成对应图像的缩略图。放大图像（或称为上采样（upSampling）或图像插值（interpolating））的主要目的是放大原图像,从而可以显示在更高分辨率的显示设备上。</p><p><strong>先验框</strong>（anchor box）：就是帮助我们定好了常见目标的宽和高，在进行预测的时候，我们可以利用这个已经定好的宽和高来进行处理，可以帮助我们进行预测，作用就是辅助处理x_offset、y_offset、h和w。如下图所示，用的是coco数据集，输出是(13,13,(80+5)*3)，乘3表示，有3个先验框，每个先验框都有85个参数，下图就有3个蓝色框，也即先验框，可以理解成给你的建议框，识别的对象可能在这些建议框中，目的是带你得到更高的IOU，即更高置信度、更可能有对象得部分，黄色框为真实最后显示的边界框，红色框表示中心位置。</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2kroe0h5ah.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2kroe0h5ah.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p><strong>置信度</strong>（confidence）：就是预测的先验框和真实框ground truth box（真实对象的框）的IOU值，即先验框是否有对象的概率Pr(Object)，如进行人脸识别，一张图中有房子，树，车，人等，识别时背景和人的身体都没有脸这个需要识别的对象，那么这些地方的置信度就是0，框中的人脸越多，置信度（有对象概率）就越大，置信度是检测中非常重要的参数</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.5tqsao8853.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.5tqsao8853.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>IOU表示交并比</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3razmma7pz.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3razmma7pz.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p><strong>为什么要使用残差（Residual）神经网络？</strong><br>答：网络越深，梯度消失的现象就越来越明显，网络的训练效果也不会很好。残差神经网络就是为了在加深网络的情况下又解决梯度消失的问题。残差结构可以不通过卷积，直接从前面一个特征层映射到后面的特征层（跳跃连接），有助于训练，也有助于特征的提取，容易优化。</p><h2 id="yolov3检测流程原理"><a href="#yolov3检测流程原理" class="headerlink" title="yolov3检测流程原理"></a>yolov3检测流程原理</h2><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.26l8n5exyl.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.26l8n5exyl.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="第一步：从特征获取预测结果"><a href="#第一步：从特征获取预测结果" class="headerlink" title="第一步：从特征获取预测结果"></a>第一步：从特征获取预测结果</h3><ol><li><p>yolov3提取多特征层进行目标检测，一共提取三个特征层，三个特征层位于主干特征提取网络darknet53的不同位置，分别位于中间层，中下层，底层，三个特征层的shape分别为(52,52,256)、(26,26,512)、(13,13,1024)，这三个特征层后面用于与上采样后的其他特征层堆叠拼接（Concat）</p></li><li><p>第三个特征层(13,13,1024)进行5次卷积处理（为了特征提取），处理完后一部分用于卷积+上采样UpSampling，另一部分用于输出对应的预测结果（13,13,75），Conv2D 3×3和Conv2D1×1两个卷积起通道调整的作用，调整成输出需要的大小。</p></li><li><p>卷积+上采样后得到(26,26,256)的特征层，然后与Darknet53网络中的特征层(26,26,512)进行拼接，得到的shape为(26,26,768)，再进行5次卷积，处理完后一部分用于卷积上采样，另一部分用于输出对应的预测结果(26,26,75)，Conv2D 3×3和Conv2D1×1同上为通道调整</p></li><li><p>之后再将3中卷积+上采样的特征层与shape为(52,52,256)的特征层拼接（Concat）,再进行卷积得到shape为(52,52,128)的特征层，最后再Conv2D 3×3和Conv2D1×1两个卷积，得到(52,52,75)特征层</p></li></ol><p>最后图中有三个红框原因就是有些物体相对在图中较大，就用13×13检测，物体在图中比较小，就会归为52×52来检测</p><h3 id="第二步：预测结果的解码"><a href="#第二步：预测结果的解码" class="headerlink" title="第二步：预测结果的解码"></a>第二步：预测结果的解码</h3><p>预测结果解码原因：预测结果(红框)并不对应着最终的预测框在图片上的位置，还需要解码）</p><p>yolov3的预测原理是分别将整幅图分为13x13、26x26、52x52的网格，每个网络点负责一个区域的检测。解码过程就是计算得出最后显示的边界框的坐标bx,by，以及宽高bw,bh，这样就得出了边界框的位置，计算过程如图（b–为bounding box 缩写）</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1e8d5fao6l.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1e8d5fao6l.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>(cx,cy)：该点所在网格的左上角距离最左上角相差的格子数。<br>(pw,ph)：先验框的边长<br>(tx,ty)：目标中心点相对于该点所在网格左上角的偏移量<br>(tw,th)：预测边框的宽和高<br>σ：激活函数，论文作者用的是sigmoid函数，[0,1]之间概率，之所以用sigmoid取代之前版本的softmax，原因是softmax会扩大最大类别概率值而抑制其他类别概率值 ，图解如下</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.9rj5rcytb7.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.9rj5rcytb7.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>注：最终得到的边框坐标值是bx,by,bw,bh.而网络学习目标是tx，ty，tw，th。<br>另外cy向下此处为正向</p><h3 id="第三步：对预测出的边界框得分排序与非极大抑制筛选"><a href="#第三步：对预测出的边界框得分排序与非极大抑制筛选" class="headerlink" title="第三步：对预测出的边界框得分排序与非极大抑制筛选"></a>第三步：对预测出的边界框得分排序与非极大抑制筛选</h3><p>这步就是将最大概率的框筛选出来<br>1、取出每一类得分大于一定阈值的框和得分进行排序。<br>2、利用框的位置和得分进行非极大抑制。最后可以得出概率最大的边界框，也就是最后显示出的框<br>如下几幅图，一步步筛选得到最终边界框</p>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 深度学习 </tag>
            
            <tag> 智能车 </tag>
            
            <tag> YoloV3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1x1卷积核</title>
      <link href="/2024/03/21/1x1%E5%8D%B7%E7%A7%AF%E6%A0%B8/"/>
      <url>/2024/03/21/1x1%E5%8D%B7%E7%A7%AF%E6%A0%B8/</url>
      
        <content type="html"><![CDATA[<div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7awxc3fekp.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7awxc3fekp.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><blockquote><p>在卷积神经网络的卷积层中，不同的通道使用的卷积核参数是不一样的。每个通道都有自己对应的卷积核参数，这些参数用于在该通道上对输入数据进行滤波操作，提取特定的特征。<br>通道之间的卷积核参数是不共享的，即每个通道都有自己独特的卷积核参数。这种设计可以让神经网络更加灵活地学习不同通道之间的特征表示，从而提高网络的表征能力。</p></blockquote><h2 id="1×1-卷积核作用"><a href="#1×1-卷积核作用" class="headerlink" title="$1×1$卷积核作用"></a>$1×1$卷积核作用</h2><p><strong>卷积层中的卷积核数量决定了输出的通道数，而每个卷积核的通道数取决于输入数据的通道数</strong></p><ol><li><p><strong>卷积核数决定了输出通道数：</strong> 在卷积神经网络中，每个卷积层包含多个卷积核。每个卷积核在输入数据上进行卷积操作，生成一个对应的输出特征图（通道）。因此，卷积核的数量决定了输出特征图的通道数。如果一个卷积层有n个卷积核，那么输出将包含n个通道。</p></li><li><p><strong>每个卷积核的通道数取决于输入的通道数：</strong> 当卷积核在输入数据上进行卷积操作时，每个卷积核会同时处理输入数据的所有通道。例如，如果输入数据是RGB图像，有3个通道（红色、绿色、蓝色），那么每个卷积核将同时在这3个通道上进行卷积操作。这样，每个卷积核的通道数就等于输入数据的通道数。因此，卷积核的通道数取决于输入数据的通道数。</p></li></ol><h3 id="增加网络深度-增加非线性映射次数"><a href="#增加网络深度-增加非线性映射次数" class="headerlink" title="增加网络深度(增加非线性映射次数)"></a>增加网络深度(增加非线性映射次数)</h3><iframe src="//player.bilibili.com/player.html?aid=696259725&bvid=BV11m4y1r7jK&cid=1062261407&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p>首先直接从网络深度来理解，1x1 的卷积核虽小，但也是卷积核，加 1 层卷积，网络深度自然会增加。<br>1x1卷积核，可以在保持feature map尺度不变的（即不损失分辨率）的前提下大幅增加非线性特性（利用后接的非线性激活函数），把网络做的很深。并且1x1卷积核的卷积过程相当于全连接的计算过程，通过<strong>加入非线性激活函数</strong>，可以<strong>增加网络的非线性</strong>，使得网络可以表达更复杂的特征。</p><h4 id="feature-map的含义"><a href="#feature-map的含义" class="headerlink" title="feature map的含义"></a>feature map的含义</h4><p>在每个卷积层，数据都是以三维形式存在的。你可以把它看成许多个二维图片叠在一起，其中每一个称为一个feature map。在输入层，如果是灰度图片，那就只有一个feature map；如果是彩色图片，一般就是3个feature map（红绿蓝）。层与层之间会有若干个卷积核（kernel），上一层和每个feature map跟每个卷积核做卷积，都会产生下一层的一个feature map。</p><p>feature map（下图红线标出） 即：该层卷积核的个数，有多少个卷积核，经过卷积就会产生多少个feature map，也就是下图中 <code>豆腐皮儿</code>的层数、同时也是下图<code>豆腐块</code>的深度（宽度）！！这个宽度可以手动指定，一般网络越深的地方这个值越大，因为随着网络的加深，feature map的长宽尺寸缩小，本卷积层的每个map提取的特征越具有代表性（精华部分），所以后一层卷积层需要增加feature map的数量，才能更充分的提取出前一层的特征，一般是成倍增加（不过具体论文会根据实验情况具体设置）！</p><p>在卷积神经网络中，每个卷积层都包含多个卷积核（也称为滤波器），每个卷积核生成一个特征图。当前一层输出的特征图与后一层卷积核进行卷积操作时，可以看作是在进行矩阵相乘操作。增加后一层的特征图数量实际上意味着增加了后一层卷积核的数量，这可以使网络在进行特征提取时拥有更多的“过滤器”，从而更全面地捕获输入数据中的不同特征和模式。</p><p>卷积特征的可视化，有助于我们更好地理解深度网络。卷积网络在学习过程中保持了图像的空间结构，也就是说最后一层的激活值（feature map）总和原始图像具有空间上的对应关系，具体对应的位置以及大小，可以用感受野来度量。利用这点性质可以做很多事情：</p><ol><li>前向计算。我们直接可视化网络每层的 feature map，然后观察feature map 的数值变化. 一个训练成功的CNN 网络，其feature map 的值伴随网络深度的增加，会越来越稀疏。这可以理解网络取精去燥。 <details open><summary pointer> WHY越来越稀疏 </summary>              <div class='content'>              <p>在一个训练成功的CNN（Convolutional Neural Network）网络中，随着网络深度的增加，feature map 的值会越来越稀疏的现象可以通过以下方面进行详细解释：</p><ol><li><p><strong>特征稀疏性在深层网络中的原因</strong>：</p><ul><li><strong>激活函数的非线性作用</strong>：在卷积神经网络中，通常在每个卷积层之后都会使用非线性激活函数（如ReLU）。这种非线性激活会导致大部分神经元的输出接近于0，只有部分神经元会激活并输出非零值，从而导致 feature map 的稀疏性。</li><li><strong>权重更新和特征选择</strong>：随着网络的训练，CNN 会根据损失函数进行权重更新，通过学习提取对分类任务有用的特征。在网络深度增加的过程中，网络会更加注重对关键特征的提取，而相对不重要的特征很可能被抑制，这也会导致 feature map 的稀疏性。</li></ul></li><li><p><strong>稀疏特征对网络性能的影响</strong>：</p><ul><li><strong>泛化能力提升</strong>：存储较少的激活值可以增加网络的泛化能力，减少过拟合的风险，因为网络更多地关注于对区分性重要的特征进行学习。</li><li><strong>计算效率提高</strong>：稀疏的特征图在后续的层次中减少了计算量，因为对于很多值较小或接近于零的神经元，不必执行额外的乘法运算，从而提高了网络的计算效率。</li></ul></li><li><p><strong>深度增加导致特征复杂性</strong>：</p><ul><li>随着网络深度的增加，特征图表示的特征也会变得越来越复杂和抽象，需要更少的激活来描述一个高级别的特征，这也间接导致 feature map 的稀疏性。</li></ul></li></ol><p>综上所述，随着网络深度的增加，一个训练成功的CNN 网络中的 feature map 的值会变得越来越稀疏，这主要是由于非线性激活函数的作用、权重更新和特征选择机制，以及深层网络中复杂特征的表示所导致的结果。这种稀疏性有助于提升网络的泛化能力、计算效率，并反映了网络对关键特征的学习和抽象能力。</p><details open><summary pointer> 激活一个神经元的过程 </summary>          <div class='content'>          <p>激活一个神经元的过程可以简单描述为以下几个步骤：</p><ol><li><p><strong>加权求和（Weighted Summation）</strong>：神经元接收来自上一层或输入数据的输入信号，每个输入信号都会乘以对应的连接权重（weights），然后将所有加权输入信号求和，得到一个加权和。这个加权和可以表示为：$[ z &#x3D; \sum_{i&#x3D;1}^{n} (w_i \cdot x_i) + b ]$，其中 $(w_i)$ 是第 $(i)$ 个输入信号的权重，$(x_i)$ 是对应的输入值，$(b)$ 是神经元的偏置项（bias）。</p></li><li><p><strong>激活函数（Activation Function）</strong>：将上一步计算得到的加权和$(z)$输入到激活函数中，激活函数会对加权和进行非线性变换，从而输出神经元的激活值（activation value）。常见的激活函数包括ReLU、Sigmoid、Tanh等。激活函数将决定神经元是否被激活，以及激活级别如何。</p></li><li><p><strong>输出值（Output）</strong>：激活函数的输出值即为神经元的最终输出，也可以表示为神经元的激活值。这个输出值将会被传递到下一层神经元或作为最终输出。</p></li></ol><p>总结起来，激活一个神经元的详细过程就是通过加权求和得到输入信号的加权和，然后经过激活函数进行非线性变换得到最终的输出值。这个过程在神经网络的每一层都会被重复执行，用于处理来自前一层神经元的信号并生成新的表示。</p>          </div>        </details>               </div>            </details></li><li>反向计算。根据网络最后一层最强的激活值，利用感受野求出原始输入图像的区域。可以观察输入图像的那些区域激活了网络，利用这个思路可以做一些物体定位。</li></ol><h4 id="1x1卷积核增加网络深度的原因"><a href="#1x1卷积核增加网络深度的原因" class="headerlink" title="1x1卷积核增加网络深度的原因"></a>1x1卷积核增加网络深度的原因</h4><p>在卷积神经网络中，1x1卷积核通过在通道维度上进行卷积操作，可以起到增加网络深度的作用。这是因为1x1卷积核可以在不改变空间尺寸的情况下，增加通道数量，从而增加网络的深度，提供更多的非线性变换和表达能力。以下是1x1卷积核如何增加网络深度的原理：</p><ol><li><p><strong>通道维度的变换：</strong> 1x1卷积核的作用是在每个空间位置对输入数据的通道进行线性变换。通过对输入数据的每个通道分别进行加权求和，可以生成新的特征表示。这样，在1x1卷积层之后，输出将具有更多的通道数，因此网络的深度也会增加。</p></li><li><p><strong>引入非线性变换：</strong> 尽管1x1卷积核是在通道维度上进行卷积操作，但其引入的非线性激活函数（如ReLU）会使输出具有更丰富的特征表示能力。这种非线性变换有助于增加网络的深度，使网络能够学习到更复杂的特征。</p></li><li><p><strong>增加网络的表达能力：</strong> 通过1x1卷积核增加网络的深度，网络可以更好地捕获不同抽象级别的特征。每个1x1卷积层都可以看作是一个含有非线性激活函数的全连接层，因此可以提高网络的表达能力和学习能力。</p></li></ol><h4 id="WHY使用1x1卷积核"><a href="#WHY使用1x1卷积核" class="headerlink" title="WHY使用1x1卷积核"></a>WHY使用1x1卷积核</h4><p><strong>增加网络深度有什么好处？为什么非要用 1x1 来增加深度呢？其它的不可以吗？</strong></p><p>其实，这涉及到<code>感受野</code>(感受野（Receptive Field）的定义是卷积神经网络每一层输出的特征图（feature map）上的像素点在输入图片上映射的区域大小)的问题，我们知道<strong>卷积核越大，它生成的 featuremap 上单个节点的感受野就越大</strong>，随着网络深度的增加，<strong>越靠后的 featuremap 上的节点感受野也越大。因此特征也越来越抽象</strong>。</p><p>但有的时候，我们想在不增加感受野的情况下，让网络加深，为的就是引入更多的非线性。</p><p>而 1x1 卷积核，恰巧可以办到。</p><p>我们知道，卷积后生成图片的尺寸受卷积核的大小和跨度影响，但如果卷积核是 1x1 ，跨度也是 1，那么生成后的图像大小就并没有变化。</p><p>但通常一个卷积过程包括一个激活函数，比如 Sigmoid 和 Relu。</p><p>所以，<strong>在输入不发生尺寸的变化下，却引入了更多的非线性</strong>，这将增强神经网络的表达能力</p><h3 id="升维-降维"><a href="#升维-降维" class="headerlink" title="升维&#x2F;降维"></a>升维&#x2F;降维</h3><p>其实这里的升维、降维具体指的是通道数的变化，当我们确定了卷积核尺寸后，我们的height、width都不变，那么这里的维度具体指的就是channels。我们通过改变卷积核的数量来改变卷积后特征图的通道channels来实现升维、降维的效果。这样可以将原本的数据量进行增加或者减少<br>下面分别举两个例子就能明显看到效果</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4ckn8pum0v.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4ckn8pum0v.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="升维"><a href="#升维" class="headerlink" title="升维"></a>升维</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3nrdop8yvr.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3nrdop8yvr.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="降维"><a href="#降维" class="headerlink" title="降维"></a>降维</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2ruw98zwjt.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2ruw98zwjt.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1e8d57p5wp.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1e8d57p5wp.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>其实很明显的能看出来，无论是升维还是降维，我们都是通过改变卷积核的数量实现的，卷积后的特征图的通道数channels同卷积核的数量保持一致，这里其实不仅仅是1x1卷积核能实现这个功能，其他尺寸的卷积核也可以，那么我们为什么要选用1x1卷积核呢</p><h4 id="使用1x1卷积核升维-降维的原因"><a href="#使用1x1卷积核升维-降维的原因" class="headerlink" title="使用1x1卷积核升维&#x2F;降维的原因"></a>使用1x1卷积核升维&#x2F;降维的原因</h4><p>当我们仅仅只是想要改变通道数的情况下，1x1卷积核是最小的选择，因为大于1x1的卷积核无疑会增加计算的参数量，内存也会随之增大，所以只想单纯的去提升或者降低特征图的通道，选用1x1卷积核最为合适， 1x1卷积核会使用更少的权重参数数量。</p><h3 id="跨通道的信息交互"><a href="#跨通道的信息交互" class="headerlink" title="跨通道的信息交互"></a>跨通道的信息交互</h3><p>1x1卷积核只有一个参数，当它作用在多通道的feature map上时，相当于不同通道上的一个线性组合，实际上就是乘以一个系数再加起来，但是这样输出的feature map就是多个通道的整合信息了，能够使网络提取的特征更加丰富。</p><p>使用1x1卷积核，实现降维和升维的操作其实就是 channel 间信息的线性组合变化。</p><p>比如：在尺寸 3x3，64通道个数的卷积核后面添加一个尺寸1x1，28通道个数的卷积核，就变成了尺寸3x3，28尺寸的卷积核。 原来的64个通道就可以理解为跨通道线性组合变成了28通道，这就是通道间的信息交互。</p><p>注意：只是在通道维度上做线性组合，W和H上是共享权值的滑动窗口。</p><h3 id="减少卷积核参数（简化模型）"><a href="#减少卷积核参数（简化模型）" class="headerlink" title="减少卷积核参数（简化模型）"></a>减少卷积核参数（简化模型）</h3><p>下面仅以计算权重数为例子进行计算（不添加偏差bias）</p><h4 id="一层卷积添加1x1卷积核，分别计算权重数"><a href="#一层卷积添加1x1卷积核，分别计算权重数" class="headerlink" title="一层卷积添加1x1卷积核，分别计算权重数"></a>一层卷积添加1x1卷积核，分别计算权重数</h4><ul><li><p>不使用1x1卷积核</p>  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.839stz0ial.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.839stz0ial.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li><li><p>使用1x1卷积核</p>  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.73tpgsyher.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.73tpgsyher.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li></ul><p>可以看到不使用1x1的卷积核是使用卷积核的10倍左右</p><h4 id="GoogLeNet的3a模块"><a href="#GoogLeNet的3a模块" class="headerlink" title="GoogLeNet的3a模块"></a>GoogLeNet的3a模块</h4><ul><li>不使用1x1卷积核  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.58h4o6olfv.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.58h4o6olfv.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.13ljc2ryvv.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.13ljc2ryvv.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>权重数：192 × (1×1×64) +192 × (3×3×128) + 192 × (5×5×32) &#x3D; 387072<br>这个网络的说明如下</li></ul><ol><li>采用不同大小的卷积核意味着不同大小的感受野，最后拼接意味着不同尺度特征的融合；</li><li>之所以卷积核大小采用1、3和5，主要是为了方便对齐。设定卷积步长stride&#x3D;1之后，只要分别设定pad&#x3D;0、1、2，那么卷积之后便可以得到相同维度的特征，然后这些特征就可以直接拼接在一起了；</li><li>文章说很多地方都表明pooling挺有效，所以Inception里面也嵌入了。</li><li>网络越到后面，特征越抽象，而且每个特征所涉及的感受野也更大了，因此随着层数的增加，3x3和5x5卷积的比例也要增加。</li></ol><ul><li>使用1x1卷积核  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2a4ukoith5.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2a4ukoith5.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7zq6w9eiya.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7zq6w9eiya.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li></ul><p>权重数：192 × (1×1×64) +（192×1×1×96+ 96 × 3×3×128）+（192×1×1×16+16×5×5×32）&#x3D; 157184</p><p>不使用1x1的卷积核是使用1x1卷积核的权重数2倍</p><h4 id="ResNet"><a href="#ResNet" class="headerlink" title="ResNet"></a>ResNet</h4><p>ResNet同样也利用了1×1卷积，并且是在3×3卷积层的前后都使用了，不仅进行了降维，还进行了升维，参数数量进一步减少</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8ojgga406k.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8ojgga406k.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>其中右图又称为<code>bottleneck design</code>，目的一目了然，就是为了降低参数的数目，第一个1x1的卷积把256维channel降到64维，然后在最后通过1x1卷积恢复，<br>当我们的特征图通道数为256时，变得很大，出现的问题是计算复杂度会很高，这里做法是通过1×1卷积投影映射回64维，再做一个3×3通道数不变的卷积，然后再通过1×1卷积投影回去256维，因为输入是256维，输出要匹配上，这样设计之后复杂度就跟左图差不多了。<br>左图参数量：64 x ( 3 x 3 x 64)+64 x ( 3 x 3 x 64 ) &#x3D; 73728<br>当通道数增加到 256时：256 x ( 3 x 3 x 256 ) + 256 x ( 3 x 3 x 256 ) &#x3D; 1179648<br>右图参数量：256 x ( 1 x 1 x 64) + 64 x ( 3 x 3 x 64 ) + 256 x ( 1 x 1 x 64) &#x3D; 69632</p><p>当通道数增加为256时，可以发现添加两层1x1的卷积的参数量和64为原有残差块参数量差不多。</p><p>对于常规ResNet，可以用于34层或者更少的网络中，对于Bottleneck Design的ResNet通常用于更深的网络中，目的是减少计算和参数量（实用目的）</p>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 深度学习 </tag>
            
            <tag> 智能车 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>残差网络</title>
      <link href="/2024/03/21/%E6%AE%8B%E5%B7%AE%E7%BD%91%E7%BB%9C/"/>
      <url>/2024/03/21/%E6%AE%8B%E5%B7%AE%E7%BD%91%E7%BB%9C/</url>
      
        <content type="html"><![CDATA[<div class="tagLink"><a class="link-card" title="详解残差网络" href="https://zhuanlan.zhihu.com/p/42706477"><span class="link-card-backdrop" style="background-image: url(https://pic2.zhimg.com/80/v2-bd76d0f10f84d74f90505eababd3d4a1_1440w.webp)"></span><div class="left"><img src="https://pic2.zhimg.com/80/v2-bd76d0f10f84d74f90505eababd3d4a1_1440w.webp" class="lazyload placeholder" data-srcset="https://pic2.zhimg.com/80/v2-bd76d0f10f84d74f90505eababd3d4a1_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">详解残差网络</p><p class="url">https://zhuanlan.zhihu.com/p/42706477</p></div></a></div><h2 id="WHY要有残差网络"><a href="#WHY要有残差网络" class="headerlink" title="WHY要有残差网络"></a><strong>WHY要有残差网络</strong></h2><blockquote><ul><li><p>首先，当网络发生退化时，意味着随着网络层数的增加，模型的性能并没有相应地提高，甚至可能变得更差。这通常是由于梯度消失、梯度爆炸或者模型优化难度增加导致的。在这种情况下，浅层的网络由于模型复杂度较低，可能更容易优化，因此能够达到更好的训练效果。</p></li><li><p>接下来，如果我们能够<strong>将低层的特征有效地传递到高层</strong>，那么高层网络就有可能利用这些有用的特征来提高性能。这是因为在深度学习中，<strong>低层网络</strong>通常学习一些<strong>基本的、通用的特征</strong>（如边缘、纹理等），而高层网络则在此基础上学习更复杂的特征。如果<strong>高层网络能够重用这些低层的特征，那么它就有可能达到甚至超过浅层网络的性能</strong>。</p></li><li><p>以VGG-100和VGG-16为例，假设我们在VGG-100的第98层和第14层之间<strong>添加一条直接映射</strong>（Identity Mapping）。这意味着第98层的输出将包含第14层的输出作为其一部分。<strong>如果这条直接映射能够有效地传递有用的特征，并且高层网络能够有效地利用这些特征，那么VGG-100的性能理论上应该至少与VGG-16相当，甚至可能更好。</strong></p></li><li><p>然而，需要注意的是，直接映射并不意味着简单地复制和粘贴特征。它需要以一种有效的方式将低层特征整合到高层网络中，以确保高层网络能够充分利用这些特征。此外，还需要考虑如何平衡新旧特征之间的关系，以及如何处理特征维度不匹配等问题。</p></li><li><p>在实际应用中，直接映射的策略已经在一些深度学习架构中得到了应用，如<strong>残差网络（ResNet）和密集连接网络（DenseNet）</strong>。这些网络通过引入残差块或密集连接来实现直接映射，从而有效地缓解了网络退化的问题，并提高了模型的性能。</p></li></ul></blockquote><details open><summary pointer> 高层网络 </summary>              <div class='content'>              <blockquote><p>在一个神经网络中，离输入层更远的网络层通常被称为“深层网络”或“高层网络”，因为它们在网络中的位置更深或更靠近网络的中间部分，而不是直接与输出层相连。这些深层网络通常包括多个隐藏层，并且在网络的层次结构中扮演重要的角色，用于提取更加抽象和高级的特征信息。<br>一个神经网络的层次结构通常包括输入层、多个隐藏层（包括深层网络）和输出层。深层网络在隐藏层中间位置，远离输入层但不是靠近输出层，因为深层网络通常在多层神经网络的结构中处于中间位置。<br>因此，深层网络位于输入层和输出层之间，通过多个隐藏层处理输入数据，逐步提取和学习特征，最终为输出层提供经过多次非线性变换后的表示以完成具体任务。深度学习模型的深度通常指的是隐藏层的层数，而深层网络则是指包含多个隐藏层的部分。</p></blockquote><blockquote><p>高层网络（即深层网络）在深度学习中具有以下特点：</p><ol><li><p><strong>多层结构</strong>：高层网络由多个隐藏层组成，每一层都包含大量的神经元。通过多层结构，网络可以学习和表示更加复杂和抽象的特征。</p></li><li><p><strong>层间连接</strong>：不同层之间的神经元相互连接，信息逐层传递。每一层的输出作为下一层的输入，通过层间连接实现特征的组合和抽象。</p></li><li><p><strong>特征提取</strong>：高层网络可以通过多个隐藏层逐步提取数据中的特征信息，从低级特征到高级特征的逐渐抽象过程有助于网络学习更深层次的表示。</p></li><li><p><strong>表征学习</strong>：通过深度学习，高层网络可以自动学习表示数据的特征，而无需手工设计特征提取器。这种表征学习的方式能够更好地适应不同类型的数据和任务。</p></li><li><p><strong>非线性变换</strong>：高层网络通过激活函数引入非线性变换，使网络能够学习和表示更加复杂的函数关系。非线性激活函数如ReLU、Sigmoid等有助于网络学习非线性模式。</p></li><li><p><strong>端对端学习</strong>：高层网络支持端对端学习，即从原始输入数据端到最终输出结果端的全过程训练。这种端对端学习能够更好地优化整个模型，提高模型的泛化能力和性能。</p></li></ol><p>总的来说，高层网络的特点包括多层结构、特征提取、表征学习、非线性变换等，使得深度学习模型能够更好地适应和解决复杂的机器学习任务。</p></blockquote><blockquote><p>在深度神经网络中，一旦到达最深层级，通常会对网络进行一些操作，以降低网络的深度或减少参数数量，使接下来的层级逐渐变浅。这些操作包括：</p><ol><li><p><strong>降采样（Downsampling）</strong>：通过池化操作（如最大池化或平均池化）或步长较大的卷积操作来减少特征图的宽度和高度，从而减少下一层的神经元数量。</p></li><li><p><strong>特征合并（Feature Concatenation）</strong>：将前几层提取的高级特征与浅层特征进行连接或拼接，使得网络在接下来层级中不需要再学习这些高级特征，从而减少网络的深度。</p></li><li><p><strong>特征选择（Feature Selection）</strong>：对于某些特征进行筛选或降维，只保留最重要的特征，可以通过降维技术（如主成分分析）来实现。</p></li><li><p><strong>残差连接（Residual Connections）</strong>：在残差网络（ResNet）中使用残差连接，使得深层网络可以通过跳过连接获得浅层网络的信息，从而减少深层网络的堆叠层数。</p></li><li><p><strong>特征映射（Feature Mapping）</strong>：通过对特征图进行逐层映射或抽取表示，可以将原始的深层特征映射到浅层网络中，减少网络的深度。</p></li></ol><p>这些操作旨在提高网络的效率和泛化能力，避免深度过深导致的梯度消失、计算量增加和过拟合等问题。通过适当的操作，可以使深度神经网络在保持良好性能的同时，减少深度或层级，提高网络的训练效率和性能。</p></blockquote>              </div>            </details><details open><summary pointer> CNN中的底层、高层特征、上下文信息、多尺度 </summary>              <div class='content'>              <ol><li><p><strong>CNN中的底层、高层特征:</strong></p><p> 简短总结： 分类要求特征有较多的高级信息，回归（定位）要求特征包含更多的细节信息</p><ul><li><p><strong>图像的低层特征</strong>（对定位任务帮助大，我们可以想想比如轮廓信息都不准那怎么去良好定位）:</p><p>  图像底层特征指的是：轮廓、边缘、颜色、纹理、棱角和形状特征。</p><p>  边缘和轮廓能反映图像内容；如果能对边缘和关键点进行可靠提取的话，很多视觉问题就基本上得到了解决。图像的低层的特征语义信息比较少，但越浅的层特征越细节（低级）且特征图分辨率大，所以位置信息很充足，目标位置准确。再从另一个方面讲，越浅层的特征感受野越小（每个像素点映射回原图的覆盖面积小），故用浅层特征图检测大目标时就有点像瞎子摸象的感觉效果并不好，因为光能看到象腿也不知道这是啥东西。当然对于小目标检测来说如果能利用足够的上下文信息也是有好处的！例如，通过只看图中的一个小目标所在的那个位置，人类甚至很难识别这些物体。然而，通过考虑到它位于天空中的背景，这个物体可以被识别为鸟类。因此，我们认为，解决这个问题的关键取决于我们如何将上下文作为额外信息来帮助检测小目标。</p></li><li><p><strong>图像的高层特征</strong>也叫语义特征（高层特征即CNN中网络越深的层得到的特征，高层的特征包含很丰富的组合信息，象征着人对它的分辨能力，越高层越好分辨出是啥东西，如表征着类别啥的，对识别任务帮助大）:</p></li></ul><p> 图像的高层语义特征值得是我们所能看的东西，比如对一张人脸提取低层特征我们可以提取到连的轮廓、鼻子、眼睛之类的，那么高层的特征就显示为一张人脸。高层的特征语义信息比较丰富，但是目标位置比较粗略。</p><p> 愈深层特征包含的高层语义性愈强、分辨能力也愈强。我们把图像的视觉特征称为视觉空间 (visual space)，把种类的语义信息称为语义空间 (semantic space)</p></li><li><p><strong>上下文信息</strong></p><p> 做图像的，上下文特征是很常见的，其实上下文大概去理解就是图像中的每一个像素点不可能是孤立的，一个像素一定和周围像素是有一定的关系的，大量像素的互相联系才产生了图像中的各种物体，所以上下文特征就指像素以及周边像素的某种联系。</p><p> 具体到图像语义分割，一般论文会说我们的XXX算法充分结合了上下文信息，意思也就是在判断某一个位置上的像素属于哪种类别的时候，不仅考察到该像素的灰度值，还充分考虑和它临近的像素。</p><p> 然后上下文信息还分全局和局部，意思就是考虑全图不同范围内的像素和只考虑邻近的一些像素。</p><p> 全局上下文信息 也可以理解为能够捕捉来自更多的不同尺度的上下文信息，不同尺度就是指不同感受野。</p></li><li><p><strong>多尺度</strong></p><p> 个人感觉，多尺度 就是 你能看到的范围（看到尺度就理解为CNN的感受野就完事了！！！）。</p><p> 图像中一个东西的尺度越大，就指距离越近相当于被放大了，那么给人感觉就越模糊。例如：</p><ul><li><p>训练的时候，把图片缩放到不同大小输入给同一个网络，网络就能看到不一样大小范围的内容，缩放得分辨率越高就指尺度越大，因为对图中的某一个物体来讲就是被放大的感觉。然后就是因为缩放后，比如中间特征图上的某个像素点都只能看到原图3乘3的区域，可随着输入的图片尺度不一样，同样是看到的3乘3区域，但相对于整张图的范围也自然就不一样了，然后就叫做多尺度训练；好处是可以适应不同尺度的输入，泛化性好。</p></li><li><p>把一个特征层用由不同感受野的卷积核组成的网络层（例如SPP）处理，这层网络的同一个像素位置就能看到不同范围的上层特征，就叫做多尺度特征融合；好处是能考虑到不同范围的空间特征上下文（例如头发下面一般会有一张脸）。</p></li><li><p>把一个网络中不同深度的层做融合：浅层感受野小，分辨率大，能够处理并保存小尺度的几何特征；高层感受野大，分辨率小，能够处理并保存大尺度的语义特征。这也叫做多尺度特征融合；好处是能够将语义特征和几何特征进行融合（例如这块区域是头发，低分辨率图上的分界线一般是线状特征和非线状特征的边界）。</p></li></ul></li></ol>              </div>            </details><blockquote><p>从信息论的角度讲，由于DPI(数据处理不等式)的存在，在前向传输的过程中，随着层数的加深，Feature Map包含的图像信息会逐层减少，而ResNet的直接映射的加入，保证了$l+1$层的网络一定比$l$层包含更多的图像信息。</p><details open><summary pointer> 解释 </summary>              <div class='content'>              <p>保证了$l+1$层的网络一定比l层包含更多的图像信息，这是因为直接映射（恒等映射）将前一层的信息无损地传递到了后一层，确保了信息的完整性。同时，由于残差部分的存在，网络可以学习输入和输出之间的差值，即残差。这个残差部分可能会引入一些新的、有用的特征或模式，这些特征或模式在之前的层中可能并不存在。这些新增的特征或模式会与直接映射的信息相结合，导致$l+1$层的信息量实际上比$l$层更多。<br>换句话说，直接映射保证了信息量的下限（即至少与前一层相同），而残差部分则有可能增加额外的信息量。因此，综合这两部分，$l+1$层的网络包含的信息量一定会比$l$层更多。这也是ResNet能够在增加网络深度的同时保持甚至提高性能的关键原因之一。<br>需要注意的是，这里的“更多”并不意味着绝对的信息量一定更大，而是指相对于前一层，后一层有可能包含更多的有用特征或模式。在实际应用中，还需要考虑其他因素，如网络的训练方式、数据集的质量等，来综合评估网络性能。</p>              </div>            </details><p>基于这种使用直接映射来连接网络不同层直接的思想，残差网络应运而生。</p></blockquote><h2 id="残差网络"><a href="#残差网络" class="headerlink" title="残差网络"></a>残差网络</h2><h3 id="残差块"><a href="#残差块" class="headerlink" title="残差块"></a>残差块</h3><p>残差网络是由一系列残差块组成的（图1）。一个残差块可以用表示为：</p><p class='p center'>$x_{l+1}=x_l+F(x_l，W_l)$</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.969i4oz9f9.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.969i4oz9f9.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="图1:残差块"/></div><span class="image-caption">图1:残差块</span></div><blockquote><p>图1中的Weight在卷积网络中是指卷积操作，addition指的是单位加操作，即在卷积计算中的相加步骤。<br>卷积计算的4个步骤为反折、平移、相乘、相加。将两组数进行卷积后，变成第三组数，其中相加就是addition。</p></blockquote><p><strong>残差块分成两部分-直接映射部分和残差部分。</strong></p><ul><li>$h(x_l)$是直接映射，反应在图1中是左边的曲线</li><li>$F(x_l，W_l)$是残差部分，一般由两个或者三个卷积操作构成，即图1中右侧包含卷积的部分。</li></ul><p>在卷积网络中,$x_l$可能和$x_{l+1}$的Feature Map的数量不一样，这时候就需要使用$1×1$卷积进行升维或者降维（图2）。</p><div class="tagLink"><a class="link-card" title="$1×1$卷积核" href="https://tumytime.space/2024/03/21/1x1%E5%8D%B7%E7%A7%AF%E6%A0%B8/"><span class="link-card-backdrop" style="background-image: url(https://tumytime.github.io/picx-images-hosting/image.7awxc3fekp.webp)"></span><div class="left"><img src="https://tumytime.github.io/picx-images-hosting/image.7awxc3fekp.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7awxc3fekp.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">$1×1$卷积核</p><p class="url">https://tumytime.space/2024/03/21/1x1%E5%8D%B7%E7%A7%AF%E6%A0%B8/</p></div></a></div><p>这时，残差块表示为：</p><p class='p center'>$x_{l+1}=h(x_l)+F(x_l，W_l)$</p><p>其中$h(x_l)&#x3D;W_l^{‘}x$。其中$W_l^{‘}$是$1×1$卷积操作，但是实验结果$1×1$卷积对模型性能提升有限，所以一般是在升维或者降维时才会使用。</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.54xiqiz1jd.webp ,alt=$1×1$残差块" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.54xiqiz1jd.webp ,alt=$1×1$残差块" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>一般，这种版本的残差块叫做resnet_v1，keras代码实现如下：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">res_block_v1</span>(<span class="params">x, input_filter, output_filter</span>):</span><br><span class="line">    res_x = Conv2D(kernel_size=(<span class="number">3</span>,<span class="number">3</span>), filters=output_filter, strides=<span class="number">1</span>, padding=<span class="string">&#x27;same&#x27;</span>)(x)</span><br><span class="line">    res_x = BatchNormalization()(res_x)</span><br><span class="line">    res_x = Activation(<span class="string">&#x27;relu&#x27;</span>)(res_x)</span><br><span class="line">    res_x = Conv2D(kernel_size=(<span class="number">3</span>,<span class="number">3</span>), filters=output_filter, strides=<span class="number">1</span>, padding=<span class="string">&#x27;same&#x27;</span>)(res_x)</span><br><span class="line">    res_x = BatchNormalization()(res_x)</span><br><span class="line">    <span class="keyword">if</span> input_filter == output_filter:</span><br><span class="line">        identity = x</span><br><span class="line">    <span class="keyword">else</span>: <span class="comment">#需要升维或者降维</span></span><br><span class="line">        identity = Conv2D(kernel_size=(<span class="number">1</span>,<span class="number">1</span>), filters=output_filter, strides=<span class="number">1</span>, padding=<span class="string">&#x27;same&#x27;</span>)(x)</span><br><span class="line">    x = keras.layers.add([identity, res_x])</span><br><span class="line">    output = Activation(<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line">    <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure><p>这段代码定义了一个简单的残差块（residual block），用于构建残差神经网络（ResNet）中的一个基本单元。在这段代码中，<code>res_block_v1</code>函数接受输入特征<code>x</code>，输入的卷积核数量<code>input_filter</code>和输出的卷积核数量<code>output_filter</code>作为参数，然后构建一个残差块，并返回处理后的输出特征。</p><p>具体实现过程如下：</p><ol><li>使用一个3x3大小的卷积核，输出通道数为<code>output_filter</code>，步长为1，填充方式为’same’进行卷积操作，并接上BatchNormalization层和ReLU激活函数。</li><li>再次使用一个3x3大小的卷积核，输出通道数为<code>output_filter</code>，步长为1，填充方式为’same’进行卷积操作，并接上BatchNormalization层。</li><li>根据输入卷积核数量和输出卷积核数量是否相等，判断是否需要进行维度加减变换，如果相等则直接将输入特征作为恒等映射（identity），否则使用1x1的卷积核进行维度变换。</li><li>将恒等映射和经过两次卷积操作的特征相加，得到残差连接。</li><li>对残差连接的结果进行ReLU激活函数操作，最终输出处理后的特征。</li></ol><p>这段代码展示了如何实现一个简单的残差块，用于搭建深度残差神经网络，通过残差连接来解决深度神经网络训练中的梯度消失和梯度爆炸问题，帮助网络更好地训练和优化。</p><h3 id="残差网络的搭建"><a href="#残差网络的搭建" class="headerlink" title="残差网络的搭建"></a>残差网络的搭建</h3><p>残差网络的搭建分为两步：</p><ol><li>使用VGG公式搭建Plain VGG网络</li><li>在Plain VGG的卷积网络之间插入Identity Mapping，注意需要升维或者降维的时候加入$1×1$卷积。<br>在实现过程中，一般是直接stack残差块的方式。<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">resnet_v1</span>(<span class="params">x</span>):</span><br><span class="line">    x = Conv2D(kernel_size=(<span class="number">3</span>,<span class="number">3</span>), filters=<span class="number">16</span>, strides=<span class="number">1</span>, padding=<span class="string">&#x27;same&#x27;</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line">    x = res_block_v1(x, <span class="number">16</span>, <span class="number">16</span>)</span><br><span class="line">    x = res_block_v1(x, <span class="number">16</span>, <span class="number">32</span>)</span><br><span class="line">    x = Flatten()(x)</span><br><span class="line">    outputs = Dense(<span class="number">10</span>, activation=<span class="string">&#x27;softmax&#x27;</span>, kernel_initializer=<span class="string">&#x27;he_normal&#x27;</span>)(x)</span><br><span class="line">    <span class="keyword">return</span> outputs</span><br></pre></td></tr></table></figure></li></ol><h3 id="为什么叫残差网络"><a href="#为什么叫残差网络" class="headerlink" title="为什么叫残差网络"></a>为什么叫残差网络</h3><p>在统计学中，残差和误差是非常容易混淆的两个概念。误差是衡量观测值和真实值之间的差距，残差是指预测值和观测值之间的差距。对于残差网络的命名原因，作者给出的解释是，网络的一层通常可以看做$y&#x3D;H(x)$, 而残差网络的一个残差块可以表示为$H(x)&#x3D;F(x)+x$，也就是$F(x)&#x3D;H(x)-x$，在单位映射中，$y&#x3D;x$便是观测值，而$H(x)$是预测值，所以$F(x)$便对应着残差，因此叫做残差网络。</p><h3 id="略"><a href="#略" class="headerlink" title="略"></a>略</h3><h3 id="将激活函数移动到残差部分可以提高模型的精度"><a href="#将激活函数移动到残差部分可以提高模型的精度" class="headerlink" title="将激活函数移动到残差部分可以提高模型的精度"></a>将激活函数移动到残差部分可以提高模型的精度</h3><p>该网络一般就在resnet_v2，keras实现如下：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">res_block_v2</span>(<span class="params">x, input_filter, output_filter</span>):</span><br><span class="line">    res_x = BatchNormalization()(x)</span><br><span class="line">    res_x = Activation(<span class="string">&#x27;relu&#x27;</span>)(res_x)</span><br><span class="line">    res_x = Conv2D(kernel_size=(<span class="number">3</span>,<span class="number">3</span>), filters=output_filter, strides=<span class="number">1</span>, padding=<span class="string">&#x27;same&#x27;</span>)(res_x)</span><br><span class="line">    res_x = BatchNormalization()(res_x)</span><br><span class="line">    res_x = Activation(<span class="string">&#x27;relu&#x27;</span>)(res_x)</span><br><span class="line">    res_x = Conv2D(kernel_size=(<span class="number">3</span>,<span class="number">3</span>), filters=output_filter, strides=<span class="number">1</span>, padding=<span class="string">&#x27;same&#x27;</span>)(res_x)</span><br><span class="line">    <span class="keyword">if</span> input_filter == output_filter:</span><br><span class="line">        identity = x</span><br><span class="line">    <span class="keyword">else</span>: <span class="comment">#需要升维或者降维</span></span><br><span class="line">        identity = Conv2D(kernel_size=(<span class="number">1</span>,<span class="number">1</span>), filters=output_filter, strides=<span class="number">1</span>, padding=<span class="string">&#x27;same&#x27;</span>)(x)</span><br><span class="line">    output= keras.layers.add([identity, res_x])</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resnet_v2</span>(<span class="params">x</span>):</span><br><span class="line">    x = Conv2D(kernel_size=(<span class="number">3</span>,<span class="number">3</span>), filters=<span class="number">16</span> , strides=<span class="number">1</span>, padding=<span class="string">&#x27;same&#x27;</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line">    x = res_block_v2(x, <span class="number">16</span>, <span class="number">16</span>)</span><br><span class="line">    x = res_block_v2(x, <span class="number">16</span>, <span class="number">32</span>)</span><br><span class="line">    x = BatchNormalization()(x)</span><br><span class="line">    y = Flatten()(x)</span><br><span class="line">    outputs = Dense(<span class="number">10</span>, activation=<span class="string">&#x27;softmax&#x27;</span>, kernel_initializer=<span class="string">&#x27;he_normal&#x27;</span>)(y)</span><br><span class="line">    <span class="keyword">return</span> outputs</span><br></pre></td></tr></table></figure><h2 id="分割线"><a href="#分割线" class="headerlink" title="分割线*******************"></a>分割线*******************</h2>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 深度学习 </tag>
            
            <tag> 智能车 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蓝桥杯stm32学习笔记（八）：模数转换ADC</title>
      <link href="/2024/03/18/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AB%EF%BC%89%EF%BC%9A%E6%A8%A1%E6%95%B0%E8%BD%AC%E6%8D%A2ADC/"/>
      <url>/2024/03/18/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AB%EF%BC%89%EF%BC%9A%E6%A8%A1%E6%95%B0%E8%BD%AC%E6%8D%A2ADC/</url>
      
        <content type="html"><![CDATA[<h3 id="CubeMX配置"><a href="#CubeMX配置" class="headerlink" title="CubeMX配置"></a>CubeMX配置</h3><h4 id="配置引脚"><a href="#配置引脚" class="headerlink" title="配置引脚"></a>配置引脚</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2h82d2oxha.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2h82d2oxha.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>我们这里先只用R37</p><p>配置<code>PB15</code>为<code>ADC2_IN15</code></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.6t6vkmcqb6.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.6t6vkmcqb6.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>选择<code>Single_ended</code></p><h4 id="生成工程"><a href="#生成工程" class="headerlink" title="生成工程"></a>生成工程</h4><p><strong>点击右上角”GENERATE CODE”,生成工程</strong></p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><h4 id="aadc-c"><a href="#aadc-c" class="headerlink" title="aadc.c"></a>aadc.c</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;aadc.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">double</span> <span class="title function_">getADC</span><span class="params">(ADC_HandleTypeDef *pin)</span></span><br><span class="line">&#123;</span><br><span class="line">uint adc;</span><br><span class="line">HAL_ADC_Start (pin);</span><br><span class="line">adc = HAL_ADC_GetValue(pin);</span><br><span class="line"><span class="keyword">return</span> adc*<span class="number">3.3</span>/<span class="number">4096</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="aadc-h"><a href="#aadc-h" class="headerlink" title="aadc.h"></a>aadc.h</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">double</span> <span class="title function_">getADC</span><span class="params">(ADC_HandleTypeDef *pin)</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这个函数 <code>getADC</code> 是一个用于从ADC（模拟到数字转换器）读取模拟信号并将其转换为电压值的函数。让我们一步步地分析这个函数：</p><ol><li><strong>函数签名</strong>:</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">getADC</span><span class="params">(ADC_HandleTypeDef *pin)</span></span><br></pre></td></tr></table></figure><ul><li><code>double</code>: 函数的返回类型是<code>double</code>，这意味着它将返回一个浮点数。</li><li><code>ADC_HandleTypeDef *pin</code>: 函数接受一个指向<code>ADC_HandleTypeDef</code>类型的指针，这个指针指向一个ADC句柄，它包含了ADC的配置信息和状态信息。</li></ul><ol start="2"><li><strong>函数体</strong>:</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> uint adc;</span><br><span class="line"> HAL_ADC_Start (pin);</span><br><span class="line"> adc = HAL_ADC_GetValue(pin);</span><br><span class="line"> <span class="keyword">return</span> adc*<span class="number">3.3</span>/<span class="number">4096</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>uint adc;</code>: 定义了一个无符号整数变量<code>adc</code>，用于存储从ADC读取的原始值。</li><li><code>HAL_ADC_Start (pin);</code>: 调用HAL库（硬件抽象层库）中的<code>HAL_ADC_Start</code>函数来启动指定的ADC。这个函数接受一个ADC句柄（即<code>pin</code>）作为参数。</li><li><code>adc = HAL_ADC_GetValue(pin);</code>: 在ADC转换完成后，调用<code>HAL_ADC_GetValue</code>函数来获取转换后的ADC值，并将其存储在<code>adc</code>变量中。</li><li><code>return adc*3.3/4096;</code>: 返回转换后的电压值。这里假设ADC是一个12位的ADC（因此最大值是4095或4096，取决于具体的实现和计数方式），其参考电压是3.3V。因此，<code>adc*3.3/4096</code>这个公式将ADC的原始读数转换成了相应的电压值。</li></ul><p>总之，这个函数的主要目的是从指定的ADC读取模拟信号，并将其转换为一个表示电压的浮点数。这个电压值是基于ADC的参考电压（在这个例子中是3.3V）和ADC的位数（在这个例子中是12位）来计算的。</p>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>蓝桥杯stm32学习笔记（七）：输入捕获（频率，占空比测量）</title>
      <link href="/2024/03/18/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%83%EF%BC%89%EF%BC%9A%E8%BE%93%E5%85%A5%E6%8D%95%E8%8E%B7%EF%BC%88%E9%A2%91%E7%8E%87%EF%BC%8C%E5%8D%A0%E7%A9%BA%E6%AF%94%E6%B5%8B%E9%87%8F%EF%BC%89/"/>
      <url>/2024/03/18/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%83%EF%BC%89%EF%BC%9A%E8%BE%93%E5%85%A5%E6%8D%95%E8%8E%B7%EF%BC%88%E9%A2%91%E7%8E%87%EF%BC%8C%E5%8D%A0%E7%A9%BA%E6%AF%94%E6%B5%8B%E9%87%8F%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<blockquote><p>跳线帽拔了不能烧工程。。。。(好像可以。。。那天不知道怎么了板子抽风)</p></blockquote><h3 id="CubeMX配置"><a href="#CubeMX配置" class="headerlink" title="CubeMX配置"></a>CubeMX配置</h3><h4 id="配置引脚"><a href="#配置引脚" class="headerlink" title="配置引脚"></a>配置引脚</h4><p><strong>我们这里使用<code>PA7</code>进行捕获</strong></p><p><strong>配置<code>PA7</code>为<code>TIM17_CH1</code></strong><br>(只有一个通道没关系，我的题目里不用测占空比，但是我后面会写加上测占空比的引脚和程序的)</p><ul><li>配置一下引脚  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.5j3yd4e8d4.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.5j3yd4e8d4.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li><li>使能定时器中断  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7awx810hqy.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7awx810hqy.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li></ul><h4 id="生成工程"><a href="#生成工程" class="headerlink" title="生成工程"></a>生成工程</h4><p><strong>点击右上角”GENERATE CODE”,生成工程</strong></p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><h4 id="中断函数"><a href="#中断函数" class="headerlink" title="中断函数"></a>中断函数</h4><p><strong>interrupt.c中：</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">uint ccrl_val=<span class="number">0</span>;</span><br><span class="line">uint frq=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">HAL_TIM_IC_CaptureCallback</span><span class="params">(TIM_HandleTypeDef *htim)</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>中断回调函数名记不住的话和按键那一章一样，在tim.h文件里找</p><details open><summary pointer> 中断回调函数 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">HAL_TIM_IC_CaptureCallback</span><span class="params">(TIM_HandleTypeDef *htim)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(htim-&gt;Instance==TIM17)</span><br><span class="line">&#123;</span><br><span class="line">ccrl_val = HAL_TIM_ReadCapturedValue(htim,TIM_CHANNEL_1);</span><br><span class="line">frq=(<span class="number">80000000</span>/<span class="number">80</span>)/ccrl_val;</span><br><span class="line">__HAL_TIM_SetCounter(htim,<span class="number">0</span>);</span><br><span class="line">HAL_TIM_IC_Start(htim,TIM_CHANNEL_1);<span class="comment">//IC:Input Capture</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><blockquote><p>注意自己写的中断回调函数有什么用，如果不写自己的回调函数，已设置的中断照样正常运行，自己的函数是用来特殊化一些中断流程的，没有特殊化的仍旧按照默认正常运行</p></blockquote><blockquote><p><strong>原理解释:</strong><br>当TIM17的中断触发(因为配置了上升沿触发，即当检测到上升沿时)<br>进入中断回调函数<br>因为最后一行才启动定时器的输入捕获通道1<br>所以第一次触发后，计数器归0(__HAL_TIM_SetCounter(htim,0);)<br>启动定时器的输入捕获通道1,开始计数<br>第二次触发中断(即第二次上升沿)<br>ccrl_val读取到两个上升沿间隔(因为第一个上升沿才开始计数)<br>所以频率等于时钟主频除以分频系数除以周期计数<br>重新启动定时器的输入捕获通道1</p></blockquote><h4 id="main-c中配置"><a href="#main-c中配置" class="headerlink" title="main.c中配置"></a>main.c中配置</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> uint frq;</span><br><span class="line">uchar pa1_duty=<span class="number">10</span>;<span class="comment">//初始化占空比</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>main函数里的初始化:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">HAL_TIM_Base_Start_IT(&amp;htim4 );<span class="comment">//按键的定时器</span></span><br><span class="line">HAL_TIM_PWM_Start(&amp;htim2,TIM_CHANNEL_2);<span class="comment">//PA1的PWM输出开启</span></span><br><span class="line"></span><br><span class="line">HAL_TIM_IC_Start_IT(&amp;htim17,TIM_CHANNEL_1);<span class="comment">//频率测量捕获定时器开启</span></span><br><span class="line"></span><br><span class="line">__HAL_TIM_SetCompare(&amp;htim2,TIM_CHANNEL_2,pa1_duty);<span class="comment">//设置初始pwm频率</span></span><br></pre></td></tr></table></figure><h3 id="同时测频率和占空比："><a href="#同时测频率和占空比：" class="headerlink" title="同时测频率和占空比："></a>同时测频率和占空比：</h3><h4 id="引脚配置"><a href="#引脚配置" class="headerlink" title="引脚配置"></a>引脚配置</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.41xtci74hr.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.41xtci74hr.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/////////////////////////////测量频率+占空比///////////////////</span></span><br><span class="line"><span class="type">double</span> ccr1_val1a=<span class="number">0</span>,ccr1_val2a=<span class="number">0</span>;</span><br><span class="line">uint ccr1_val1b=<span class="number">0</span>,ccr1_val2b=<span class="number">0</span>;</span><br><span class="line">uint frq1=<span class="number">0</span>,frq2=<span class="number">0</span>;<span class="comment">//频率</span></span><br><span class="line"><span class="type">float</span> duty1=<span class="number">0</span>,duty2=<span class="number">0</span>;<span class="comment">//占空比</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">HAL_TIM_IC_CaptureCallback</span><span class="params">(TIM_HandleTypeDef *htim)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(htim-&gt;Instance==TIM17)<span class="comment">//PA7</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//if(htim-&gt;Channel==HAL_TIM_ACTIVE_CHANNEL_1)//中断消息来源 选择直接输入的通道</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line">ccr1_val1a=HAL_TIM_ReadCapturedValue(htim,TIM_CHANNEL_1);<span class="comment">//直接</span></span><br><span class="line"><span class="comment">//ccr1_val1b=HAL_TIM_ReadCapturedValue(htim,TIM_CHANNEL_2);//间接</span></span><br><span class="line">__HAL_TIM_SetCounter(htim,<span class="number">0</span>);</span><br><span class="line">frq1=(<span class="number">80000000</span>/<span class="number">80</span>)/ccr1_val1a;</span><br><span class="line"><span class="comment">//duty1=(ccr1_val1b/ccr1_val1a)*100;</span></span><br><span class="line">HAL_TIM_IC_Start(htim,TIM_CHANNEL_1);</span><br><span class="line"><span class="comment">//HAL_TIM_IC_Start(htim,TIM_CHANNEL_2);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(htim-&gt;Instance==TIM3)<span class="comment">//PB4</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(htim-&gt;Channel==HAL_TIM_ACTIVE_CHANNEL_1)<span class="comment">//中断消息来源 选择直接输入的通道</span></span><br><span class="line">&#123;</span><br><span class="line">ccr1_val2a=HAL_TIM_ReadCapturedValue(htim,TIM_CHANNEL_1);</span><br><span class="line">ccr1_val2b=HAL_TIM_ReadCapturedValue(htim,TIM_CHANNEL_2);</span><br><span class="line">__HAL_TIM_SetCounter(htim,<span class="number">0</span>);</span><br><span class="line">frq2=(<span class="number">80000000</span>/<span class="number">80</span>)/ccr1_val2a;</span><br><span class="line">duty2=(ccr1_val2b/ccr1_val2a)*<span class="number">100</span>;</span><br><span class="line">HAL_TIM_IC_Start(htim,TIM_CHANNEL_1);</span><br><span class="line">HAL_TIM_IC_Start(htim,TIM_CHANNEL_2);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式 </tag>
            
            <tag> stm32 </tag>
            
            <tag> 蓝桥杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蓝桥杯stm32学习笔记（六）：PWM输出</title>
      <link href="/2024/03/17/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89%EF%BC%9APWM%E8%BE%93%E5%87%BA/"/>
      <url>/2024/03/17/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89%EF%BC%9APWM%E8%BE%93%E5%87%BA/</url>
      
        <content type="html"><![CDATA[<blockquote><p>PWM的占空比改变的是CCR寄存器的值（不同通道对应不同的CCR），频率的改变对应的是ARR寄存器的值</p></blockquote><h3 id="CubeMX配置"><a href="#CubeMX配置" class="headerlink" title="CubeMX配置"></a>CubeMX配置</h3><h4 id="配置引脚"><a href="#配置引脚" class="headerlink" title="配置引脚"></a>配置引脚</h4><blockquote><p>频率是指PWM信号的周期性重复频率，即PWM信号在一段时间内完整周期重复的次数。频率与占空比和自动重载值之间存在以下关系：</p><ol><li>PWM信号的频率 &#x3D; 1 &#x2F; PWM信号的周期</li><li>PWM信号的周期 &#x3D; 自动重载值 + 1</li><li>PWM信号的占空比 &#x3D; 高电平时间 &#x2F; PWM信号的周期</li></ol></blockquote><p><strong>我们这里配置PC9输出PWM波</strong><br>配置<code>PC9</code>引脚为<code>TIM3_CH4</code>,选择定时器<code>TIM3</code>的通道4(有哪个用哪个)<br>(后面带<code>N</code>的是互补PWM波)</p><blockquote><p>PWM频率 &#x3D; 1 &#x2F; (周期时间)<br>单个脉冲宽度 &#x3D; (占空比) * (周期时间)</p></blockquote><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.ibvk6580f.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.ibvk6580f.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="生成工程"><a href="#生成工程" class="headerlink" title="生成工程"></a>生成工程</h4><p><strong>点击右上角”GENERATE CODE”,生成工程</strong></p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><h4 id="打开定时器"><a href="#打开定时器" class="headerlink" title="打开定时器"></a>打开定时器</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HAL_TIM_PWM_Start(&amp;htim3,TIM_CHANNEL_4);</span><br></pre></td></tr></table></figure><h4 id="编写代码"><a href="#编写代码" class="headerlink" title="编写代码"></a>编写代码</h4><details open><summary pointer> while(1) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">LED_Disp(<span class="number">0x00</span>);<span class="comment">//LED的初始化</span></span><br><span class="line"><span class="keyword">if</span>(key[<span class="number">2</span>].single_flag==<span class="number">1</span>) &#123;</span><br><span class="line"></span><br><span class="line">w+=<span class="number">1000</span>;</span><br><span class="line"><span class="keyword">if</span>(w&gt;<span class="number">10000</span>)</span><br><span class="line">&#123;</span><br><span class="line">w=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">TIM3-&gt;CCR4 = w;</span><br><span class="line">key[<span class="number">2</span>].single_flag=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE END WHILE */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE BEGIN 3 */</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式 </tag>
            
            <tag> stm32 </tag>
            
            <tag> 蓝桥杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蓝桥杯stm32学习笔记（五）：按键</title>
      <link href="/2024/03/16/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%94%EF%BC%89%EF%BC%9A%E6%8C%89%E9%94%AE/"/>
      <url>/2024/03/16/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%94%EF%BC%89%EF%BC%9A%E6%8C%89%E9%94%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="短按键"><a href="#短按键" class="headerlink" title="短按键"></a>短按键</h2><h3 id="电路图"><a href="#电路图" class="headerlink" title="电路图"></a>电路图</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1lbkuno8bo.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1lbkuno8bo.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>按键按下后接地变为低电平，未按下为高电平；</p><h4 id="不用定时器的简单按键："><a href="#不用定时器的简单按键：" class="headerlink" title="不用定时器的简单按键："></a>不用定时器的简单按键：</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(HAL_GPIO_ReadPin (GPIOB,GPIO_PIN_0)==GPIO_PIN_RESET ) &#123;</span><br><span class="line">HAL_GPIO_WritePin(GPIOC,GPIO_PIN_8,GPIO_PIN_RESET );</span><br><span class="line">HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_SET);</span><br><span class="line">HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_RESET);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">HAL_GPIO_WritePin(GPIOC,GPIO_PIN_8,GPIO_PIN_SET );</span><br><span class="line">HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_SET);</span><br><span class="line">HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_RESET);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="CubeMX配置"><a href="#CubeMX配置" class="headerlink" title="CubeMX配置"></a>CubeMX配置</h3><h4 id="引脚配置"><a href="#引脚配置" class="headerlink" title="引脚配置"></a>引脚配置</h4><p>配置<code>PB0-2</code>和<code>PA0</code>为<code>GPIO_Input</code><br>并将<code>GPIO Pull-up/Pull-down</code>配置为<code>Pull-up</code></p><h4 id="定时器配置"><a href="#定时器配置" class="headerlink" title="定时器配置"></a>定时器配置</h4><p>选一个定时器（这里选择TIM4）</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7smyutv65f.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7smyutv65f.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>配置时钟源为内部时钟</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.wibapqvqk.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.wibapqvqk.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><details open><summary pointer> 选项解释 </summary>              <div class='content'>              <ol><li><p><strong>Prescaler (PSC-16 bits value)</strong>:</p><ul><li>Prescaler是用于将输入时钟频率进行分频的参数，以降低计数器的工作频率。16位值表示了分频比，用于控制计数器每次计数之前如何分频输入时钟。较大的分频比会使计数器工作在较低的频率下。例如，如果一个系统的输入时钟频率为10 MHz，而计数器需要以1 kHz的频率进行计数，那么可以通过设置适当的预分频器值来实现这一要求。假设我们设置预分频器的16位值为10000，在这种情况下，输入时钟在进入计数器之前会先进行10,000倍的分频。这样，每10,000个输入时钟周期，计数器才会计数一次，从而使得计数器的工作频率为1 kHz。不同的应用场景会有不同的计数需求。例如，某些应用可能需要高速计数，一种计数器的频率可能需要达到几十MHz甚至更高的频率。在这种情况下，计数器需要以更高的速率进行计数，以满足对计数精度和速度的要求。另一方面，一些应用可能只需要低速计数，比如在一些传感器监测系统中，计数器可以以较低的频率进行计数，以实时监测并记录事件发生的次数。</li></ul></li><li><p><strong>Counter Mode</strong>:</p><ul><li>此处设置计数器的工作模式为”Up”，即计数器会从0开始递增计数，计数到最大值后重新从0开始。</li></ul></li><li><p><strong>Dithering</strong>:</p><ul><li>在这里设置了禁用抖动（Dithering），抖动是指通过微小的随机变化来减小量化误差的一种技术。在这种情况下，抖动被禁用，即不会在计数器中引入这种微小的变化。</li></ul></li><li><p><strong>Counter Period (AutoReload Register)</strong>:</p><ul><li>设置计数器的计数周期，通常通过AutoReload Register（自动重装载寄存器）来实现。在这里设置了计数器的周期为0到65535之间的值，当计数器达到最大值时会重新加载初始值。</li></ul></li><li><p><strong>Internal Clock Division (CKD)</strong>:</p><ul><li>设置内部时钟分频（CKD），在这里选择了”No Division”，表示计数器的时钟不会被分频，以确保计数器运行在输入时钟的最高频率下。</li></ul></li><li><p><strong>Auto-reload preload</strong>:</p><ul><li>在这里禁用了自动加载预设值功能，即不会在计数器自动重新加载时预先装载新的值。</li></ul></li></ol><p>这些设置有助于调整计时器&#x2F;计数器的行为和性能，例如调整计数模式、周期以及时钟分频等，以满足特定的应用需求。通过合理设置这些参数，可以有效地控制计时器&#x2F;计数器的功能，确保其在系统中正确、稳定地运行。</p>              </div>            </details><ol><li><p><strong>Prescaler</strong>:分频系数，决定定时器的工作频率<br> 定时器工作频率&#x3D;外部总线频率(80MHz)&#x2F;(PSC+1)<br> 这里设置为80-1,即定时器工作频率&#x3D;80，000，000&#x2F;80&#x3D;1，000，000</p></li><li><p><strong>Counter Period</strong>:<br> 定时频率&#x3D;定时器工作频率&#x2F;counter<br> 这里设置为10000-1,即定时频率&#x3D;1，000，000&#x2F;10，000&#x3D;100Hz，即定时周期10ms;<br> 10ms中断一次；</p></li></ol><p><strong>使能中断</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4n7gvyvfe6.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4n7gvyvfe6.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="生成工程"><a href="#生成工程" class="headerlink" title="生成工程"></a>生成工程</h4><p><strong>点击右上角”GENERATE CODE”,生成工程</strong></p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><h4 id="新建两个文件"><a href="#新建两个文件" class="headerlink" title="新建两个文件"></a>新建两个文件</h4><p>保存<code>interrupt.c</code>和<code>interrupt.h</code>到<code>bsp</code>文件夹<br>然后添加<code>interrupt.c</code>到项目<code>bsp</code>文件夹里</p><h4 id="写中断回调函数"><a href="#写中断回调函数" class="headerlink" title="写中断回调函数"></a>写中断回调函数</h4><p>记不住函数名复制这个:</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.wibaqozwy.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.wibaqozwy.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="interrupt-h"><a href="#interrupt-h" class="headerlink" title="interrupt.h"></a>interrupt.h</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _INTERRUPT_H_</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _INTERRUPT_H_</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdbool.h&quot;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">keys</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">uchar judge;</span><br><span class="line"><span class="type">bool</span> status;</span><br><span class="line"><span class="type">bool</span> single_flag;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><h4 id="interrupt-c"><a href="#interrupt-c" class="headerlink" title="interrupt.c"></a>interrupt.c</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;interrupt.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">keys</span> <span class="title">key</span>[4]=</span> &#123;&#123;<span class="number">0</span>,<span class="literal">false</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="literal">false</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="literal">false</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="literal">false</span>,<span class="number">0</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">HAL_TIM_PeriodElapsedCallback</span><span class="params">(TIM_HandleTypeDef *htim)</span> &#123;</span><br><span class="line"></span><br><span class="line">key[<span class="number">0</span>].status=HAL_GPIO_ReadPin (GPIOB,GPIO_PIN_0);</span><br><span class="line">key[<span class="number">1</span>].status=HAL_GPIO_ReadPin (GPIOB,GPIO_PIN_1);</span><br><span class="line">key[<span class="number">2</span>].status=HAL_GPIO_ReadPin (GPIOB,GPIO_PIN_2);</span><br><span class="line">key[<span class="number">3</span>].status=HAL_GPIO_ReadPin (GPIOA,GPIO_PIN_0);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(htim-&gt;Instance==TIM4) &#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++) </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span>(key[i].judge)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(key[i].status==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">key[i].judge=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(key[i].status==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">key[i].judge=<span class="number">2</span>;</span><br><span class="line">key[i].single_flag=<span class="number">1</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;key[i].judge=<span class="number">0</span>;&#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(key[i].status==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">key[i].judge=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="main-c中extern结构体-打开中断"><a href="#main-c中extern结构体-打开中断" class="headerlink" title="main.c中extern结构体&#x2F;打开中断"></a>main.c中extern结构体&#x2F;打开中断</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="class"><span class="keyword">struct</span> <span class="title">keys</span> <span class="title">key</span>[];</span></span><br></pre></td></tr></table></figure><p><strong>main函数里：</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HAL_TIM_Base_Start_IT(&amp;htim4 );</span><br></pre></td></tr></table></figure><blockquote><p>一定要放在<code>MX_TIM4_Init();</code>后面！！！！！！！！！！！</p></blockquote><blockquote><p>启动定时器 TIM4 的基本定时器模式并使能定时器中断.</p></blockquote><h2 id="长按键"><a href="#长按键" class="headerlink" title="长按键"></a>长按键</h2><h3 id="interrupt-h-1"><a href="#interrupt-h-1" class="headerlink" title="interrupt.h"></a>interrupt.h</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _INTERRUPT_H_</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _INTERRUPT_H_</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdbool.h&quot;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">keys</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">uchar judge;</span><br><span class="line"><span class="type">bool</span> status;</span><br><span class="line"><span class="type">bool</span> single_flag;</span><br><span class="line"><span class="type">bool</span> long_flag;</span><br><span class="line">uint time;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><h3 id="interrupt-c-1"><a href="#interrupt-c-1" class="headerlink" title="interrupt.c"></a>interrupt.c</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;interrupt.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">keys</span> <span class="title">key</span>[4]=</span> &#123;&#123;<span class="number">0</span>,<span class="literal">false</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="literal">false</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="literal">false</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="literal">false</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">HAL_TIM_PeriodElapsedCallback</span><span class="params">(TIM_HandleTypeDef *htim)</span> &#123;</span><br><span class="line"></span><br><span class="line">key[<span class="number">0</span>].status=HAL_GPIO_ReadPin (GPIOB,GPIO_PIN_0);</span><br><span class="line">key[<span class="number">1</span>].status=HAL_GPIO_ReadPin (GPIOB,GPIO_PIN_1);</span><br><span class="line">key[<span class="number">2</span>].status=HAL_GPIO_ReadPin (GPIOB,GPIO_PIN_2);</span><br><span class="line">key[<span class="number">3</span>].status=HAL_GPIO_ReadPin (GPIOA,GPIO_PIN_0);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(htim-&gt;Instance==TIM4) &#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++) &#123;</span><br><span class="line"><span class="keyword">switch</span>(key[i].judge) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>: &#123;</span><br><span class="line"><span class="keyword">if</span>(key[i].status==<span class="number">0</span>) &#123;</span><br><span class="line">key[i].judge=<span class="number">1</span>;</span><br><span class="line">key[i].time =<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line"><span class="keyword">if</span>(key[i].status==<span class="number">0</span>) &#123;</span><br><span class="line">key[i].judge=<span class="number">2</span>;</span><br><span class="line"><span class="comment">//key[i].single_flag=1;</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">key[i].judge=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>: &#123;</span><br><span class="line"><span class="keyword">if</span>(key[i].status==<span class="number">1</span>) &#123;</span><br><span class="line">key[i].judge=<span class="number">0</span>;</span><br><span class="line">key[i].single_flag=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(key[i].time&lt;<span class="number">200</span>)</span><br><span class="line">&#123;</span><br><span class="line">key[i].long_flag=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">key[i].time++;</span><br><span class="line"><span class="keyword">if</span>(key[i].time&gt;<span class="number">200</span>)</span><br><span class="line">&#123;</span><br><span class="line">key[i].long_flag=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>key[i].time&gt;200:</strong><br>之前配置的定时器一个周期10ms,<strong>200也就是2s</strong></p><h2 id="函数封装"><a href="#函数封装" class="headerlink" title="函数封装"></a>函数封装</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span>  view=<span class="number">0</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">key_proc</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">disp_proc</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">key_proc</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(key[<span class="number">0</span>].single_flag==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">key[<span class="number">0</span>].single_flag =<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(key[<span class="number">1</span>].single_flag==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">view++;</span><br><span class="line"><span class="keyword">if</span>(view&gt;<span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">view=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">key[<span class="number">1</span>].single_flag =<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(key[<span class="number">2</span>].single_flag==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">key[<span class="number">2</span>].single_flag =<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(key[<span class="number">3</span>].single_flag==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">key[<span class="number">3</span>].single_flag =<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">disp_proc</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(view==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> text[<span class="number">30</span>];</span><br><span class="line"><span class="built_in">sprintf</span>(text,<span class="string">&quot;  view=0      &quot;</span>);</span><br><span class="line">LCD_DisplayStringLine(Line9, (<span class="type">uint8_t</span> *)text);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(view==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> text[<span class="number">30</span>];</span><br><span class="line"><span class="built_in">sprintf</span>(text,<span class="string">&quot;  view=1      &quot;</span>);</span><br><span class="line">LCD_DisplayStringLine(Line9, (<span class="type">uint8_t</span> *)text);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(view==<span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> text[<span class="number">30</span>];</span><br><span class="line"><span class="built_in">sprintf</span>(text,<span class="string">&quot;  view=2      &quot;</span>);</span><br><span class="line">LCD_DisplayStringLine(Line9, (<span class="type">uint8_t</span> *)text);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式 </tag>
            
            <tag> stm32 </tag>
            
            <tag> 蓝桥杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>STM32第二次考核</title>
      <link href="/2024/03/14/STM32%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%80%83%E6%A0%B8/"/>
      <url>/2024/03/14/STM32%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%80%83%E6%A0%B8/</url>
      
        <content type="html"><![CDATA[<p>要求：</p><h2 id="功能引脚概述"><a href="#功能引脚概述" class="headerlink" title="功能引脚概述"></a>功能引脚概述</h2><h3 id="PA1"><a href="#PA1" class="headerlink" title="PA1"></a>PA1</h3><p>PA1:PWM（频率、占空比可调节）</p><ol><li>低频模式: 输出信号频率为4KHz。</li><li>高频模式: 输出信号频率为8KHz。<br>PA1输出信号占空比可以通过电位器R37进行调节，关系如图2所示。<div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="/img/图片1.jpg" class="lazyload placeholder" data-srcset="/img/图片1.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li></ol><p>当模式切换时，在保证占空比不变的前提下，频率在5秒内均匀的升高或降低到目标频率，要求频率步进值小于200Hz</p><h3 id="PA7-频率测量"><a href="#PA7-频率测量" class="headerlink" title="PA7(频率测量)"></a>PA7(频率测量)</h3><p>PA7:脉冲捕获<br>测量输入到PA7 引脚的信号频率，并将其转换为速度值，速度值(v) 与频率值(f)的对应关系:</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="/img/图片2.jpg" class="lazyload placeholder" data-srcset="/img/图片2.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>其中f单位为Hz，R和K作为参数，可以通过按键进行调整，π取小数点后2位有效数字。</p><h3 id="ADC"><a href="#ADC" class="headerlink" title="ADC"></a>ADC</h3><p>ADC:检测电位器R37上输出的模拟电压信号</p><h2 id="显示"><a href="#显示" class="headerlink" title="显示"></a>显示</h2><blockquote><p>显示背景色 (BackColor):黑色<br>显示前景色(TextColor):白色.<br>数据项与对应的数据之间使用“&#x3D;”间隔开。</p></blockquote><h3 id="数据界面"><a href="#数据界面" class="headerlink" title="数据界面"></a>数据界面</h3><ol><li>LD1:处于数据界面，指示灯LD1点亮，否则熄灭。</li><li>LD2: 低频模式、高频模式切换期间，指示灯LD2以0.1秒为间隔切换亮、灭状态，模式切换完成后熄灭。</li><li>LD3:占空比调整处于 “锁定”状态时，指示灯LD3点亮，否则熄灭。</li></ol><blockquote><p>显示要素包括界面名称(DATA)、PWM 输出模式(M)、 实时占空比(P)、 实时速度(V)。</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="/img/图片3.jpg" class="lazyload placeholder" data-srcset="/img/图片3.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>实时速度取小数点后1位有效数字。<br>输出模式以“H”表示高频模式、“L”表示低频模式，模式切换未完成前，屏幕显示的输出模式保持不变。</p></blockquote><h3 id="参数界面"><a href="#参数界面" class="headerlink" title="参数界面"></a>参数界面</h3><p>显示要素包括界面名称(PARA)、参数R和K的当前值，R值和K值有效范围1-10,整数。</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="/img/图片4.jpg" class="lazyload placeholder" data-srcset="/img/图片4.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="统计界面"><a href="#统计界面" class="headerlink" title="统计界面"></a>统计界面</h3><p>显示要素包括:界面名称( RECD)、PWM输出模式切换次数(N)、高频和低频模式下的速度最大值。</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="/img/图片5.jpg" class="lazyload placeholder" data-srcset="/img/图片5.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>MH:高频模式最大速度，ML: 低频模式最大速度，显示保留小数点后1位有效数字。</p><h2 id="按键功能"><a href="#按键功能" class="headerlink" title="按键功能"></a>按键功能</h2><h3 id="B1"><a href="#B1" class="headerlink" title="B1"></a>B1</h3><p>定义为“界面”按键，按下B1按键可以往复切换数据、参数和记录三个界面，切换模式如图6所示。</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="/img/图片6.png" class="lazyload placeholder" data-srcset="/img/图片6.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="B2"><a href="#B2" class="headerlink" title="B2"></a>B2</h3><p>定义为 “选择”按键。</p><ol><li>在数据界面下，用于切换选择低频或高频模式。按键按下后，5秒内不可再次触发切换功能。</li><li>在参数界面下，按下B2按键，切换选择R或K参数。每次从数据界面进入参数界面，默认当前可调整的参数为R参数;从参数界面退出时，新的R参数和K参数生效。</li></ol><h3 id="B3"><a href="#B3" class="headerlink" title="B3"></a>B3</h3><p>定义为 “加”按键。<br>在参数界面下，按下B3按键，当前可调整的参数加1，参数调整模式:<br>… 1 2 3 4 … 10 1 2 3 …</p><h3 id="B4"><a href="#B4" class="headerlink" title="B4"></a>B4</h3><ol><li>在参数界面下，按下B4按键，当前可调整的参数减1,参数调整模式· · ·1  10  9 · · · 2  1  10  9  ··· · ·</li><li>在数据界面下，长按B4按键超过2秒后松开(长按键)，可以“锁定“占空比调整功能，此时输出信号占空比保持不变，不受R37电位器输出电压控制;处于“锁定”状态后，再次按下B4按键(短按键),实现“解锁”功能，恢复R37电位器对输出信号占空比的控制。.</li></ol><p><strong>要求:</strong></p><ul><li>按键应进行有效的防抖处理，避免出现一次按键动作 触发多次功能等情形。</li><li>按键动作不应影响数据采集过程和屏幕显示效果。</li><li>有效区分长、短按键功能，互不影响。</li><li>参数调整应考虑边界值，不出现无效参数。</li><li>当前界面下无功能的按键按下，不触发其它界面的功能。</li></ul><h2 id="统计功能"><a href="#统计功能" class="headerlink" title="统计功能"></a>统计功能</h2><ol><li>低频模式、高频模式切换次数(N)。</li><li>高频、低频输出模式下的最大速度分开统计,保持时间不足2秒的速度值不纳入统计。</li></ol><h2 id="LED"><a href="#LED" class="headerlink" title="LED"></a>LED</h2><p>LD4-LD8 指示灯始终处于熄灭状态。</p><h2 id="初始状态说明"><a href="#初始状态说明" class="headerlink" title="初始状态说明"></a>初始状态说明</h2><ol><li>参数R为1。</li><li>参数K为1。</li><li>切换次数N 为0。</li><li>PWM输出模式为低频模式。</li><li>处于“解锁”状态，R37电位器可以控制信号占空比。</li><li>处于数据显示界面。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式 </tag>
            
            <tag> stm32 </tag>
            
            <tag> 蓝桥杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一.《动手学深度学习》Paddle版笔记-使用Tensor来处理数据</title>
      <link href="/2024/03/14/%E4%B8%80.%E3%80%8A%E5%8A%A8%E6%89%8B%E5%AD%A6%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E3%80%8BPaddle%E7%89%88%E7%AC%94%E8%AE%B0-%E4%BD%BF%E7%94%A8Tensor%E6%9D%A5%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/"/>
      <url>/2024/03/14/%E4%B8%80.%E3%80%8A%E5%8A%A8%E6%89%8B%E5%AD%A6%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E3%80%8BPaddle%E7%89%88%E7%AC%94%E8%AE%B0-%E4%BD%BF%E7%94%A8Tensor%E6%9D%A5%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<blockquote><p>记录一下，如果文章在文件夹里改名字了，要再打开一次，要不然vscode里改的bug不影响这个文件。。。</p></blockquote><h1 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h1><h2 id="使用Tensor来处理数据"><a href="#使用Tensor来处理数据" class="headerlink" title="使用Tensor来处理数据"></a>使用Tensor来处理数据</h2><blockquote><p>“tensor”这个单词一般可译作“张量”，张量可以看作是一个多维数组。标量可以看作是0维张量，向量可以看作1维张量，矩阵可以看作是二维张量。</p></blockquote><h3 id="Tensor概念解释"><a href="#Tensor概念解释" class="headerlink" title="Tensor概念解释"></a>Tensor概念解释</h3><ul><li>飞桨使用张量（Tensor） 来表示神经网络中传递的数据</li><li>Tensor 可以理解为多维数组，类似于 Numpy 数组（ndarray） 的概念</li><li>与 Numpy 数组相比，Tensor 除了支持运行在 CPU 上，还支持运行在 GPU 及各种 AI 芯片上，以实现计算加速</li><li>飞桨基于 Tensor，实现了深度学习所必须的反向传播功能和多种多样的组网算子，从而可更快捷地实现深度学习组网与训练等功能</li></ul><h3 id="Tensor的创建"><a href="#Tensor的创建" class="headerlink" title="Tensor的创建"></a>Tensor的创建</h3><h4 id="指定数据创建"><a href="#指定数据创建" class="headerlink" title="指定数据创建"></a>指定数据创建</h4><p>与 Numpy 创建数组方式类似，通过给定 Python 序列（如列表 list、元组 tuple），可使用 paddle.to_tensor 创建任意维度的 Tensor</p><ol><li><p><strong>创建类似向量的1维Tensor</strong></p> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> paddle</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ndim_1_Tensor = paddle.to_tensor([<span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(ndim_1_Tensor)</span><br><span class="line">Tensor(shape=[<span class="number">3</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">    [<span class="number">2.</span>, <span class="number">3.</span>, <span class="number">4.</span>])</span><br></pre></td></tr></table></figure><p> ndim:维度<br> <strong>如果仅输入单个标量（scalar）数据（例如 float&#x2F;int&#x2F;bool 类型的单个元素），则会创建形状为 [1] 的 Tensor，即 0 维 Tensor：</strong></p> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>paddle.to_tensor(<span class="number">2</span>)</span><br><span class="line">Tensor(shape=[], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">    <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>paddle.to_tensor([<span class="number">2</span>])</span><br><span class="line">Tensor(shape=[<span class="number">1</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">    [<span class="number">2</span>])</span><br></pre></td></tr></table></figure><blockquote><p>这两个有区别，维度不同，一个0维，一个1维</p></blockquote></li><li><p><strong>创建类似矩阵的2维Tensor</strong></p> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>ndim_2_Tensor = paddle.to_tensor([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(ndim_2_Tensor)</span><br><span class="line">Tensor(shape=[<span class="number">2</span>, <span class="number">3</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">    [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">        [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ndim_2_Tensor = paddle.to_tensor([[<span class="number">1.0</span>,<span class="number">2.0</span>,<span class="number">3.0</span>],[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(ndim_2_Tensor)</span><br><span class="line">Tensor(shape=[<span class="number">2</span>, <span class="number">3</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">    [[<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>],</span><br><span class="line">        [<span class="number">2.</span>, <span class="number">3.</span>, <span class="number">4.</span>]])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ndim_2_Tensor = paddle.to_tensor([[<span class="number">1.0</span>,<span class="number">2.0</span>,<span class="number">3.0</span>],[<span class="number">2.0</span>,<span class="number">3.0</span>,<span class="number">4.0</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(ndim_2_Tensor)</span><br><span class="line">Tensor(shape=[<span class="number">2</span>, <span class="number">3</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">    [[<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>],</span><br><span class="line">        [<span class="number">2.</span>, <span class="number">3.</span>, <span class="number">4.</span>]])</span><br></pre></td></tr></table></figure></li><li><p><strong>创建3维Tensor</strong></p> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>ndim_3_Tensor = paddle.to_tensor([[[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]],[[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(ndim_3_Tensor)</span><br><span class="line">Tensor(shape=[<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">    [[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">        [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]],</span><br><span class="line"></span><br><span class="line">        [[<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]]])</span><br></pre></td></tr></table></figure><p> 上述不同维度的 Tensor 可视化的表示如下图所示(数据可能不同，看个图示就行)：</p> <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.9rj5gz3k7w.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.9rj5gz3k7w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><blockquote><p>需要注意的是，Tensor 必须形如矩形，即在任何一个维度上，元素的数量必须相等，否则会抛出异常，示例如下：<br> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = paddle.to_tensor([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">File <span class="string">&quot;C:\Users\lxcqm\anaconda3\envs\Paddle_Py3.12\Lib\site-packages\paddle\tensor\creation.py&quot;</span>, line <span class="number">794</span>, <span class="keyword">in</span> to_tensor</span><br><span class="line">    <span class="keyword">return</span> _to_tensor_non_static(data, dtype, place, stop_gradient)</span><br><span class="line">        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">File <span class="string">&quot;C:\Users\lxcqm\anaconda3\envs\Paddle_Py3.12\Lib\site-packages\paddle\tensor\creation.py&quot;</span>, line <span class="number">577</span>, <span class="keyword">in</span> _to_tensor_non_static</span><br><span class="line">    data = np.array(data)</span><br><span class="line">        ^^^^^^^^^^^^^^</span><br><span class="line">ValueError: setting an array element <span class="keyword">with</span> a sequence. The requested array has an inhomogeneous shape after <span class="number">1</span> dimensions. The detected shape was (<span class="number">2</span>,) + inhomogeneous part.</span><br></pre></td></tr></table></figure><br><strong>说明：</strong></p><ul><li>飞桨也支持将 Tensor 转换为 Python 序列数据，可通过 paddle.tolist 实现，飞桨实际的转换处理过程是 Python 序列 &lt;-&gt; Numpy 数组 &lt;-&gt; Tensor。</li><li>基于给定数据创建 Tensor 时，飞桨是通过拷贝方式创建，与原始数据不共享内存。</li></ul></blockquote></li></ol><h4 id="指定形状创建"><a href="#指定形状创建" class="headerlink" title="指定形状创建"></a>指定形状创建</h4><p>如果要创建一个指定形状的 Tensor，可以使用 paddle.zeros、paddle.ones、paddle.full 实现：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>paddle.zeros([<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">W0314 <span class="number">17</span>:<span class="number">10</span>:<span class="number">06.231387</span>  <span class="number">9012</span> gpu_resources.cc:<span class="number">119</span>] Please NOTE: device: <span class="number">0</span>, GPU Compute Capability: <span class="number">8.9</span>, Driver API Version: <span class="number">12.4</span>, Runtime API Version: <span class="number">12.0</span></span><br><span class="line">W0314 <span class="number">17</span>:<span class="number">10</span>:<span class="number">08.771996</span>  <span class="number">9012</span> gpu_resources.cc:<span class="number">164</span>] device: <span class="number">0</span>, cuDNN Version: <span class="number">8.9</span>.</span><br><span class="line">Tensor(shape=[<span class="number">2</span>, <span class="number">3</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">        [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>]])</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>paddle.ones([<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">Tensor(shape=[<span class="number">2</span>, <span class="number">3</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>]])</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>paddle.twos([<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: module <span class="string">&#x27;paddle&#x27;</span> has no attribute <span class="string">&#x27;twos&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>paddle.full([<span class="number">2</span>,<span class="number">4</span>],<span class="number">4</span>)</span><br><span class="line">Tensor(shape=[<span class="number">2</span>, <span class="number">4</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">4.</span>, <span class="number">4.</span>, <span class="number">4.</span>, <span class="number">4.</span>],</span><br><span class="line">        [<span class="number">4.</span>, <span class="number">4.</span>, <span class="number">4.</span>, <span class="number">4.</span>]])</span><br></pre></td></tr></table></figure><h4 id="指定区间创建"><a href="#指定区间创建" class="headerlink" title="指定区间创建"></a>指定区间创建</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">paddle.arange(start, end, step)  <span class="comment"># 创建以步长 step 均匀分隔区间[start, end)的 Tensor</span></span><br><span class="line">paddle.linspace(start, stop, num) <span class="comment"># 创建以元素个数 num 均匀分隔区间[start, stop)的 Tensor</span></span><br></pre></td></tr></table></figure><p>实例:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>paddle.arange(start=<span class="number">1</span>, end=<span class="number">10</span>, step = <span class="number">2</span>)</span><br><span class="line">Tensor(shape=[<span class="number">5</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>])</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>paddle.linspace(start=<span class="number">1</span>,stop=<span class="number">10</span>,num=<span class="number">3</span>)</span><br><span class="line">Tensor(shape=[<span class="number">3</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [<span class="number">1.</span>        , <span class="number">5.50000000</span>, <span class="number">10.</span>       ])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>paddle.linspace(start=<span class="number">0</span>,stop=<span class="number">10</span>,num=<span class="number">3</span>)</span><br><span class="line">Tensor(shape=[<span class="number">3</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [<span class="number">0.</span> , <span class="number">5.</span> , <span class="number">10.</span>])</span><br></pre></td></tr></table></figure><blockquote><p><strong>说明：</strong><br>除了以上指定数据、形状、区间创建 Tensor 的方法，飞桨还支持如下类似的创建方式，如：</p><ul><li>创建一个空 Tensor，即根据 shape 和 dtype 创建尚未初始化元素值的 Tensor，可通过 paddle.empty 实现。</li><li>创建一个与其他 Tensor 具有相同 <strong>shape</strong> 与 <strong>dtype</strong> 的 Tensor，可通过 paddle.ones_like 、 paddle.zeros_like 、 paddle.full_like 、paddle.empty_like 实现。</li><li>拷贝并创建一个与其他 Tensor 完全相同的 Tensor，可通过 paddle.<strong>clone</strong> 实现。</li><li>创建一个满足特定分布的 Tensor，如 paddle.rand, paddle.randn , paddle.randint 等。</li><li>通过设置随机种子创建 Tensor，可每次生成相同元素值的随机数 Tensor，可通过 paddle.seed 和 paddle.rand 组合实现。</li></ul></blockquote><h4 id="指定图像-文本数据创建"><a href="#指定图像-文本数据创建" class="headerlink" title="指定图像&#x2F;文本数据创建"></a>指定图像&#x2F;文本数据创建</h4><p>在常见深度学习任务中，数据样本可能是图片（image）、文本（text）、语音（audio）等多种类型，在送入神经网络训练或推理前，这些数据和对应的标签均需要创建为 Tensor。以下是图像场景和 NLP(自然语言处理) 场景中手动转换 Tensor 方法的介绍。</p><ul><li><p>对于图像场景，可使用 paddle.vision.transforms.ToTensor 直接将 PIL.Image 格式的数据转为 Tensor，使用 paddle.to_tensor 将图像的标签（Label，通常是 Python 或 Numpy 格式的数据）转为 Tensor。</p></li><li><p>对于文本场景，需将文本数据解码为数字后，再通过 paddle.to_tensor 转为 Tensor。不同文本任务标签形式不一样，有的任务标签也是文本，有的则是数字，均需最终通过 paddle.to_tensor 转为 Tensor。</p></li></ul><p>下面以图像场景为例介绍，以下示例代码中将随机生成的图片转换为 Tensor:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> paddle.vision.transforms <span class="keyword">as</span> T</span><br><span class="line"><span class="keyword">import</span> paddle.vision.transforms.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line">fake_img = Image.fromarray((np.random.rand(<span class="number">224</span>, <span class="number">224</span>, <span class="number">3</span>) * <span class="number">255.</span>).astype(np.uint8)) <span class="comment"># 创建随机图片</span></span><br><span class="line">fake_img.show()</span><br><span class="line">transform = T.ToTensor()</span><br><span class="line">tensor = transform(fake_img) <span class="comment"># 使用 ToTensor()将图片转换为 Tensor</span></span><br><span class="line"><span class="built_in">print</span>(tensor)</span><br></pre></td></tr></table></figure><p>输出:</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4g48waay9i.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4g48waay9i.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">(Paddle_Py3<span class="number">.12</span>) C:\Users\lxcqm&gt;python D:\PyTorch\Pytorch1\main.py</span><br><span class="line">W0314 <span class="number">17</span>:<span class="number">25</span>:<span class="number">22.979338</span> <span class="number">34280</span> gpu_resources.cc:<span class="number">119</span>] Please NOTE: device: <span class="number">0</span>, GPU Compute Capability: <span class="number">8.9</span>, Driver API Version: <span class="number">12.4</span>, Runtime API Version: <span class="number">12.0</span></span><br><span class="line">W0314 <span class="number">17</span>:<span class="number">25</span>:<span class="number">22.984452</span> <span class="number">34280</span> gpu_resources.cc:<span class="number">164</span>] device: <span class="number">0</span>, cuDNN Version: <span class="number">8.9</span>.</span><br><span class="line">Tensor(shape=[<span class="number">3</span>, <span class="number">224</span>, <span class="number">224</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[[<span class="number">0.05098040</span>, <span class="number">0.00392157</span>, <span class="number">0.09019608</span>, ..., <span class="number">0.48627454</span>,</span><br><span class="line">          <span class="number">0.25882354</span>, <span class="number">0.21960786</span>],</span><br><span class="line">         [<span class="number">0.77254909</span>, <span class="number">0.82352948</span>, <span class="number">0.12549020</span>, ..., <span class="number">0.29411766</span>,</span><br><span class="line">          <span class="number">0.47450984</span>, <span class="number">0.99215692</span>],</span><br><span class="line">         [<span class="number">0.50980395</span>, <span class="number">0.90588242</span>, <span class="number">0.86666673</span>, ..., <span class="number">0.94509810</span>,</span><br><span class="line">          <span class="number">0.73725492</span>, <span class="number">0.40784317</span>],</span><br><span class="line">         ...,</span><br><span class="line">         [<span class="number">0.59215689</span>, <span class="number">0.96470594</span>, <span class="number">0.12549020</span>, ..., <span class="number">0.43529415</span>,</span><br><span class="line">          <span class="number">0.34117648</span>, <span class="number">0.25490198</span>],</span><br><span class="line">         [<span class="number">0.27843139</span>, <span class="number">0.50196081</span>, <span class="number">0.22745100</span>, ..., <span class="number">0.70588237</span>,</span><br><span class="line">          <span class="number">0.95294124</span>, <span class="number">0.57647061</span>],</span><br><span class="line">         [<span class="number">0.20784315</span>, <span class="number">0.70588237</span>, <span class="number">0.88235301</span>, ..., <span class="number">0.55294120</span>,</span><br><span class="line">          <span class="number">0.77254909</span>, <span class="number">0.16078432</span>]],</span><br><span class="line"></span><br><span class="line">        [[<span class="number">0.28235295</span>, <span class="number">0.54117650</span>, <span class="number">0.21960786</span>, ..., <span class="number">0.47450984</span>,</span><br><span class="line">          <span class="number">0.32941177</span>, <span class="number">0.95294124</span>],</span><br><span class="line">         [<span class="number">0.22352943</span>, <span class="number">0.68627453</span>, <span class="number">0.76470596</span>, ..., <span class="number">0.51764709</span>,</span><br><span class="line">          <span class="number">0.55294120</span>, <span class="number">0.96470594</span>],</span><br><span class="line">         [<span class="number">0.23921570</span>, <span class="number">0.79607850</span>, <span class="number">0.48627454</span>, ..., <span class="number">0.51764709</span>,</span><br><span class="line">          <span class="number">0.20000002</span>, <span class="number">0.80392164</span>],</span><br><span class="line">         ...,</span><br><span class="line">         [<span class="number">0.09411766</span>, <span class="number">0.49019611</span>, <span class="number">0.83529419</span>, ..., <span class="number">0.43137258</span>,</span><br><span class="line">          <span class="number">0.76862752</span>, <span class="number">0.26666668</span>],</span><br><span class="line">         [<span class="number">0.99607849</span>, <span class="number">0.09411766</span>, <span class="number">0.81960791</span>, ..., <span class="number">0.54117650</span>,</span><br><span class="line">          <span class="number">0.27843139</span>, <span class="number">0.92549026</span>],</span><br><span class="line">         [<span class="number">0.20000002</span>, <span class="number">0.47058827</span>, <span class="number">0.05882353</span>, ..., <span class="number">0.41176474</span>,</span><br><span class="line">          <span class="number">0.41960788</span>, <span class="number">0.30196080</span>]],</span><br><span class="line"></span><br><span class="line">        [[<span class="number">0.86666673</span>, <span class="number">0.46274513</span>, <span class="number">0.13333334</span>, ..., <span class="number">0.80000007</span>,</span><br><span class="line">          <span class="number">0.34509805</span>, <span class="number">0.13333334</span>],</span><br><span class="line">         [<span class="number">0.47843140</span>, <span class="number">0.14509805</span>, <span class="number">0.41960788</span>, ..., <span class="number">0.73725492</span>,</span><br><span class="line">          <span class="number">0.18823531</span>, <span class="number">0.42745101</span>],</span><br><span class="line">         [<span class="number">0.11372550</span>, <span class="number">0.73725492</span>, <span class="number">0.65490198</span>, ..., <span class="number">0.86666673</span>,</span><br><span class="line">          <span class="number">0.25490198</span>, <span class="number">0.83137262</span>],</span><br><span class="line">         ...,</span><br><span class="line">         [<span class="number">0.94901967</span>, <span class="number">0.45490199</span>, <span class="number">0.08235294</span>, ..., <span class="number">0.85882360</span>,</span><br><span class="line">          <span class="number">0.14901961</span>, <span class="number">0.14117648</span>],</span><br><span class="line">         [<span class="number">0.03137255</span>, <span class="number">0.72549021</span>, <span class="number">0.51372552</span>, ..., <span class="number">0.35686275</span>,</span><br><span class="line">          <span class="number">0.24313727</span>, <span class="number">0.01176471</span>],</span><br><span class="line">         [<span class="number">0.12941177</span>, <span class="number">0.24705884</span>, <span class="number">0.97254908</span>, ..., <span class="number">0.65098041</span>,</span><br><span class="line">          <span class="number">0.00784314</span>, <span class="number">0.96470594</span>]]])</span><br></pre></td></tr></table></figure><blockquote><p>说明：<br>实际编码时，由于飞桨数据加载的 paddle.io.DataLoader API 能够将原始 paddle.io.Dataset 定义的数据自动转换为 Tensor，所以可以不做手动转换。具体如下节介绍。</p></blockquote><h4 id="自动创建Tensor的功能介绍"><a href="#自动创建Tensor的功能介绍" class="headerlink" title="自动创建Tensor的功能介绍"></a>自动创建Tensor的功能介绍</h4><p>除了手动创建 Tensor 外，实际在飞桨框架中有一些 API 封装了 Tensor 创建的操作，从而无需用户手动创建 Tensor。例如 paddle.io.DataLoader 能够基于原始 Dataset，返回读取 Dataset 数据的迭代器，迭代器返回的数据中的每个元素都是一个 Tensor。另外在一些高层 API，如 paddle.Model.fit 、paddle.Model.predict ，如果传入的数据不是 Tensor，会自动转为 Tensor 再进行模型训练或推理。</p><blockquote><p><strong>说明：</strong><br>paddle.Model.fit、paddle.Model.predict 等高层 API 支持传入 Dataset 或 DataLoader，如果传入的是 Dataset，那么会用 DataLoader 封装转为 Tensor 数据；如果传入的是 DataLoader，则直接从 DataLoader 迭代读取 Tensor 数据送入模型训练或推理。因此即使没有写将数据转为 Tensor 的代码，也能正常执行，提升了编程效率和容错性。</p></blockquote><p>以下示例代码中，分别打印了原始数据集的数据，和送入 DataLoader 后返回的数据，可以看到数据结构由 Python list 转为了 Tensor:</p><details open><summary pointer> Compose&Normalize </summary>              <div class='content'>              <ol><li><p><strong>Compose</strong>:</p><ul><li><code>Compose</code> 是一个组合多个图像变换的工具。你可以将多个变换（transforms）放入一个列表中，然后传递给 <code>Compose</code>。当你应用这个组合变换到一个图像上时，这些变换会按照列表中的顺序一个接一个地应用到图像上。</li><li>例如，如果你想先对图像进行归一化，然后再将其转换为 Tensor，你可以这样做： <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">transforms = Compose([</span><br><span class="line">    Normalize(mean=[<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>], std=[<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>]),</span><br><span class="line">    ToTensor()</span><br><span class="line">])</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>Normalize</strong>:</p><ul><li><code>Normalize</code> 用于对图像进行标准化。在深度学习中，我们经常对输入数据进行标准化，使其具有零均值和单位方差，这有助于模型的训练。</li><li><code>Normalize</code> 需要两个参数：<code>mean</code> 和 <code>std</code>，分别代表每个通道的均值和标准差。对于 RGB 图像，这三个通道分别是红色、绿色和蓝色。</li><li>在上面的例子中，我们使用了 <code>[0.5, 0.5, 0.5]</code> 作为均值和 <code>[0.5, 0.5, 0.5]</code> 作为标准差，这实际上是将图像的像素值从 [0, 1] 范围转换到 [-1, 1] 范围。</li></ul></li></ol><p>总之，<code>Compose</code> 和 <code>Normalize</code> 是 PaddlePaddle 中非常有用的工具，用于图像预处理和增强。</p>              </div>            </details><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"><span class="keyword">from</span> paddle.vision.transforms <span class="keyword">import</span> Compose,Normalize</span><br><span class="line"></span><br><span class="line">transform = Compose([Normalize(mean=[<span class="number">127.5</span>], std=[<span class="number">127.5</span>], data_format=<span class="string">&#x27;CHW&#x27;</span>)])</span><br><span class="line">test_dataset = paddle.vision.datasets.MNIST(mode=<span class="string">&#x27;test&#x27;</span>, transform=transform)</span><br><span class="line"><span class="built_in">print</span>(test_dataset[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">loader = paddle.io.DataLoader(test_dataset)</span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> <span class="built_in">enumerate</span>(loader):</span><br><span class="line">    x, label = data[<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(label)</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><strong>输出:</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(Paddle_Py3<span class="number">.12</span>) C:\Users\lxcqm&gt;python D:\PyTorch\Pytorch1\main.py</span><br><span class="line">[<span class="number">7</span>]  <span class="comment"># 原始数据中 label 为 Python list</span></span><br><span class="line">Tensor(shape=[<span class="number">1</span>, <span class="number">1</span>], dtype=int64, place=Place(gpu_pinned), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">7</span>]])   <span class="comment"># 由 DataLoader 转换后，label 为 Tensor</span></span><br></pre></td></tr></table></figure><h3 id="Tensor的属性"><a href="#Tensor的属性" class="headerlink" title="Tensor的属性"></a>Tensor的属性</h3><p>在前文中，可以看到打印 Tensor 时有 shape、dtype、place 等信息，这些都是 Tensor 的重要属性，想要了解如何操作 Tensor 需要对其属性有一定了解，接下来分别展开介绍 Tensor 的属性相关概念:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">3</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [<span class="number">2.</span>, <span class="number">3.</span>, <span class="number">4.</span>])</span><br></pre></td></tr></table></figure><h4 id="Tensor的形状"><a href="#Tensor的形状" class="headerlink" title="Tensor的形状"></a>Tensor的形状</h4><ol><li><p>形状的介绍<br> 形状是 Tensor 的一个重要的基础属性，可以通过 Tensor.shape 查看一个 Tensor 的形状，以下为相关概念：</p><ul><li><p>shape：描述了 Tensor 每个维度上元素的数量。</p></li><li><p>ndim： Tensor 的维度数量，例如<strong>向量的维度为 1，矩阵的维度为 2</strong>，Tensor 可以有任意数量的维度。</p></li><li><p>axis 或者 dimension：Tensor 的轴，<strong>即某个特定的维度</strong>。</p></li><li><p>size：Tensor 中全部元素的个数。</p></li></ul><p> 创建 1 个四维 Tensor ，并通过图形来直观表达以上几个概念之间的关系：</p> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ndim_4_Tensor = paddle.ones([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br></pre></td></tr></table></figure> <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7p1mhwgcx.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7p1mhwgcx.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p> axis0:2的意思是0轴，数值为2<br> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">ndim_4_Tensor = paddle.ones([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Data Type of every element:&quot;</span>, ndim_4_Tensor.dtype)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Number of dimensions:&quot;</span>, ndim_4_Tensor.ndim)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Shape of Tensor:&quot;</span>, ndim_4_Tensor.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Elements number along axis 0 of Tensor:&quot;</span>, ndim_4_Tensor.shape[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Elements number along the last axis of Tensor:&quot;</span>, ndim_4_Tensor.shape[-<span class="number">1</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure><br> 输出:<br> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(Paddle_Py3<span class="number">.12</span>) C:\Users\lxcqm&gt;python D:\PyTorch\Pytorch1\main.py</span><br><span class="line">W0314 <span class="number">18</span>:05:<span class="number">09.299489</span>  <span class="number">8612</span> gpu_resources.cc:<span class="number">119</span>] Please NOTE: device: <span class="number">0</span>, GPU Compute Capability: <span class="number">8.9</span>, Driver API Version: <span class="number">12.4</span>, Runtime API Version: <span class="number">12.0</span></span><br><span class="line">W0314 <span class="number">18</span>:05:<span class="number">09.303498</span>  <span class="number">8612</span> gpu_resources.cc:<span class="number">164</span>] device: <span class="number">0</span>, cuDNN Version: <span class="number">8.9</span>.</span><br><span class="line">Data <span class="type">Type</span> of every element: paddle.float32</span><br><span class="line">Number of dimensions: <span class="number">4</span></span><br><span class="line">Shape of Tensor: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">Elements number along axis <span class="number">0</span> of Tensor: <span class="number">2</span></span><br><span class="line">Elements number along the last axis of Tensor: <span class="number">5</span></span><br></pre></td></tr></table></figure></p></li><li><p>重置 Tensor 形状（Reshape） 的方法</p> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">ndim_1_Tensor = paddle.to_tensor([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;origina:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(ndim_1_Tensor)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;the shape of ndim_1_Tensor:&quot;</span>, ndim_1_Tensor.shape)</span><br><span class="line"></span><br><span class="line">reshape_Tensor = paddle.reshape(ndim_1_Tensor, [<span class="number">3</span>, <span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[3, 1]:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(reshape_Tensor)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;After reshape:&quot;</span>, reshape_Tensor.shape)</span><br><span class="line"></span><br><span class="line">reshape_Tensor = paddle.reshape(ndim_1_Tensor, [<span class="number">1</span>, <span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[1, 3]:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(reshape_Tensor)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;After reshape:&quot;</span>, reshape_Tensor.shape)</span><br></pre></td></tr></table></figure><p> 输出:</p> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">original:</span><br><span class="line">Tensor(shape=[<span class="number">3</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">the shape of ndim_1_Tensor: [<span class="number">3</span>]</span><br><span class="line">[<span class="number">3</span>, <span class="number">1</span>]:</span><br><span class="line">Tensor(shape=[<span class="number">3</span>, <span class="number">1</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">    [[<span class="number">1</span>],</span><br><span class="line">        [<span class="number">2</span>],</span><br><span class="line">        [<span class="number">3</span>]])</span><br><span class="line">After reshape: [<span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>]:</span><br><span class="line">Tensor(shape=[<span class="number">1</span>, <span class="number">3</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">    [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]])</span><br><span class="line">After reshape: [<span class="number">1</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure><blockquote><p>在指定新的 <code>shape</code> 时存在一些技巧：<br><code>-1</code>表示这个维度的值是从 <code>Tensor</code> 的元素总数和剩余维度自动推断出来的。因此，有且只有一个维度可以被设置为 <code>-1</code>。<br><code>0</code> 表示该维度的元素数量与原值相同，因此 <code>shape</code> 中 <code>0</code> 的索引值必须小于 <code>Tensor</code> 的维度（索引值从 <code>0</code> 开始计，如第 <code>1</code> 维的索引值是 <code>0</code>，第二维的索引值是 <code>1</code>）。<br>通过几个例子来详细了解：<br> origin代表原始形状<br> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">origin:[<span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>] reshape:[<span class="number">3</span>, <span class="number">10</span>]      actual: [<span class="number">3</span>, <span class="number">10</span>] <span class="comment"># 直接指定目标 shape</span></span><br><span class="line"></span><br><span class="line">origin:[<span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>] reshape:[-<span class="number">1</span>]         actual: [<span class="number">30</span>] <span class="comment"># 转换为 1 维，维度根据元素总数推断出来是 3*2*5=30</span></span><br><span class="line"></span><br><span class="line">origin:[<span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>] reshape:[-<span class="number">1</span>, <span class="number">5</span>]      actual: [<span class="number">6</span>, <span class="number">5</span>] <span class="comment"># 转换为 2 维，固定一个维度 5，另一个维度根据元素总数推断出来是 30÷5=6</span></span><br><span class="line"></span><br><span class="line">origin:[<span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>] reshape:[<span class="number">0</span>, -<span class="number">1</span>]      actual: [<span class="number">3</span>, <span class="number">10</span>] <span class="comment"># reshape:[0, -1]中 0 的索引值为 0，按照规则，转换后第 0 维的元素数量与原始 Tensor 第 0 维的元素数量相同，为 3；第 1 维的元素数量根据元素总值计算得出为 30÷3=10。</span></span><br><span class="line"></span><br><span class="line">origin:[<span class="number">3</span>, <span class="number">2</span>]    reshape:[<span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>]    error： <span class="comment"># reshape:[3, 1, 0]中 0 的索引值为 2，但原 Tensor 只有 2 维，无法找到与第 3 维对应的元素数量，因此出错。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br> 从上面的例子可以看到，通过 reshape:[-1] ，可以很方便地将 Tensor 按其在计算机上的内存分布展平为一维。<br> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">ndim_3_Tensor = paddle.to_tensor([[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">                                [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]],</span><br><span class="line">                                [[<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>],</span><br><span class="line">                                [<span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>]]])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Tensor flattened to Vector:&quot;</span>, paddle.reshape(ndim_3_Tensor, [-<span class="number">1</span>]).numpy())</span><br></pre></td></tr></table></figure><br> 输出:<br> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tensor flattened to Vector: [ <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span>]</span><br></pre></td></tr></table></figure><br><strong>说明：</strong><br>除了 paddle.reshape 可重置 Tensor 的形状，还可通过如下方法改变 shape：</p><ul><li>paddle.squeeze，可实现 Tensor 的降维操作，即把 Tensor 中尺寸为 1 的维度删除。</li><li>paddle.unsqueeze，可实现 Tensor 的升维操作，即向 Tensor 中某个位置插入尺寸为 1 的维度。</li><li>paddle.flatten，将 Tensor 的数据在指定的连续维度上展平。</li><li>paddle.transpose，对 Tensor 的数据进行重排。</li></ul></blockquote></li><li><p>原位（Inplace）操作和非原位操作的区别</p></li></ol><h2 id="课程笔记"><a href="#课程笔记" class="headerlink" title="课程笔记"></a>课程笔记</h2><h3 id="创建一个tensor"><a href="#创建一个tensor" class="headerlink" title="创建一个tensor"></a>创建一个tensor</h3><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">x = paddle.arange(<span class="number">12</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="built_in">print</span>(x.shape)  <span class="comment">#the shape of the tensor</span></span><br><span class="line"><span class="built_in">print</span>(x.numel())    <span class="comment">#the num element of the tensor</span></span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">12</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [<span class="number">0</span> , <span class="number">1</span> , <span class="number">2</span> , <span class="number">3</span> , <span class="number">4</span> , <span class="number">5</span> , <span class="number">6</span> , <span class="number">7</span> , <span class="number">8</span> , <span class="number">9</span> , <span class="number">10</span>, <span class="number">11</span>])</span><br><span class="line">[<span class="number">12</span>]</span><br><span class="line">Tensor(shape=[], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       <span class="number">12</span>)</span><br></pre></td></tr></table></figure><h3 id="改变张量形状"><a href="#改变张量形状" class="headerlink" title="改变张量形状"></a>改变张量形状</h3><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">x = paddle.arange(<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">y = paddle.reshape(x, [<span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(y)</span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">3</span>, <span class="number">4</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">0</span> , <span class="number">1</span> , <span class="number">2</span> , <span class="number">3</span> ],</span><br><span class="line">        [<span class="number">4</span> , <span class="number">5</span> , <span class="number">6</span> , <span class="number">7</span> ],</span><br><span class="line">        [<span class="number">8</span> , <span class="number">9</span> , <span class="number">10</span>, <span class="number">11</span>]])</span><br></pre></td></tr></table></figure><h3 id="tensor的计算"><a href="#tensor的计算" class="headerlink" title="tensor的计算"></a>tensor的计算</h3><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">x = paddle.to_tensor([<span class="number">1.0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>])</span><br><span class="line">y = paddle.to_tensor([<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x + y)</span><br><span class="line"><span class="built_in">print</span>(x - y)</span><br><span class="line"><span class="built_in">print</span>(x * y)</span><br><span class="line"><span class="built_in">print</span>(x / y)</span><br><span class="line"><span class="built_in">print</span>(x ** y)  <span class="comment"># 求幂</span></span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">4</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [<span class="number">3.</span> , <span class="number">4.</span> , <span class="number">6.</span> , <span class="number">10.</span>])</span><br><span class="line">Tensor(shape=[<span class="number">4</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [-<span class="number">1.</span>,  <span class="number">0.</span>,  <span class="number">2.</span>,  <span class="number">6.</span>])</span><br><span class="line">Tensor(shape=[<span class="number">4</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [<span class="number">2.</span> , <span class="number">4.</span> , <span class="number">8.</span> , <span class="number">16.</span>])</span><br><span class="line">Tensor(shape=[<span class="number">4</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [<span class="number">0.50000000</span>, <span class="number">1.</span>        , <span class="number">2.</span>        , <span class="number">4.</span>        ])</span><br><span class="line">Tensor(shape=[<span class="number">4</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [<span class="number">1.</span> , <span class="number">4.</span> , <span class="number">16.</span>, <span class="number">64.</span>])</span><br></pre></td></tr></table></figure><h3 id="tensor的连结"><a href="#tensor的连结" class="headerlink" title="tensor的连结"></a>tensor的连结</h3><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">x = paddle.arange(<span class="number">12</span>, dtype=paddle.float32).reshape([<span class="number">3</span>, <span class="number">4</span>])<span class="comment">#[]也可以写成()</span></span><br><span class="line">y = paddle.to_tensor([[<span class="number">2.0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(paddle.concat((x, y), axis=<span class="number">0</span>))<span class="comment">#第一个维度</span></span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">6</span>, <span class="number">4</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">0.</span> , <span class="number">1.</span> , <span class="number">2.</span> , <span class="number">3.</span> ],</span><br><span class="line">        [<span class="number">4.</span> , <span class="number">5.</span> , <span class="number">6.</span> , <span class="number">7.</span> ],</span><br><span class="line">        [<span class="number">8.</span> , <span class="number">9.</span> , <span class="number">10.</span>, <span class="number">11.</span>],</span><br><span class="line">        [<span class="number">2.</span> , <span class="number">1.</span> , <span class="number">4.</span> , <span class="number">3.</span> ],</span><br><span class="line">        [<span class="number">1.</span> , <span class="number">2.</span> , <span class="number">3.</span> , <span class="number">4.</span> ],</span><br><span class="line">        [<span class="number">4.</span> , <span class="number">3.</span> , <span class="number">2.</span> , <span class="number">1.</span> ]])</span><br></pre></td></tr></table></figure><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">x = paddle.arange(<span class="number">12</span>, dtype=paddle.float32).reshape([<span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">y = paddle.to_tensor([[<span class="number">2.0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(paddle.concat((x, y), axis=-<span class="number">1</span>))<span class="comment">#最后一个维度</span></span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">3</span>, <span class="number">8</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">0.</span> , <span class="number">1.</span> , <span class="number">2.</span> , <span class="number">3.</span> , <span class="number">2.</span> , <span class="number">1.</span> , <span class="number">4.</span> , <span class="number">3.</span> ],</span><br><span class="line">        [<span class="number">4.</span> , <span class="number">5.</span> , <span class="number">6.</span> , <span class="number">7.</span> , <span class="number">1.</span> , <span class="number">2.</span> , <span class="number">3.</span> , <span class="number">4.</span> ],</span><br><span class="line">        [<span class="number">8.</span> , <span class="number">9.</span> , <span class="number">10.</span>, <span class="number">11.</span>, <span class="number">4.</span> , <span class="number">3.</span> , <span class="number">2.</span> , <span class="number">1.</span> ]])</span><br></pre></td></tr></table></figure><h3 id="通过逻辑运算符构建二维tensor"><a href="#通过逻辑运算符构建二维tensor" class="headerlink" title="通过逻辑运算符构建二维tensor"></a>通过逻辑运算符构建二维tensor</h3><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">x = paddle.arange(<span class="number">12</span>, dtype=paddle.float32).reshape([<span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">y = paddle.to_tensor([[<span class="number">2.0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line">z = x == y</span><br><span class="line"><span class="built_in">print</span>(z)</span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">3</span>, <span class="number">4</span>], dtype=<span class="built_in">bool</span>, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="literal">False</span>, <span class="literal">True</span> , <span class="literal">False</span>, <span class="literal">True</span> ],</span><br><span class="line">        [<span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>],</span><br><span class="line">        [<span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span>]])</span><br></pre></td></tr></table></figure><h3 id="求和产生一个元素的张量"><a href="#求和产生一个元素的张量" class="headerlink" title="求和产生一个元素的张量"></a>求和产生一个元素的张量</h3><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">x = paddle.arange(<span class="number">12</span>, dtype=paddle.float32).reshape([<span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x.<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       <span class="number">66.</span>)</span><br></pre></td></tr></table></figure><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">y = paddle.to_tensor([[<span class="number">2.0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">sum</span>(y))</span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">4</span>], dtype=float32, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [<span class="number">7.</span>, <span class="number">6.</span>, <span class="number">9.</span>, <span class="number">8.</span>])</span><br></pre></td></tr></table></figure><h3 id="广播机制"><a href="#广播机制" class="headerlink" title="广播机制"></a>广播机制</h3><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">x = paddle.arange(<span class="number">3</span>).reshape([<span class="number">3</span>, <span class="number">1</span>])</span><br><span class="line">y = paddle.arange(<span class="number">2</span>).reshape([<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="built_in">print</span>(x+y)</span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">3</span>, <span class="number">1</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">0</span>],</span><br><span class="line">        [<span class="number">1</span>],</span><br><span class="line">        [<span class="number">2</span>]])</span><br><span class="line">Tensor(shape=[<span class="number">1</span>, <span class="number">2</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">0</span>, <span class="number">1</span>]])</span><br><span class="line">Tensor(shape=[<span class="number">3</span>, <span class="number">2</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">        [<span class="number">2</span>, <span class="number">3</span>]])</span><br></pre></td></tr></table></figure><h3 id="访问元素"><a href="#访问元素" class="headerlink" title="访问元素"></a>访问元素</h3><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">x = paddle.arange(<span class="number">3</span>).reshape([<span class="number">3</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x[<span class="number">0</span>:<span class="number">2</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">2</span>, <span class="number">1</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">0</span>],</span><br><span class="line">        [<span class="number">1</span>]])</span><br></pre></td></tr></table></figure><h3 id="赋值矩阵中的元素"><a href="#赋值矩阵中的元素" class="headerlink" title="赋值矩阵中的元素"></a>赋值矩阵中的元素</h3><h4 id="赋值单个元素"><a href="#赋值单个元素" class="headerlink" title="赋值单个元素"></a>赋值单个元素</h4><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">x = paddle.arange(<span class="number">3</span>).reshape([<span class="number">3</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"></span><br><span class="line">x[<span class="number">1</span>, <span class="number">0</span>] = <span class="number">5</span></span><br><span class="line"><span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">3</span>, <span class="number">1</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">0</span>],</span><br><span class="line">        [<span class="number">1</span>],</span><br><span class="line">        [<span class="number">2</span>]])</span><br><span class="line">Tensor(shape=[<span class="number">3</span>, <span class="number">1</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">0</span>],</span><br><span class="line">        [<span class="number">5</span>],</span><br><span class="line">        [<span class="number">2</span>]])</span><br></pre></td></tr></table></figure><h4 id="赋值多个元素"><a href="#赋值多个元素" class="headerlink" title="赋值多个元素"></a>赋值多个元素</h4><p><strong>IN</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"></span><br><span class="line">x = paddle.arange(<span class="number">12</span>).reshape([<span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"></span><br><span class="line">x[<span class="number">0</span>:<span class="number">2</span>, :] = <span class="number">99</span></span><br><span class="line"><span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure><p><strong>OUT</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Tensor(shape=[<span class="number">3</span>, <span class="number">4</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">0</span> , <span class="number">1</span> , <span class="number">2</span> , <span class="number">3</span> ],</span><br><span class="line">        [<span class="number">4</span> , <span class="number">5</span> , <span class="number">6</span> , <span class="number">7</span> ],</span><br><span class="line">        [<span class="number">8</span> , <span class="number">9</span> , <span class="number">10</span>, <span class="number">11</span>]])</span><br><span class="line">Tensor(shape=[<span class="number">3</span>, <span class="number">4</span>], dtype=int64, place=Place(gpu:<span class="number">0</span>), stop_gradient=<span class="literal">True</span>,</span><br><span class="line">       [[<span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>],</span><br><span class="line">        [<span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>],</span><br><span class="line">        [<span class="number">8</span> , <span class="number">9</span> , <span class="number">10</span>, <span class="number">11</span>]])</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="为新结果分配内存"><a href="#为新结果分配内存" class="headerlink" title="为新结果分配内存"></a>为新结果分配内存</h4>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 深度学习 </tag>
            
            <tag> 智能车 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>人工智能考核</title>
      <link href="/2024/03/11/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E8%80%83%E6%A0%B8/"/>
      <url>/2024/03/11/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E8%80%83%E6%A0%B8/</url>
      
        <content type="html"><![CDATA[<h1 id="task1-1"><a href="#task1-1" class="headerlink" title="task1.1"></a>task1.1</h1><blockquote><p>对于你给出的解释，请给出相应的PaddlePaddle对应的函数，并尽可能的解释函数参数的意义</p><ol><li>解释神经网络中<strong>卷积层</strong>的作用。<blockquote><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.39kxm747di.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.39kxm747di.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7zq6klz9it.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7zq6klz9it.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><ul><li>把卷积核中心点周围的像素按比例附加到(对其产生影响)卷积核中心对应的像素;</li><li>卷积核代表一个特征，用来提取输入数据的特定特征<br><strong>paddle.nn.Conv2D()</strong></li><li><code>in_channels</code>：输入特征图的通道数。</li><li><code>out_channels</code>：输出特征图的通道数。</li><li><code>kernel_size</code>：卷积核大小。</li><li><code>stride</code>：卷积步长。</li><li><code>padding</code>：填充大小。</li></ul></blockquote></li><li>解释神经网络中<strong>池化层</strong>的作用。<blockquote><p>过滤特征(减小特征图的维度)<br><strong>paddle.nn.MaxPool2D(最大池化)   paddle.nn.AvgPool2D(平均池化)</strong></p><ul><li><code>kernel_size</code>：池化核大小。</li><li><code>stride</code>：池化步长。</li><li><code>padding</code>：填充大小。</li></ul></blockquote></li><li>解释神经网络中<strong>连接层</strong>的作用。<blockquote><p>将输入的多维向量数据展平为一维向量，然后线性处理，与权重矩阵相乘，再加上偏置项，通过激活函数输出结构，可以进行分类&#x2F;预测<br><strong>paddle.nn.Linear()</strong></p><ul><li><code>in_features</code>：输入特征的大小。</li><li><code>out_features</code>：输出特征的大小。</li></ul></blockquote></li><li>解释神经网络中<strong>激活函数层</strong>的作用。<blockquote><p>把连接层得到的线性结构转化为非线性结果，从而更好地拟合数据并提高模型的性能<br><strong>paddle.nn.ReLU  paddle.nn.Sigmoid   paddle.tanh</strong></p><ul><li>没有参数</li></ul></blockquote></li><li>解释神经网络中<strong>Dropout层</strong>的作用。<blockquote><p>正则化，随机丢弃神经元，减少参数，降低模型复杂度，减少过拟合情况<br><strong>paddle.nn.Dropout</strong></p><ul><li><code>dropout_prob</code>：丢弃概率，即要丢弃的神经元的比例。</li></ul></blockquote></li></ol></blockquote><h1 id="task2-1"><a href="#task2-1" class="headerlink" title="task2.1"></a>task2.1</h1><p>在一个单层感知器中，假设有两个输入特征和一个输出。</p><p>权重分别是w1 &#x3D; 0.5，w2 &#x3D; -0.3，偏差为b &#x3D; 0.1。</p><p>输入特征为x1 &#x3D; 2，x2 &#x3D; -1。</p><p>计算输出（假设激活函数是阶跃函数）。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义权重/偏差/输入特征</span></span><br><span class="line">w1 = <span class="number">0.5</span></span><br><span class="line">w2 = -<span class="number">0.3</span></span><br><span class="line">b = <span class="number">0.1</span></span><br><span class="line">x1 = <span class="number">2</span></span><br><span class="line">x2 = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义激活函数(阶跃函数)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step_function</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> x &gt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">perceptron_output</span>(<span class="params">w1, w2, b, x1, x2</span>):</span><br><span class="line">    result = w1 * x1 + w2 * x2 + b</span><br><span class="line">    <span class="keyword">return</span> step_function(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">output = perceptron_output(w1, w2, b, x1, x2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Output:&quot;</span>, output)</span><br></pre></td></tr></table></figure><h1 id="task2-2（代码实现）"><a href="#task2-2（代码实现）" class="headerlink" title="task2.2（代码实现）"></a>task2.2（代码实现）</h1><p>假设你有一个包含两个隐藏层的前馈神经网络，每个隐藏层分别有3个神经元。</p><p>输入层有4个特征，输出层有2个神经元。</p><p>所有的激活函数都是ReLU。</p><p>编写一个函数来计算整个网络的输出，给定输入和网络参数。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">IP = [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]]</span><br><span class="line">W1 = [[<span class="number">0.32361505</span>, -<span class="number">1.08053636</span>, <span class="number">1.94312927</span>],</span><br><span class="line">      [<span class="number">1.87599918</span>, <span class="number">0.09333858</span>, -<span class="number">0.54394708</span>],</span><br><span class="line">      [<span class="number">0.31721595</span>, <span class="number">0.15919131</span>, <span class="number">0.75238423</span>],</span><br><span class="line">      [<span class="number">0.52593422</span>, <span class="number">0.39281801</span>, <span class="number">0.47263081</span>]]</span><br><span class="line">B1 = [[-<span class="number">0.95059911</span>, -<span class="number">0.78673449</span>, -<span class="number">0.27075615</span>]]</span><br><span class="line">W2 = [[-<span class="number">1.11562289</span>, -<span class="number">1.05667625</span>, <span class="number">1.17330918</span>],</span><br><span class="line">      [<span class="number">1.15682221</span>, <span class="number">0.30359694</span>, -<span class="number">0.32633211</span>],</span><br><span class="line">      [<span class="number">0.44536135</span>, <span class="number">0.31302144</span>, -<span class="number">1.16012537</span>]]</span><br><span class="line">B2 = [[<span class="number">1.48936813</span>, -<span class="number">0.50073038</span>, -<span class="number">0.16725209</span>]]</span><br><span class="line">W3 = [[-<span class="number">0.06277751</span>, -<span class="number">0.52103597</span>],</span><br><span class="line">      [-<span class="number">0.29022904</span>, <span class="number">1.55451498</span>],</span><br><span class="line">      [-<span class="number">0.80766273</span>, -<span class="number">0.24495497</span>]]</span><br><span class="line">B3 = [[<span class="number">0.97822396</span>, <span class="number">1.32775756</span>]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义relu函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">relu</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> np.maximum(<span class="number">0</span>, x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Feedforward_neural_network</span>(<span class="params">IP, W1, B1, W2, B2, W3, B3</span>):</span><br><span class="line">    IP = np.array(IP)</span><br><span class="line">    W1 = np.array(W1)</span><br><span class="line">    B1 = np.array(B1)</span><br><span class="line">    W2 = np.array(W2)</span><br><span class="line">    B2 = np.array(B2)</span><br><span class="line">    W3 = np.array(W3)</span><br><span class="line">    B3 = np.array(B3)</span><br><span class="line"></span><br><span class="line">    out1 = np.dot(IP, W1) + B1</span><br><span class="line">    in2 = relu(out1)</span><br><span class="line">    out2 = np.dot(in2, W2) + B2</span><br><span class="line">    in3 = relu(out2)</span><br><span class="line">    out3 = np.dot(in3, W3) + B3</span><br><span class="line">    output = out3</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行前向传播</span></span><br><span class="line">result = Feedforward_neural_network(IP, W1, B1, W2, B2, W3, B3)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><h1 id="task3-1（代码实现）"><a href="#task3-1（代码实现）" class="headerlink" title="task3.1（代码实现）"></a>task3.1（代码实现）</h1><h3 id="题目：线性回归模型"><a href="#题目：线性回归模型" class="headerlink" title="题目：线性回归模型"></a>题目：线性回归模型</h3><p>使用PaddlePaddle框架（Paddle Pytorch Tensorflow，或者自己手写线性回归网络都可）搭建一个简单的线性回归模型，对data.csv数据集中的数据进行训练，并预测新数据点的值。</p><h4 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h4><p>使用paddle.nn.Linear创建一个具有单个输入和单个输出的线性层。<br>定义损失函数和优化器。<br>训练模型以拟合数据。<br>对新数据进行预测。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"><span class="keyword">from</span> paddle.nn <span class="keyword">import</span> Linear</span><br><span class="line"><span class="keyword">import</span> paddle.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_data</span>():</span><br><span class="line">    <span class="comment"># 从文件导入数据</span></span><br><span class="line">    datafile = pd.read_csv(<span class="string">&quot;C:/Users/lxcqm/Desktop/人工智能考核/训练数据/data.csv&quot;</span>)</span><br><span class="line">    X = datafile[<span class="string">&quot;X&quot;</span>].values.astype(<span class="string">&quot;float32&quot;</span>)</span><br><span class="line">    Y = datafile[<span class="string">&quot;y&quot;</span>].values.astype(<span class="string">&quot;float32&quot;</span>)</span><br><span class="line">    data_matrix = np.column_stack((X, Y))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 确保数据的总元素数量为 100000</span></span><br><span class="line">    num_rows = <span class="number">50000</span></span><br><span class="line">    num_cols = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    data_matrix = data_matrix.reshape((num_rows, num_cols))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将原数据集拆分成训练集和测试集</span></span><br><span class="line">    <span class="comment"># 这里使用80%的数据做训练，20%的数据做测试</span></span><br><span class="line">    <span class="comment"># 测试集和训练集必须是没有交集的</span></span><br><span class="line">    ratio = <span class="number">0.8</span></span><br><span class="line">    offset = <span class="built_in">int</span>(data_matrix.shape[<span class="number">0</span>] * ratio)</span><br><span class="line">    training_data = data_matrix[:offset]</span><br><span class="line">    test_data = data_matrix[offset:]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算train数据集的最大值，最小值</span></span><br><span class="line">    maximums, minimums = training_data.<span class="built_in">max</span>(axis=<span class="number">0</span>), training_data.<span class="built_in">min</span>(axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记录数据的归一化参数，在预测时对数据做归一化</span></span><br><span class="line">    <span class="keyword">global</span> max_values</span><br><span class="line">    <span class="keyword">global</span> min_values</span><br><span class="line"></span><br><span class="line">    max_values = maximums</span><br><span class="line">    min_values = minimums</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对数据进行归一化处理</span></span><br><span class="line">    training_data = (training_data - min_values) / (maximums - minimums)</span><br><span class="line">    test_data = (test_data - min_values) / (maximums - minimums)</span><br><span class="line">    <span class="keyword">return</span> training_data, test_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># # 验证数据集读取程序的正确性</span></span><br><span class="line"><span class="comment"># training_data, test_data = load_data()</span></span><br><span class="line"><span class="comment"># print(training_data.shape)</span></span><br><span class="line"><span class="comment"># print(training_data)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Regressor</span>(paddle.nn.Layer):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># self代表类的实例自身</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 初始化父类中的一些参数</span></span><br><span class="line">        <span class="built_in">super</span>(Regressor, self).__init__()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 定义一层全连接层，输入维度是1，输出维度是1</span></span><br><span class="line">        self.fc = Linear(in_features=<span class="number">1</span>, out_features=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 网络的前向计算</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, inputs</span>):</span><br><span class="line">        x = self.fc(inputs)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 声明定义好的线性回归模型</span></span><br><span class="line">model = Regressor()</span><br><span class="line"><span class="comment"># 开启模型训练模式</span></span><br><span class="line">model.train()</span><br><span class="line"><span class="comment"># 加载数据</span></span><br><span class="line">training_data, test_data = load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义优化算法，使用随机梯度下降SGD</span></span><br><span class="line"><span class="comment"># 学习率设置为0.01</span></span><br><span class="line">opt = paddle.optimizer.SGD(learning_rate=<span class="number">0.01</span>, parameters=model.parameters())</span><br><span class="line"></span><br><span class="line">EPOCH_NUM = <span class="number">10</span>  <span class="comment"># 设置外层循环次数</span></span><br><span class="line">BATCH_SIZE = <span class="number">100</span>  <span class="comment"># 设置batch大小</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义外层循环</span></span><br><span class="line"><span class="keyword">for</span> epoch_id <span class="keyword">in</span> <span class="built_in">range</span>(EPOCH_NUM):</span><br><span class="line">    <span class="comment"># 在每轮迭代开始之前，将训练数据的顺序随机的打乱</span></span><br><span class="line">    np.random.shuffle(training_data)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将训练数据进行拆分，每个batch包含10条数据</span></span><br><span class="line">    mini_batches = [training_data[k:k + BATCH_SIZE] <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(training_data), BATCH_SIZE)]</span><br><span class="line"><span class="comment"># print(mini_batches)</span></span><br><span class="line">    <span class="comment"># 定义内层循环</span></span><br><span class="line">    <span class="keyword">for</span> iter_id, mini_batch <span class="keyword">in</span> <span class="built_in">enumerate</span>(mini_batches):</span><br><span class="line">        x = np.array(mini_batch[:, :-<span class="number">1</span>])  <span class="comment"># 获得当前批次训练X</span></span><br><span class="line">        y = np.array(mini_batch[:, -<span class="number">1</span>:])  <span class="comment"># 获得当前批次训练Y</span></span><br><span class="line"><span class="comment"># print(mini_batch, x, y)</span></span><br><span class="line">        <span class="comment"># 将numpy数据转为飞桨动态图tensor的格式</span></span><br><span class="line">        X = paddle.to_tensor(x)</span><br><span class="line">        Y = paddle.to_tensor(y)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 前向计算</span></span><br><span class="line">        predicts = model(X)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算损失</span></span><br><span class="line">        loss = F.square_error_cost(predicts, label=Y)</span><br><span class="line">        avg_loss = paddle.mean(loss)</span><br><span class="line">        <span class="keyword">if</span> iter_id % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;epoch: &#123;&#125;, iter: &#123;&#125;, loss is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(epoch_id, iter_id, avg_loss.numpy()))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 反向传播，计算每层参数的梯度值</span></span><br><span class="line">        avg_loss.backward()</span><br><span class="line">        <span class="comment"># 更新参数，根据设置好的学习率迭代一步</span></span><br><span class="line">        opt.step()</span><br><span class="line">        <span class="comment"># 清空梯度变量，以备下一轮计算</span></span><br><span class="line">        opt.clear_grad()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_one_example</span>():</span><br><span class="line">    <span class="comment"># 从上边已加载的测试集中，随机选择一条作为测试数据</span></span><br><span class="line">    idx = np.random.randint(<span class="number">0</span>, test_data.shape[<span class="number">0</span>])</span><br><span class="line">    <span class="comment"># idx = -10</span></span><br><span class="line">    x0, y0 = test_data[idx, <span class="number">0</span>], test_data[idx, -<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    x0 = x0.reshape([<span class="number">1</span>, -<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> x0, y0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存模型参数，文件名为LR_model.pdparams</span></span><br><span class="line">paddle.save(model.state_dict(), <span class="string">&#x27;C:/Users/lxcqm/Desktop/model/model1.pdmodel&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;模型保存成功，模型参数保存在C:/Users/lxcqm/Desktop/model/model1.pdmodel&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数为保存模型参数的文件地址</span></span><br><span class="line">model_dict = paddle.load(<span class="string">&#x27;C:/Users/lxcqm/Desktop/model/model1.pdmodel&#x27;</span>)</span><br><span class="line">model.load_dict(model_dict)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数为数据集的文件地址</span></span><br><span class="line">xn, yn = load_one_example()</span><br><span class="line"><span class="comment"># 将数据转为动态图的variable格式</span></span><br><span class="line">xn = paddle.to_tensor(xn)</span><br><span class="line">predict = model(xn)</span><br><span class="line"><span class="comment"># print(&quot;xn&quot;, xn,&quot;predict&quot;,predict, &quot;yn&quot;, yn)</span></span><br><span class="line"><span class="comment"># 对结果做反归一化处理</span></span><br><span class="line">predict = predict * (max_values[-<span class="number">1</span>] - min_values[-<span class="number">1</span>]) + min_values[-<span class="number">1</span>]</span><br><span class="line"><span class="comment"># 对Y数据做反归一化处理</span></span><br><span class="line">yn = yn * (max_values[-<span class="number">1</span>] - min_values[-<span class="number">1</span>]) + min_values[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Inference result is &#123;&#125;, the corresponding Y is &#123;&#125;&quot;</span>.<span class="built_in">format</span>(predict.numpy(), yn))</span><br></pre></td></tr></table></figure><h1 id="task3-2（代码实现）"><a href="#task3-2（代码实现）" class="headerlink" title="task3.2（代码实现）"></a>task3.2（代码实现）</h1><h3 id="题目：卷积神经网络（CNN）分类"><a href="#题目：卷积神经网络（CNN）分类" class="headerlink" title="题目：卷积神经网络（CNN）分类"></a>题目：卷积神经网络（CNN）分类</h3><p>使用PaddlePaddle框架构建一个简单的卷积神经网络（CNN），用于对MNIST手写数字数据集进行分类。</p><p>(Paddle Pytorch Tensorflow等框架都可)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"><span class="keyword">from</span> paddle.vision.transforms <span class="keyword">import</span> Normalize</span><br><span class="line"><span class="keyword">from</span> paddle.io <span class="keyword">import</span> Dataset</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> paddle.vision.transforms <span class="keyword">import</span> functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义图像归一化处理方法,这里的CHW指图像格式需为 [C通道数,H图像高度,W图像宽度]</span></span><br><span class="line"><span class="comment"># 减均值,除以标准差</span></span><br><span class="line"><span class="comment"># 假设像素值范围是 [0, 255]</span></span><br><span class="line"><span class="comment"># 当每个像素值减去 127.5 后</span></span><br><span class="line"><span class="comment"># 范围变为 [-127.5, 127.5]</span></span><br><span class="line"><span class="comment"># 再除以 127.5（或者是原始数据范围的一半）</span></span><br><span class="line"><span class="comment"># 就得到了 [-1, 1] 的范围</span></span><br><span class="line">transform = Normalize(mean=[<span class="number">127.5</span>], std=[<span class="number">127.5</span>], data_format=<span class="string">&#x27;CHW&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MNISTDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, datafile, mode=<span class="string">&#x27;train&#x27;</span>, transform=<span class="literal">None</span></span>):</span><br><span class="line"></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">        self.mode = mode</span><br><span class="line">        self.transform = transform</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;loading mnist dataset from &#123;&#125; ......&#x27;</span>.<span class="built_in">format</span>(datafile))</span><br><span class="line"></span><br><span class="line">        data = json.load(gzip.<span class="built_in">open</span>(datafile))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;mnist dataset load done&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 读取到的数据区分训练集,验证集,测试集</span></span><br><span class="line">        train_set, val_set, eval_set = data</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> mode == <span class="string">&#x27;train&#x27;</span>:</span><br><span class="line">            <span class="comment"># 获得训练数据集</span></span><br><span class="line">            self.imgs, self.labels = train_set[<span class="number">0</span>], train_set[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> mode == <span class="string">&#x27;valid&#x27;</span>:</span><br><span class="line">            <span class="comment"># 获得验证数据集</span></span><br><span class="line">            self.imgs, self.labels = val_set[<span class="number">0</span>], val_set[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> mode == <span class="string">&#x27;test&#x27;</span>:</span><br><span class="line">            <span class="comment"># 获得测试数据集</span></span><br><span class="line">            self.imgs, self.labels = eval_set[<span class="number">0</span>], eval_set[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&quot;mode can only be one of [&#x27;train&#x27;, &#x27;valid&#x27;, &#x27;test&#x27;]&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        实现__getitem__方法，定义指定index时如何获取数据</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        data = self.imgs[index]</span><br><span class="line">        label = self.labels[index]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.transform(data), label</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        实现__len__方法，返回数据集总数目</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.imgs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">datafile = <span class="string">&#x27;D:/paddlepaddle/paddlepaddle手写数字/mnist.json.gz&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载数据集并初始化 DataSet</span></span><br><span class="line">train_dataset = MNISTDataset(datafile, mode=<span class="string">&#x27;train&#x27;</span>, transform=transform)</span><br><span class="line">test_dataset = MNISTDataset(datafile, mode=<span class="string">&#x27;test&#x27;</span>, transform=transform)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&#x27;train images: &#x27;, train_dataset.__len__(), &#x27;, test images: &#x27;, test_dataset.__len__())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># from matplotlib import pyplot as plt</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># for data in train_dataset:</span></span><br><span class="line"><span class="comment">#     image, label = data</span></span><br><span class="line"><span class="comment">#     print(&#x27;shape of image: &#x27;, image.shape)</span></span><br><span class="line"><span class="comment">#     plt.title(str(label))</span></span><br><span class="line"><span class="comment">#     plt.imshow(image[0])</span></span><br><span class="line"><span class="comment">#     break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义并初始化数据读取器</span></span><br><span class="line">train_loader = paddle.io.DataLoader(train_dataset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">True</span>, num_workers=<span class="number">0</span>)</span><br><span class="line">test_loader = paddle.io.DataLoader(test_dataset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">False</span>, num_workers=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># print(&#x27;step num:&#x27;, len(train_loader))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># class MNIST_CNN(paddle.nn.Layer):</span></span><br><span class="line"><span class="comment">#     def __init__(self):</span></span><br><span class="line"><span class="comment">#         super(MNIST_CNN, self).__init__()</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#         # 定义一层全连接层，输出维度为一</span></span><br><span class="line"><span class="comment">#         self.fc = paddle.nn.Linear(in_features=784, out_features=1)</span></span><br><span class="line"><span class="comment">#         # 图片像素28*28=784个像素点</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     def forward(self, inputs):</span></span><br><span class="line"><span class="comment">#         outputs = self.fc(inputs)</span></span><br><span class="line"><span class="comment">#         return outputs</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MNIST_CNN</span>(paddle.nn.Layer):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(MNIST_CNN, self).__init__()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 定义卷积层</span></span><br><span class="line">        self.conv1 = paddle.nn.Conv2D(in_channels=<span class="number">1</span>, out_channels=<span class="number">16</span>, kernel_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>)</span><br><span class="line">        self.pool1 = paddle.nn.MaxPool2D(kernel_size=<span class="number">2</span>, stride=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        self.conv2 = paddle.nn.Conv2D(in_channels=<span class="number">16</span>, out_channels=<span class="number">32</span>, kernel_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>)</span><br><span class="line">        self.pool2 = paddle.nn.MaxPool2D(kernel_size=<span class="number">2</span>, stride=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算全连接层的输入维度</span></span><br><span class="line">        self.fc_input_dim = <span class="number">32</span> * <span class="number">7</span> * <span class="number">7</span>  <span class="comment"># 根据卷积层和池化层输出的维度计算</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 定义全连接层</span></span><br><span class="line">        self.fc1 = paddle.nn.Linear(in_features=self.fc_input_dim, out_features=<span class="number">128</span>)</span><br><span class="line">        self.fc2 = paddle.nn.Linear(in_features=<span class="number">128</span>, out_features=<span class="number">10</span>)  <span class="comment"># 输出类别数量为10，适用于MNIST数据集</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, inputs</span>):</span><br><span class="line">        x = paddle.to_tensor(inputs)</span><br><span class="line">        x = paddle.reshape(x, [-<span class="number">1</span>, <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>])</span><br><span class="line">        <span class="comment"># x = paddle.unsqueeze(x, axis=1)  # Add channel dimension</span></span><br><span class="line">        x = self.conv1(x)</span><br><span class="line">        x = paddle.nn.functional.relu(x)</span><br><span class="line">        x = self.pool1(x)</span><br><span class="line"></span><br><span class="line">        x = self.conv2(x)</span><br><span class="line">        x = paddle.nn.functional.relu(x)</span><br><span class="line">        x = self.pool2(x)</span><br><span class="line"></span><br><span class="line">        x = paddle.flatten(x, start_axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        x = self.fc1(x)</span><br><span class="line">        x = paddle.nn.functional.relu(x)</span><br><span class="line">        x = self.fc2(x)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model = MNIST_CNN()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">model</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;train:&#x27;</span>)</span><br><span class="line">    model.train()</span><br><span class="line">    <span class="comment"># 定义优化器，使用随机梯度下降SGD优化器，学习率设置为0.001</span></span><br><span class="line">    <span class="comment"># SGD的基本原理是在每一次迭代中，使用随机选择的小批量训练数据来计算梯度，并更新模型参数</span></span><br><span class="line">    opt = paddle.optimizer.SGD(learning_rate=<span class="number">0.001</span>, parameters=model.parameters())</span><br><span class="line">    EPOCH_NUM = <span class="number">5</span></span><br><span class="line">    <span class="keyword">for</span> epoch_id <span class="keyword">in</span> <span class="built_in">range</span>(EPOCH_NUM):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;epoch:&#x27;</span>, epoch_id)</span><br><span class="line">        <span class="keyword">for</span> batch_id, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_loader()):</span><br><span class="line">            images, labels = data</span><br><span class="line">            images = paddle.to_tensor(images).astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line">            labels = paddle.to_tensor(labels).astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            images = paddle.reshape(images, [images.shape[<span class="number">0</span>], images.shape[<span class="number">2</span>] * images.shape[<span class="number">3</span>]])</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 前向计算的过程</span></span><br><span class="line">            predicts = model(images)</span><br><span class="line">            <span class="comment"># Convert labels data type to integer</span></span><br><span class="line">            labels_int = paddle.cast(labels, dtype=<span class="string">&#x27;int64&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Convert labels to one-hot encoding</span></span><br><span class="line">            labels_onehot = paddle.nn.functional.one_hot(labels_int, num_classes=<span class="number">10</span>)</span><br><span class="line">            <span class="comment"># 计算损失，取一个批次样本损失的平均值</span></span><br><span class="line"></span><br><span class="line">            loss = paddle.nn.functional.square_error_cost(predicts, labels_onehot)</span><br><span class="line">            avg_loss = paddle.mean(loss)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 每训练了200批次的数据，打印下当前Loss的情况</span></span><br><span class="line">            <span class="keyword">if</span> batch_id % <span class="number">200</span> == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;epoch: &#123;&#125;, batch: &#123;&#125;, loss is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(epoch_id, batch_id, avg_loss.numpy()))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 后向传播，更新参数的过程</span></span><br><span class="line">            avg_loss.backward()</span><br><span class="line">            opt.step()</span><br><span class="line">            opt.clear_grad()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建模型</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;create model:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动训练过程</span></span><br><span class="line">train(model)</span><br><span class="line"><span class="comment"># # 保存模型参数，文件名为LR_model.pdparams</span></span><br><span class="line"><span class="comment"># paddle.save(model.state_dict(), &#x27;C:/Users/lxcqm/Desktop/model/modelhn.pdmodel&#x27;)</span></span><br><span class="line"><span class="comment"># print(&quot;模型保存成功，模型参数保存在C:/Users/lxcqm/Desktop/model/modelhn.pdmodel&quot;)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # 参数为保存模型参数的文件地址</span></span><br><span class="line"><span class="comment"># model_dict = paddle.load(&#x27;C:/Users/lxcqm/Desktop/model/modelhn.pdmodel&#x27;)</span></span><br><span class="line"><span class="comment"># model.load_dict(model_dict)</span></span><br><span class="line"><span class="comment"># model.eval()</span></span><br></pre></td></tr></table></figure><h1 id="task3-2（代码实现）-1"><a href="#task3-2（代码实现）-1" class="headerlink" title="task3.2（代码实现）"></a>task3.2（代码实现）</h1><h3 id="题目：卷积神经网络（CNN）分类-1"><a href="#题目：卷积神经网络（CNN）分类-1" class="headerlink" title="题目：卷积神经网络（CNN）分类"></a>题目：卷积神经网络（CNN）分类</h3><p>使用PaddlePaddle框架构建一个简单的卷积神经网络（CNN），用于对MNIST手写数字数据集进行分类。</p><p>(Paddle Pytorch Tensorflow等框架都可)</p><h4 id="提示-1"><a href="#提示-1" class="headerlink" title="提示"></a>提示</h4><p>构建一个包含卷积层、池化层和全连接层的CNN模型。<br>加载MNIST数据集，可以使用paddle.vision.datasets.MNIST。<br>定义损失函数和优化器。<br>训练模型以对手写数字进行分类。<br>评估模型性能并进行预测。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"><span class="keyword">from</span> paddle.vision.transforms <span class="keyword">import</span> Normalize</span><br><span class="line"><span class="keyword">from</span> paddle.io <span class="keyword">import</span> Dataset</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> paddle.vision.transforms <span class="keyword">import</span> functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义图像归一化处理方法,这里的CHW指图像格式需为 [C通道数,H图像高度,W图像宽度]</span></span><br><span class="line"></span><br><span class="line">transform = Normalize(mean=[<span class="number">127.5</span>], std=[<span class="number">127.5</span>], data_format=<span class="string">&#x27;CHW&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MNISTDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, datafile, mode=<span class="string">&#x27;train&#x27;</span>, transform=<span class="literal">None</span></span>):</span><br><span class="line"></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">        self.mode = mode</span><br><span class="line">        self.transform = transform</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;loading mnist dataset from &#123;&#125; ......&#x27;</span>.<span class="built_in">format</span>(datafile))</span><br><span class="line"></span><br><span class="line">        data = json.load(gzip.<span class="built_in">open</span>(datafile))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;mnist dataset load done&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 读取到的数据区分训练集,验证集,测试集</span></span><br><span class="line">        train_set, val_set, eval_set = data</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> mode == <span class="string">&#x27;train&#x27;</span>:</span><br><span class="line">            <span class="comment"># 获得训练数据集</span></span><br><span class="line">            self.imgs, self.labels = train_set[<span class="number">0</span>], train_set[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> mode == <span class="string">&#x27;valid&#x27;</span>:</span><br><span class="line">            <span class="comment"># 获得验证数据集</span></span><br><span class="line">            self.imgs, self.labels = val_set[<span class="number">0</span>], val_set[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> mode == <span class="string">&#x27;test&#x27;</span>:</span><br><span class="line">            <span class="comment"># 获得测试数据集</span></span><br><span class="line">            self.imgs, self.labels = eval_set[<span class="number">0</span>], eval_set[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&quot;mode can only be one of [&#x27;train&#x27;, &#x27;valid&#x27;, &#x27;test&#x27;]&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        实现__getitem__方法，定义指定index时如何获取数据</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        data = self.imgs[index]</span><br><span class="line">        label = self.labels[index]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.transform(data), label</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        实现__len__方法，返回数据集总数目</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.imgs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">datafile = <span class="string">&#x27;D:/paddlepaddle/paddlepaddle手写数字/mnist.json.gz&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载数据集并初始化 DataSet</span></span><br><span class="line">train_dataset = MNISTDataset(datafile, mode=<span class="string">&#x27;train&#x27;</span>, transform=transform)</span><br><span class="line">test_dataset = MNISTDataset(datafile, mode=<span class="string">&#x27;test&#x27;</span>, transform=transform)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义并初始化数据读取器</span></span><br><span class="line">train_loader = paddle.io.DataLoader(train_dataset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">True</span>, num_workers=<span class="number">0</span>)</span><br><span class="line">test_loader = paddle.io.DataLoader(test_dataset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">False</span>, num_workers=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># train_loader = paddle.io.DataLoader(train_dataset, batch_size=128, shuffle=True, num_workers=0)</span></span><br><span class="line"><span class="comment"># test_loader = paddle.io.DataLoader(test_dataset, batch_size=128, shuffle=False, num_workers=0)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MNIST_CNN</span>(paddle.nn.Layer):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(MNIST_CNN, self).__init__()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 定义卷积层</span></span><br><span class="line">        self.conv1 = paddle.nn.Conv2D(in_channels=<span class="number">1</span>, out_channels=<span class="number">16</span>, kernel_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>)</span><br><span class="line">        self.pool1 = paddle.nn.MaxPool2D(kernel_size=<span class="number">2</span>, stride=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        self.conv2 = paddle.nn.Conv2D(in_channels=<span class="number">16</span>, out_channels=<span class="number">32</span>, kernel_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>)</span><br><span class="line">        self.pool2 = paddle.nn.MaxPool2D(kernel_size=<span class="number">2</span>, stride=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算全连接层的输入维度</span></span><br><span class="line">        self.fc_input_dim = <span class="number">32</span> * <span class="number">7</span> * <span class="number">7</span>  <span class="comment"># 根据卷积层和池化层输出的维度计算</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 定义全连接层</span></span><br><span class="line">        self.fc1 = paddle.nn.Linear(in_features=self.fc_input_dim, out_features=<span class="number">128</span>)</span><br><span class="line">        self.fc2 = paddle.nn.Linear(in_features=<span class="number">128</span>, out_features=<span class="number">10</span>)  <span class="comment"># 输出类别数量为10，适用于MNIST数据集</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, inputs</span>):</span><br><span class="line">        x = paddle.to_tensor(inputs)</span><br><span class="line">        x = paddle.reshape(x, [-<span class="number">1</span>, <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>])</span><br><span class="line">        <span class="comment"># x = paddle.unsqueeze(x, axis=1)  # Add channel dimension</span></span><br><span class="line">        x = self.conv1(x)</span><br><span class="line">        x = paddle.nn.functional.relu(x)</span><br><span class="line">        x = self.pool1(x)</span><br><span class="line"></span><br><span class="line">        x = self.conv2(x)</span><br><span class="line">        x = paddle.nn.functional.relu(x)</span><br><span class="line">        x = self.pool2(x)</span><br><span class="line"></span><br><span class="line">        x = paddle.flatten(x, start_axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        x = self.fc1(x)</span><br><span class="line">        x = paddle.nn.functional.relu(x)</span><br><span class="line">        x = self.fc2(x)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model = MNIST_CNN()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">model</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;train:&#x27;</span>)</span><br><span class="line">    model.train()</span><br><span class="line">    <span class="comment"># 定义优化器</span></span><br><span class="line">    <span class="comment"># opt = paddle.optimizer.SGD(learning_rate=0.001, parameters=model.parameters())</span></span><br><span class="line">    <span class="comment"># opt = paddle.optimizer.Momentum(learning_rate=0.001, momentum=0.9, parameters=model.parameters())</span></span><br><span class="line">    <span class="comment"># opt = paddle.optimizer.Adagrad(learning_rate=0.001, parameters=model.parameters())</span></span><br><span class="line">    opt = paddle.optimizer.Adam(learning_rate=<span class="number">0.001</span>, parameters=model.parameters())</span><br><span class="line">    EPOCH_NUM = <span class="number">40</span></span><br><span class="line">    total_losses = []  <span class="comment"># 存储每个batch的损失值</span></span><br><span class="line">    <span class="keyword">for</span> epoch_id <span class="keyword">in</span> <span class="built_in">range</span>(EPOCH_NUM):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;epoch:&#x27;</span>, epoch_id)</span><br><span class="line">        <span class="keyword">for</span> batch_id, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_loader()):</span><br><span class="line">            images, labels = data</span><br><span class="line">            images = paddle.to_tensor(images).astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line">            labels = paddle.to_tensor(labels).astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            images = paddle.reshape(images, [images.shape[<span class="number">0</span>], images.shape[<span class="number">2</span>] * images.shape[<span class="number">3</span>]])</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 前向计算的过程</span></span><br><span class="line">            predicts = model(images)</span><br><span class="line">            <span class="comment"># Convert labels data type to integer</span></span><br><span class="line">            labels_int = paddle.cast(labels, dtype=<span class="string">&#x27;int64&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Convert labels to one-hot encoding</span></span><br><span class="line">            labels_onehot = paddle.nn.functional.one_hot(labels_int, num_classes=<span class="number">10</span>)</span><br><span class="line">            <span class="comment"># 计算损失，取一个批次样本损失的平均值</span></span><br><span class="line"></span><br><span class="line">            loss = paddle.nn.functional.square_error_cost(predicts, labels_onehot)</span><br><span class="line">            avg_loss = paddle.mean(loss)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 计算预测结果</span></span><br><span class="line">            probs = paddle.nn.functional.softmax(predicts, axis=<span class="number">1</span>)</span><br><span class="line">            predictions = paddle.argmax(probs, axis=<span class="number">1</span>)</span><br><span class="line">            <span class="comment"># 计算准确率</span></span><br><span class="line">            correct = paddle.<span class="built_in">sum</span>(paddle.cast(paddle.equal(predictions, labels_int), dtype=<span class="string">&#x27;float32&#x27;</span>))</span><br><span class="line">            accuracy = correct / images.shape[<span class="number">0</span>] * <span class="number">100</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> batch_id % <span class="number">200</span> == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;epoch: &#123;&#125;, batch: &#123;&#125;, loss is: &#123;&#125;, accuracy is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(epoch_id, batch_id,</span><br><span class="line">                                                                                  avg_loss.numpy(),</span><br><span class="line">                                                                                  accuracy.numpy()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 后向传播，更新参数的过程</span></span><br><span class="line">            avg_loss.backward()</span><br><span class="line">            opt.step()</span><br><span class="line">            opt.clear_grad()</span><br><span class="line">            <span class="comment"># 保存每个batch的损失值</span></span><br><span class="line">            total_losses.append(avg_loss.numpy())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 绘制总的损失曲线图</span></span><br><span class="line">    plt.plot(total_losses)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;Batch&#x27;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;Loss&#x27;</span>)</span><br><span class="line">    plt.title(<span class="string">&#x27;Training Loss Curve&#x27;</span>)</span><br><span class="line">    plt.ylim(<span class="number">0</span>, <span class="number">0.1</span>)  <span class="comment"># 设置y轴范围为0到0.1</span></span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建模型</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;create model:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动训练过程</span></span><br><span class="line">train(model)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存模型参数，文件名为modelhn.pdmodel</span></span><br><span class="line">paddle.save(model.state_dict(), <span class="string">&#x27;C:/Users/lxcqm/Desktop/model/modelhn.pdmodel&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;模型保存成功，模型参数保存在C:/Users/lxcqm/Desktop/model/modelhn.pdmodel&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数为保存模型参数的文件地址</span></span><br><span class="line"></span><br><span class="line">model_dict = paddle.load(<span class="string">&#x27;C:/Users/lxcqm/Desktop/model/modelhn.pdmodel&#x27;</span>)</span><br><span class="line">model.load_dict(model_dict)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line">test_loader = paddle.io.DataLoader(test_dataset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">False</span>, num_workers=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> batch_id, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(test_loader):</span><br><span class="line">    images, labels = data</span><br><span class="line">    images = paddle.to_tensor(images).astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line">    labels = paddle.to_tensor(labels).astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    images = paddle.reshape(images, [images.shape[<span class="number">0</span>], images.shape[<span class="number">2</span>] * images.shape[<span class="number">3</span>]])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 前向计算的过程</span></span><br><span class="line">    predicts = model(images)</span><br><span class="line">    <span class="comment">#########################</span></span><br><span class="line">    <span class="comment"># 设置数据读取器，API自动读取MNIST数据测试集</span></span><br><span class="line">    test_dataset = paddle.vision.datasets.MNIST(mode=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">    test_data0 = np.array(test_dataset[batch_id][<span class="number">0</span>])</span><br><span class="line">    test_label_0 = np.array(test_dataset[batch_id][<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># plt.figure(&quot;Image&quot;)  # 图像窗口名称</span></span><br><span class="line">    plt.figure(figsize=(<span class="number">2</span>, <span class="number">2</span>))</span><br><span class="line">    plt.imshow(test_data0, cmap=plt.cm.binary)</span><br><span class="line">    plt.axis(<span class="string">&#x27;on&#x27;</span>)  <span class="comment"># 关掉坐标轴为 off</span></span><br><span class="line">    plt.title(<span class="string">&#x27;image&#x27;</span>)  <span class="comment"># 图像题目</span></span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># test_loader = paddle.io.DataLoader(test_dataset, batch_size=64, shuffle=False, num_workers=0)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印测试结果</span></span><br><span class="line"><span class="comment"># print(&quot;Inference result is &#123;&#125;, the corresponding label is &#123;&#125;&quot;.format(predicts, labels))</span></span><br><span class="line"></span><br><span class="line">predicts_np = predicts.numpy()</span><br><span class="line">labels_np = labels.numpy()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;预测各标签概率:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(predicts_np[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;实际标签:&quot;</span>, labels_np[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 推理结果向量</span></span><br><span class="line">predictions = np.array(predicts_np[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到概率最高的标签</span></span><br><span class="line">predicted_label = np.argmax(predictions)</span><br><span class="line"><span class="comment"># print(predictions)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;模型认为概率最高的标签是:&quot;</span>, predicted_label)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># for batch_id, data in enumerate(test_loader):</span></span><br><span class="line"><span class="comment">#     images, labels = data</span></span><br><span class="line"><span class="comment">#     images = paddle.to_tensor(images).astype(&#x27;float32&#x27;)</span></span><br><span class="line"><span class="comment">#     labels = paddle.to_tensor(labels).astype(&#x27;float32&#x27;)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     images = paddle.reshape(images, [images.shape[0], images.shape[2] * images.shape[3]])</span></span><br><span class="line"></span><br><span class="line">total_accuracy = <span class="number">0.0</span></span><br><span class="line">total_samples = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> batch_id, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(test_loader()):</span><br><span class="line">    images, labels = data</span><br><span class="line">    images = paddle.to_tensor(images).astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line">    labels = paddle.to_tensor(labels).astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    images = paddle.reshape(images, [images.shape[<span class="number">0</span>], images.shape[<span class="number">2</span>] * images.shape[<span class="number">3</span>]])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 前向计算</span></span><br><span class="line">    predicts = model(images)</span><br><span class="line">    <span class="comment"># Convert labels data type to integer</span></span><br><span class="line">    labels_int = paddle.cast(labels, dtype=<span class="string">&#x27;int64&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Convert labels to one-hot encoding</span></span><br><span class="line">    labels_onehot = paddle.nn.functional.one_hot(labels_int, num_classes=<span class="number">10</span>)</span><br><span class="line">    <span class="comment"># 计算损失，取一个批次样本损失的平均值</span></span><br><span class="line"></span><br><span class="line">    loss = paddle.nn.functional.square_error_cost(predicts, labels_onehot)</span><br><span class="line">    avg_loss = paddle.mean(loss)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算预测结果</span></span><br><span class="line">    probs = paddle.nn.functional.softmax(predicts, axis=<span class="number">1</span>)</span><br><span class="line">    predictions = paddle.argmax(probs, axis=<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 计算准确率</span></span><br><span class="line">    correct = paddle.<span class="built_in">sum</span>(paddle.cast(paddle.equal(predictions, labels_int), dtype=<span class="string">&#x27;float32&#x27;</span>))</span><br><span class="line">    accuracy = correct / images.shape[<span class="number">0</span>] * <span class="number">100</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> batch_id % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; batch: &#123;&#125;, loss is: &#123;&#125;, accuracy is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>( batch_id,</span><br><span class="line">                                                                          avg_loss.numpy(),</span><br><span class="line">                                                                          accuracy.numpy()))</span><br><span class="line">    <span class="comment"># 累加准确率值和样本数量</span></span><br><span class="line">    total_accuracy += accuracy.numpy() * images.shape[<span class="number">0</span>]</span><br><span class="line">    total_samples += images.shape[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算平均准确率</span></span><br><span class="line">accuracy_total = total_accuracy / total_samples</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;- Total Accuracy: &#123;:.5f&#125;%&quot;</span>.<span class="built_in">format</span>(accuracy_total))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 深度学习 </tag>
            
            <tag> 智能车 </tag>
            
            <tag> 考核 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python程序控制结构</title>
      <link href="/2024/03/10/Python%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/"/>
      <url>/2024/03/10/Python%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h2 id="分支语句"><a href="#分支语句" class="headerlink" title="分支语句"></a>分支语句</h2><h3 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h3><p><strong>逻辑非：</strong><br>not x</p><h4 id="遍历循环"><a href="#遍历循环" class="headerlink" title="遍历循环"></a>遍历循环</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8z69tiu27o.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8z69tiu27o.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.86tebsepob.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.86tebsepob.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="条件循环"><a href="#条件循环" class="headerlink" title="条件循环"></a>条件循环</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x=<span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">while</span> x &lt; <span class="number">10</span>:</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(x)</span><br><span class="line"><span class="meta">... </span>    x+=<span class="number">3</span></span><br><span class="line">...</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">9</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4xuaf4vpql.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4xuaf4vpql.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="循环保留字-break和continue"><a href="#循环保留字-break和continue" class="headerlink" title="循环保留字: break和continue"></a>循环保留字: break和continue</h4><ul><li><p>作用：辅助控制循环执行：</p><ul><li><p>Break：来跳出当前层循环，脱离该循环后程序从循环<br>  后代码继续执行(多层循环中break语句只能跳出最内层循环)</p></li><li><p>Continue：结束当前层当次循环，即跳过循环体中下<br>  面尚未执行的语句，进行下一次循环，但不跳出当前层<br>  循环。</p></li></ul></li><li><p>在for循环和while循环中的else扩展用法中：</p><ul><li><p>Break和return语句被执行对else有影响</p></li><li><p>continue保留字对else没有影响</p></li></ul></li></ul><h2 id="程序的异常处理"><a href="#程序的异常处理" class="headerlink" title="程序的异常处理"></a>程序的异常处理</h2><h3 id="try-except-语句"><a href="#try-except-语句" class="headerlink" title="try-except()语句"></a>try-except()语句</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.99t3mopr9a.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.99t3mopr9a.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.39kxhygpgc.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.39kxhygpgc.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    &lt;语句块<span class="number">1</span>&gt;</span><br><span class="line"><span class="keyword">except</span> &lt;异常类型&gt;:</span><br><span class="line">    &lt;语句块<span class="number">2</span>&gt;</span><br></pre></td></tr></table></figure><p>可以有多个except<br>except语句没有指定任何错误类型时，表示它对应的语句块可以处理所有其他异常<br><strong>示例</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        Vol = <span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入电池电压，单位V:&quot;</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;电池电压值：&quot;</span>, <span class="built_in">float</span>(Vol))</span><br><span class="line">        <span class="keyword">if</span> Vol &lt; <span class="number">10</span> <span class="keyword">or</span> Vol &gt; <span class="number">13</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;电压值不正常，请即使检查！&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> NameError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;输入错误！请输入一个数值！&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="random库"><a href="#random库" class="headerlink" title="random库"></a>random库</h2><p>random库是使用随机数的Python标准库</p><ul><li>random库主要用于生成随机数</li><li>伪随机数: 采用梅森旋转算法生成的(伪)随机序列中元素<div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2ob9votxz1.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2ob9votxz1.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>生成随机数之前可以通过seed()函数指定随机数种子，随机种子一般是一个整数，只要种子相同，每次生成的随机数序列也相同，这种方法便于测试和同步数据。</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>seed(<span class="number">125</span>) <span class="comment"># 随机种子赋值125</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&#123;&#125;.&#123;&#125;.&#123;&#125;&quot;</span>.<span class="built_in">format</span>(randint(<span class="number">1</span>,<span class="number">10</span>),randint(<span class="number">1</span>,<span class="number">10</span>),randint(<span class="number">1</span>,<span class="number">10</span>))</span><br><span class="line"><span class="string">&#x27;4.4.10&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&#123;&#125;.&#123;&#125;.&#123;&#125;&quot;</span>.<span class="built_in">format</span>(randint(<span class="number">1</span>,<span class="number">10</span>),randint(<span class="number">1</span>,<span class="number">10</span>),randint(<span class="number">1</span>,<span class="number">10</span>))</span><br><span class="line"><span class="string">&#x27;5.10.3&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>seed(<span class="number">125</span>) <span class="comment"># 再次给随机种子赋值125</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&#123;&#125;.&#123;&#125;.&#123;&#125;&quot;</span>.<span class="built_in">format</span>(randint(<span class="number">1</span>,<span class="number">10</span>),randint(<span class="number">1</span>,<span class="number">10</span>),randint(<span class="number">1</span>,<span class="number">10</span>))</span><br><span class="line"><span class="string">&#x27;4.4.10&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 深度学习 </tag>
            
            <tag> 智能车 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python基本语法元素及数据类型</title>
      <link href="/2024/03/09/Python%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%85%83%E7%B4%A0%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
      <url>/2024/03/09/Python%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%85%83%E7%B4%A0%E5%8F%8A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="程序基本设计方法"><a href="#程序基本设计方法" class="headerlink" title="程序基本设计方法"></a>程序基本设计方法</h2><h3 id="RELU激活函数"><a href="#RELU激活函数" class="headerlink" title="RELU激活函数"></a>RELU激活函数</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8ad0871gq2.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8ad0871gq2.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="built_in">input</span>(<span class="string">&quot;请输入数值x:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">eval</span>(x) &gt; <span class="number">0</span>: <span class="comment"># 从键盘输入的是字符串，eval() 函数接收一个数字表达式作为参数</span></span><br><span class="line">                <span class="comment"># 输出表达式的值</span></span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>一种输出：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">请输入数值x:<span class="number">1</span>+<span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure><h3 id="智能车差速转向"><a href="#智能车差速转向" class="headerlink" title="智能车差速转向"></a>智能车差速转向</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3nrd7ii95k.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3nrd7ii95k.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line">speed = <span class="number">20</span>  <span class="comment">#设定车轮直线形式速度</span></span><br><span class="line">kx = <span class="number">0.85</span>   <span class="comment">#调节参数</span></span><br><span class="line"></span><br><span class="line">left_wheel = speed</span><br><span class="line">right_wheel = speed</span><br><span class="line"></span><br><span class="line">angle = <span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入归一化后的角度:&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="number">0</span> &lt; <span class="built_in">eval</span>(angle) &lt;= <span class="number">1</span>:    <span class="comment">#右转向</span></span><br><span class="line">    right_wheel = (<span class="number">1</span> - angle * kx) * speed </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;right_wheel:&#123;&#125;;left_wheel:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(right_wheel,left_wheel)) </span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> -<span class="number">1</span> &lt;= <span class="built_in">eval</span>(angle) &lt;= <span class="number">0</span>： <span class="comment">#左转向和直行</span></span><br><span class="line">    left_wheel = (<span class="number">1</span> - <span class="built_in">abs</span>(angle * kx)) * speed</span><br><span class="line">    <span class="comment"># abs() 函数返回数字的绝对值</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;right_wheel:&#123;&#125;;left_wheel:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(right_wheel,left_wheel))</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;输入的转角信息不是归一化数据&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="python基本语法元素"><a href="#python基本语法元素" class="headerlink" title="python基本语法元素"></a>python基本语法元素</h2><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>‘#’:单行注释<br>‘’’开头’’’结尾:多行注释</p><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>大小写敏感  首字符不可为数字</p><h3 id="赋值语句"><a href="#赋值语句" class="headerlink" title="赋值语句"></a>赋值语句</h3><p>x, y &#x3D; y, x</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">1</span></span><br><span class="line">y = <span class="number">2</span></span><br><span class="line">x, y = y, x</span><br><span class="line"><span class="built_in">print</span>(x, y)</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">2 </span><span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="基本输入输出函数"><a href="#基本输入输出函数" class="headerlink" title="基本输入输出函数"></a>基本输入输出函数</h3><p>&lt;变量&gt; &#x3D; input(&lt;提示性文字&gt;)<br>获取到的变量是字符串形式(不输入按回车是空字符串)<br>可以转换：float(a)</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.54xiafsp9p.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.54xiafsp9p.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p><strong>end参数</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a=<span class="number">54</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(a,end=<span class="string">&quot;.&quot;</span>)</span><br><span class="line"><span class="number">54.</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(a,end=<span class="string">&quot;%&quot;</span>)</span><br><span class="line"><span class="number">54</span>%</span><br></pre></td></tr></table></figure><h3 id="eval"><a href="#eval" class="headerlink" title="eval()"></a>eval()</h3><p>去掉字符串最外层的引号：<br>eval(‘1+2’) &#x3D; 3<br>eval(‘“1+2”‘) &#x3D; “1+2”<br>eval(‘print(“Hello”)’) &#x3D; print(“Hello”) #输出Hello</p><h3 id="功能库引用"><a href="#功能库引用" class="headerlink" title="功能库引用"></a>功能库引用</h3><ol><li><p>import&lt;库名&gt;<br> 使用：&lt;库名&gt;.&lt;函数名&gt;(&lt;函数参数&gt;)</p></li><li><ul><li>from&lt;库名&gt;import&lt;函数名，函数名，…&gt;</li><li>from&lt;库名&gt;import*  #*是通配符，表示所有函数<br> 使用：&lt;函数名&gt;(&lt;函数参数&gt;)</li></ul></li></ol><h2 id="python基本数据类型"><a href="#python基本数据类型" class="headerlink" title="python基本数据类型"></a>python基本数据类型</h2><h3 id="数字类型"><a href="#数字类型" class="headerlink" title="数字类型"></a>数字类型</h3><ol><li><p>整数类型<br>没有取值范围限制</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8hg84tnby2.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8hg84tnby2.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li><li><p>浮点数类型</p><ul><li><p>小数点一般形式<br> 123.456</p></li><li><p>科学计数法表示<br> 1.23456e2</p></li></ul> <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4g48qfnog8.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4g48qfnog8.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li><li><p>复数类型</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8ad09e8xe1.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8ad09e8xe1.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li></ol><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.39kxhu48yc.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.39kxhu48yc.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="数值运算操作符"><a href="#数值运算操作符" class="headerlink" title="数值运算操作符"></a>数值运算操作符</h3><ol><li>x&#x2F;y &#x3D; 0.3333333</li><li>x&#x2F;&#x2F;y x与y之整数商</li><li>x%y  x与y之商的余数</li><li>x**y x的y次幂</li></ol><h3 id="混合运算规则"><a href="#混合运算规则" class="headerlink" title="混合运算规则"></a>混合运算规则</h3><p>数字类型之间相互运算所生成的结果是“更宽”的类型，基本规则是：<br>◆整数之间运算，如果数学意义上的结果是小数结果是浮点数；<br>◆整数之间运算，如果数学意义上的结果是整数结果是整数；<br>◆整数和浮点数混合运算，输出结果是浮点数;<br>◆整数和浮点数混合运算，输出结果是浮点数;</p><h3 id="python内置数值运算函数"><a href="#python内置数值运算函数" class="headerlink" title="python内置数值运算函数"></a>python内置数值运算函数</h3><ul><li>abs()<br>  绝对值</li><li>divmod(x,y)<br>  (x&#x2F;&#x2F;y,x%y) 输出为二元组形式(也称为元组类型)<br>  divmod(10, 3) &#x3D; 3, 1</li><li>pow(x,y[,z])<br>  幂余：(x**y)%z,[…]表示该参数可以省略</li><li>round(x[,ndigits])<br>  对x四舍五入，保留ndigits位小数<br>  round(x)返回四舍五入后的整数值</li><li>max(x₁,x₂,….xₙ)<br>  n没有限定</li><li>min(x₁,x₂,….xₙ)<br>  n没有限定</li></ul><h3 id="数字类型的判断"><a href="#数字类型的判断" class="headerlink" title="数字类型的判断"></a>数字类型的判断</h3><p><strong>type(x)</strong><br>返回x的类型</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Python <span class="number">3.12</span><span class="number">.1</span> (tags/v3<span class="number">.12</span><span class="number">.1</span>:2305ca5, Dec  <span class="number">7</span> <span class="number">2023</span>, <span class="number">22</span>:03:<span class="number">25</span>) [MSC v<span class="number">.1937</span> <span class="number">64</span> bit (AMD64)] on win32</span><br><span class="line"><span class="type">Type</span> <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> <span class="keyword">or</span> <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x=<span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(x)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;int&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x=<span class="number">0.1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(x)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;float&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(x=<span class="number">1</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">TypeError: <span class="built_in">type</span>() takes <span class="number">1</span> <span class="keyword">or</span> <span class="number">3</span> arguments</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x=<span class="string">&#x27;a&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(x)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x=a</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">NameError: name <span class="string">&#x27;a&#x27;</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br></pre></td></tr></table></figure><h3 id="math库"><a href="#math库" class="headerlink" title="math库"></a>math库</h3><ul><li>不支持复数类型</li><li>一共提供了4个数学常数和44个函数<ul><li>四个数学常数  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7egitz8onh.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7egitz8onh.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li><li>44个函数共分为四类：<ol><li>16个数值表示函数</li><li>8个幂对数函数</li><li>16个三角对数函数</li><li>4个高等特殊函数  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.5xads8ai47.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.5xads8ai47.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.wib0o7nkk.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.wib0o7nkk.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4xuaf2dena.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4xuaf2dena.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>  <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4jnuo75s7e.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4jnuo75s7e.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li></ol></li></ul></li></ul><h3 id="字符串类型"><a href="#字符串类型" class="headerlink" title="字符串类型"></a>字符串类型</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4ckmsrqxrn.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4ckmsrqxrn.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="字符串的定位"><a href="#字符串的定位" class="headerlink" title="字符串的定位"></a>字符串的定位</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.231m9a8aoo.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.231m9a8aoo.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="字符串的切片"><a href="#字符串的切片" class="headerlink" title="字符串的切片"></a>字符串的切片</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.101wyefd6w.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.101wyefd6w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="转义符"><a href="#转义符" class="headerlink" title="转义符"></a>转义符</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.lvh7j96v8.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.lvh7j96v8.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="字符串操作"><a href="#字符串操作" class="headerlink" title="字符串操作"></a>字符串操作</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.26l870bw9g.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.26l870bw9g.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="字符串处理函数"><a href="#字符串处理函数" class="headerlink" title="字符串处理函数"></a>字符串处理函数</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4jnuo7sgoa.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4jnuo7sgoa.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="Unicode"><a href="#Unicode" class="headerlink" title="Unicode"></a>Unicode</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.9dcpkceonf.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.9dcpkceonf.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="字符的遍历"><a href="#字符的遍历" class="headerlink" title="字符的遍历"></a>字符的遍历</h4><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.101wyez3tw.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.101wyez3tw.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h4 id="字符串处理方法"><a href="#字符串处理方法" class="headerlink" title="字符串处理方法"></a>字符串处理方法</h4><p>字符串变量自带的一些方法(即函数)</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.9rj5b7wvg3.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.9rj5b7wvg3.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7w6kilsc7t.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7w6kilsc7t.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;10,20,30&quot;</span>.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">[<span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;30&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;* 12.3* &quot;</span>.strip(<span class="string">&quot;* &quot;</span>)</span><br><span class="line"><span class="string">&#x27;12.3&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;* 12*3* &quot;</span>.strip(<span class="string">&quot;* &quot;</span>)</span><br><span class="line"><span class="string">&#x27;12*3&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="字符串类型格式化控制"><a href="#字符串类型格式化控制" class="headerlink" title="字符串类型格式化控制"></a>字符串类型格式化控制</h3><p><strong>format()方法的格式控制</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7ljqpgljeu.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7ljqpgljeu.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4n7glygggs.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4n7glygggs.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.lvh7kdb3m.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.lvh7kdb3m.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8dwm7796st.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8dwm7796st.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="time库"><a href="#time库" class="headerlink" title="time库"></a>time库</h3><h4 id="时间获取"><a href="#时间获取" class="headerlink" title="时间获取"></a>时间获取</h4><ol><li><p><strong>time()</strong>:</p><ul><li>函数描述：返回当前时间的时间戳（以自1970年1月1日零时起的秒数浮点数形式）。</li><li>示例：<code>import time time.time()</code></li></ul></li><li><p><strong>ctime()</strong>:</p><ul><li>函数描述：将给定时间戳转换为字符串格式的可读时间。</li><li>示例：<code>import time time.ctime(time.time())</code></li></ul></li><li><p><strong>gmtime()</strong>:</p><ul><li>函数描述：将给定时间戳转换为UTC时区的时间元组。</li><li>示例：<code>import time time.gmtime(time.time())</code></li></ul></li></ol><h4 id="时间格式化"><a href="#时间格式化" class="headerlink" title="时间格式化"></a>时间格式化</h4><ol><li><p><strong>strftime()</strong>:</p><ul><li>函数描述：将时间元组格式化为指定格式的字符串。</li><li>示例：<code>import time time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, time.localtime())</code></li></ul></li><li><p><strong>strptime()</strong>:</p><ul><li>函数描述：将字符串解析为时间元组。</li><li>示例：<code>import time time.strptime(&quot;2024-03-09 19:36:30&quot;, &quot;%Y-%m-%d %H:%M:%S&quot;)</code></li></ul></li></ol><h4 id="程序计时"><a href="#程序计时" class="headerlink" title="程序计时"></a>程序计时</h4><ol><li><p><strong>sleep()</strong>:</p><ul><li>函数描述：暂停程序执行指定的秒数，可以用于模拟延迟、定时任务等。</li><li>示例：<code>import time time.sleep(5)</code></li></ul></li><li><p><strong>perf_counter()</strong>:</p><ul><li>函数描述：返回一个性能计数器的值，可用于测量瞬时时间。</li><li>示例：<code>import time start_time = time.perf_counter() # 执行代码 end_time = time.perf_counter() elapsed_time = end_time - start_time</code></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 深度学习 </tag>
            
            <tag> 智能车 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>paddlepaddle报错解决合集</title>
      <link href="/2024/03/09/paddlepaddle%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3%E5%90%88%E9%9B%86/"/>
      <url>/2024/03/09/paddlepaddle%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3%E5%90%88%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<h2 id="ERRoR-Could-not-find-a-version-that-satisfies-the-reouirement-nvidia-cuda-nvrtccu12-from-nvidia-cudpn-cu12-from-versions-none"><a href="#ERRoR-Could-not-find-a-version-that-satisfies-the-reouirement-nvidia-cuda-nvrtccu12-from-nvidia-cudpn-cu12-from-versions-none" class="headerlink" title="ERRoR: Could not find a version that satisfies the reouirement nvidia cuda nvrtccu12 (from nvidia-cudpn-cu12 (from versions: none))"></a>ERRoR: Could not find a version that satisfies the reouirement nvidia cuda nvrtccu12 (from nvidia-cudpn-cu12 (from versions: none))</h2><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/1bc53ca600b9742779b2bbcc23dcc2d.esgudi6oa.png" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/1bc53ca600b9742779b2bbcc23dcc2d.esgudi6oa.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p><strong>解决方法：</strong><br>把梯子关了</p><h2 id="“The-device-should-not-be-‘gpu’-“"><a href="#“The-device-should-not-be-‘gpu’-“" class="headerlink" title="“The device should not be ‘gpu’, “"></a>“The device should not be ‘gpu’, “</h2><p>“The device should not be ‘gpu’, “<br>ValueError: The device should not be ‘gpu’, since PaddlePaddle is not compiled with CUDA<br>当前情况：环境已为GPU，paddle.utils.run.checks()显示GPU正常，代码设置无误<br>问题：<br>在终端输入pip list<br>可以看到<br>同时装了paddlepaddle和paddlepaddle-gpu<br>解决方法：<br>先pip uninstall paddlepaddle和paddlepaddle-gpu(必须两个都删掉，只删paddlepaddle是不管用的)<br>然后重新pip install paddlepaddle-gpu<br>程序运行正常；<br>能跑通的list版本：<br>实在找不到原因就把跟这个版本不一样的包uninstall再install</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br></pre></td><td class="code"><pre><span class="line">aistudio@<span class="keyword">jupyter-9311933-7542288:~$ </span>pip list</span><br><span class="line">Package                        Version</span><br><span class="line">------------------------------ ---------------</span><br><span class="line">absl-py                        <span class="number">0</span>.<span class="number">8</span>.<span class="number">1</span></span><br><span class="line">aiofiles                       <span class="number">23</span>.<span class="number">2</span>.<span class="number">1</span></span><br><span class="line">aiohttp                        <span class="number">3</span>.<span class="number">8</span>.<span class="number">6</span></span><br><span class="line">aiosignal                      <span class="number">1</span>.<span class="number">3</span>.<span class="number">1</span></span><br><span class="line">alembic                        <span class="number">1</span>.<span class="number">8</span>.<span class="number">1</span></span><br><span class="line">altair                         <span class="number">4</span>.<span class="number">2</span>.<span class="number">0</span></span><br><span class="line">annotated-types                <span class="number">0</span>.<span class="number">5</span>.<span class="number">0</span></span><br><span class="line">anyio                          <span class="number">3</span>.<span class="number">7</span>.<span class="number">1</span></span><br><span class="line">argon2-cffi                    <span class="number">21</span>.<span class="number">3</span>.<span class="number">0</span></span><br><span class="line">argon2-cffi-<span class="keyword">bindings </span>          <span class="number">21</span>.<span class="number">2</span>.<span class="number">0</span></span><br><span class="line">aspy.yaml                      <span class="number">1</span>.<span class="number">3</span>.<span class="number">0</span></span><br><span class="line">astor                          <span class="number">0</span>.<span class="number">8</span>.<span class="number">1</span></span><br><span class="line">astroid                        <span class="number">2</span>.<span class="number">4</span>.<span class="number">1</span></span><br><span class="line">async-generator                <span class="number">1</span>.<span class="number">10</span></span><br><span class="line">async-timeout                  <span class="number">4</span>.<span class="number">0</span>.<span class="number">3</span></span><br><span class="line">asynctest                      <span class="number">0</span>.<span class="number">13</span>.<span class="number">0</span></span><br><span class="line">attrs                          <span class="number">22</span>.<span class="number">1</span>.<span class="number">0</span></span><br><span class="line">audioread                      <span class="number">2</span>.<span class="number">1</span>.<span class="number">8</span></span><br><span class="line">autopep8                       <span class="number">1</span>.<span class="number">6</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">Babel </span>                         <span class="number">2</span>.<span class="number">8</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">backcall </span>                      <span class="number">0</span>.<span class="number">1</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">backports.zoneinfo </span>            <span class="number">0</span>.<span class="number">2</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">bce-python-sdk </span>                <span class="number">0</span>.<span class="number">8</span>.<span class="number">53</span></span><br><span class="line"><span class="keyword">beautifulsoup4 </span>                <span class="number">4</span>.<span class="number">11</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">bleach </span>                        <span class="number">5</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">blinker </span>                       <span class="number">1</span>.<span class="number">6</span>.<span class="number">3</span></span><br><span class="line"><span class="keyword">cachetools </span>                    <span class="number">4</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">certifi                        <span class="number">2019</span>.<span class="number">9</span>.<span class="number">11</span></span><br><span class="line">certipy                        <span class="number">0</span>.<span class="number">1</span>.<span class="number">3</span></span><br><span class="line">cffi                           <span class="number">1</span>.<span class="number">15</span>.<span class="number">1</span></span><br><span class="line">cfgv                           <span class="number">2</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line">chardet                        <span class="number">3</span>.<span class="number">0</span>.<span class="number">4</span></span><br><span class="line">charset-<span class="keyword">normalizer </span>            <span class="number">3</span>.<span class="number">3</span>.<span class="number">2</span></span><br><span class="line">Click                          <span class="number">7</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">cloudpickle </span>                   <span class="number">1</span>.<span class="number">6</span>.<span class="number">0</span></span><br><span class="line">cma                            <span class="number">2</span>.<span class="number">7</span>.<span class="number">0</span></span><br><span class="line">colorama                       <span class="number">0</span>.<span class="number">4</span>.<span class="number">4</span></span><br><span class="line">colorlog                       <span class="number">4</span>.<span class="number">1</span>.<span class="number">0</span></span><br><span class="line">cryptography                   <span class="number">38</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line">cycler                         <span class="number">0</span>.<span class="number">10</span>.<span class="number">0</span></span><br><span class="line">Cython                         <span class="number">0</span>.<span class="number">29</span></span><br><span class="line">debugpy                        <span class="number">1</span>.<span class="number">6</span>.<span class="number">0</span></span><br><span class="line">decorator                      <span class="number">4</span>.<span class="number">4</span>.<span class="number">2</span></span><br><span class="line">defusedxml                     <span class="number">0</span>.<span class="number">7</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">dill </span>                          <span class="number">0</span>.<span class="number">3</span>.<span class="number">3</span></span><br><span class="line">easydict                       <span class="number">1</span>.<span class="number">9</span></span><br><span class="line">entrypoints                    <span class="number">0</span>.<span class="number">4</span></span><br><span class="line">et-xmlfile                     <span class="number">1</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line">exceptiongroup                 <span class="number">1</span>.<span class="number">2</span>.<span class="number">0</span></span><br><span class="line">fastapi                        <span class="number">0</span>.<span class="number">85</span>.<span class="number">1</span></span><br><span class="line">fastjsonschema                 <span class="number">2</span>.<span class="number">16</span>.<span class="number">1</span></span><br><span class="line">ffmpy                          <span class="number">0</span>.<span class="number">3</span>.<span class="number">1</span></span><br><span class="line">filelock                       <span class="number">3</span>.<span class="number">0</span>.<span class="number">12</span></span><br><span class="line">flake8                         <span class="number">4</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line">Flask                          <span class="number">1</span>.<span class="number">1</span>.<span class="number">1</span></span><br><span class="line">Flask-<span class="keyword">Babel </span>                   <span class="number">1</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">Flask-Cors                     <span class="number">3</span>.<span class="number">0</span>.<span class="number">8</span></span><br><span class="line">forbiddenfruit                 <span class="number">0</span>.<span class="number">1</span>.<span class="number">3</span></span><br><span class="line">frozenlist                     <span class="number">1</span>.<span class="number">3</span>.<span class="number">3</span></span><br><span class="line">fsspec                         <span class="number">2023</span>.<span class="number">1</span>.<span class="number">0</span></span><br><span class="line">funcsigs                       <span class="number">1</span>.<span class="number">0</span>.<span class="number">2</span></span><br><span class="line">future                         <span class="number">0</span>.<span class="number">18</span>.<span class="number">0</span></span><br><span class="line">gast                           <span class="number">0</span>.<span class="number">3</span>.<span class="number">3</span></span><br><span class="line">gitdb                          <span class="number">4</span>.<span class="number">0</span>.<span class="number">5</span></span><br><span class="line">GitPython                      <span class="number">3</span>.<span class="number">1</span>.<span class="number">14</span></span><br><span class="line">google-auth                    <span class="number">1</span>.<span class="number">10</span>.<span class="number">0</span></span><br><span class="line">google-auth-oauthlib           <span class="number">0</span>.<span class="number">4</span>.<span class="number">1</span></span><br><span class="line">gradio                         <span class="number">3</span>.<span class="number">34</span>.<span class="number">0</span></span><br><span class="line">gradio_client                  <span class="number">0</span>.<span class="number">2</span>.<span class="number">6</span></span><br><span class="line">graphviz                       <span class="number">0</span>.<span class="number">13</span></span><br><span class="line">greenlet                       <span class="number">1</span>.<span class="number">1</span>.<span class="number">3</span></span><br><span class="line">grpcio                         <span class="number">1</span>.<span class="number">35</span>.<span class="number">0</span></span><br><span class="line">gunicorn                       <span class="number">20</span>.<span class="number">0</span>.<span class="number">4</span></span><br><span class="line">gym                            <span class="number">0</span>.<span class="number">12</span>.<span class="number">1</span></span><br><span class="line">h11                            <span class="number">0</span>.<span class="number">14</span>.<span class="number">0</span></span><br><span class="line">h5py                           <span class="number">2</span>.<span class="number">9</span>.<span class="number">0</span></span><br><span class="line">httpcore                       <span class="number">0</span>.<span class="number">17</span>.<span class="number">3</span></span><br><span class="line">httpx                          <span class="number">0</span>.<span class="number">24</span>.<span class="number">1</span></span><br><span class="line">huggingface-hub                <span class="number">0</span>.<span class="number">16</span>.<span class="number">4</span></span><br><span class="line">identify                       <span class="number">1</span>.<span class="number">4</span>.<span class="number">10</span></span><br><span class="line">idna                           <span class="number">2</span>.<span class="number">8</span></span><br><span class="line">imageio                        <span class="number">2</span>.<span class="number">6</span>.<span class="number">1</span></span><br><span class="line">imageio-ffmpeg                 <span class="number">0</span>.<span class="number">3</span>.<span class="number">0</span></span><br><span class="line">imgaug                         <span class="number">0</span>.<span class="number">4</span>.<span class="number">0</span></span><br><span class="line">importlib-metadata             <span class="number">4</span>.<span class="number">2</span>.<span class="number">0</span></span><br><span class="line">importlib-resources            <span class="number">5</span>.<span class="number">9</span>.<span class="number">0</span></span><br><span class="line">ipykernel                      <span class="number">6</span>.<span class="number">9</span>.<span class="number">1</span></span><br><span class="line">ipython                        <span class="number">7</span>.<span class="number">34</span>.<span class="number">0</span></span><br><span class="line">ipython-genutils               <span class="number">0</span>.<span class="number">2</span>.<span class="number">0</span></span><br><span class="line">ipywidgets                     <span class="number">7</span>.<span class="number">6</span>.<span class="number">5</span></span><br><span class="line">isort                          <span class="number">4</span>.<span class="number">3</span>.<span class="number">21</span></span><br><span class="line">itsdangerous                   <span class="number">1</span>.<span class="number">1</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">jdcal </span>                         <span class="number">1</span>.<span class="number">4</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">jedi </span>                          <span class="number">0</span>.<span class="number">17</span>.<span class="number">2</span></span><br><span class="line"><span class="keyword">jieba </span>                         <span class="number">0</span>.<span class="number">42</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">Jinja2 </span>                        <span class="number">3</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">joblib </span>                        <span class="number">0</span>.<span class="number">14</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">JPype1 </span>                        <span class="number">0</span>.<span class="number">7</span>.<span class="number">2</span></span><br><span class="line"><span class="keyword">json5 </span>                         <span class="number">0</span>.<span class="number">9</span>.<span class="number">5</span></span><br><span class="line"><span class="keyword">jsonschema </span>                    <span class="number">4</span>.<span class="number">16</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">jupyter-archive </span>               <span class="number">3</span>.<span class="number">2</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">jupyter_client </span>                <span class="number">7</span>.<span class="number">3</span>.<span class="number">5</span></span><br><span class="line"><span class="keyword">jupyter-core </span>                  <span class="number">4</span>.<span class="number">11</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">jupyter-lsp </span>                   <span class="number">1</span>.<span class="number">5</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">jupyter-server </span>                <span class="number">1</span>.<span class="number">16</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">jupyter-telemetry </span>             <span class="number">0</span>.<span class="number">1</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">jupyterhub </span>                    <span class="number">1</span>.<span class="number">3</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">jupyterlab </span>                    <span class="number">3</span>.<span class="number">4</span>.<span class="number">5</span></span><br><span class="line"><span class="keyword">jupyterlab-language-pack-zh-CN </span><span class="number">3</span>.<span class="number">4</span>.post1</span><br><span class="line"><span class="keyword">jupyterlab-pygments </span>           <span class="number">0</span>.<span class="number">2</span>.<span class="number">2</span></span><br><span class="line"><span class="keyword">jupyterlab-server </span>             <span class="number">2</span>.<span class="number">10</span>.<span class="number">3</span></span><br><span class="line"><span class="keyword">jupyterlab-widgets </span>            <span class="number">3</span>.<span class="number">0</span>.<span class="number">3</span></span><br><span class="line">kiwisolver                     <span class="number">1</span>.<span class="number">1</span>.<span class="number">0</span></span><br><span class="line">lap                            <span class="number">0</span>.<span class="number">4</span>.<span class="number">0</span></span><br><span class="line">lazy-object-proxy              <span class="number">1</span>.<span class="number">4</span>.<span class="number">3</span></span><br><span class="line">librosa                        <span class="number">0</span>.<span class="number">7</span>.<span class="number">2</span></span><br><span class="line">lightgbm                       <span class="number">3</span>.<span class="number">1</span>.<span class="number">1</span></span><br><span class="line">linkify-it-py                  <span class="number">2</span>.<span class="number">0</span>.<span class="number">2</span></span><br><span class="line"><span class="keyword">llvmlite </span>                      <span class="number">0</span>.<span class="number">31</span>.<span class="number">0</span></span><br><span class="line">lxml                           <span class="number">4</span>.<span class="number">9</span>.<span class="number">1</span></span><br><span class="line">Mako                           <span class="number">1</span>.<span class="number">2</span>.<span class="number">2</span></span><br><span class="line">Markdown                       <span class="number">3</span>.<span class="number">1</span>.<span class="number">1</span></span><br><span class="line">markdown-it-py                 <span class="number">2</span>.<span class="number">2</span>.<span class="number">0</span></span><br><span class="line">MarkupSafe                     <span class="number">2</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line">matplotlib                     <span class="number">2</span>.<span class="number">2</span>.<span class="number">3</span></span><br><span class="line">matplotlib-inline              <span class="number">0</span>.<span class="number">1</span>.<span class="number">6</span></span><br><span class="line">mccabe                         <span class="number">0</span>.<span class="number">6</span>.<span class="number">1</span></span><br><span class="line">mdit-py-plugins                <span class="number">0</span>.<span class="number">3</span>.<span class="number">3</span></span><br><span class="line">mdurl                          <span class="number">0</span>.<span class="number">1</span>.<span class="number">1</span></span><br><span class="line">mistune                        <span class="number">0</span>.<span class="number">8</span>.<span class="number">4</span></span><br><span class="line">more-itertools                 <span class="number">7</span>.<span class="number">2</span>.<span class="number">0</span></span><br><span class="line">motmetrics                     <span class="number">1</span>.<span class="number">4</span>.<span class="number">0</span></span><br><span class="line">moviepy                        <span class="number">1</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">multidict </span>                     <span class="number">6</span>.<span class="number">0</span>.<span class="number">4</span></span><br><span class="line"><span class="keyword">multiprocess </span>                  <span class="number">0</span>.<span class="number">70</span>.<span class="number">11</span>.<span class="number">1</span></span><br><span class="line">nbclassic                      <span class="number">0</span>.<span class="number">3</span>.<span class="number">1</span></span><br><span class="line">nbclient                       <span class="number">0</span>.<span class="number">5</span>.<span class="number">13</span></span><br><span class="line">nbconvert                      <span class="number">6</span>.<span class="number">4</span>.<span class="number">4</span></span><br><span class="line">nbformat                       <span class="number">5</span>.<span class="number">5</span>.<span class="number">0</span></span><br><span class="line">nest-asyncio                   <span class="number">1</span>.<span class="number">5</span>.<span class="number">5</span></span><br><span class="line">netifaces                      <span class="number">0</span>.<span class="number">10</span>.<span class="number">9</span></span><br><span class="line">networkx                       <span class="number">2</span>.<span class="number">4</span></span><br><span class="line">nltk                           <span class="number">3</span>.<span class="number">4</span>.<span class="number">5</span></span><br><span class="line">nodeenv                        <span class="number">1</span>.<span class="number">3</span>.<span class="number">4</span></span><br><span class="line">notebook                       <span class="number">5</span>.<span class="number">7</span>.<span class="number">0</span></span><br><span class="line">numba                          <span class="number">0</span>.<span class="number">48</span>.<span class="number">0</span></span><br><span class="line">numpy                          <span class="number">1</span>.<span class="number">20</span>.<span class="number">3</span></span><br><span class="line">oauthlib                       <span class="number">3</span>.<span class="number">1</span>.<span class="number">0</span></span><br><span class="line">objgraph                       <span class="number">3</span>.<span class="number">4</span>.<span class="number">1</span></span><br><span class="line">opencv-python                  <span class="number">4</span>.<span class="number">1</span>.<span class="number">1</span>.<span class="number">26</span></span><br><span class="line">openpyxl                       <span class="number">3</span>.<span class="number">0</span>.<span class="number">5</span></span><br><span class="line">opt-<span class="keyword">einsum </span>                    <span class="number">3</span>.<span class="number">3</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">orjson </span>                        <span class="number">3</span>.<span class="number">9</span>.<span class="number">7</span></span><br><span class="line">packaging                      <span class="number">21</span>.<span class="number">3</span></span><br><span class="line">paddlehub                      <span class="number">2</span>.<span class="number">0</span>.<span class="number">4</span></span><br><span class="line">paddlenlp                      <span class="number">2</span>.<span class="number">0</span>.<span class="number">7</span></span><br><span class="line">paddlepaddle-gpu               <span class="number">2</span>.<span class="number">5</span>.<span class="number">2</span></span><br><span class="line">pamela                         <span class="number">1</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">pandas                         <span class="number">1</span>.<span class="number">1</span>.<span class="number">5</span></span><br><span class="line">pandocfilters                  <span class="number">1</span>.<span class="number">5</span>.<span class="number">0</span></span><br><span class="line">parl                           <span class="number">1</span>.<span class="number">4</span>.<span class="number">1</span></span><br><span class="line">parso                          <span class="number">0</span>.<span class="number">7</span>.<span class="number">1</span></span><br><span class="line">pathlib                        <span class="number">1</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line">pexpect                        <span class="number">4</span>.<span class="number">7</span>.<span class="number">0</span></span><br><span class="line">pickleshare                    <span class="number">0</span>.<span class="number">7</span>.<span class="number">5</span></span><br><span class="line">Pillow                         <span class="number">8</span>.<span class="number">2</span>.<span class="number">0</span></span><br><span class="line">pip                            <span class="number">22</span>.<span class="number">1</span>.<span class="number">2</span></span><br><span class="line">pkgutil_resolve_name           <span class="number">1</span>.<span class="number">3</span>.<span class="number">10</span></span><br><span class="line">plotly                         <span class="number">5</span>.<span class="number">8</span>.<span class="number">0</span></span><br><span class="line">pluggy                         <span class="number">1</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">pre-commit                     <span class="number">1</span>.<span class="number">21</span>.<span class="number">0</span></span><br><span class="line">prettytable                    <span class="number">0</span>.<span class="number">7</span>.<span class="number">2</span></span><br><span class="line">proglog                        <span class="number">0</span>.<span class="number">1</span>.<span class="number">9</span></span><br><span class="line">prometheus-client              <span class="number">0</span>.<span class="number">14</span>.<span class="number">1</span></span><br><span class="line">prompt-toolkit                 <span class="number">2</span>.<span class="number">0</span>.<span class="number">10</span></span><br><span class="line">protobuf                       <span class="number">4</span>.<span class="number">24</span>.<span class="number">4</span></span><br><span class="line">psutil                         <span class="number">5</span>.<span class="number">7</span>.<span class="number">2</span></span><br><span class="line">ptyprocess                     <span class="number">0</span>.<span class="number">7</span>.<span class="number">0</span></span><br><span class="line">py4j                           <span class="number">0</span>.<span class="number">10</span>.<span class="number">9</span>.<span class="number">2</span></span><br><span class="line">pyarrow                        <span class="number">12</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line">pyasn1                         <span class="number">0</span>.<span class="number">4</span>.<span class="number">8</span></span><br><span class="line">pyasn1-modules                 <span class="number">0</span>.<span class="number">2</span>.<span class="number">7</span></span><br><span class="line">pycocotools                    <span class="number">2</span>.<span class="number">0</span>.<span class="number">7</span></span><br><span class="line">pycodestyle                    <span class="number">2</span>.<span class="number">8</span>.<span class="number">0</span></span><br><span class="line">pycparser                      <span class="number">2</span>.<span class="number">21</span></span><br><span class="line">pycryptodome                   <span class="number">3</span>.<span class="number">9</span>.<span class="number">9</span></span><br><span class="line">pydantic                       <span class="number">1</span>.<span class="number">10</span>.<span class="number">13</span></span><br><span class="line">pydantic_core                  <span class="number">2</span>.<span class="number">14</span>.<span class="number">6</span></span><br><span class="line">pydeck                         <span class="number">0</span>.<span class="number">8</span>.<span class="number">1</span>b0</span><br><span class="line">pydocstyle                     <span class="number">5</span>.<span class="number">0</span>.<span class="number">2</span></span><br><span class="line">pydub                          <span class="number">0</span>.<span class="number">25</span>.<span class="number">1</span></span><br><span class="line">pyflakes                       <span class="number">2</span>.<span class="number">4</span>.<span class="number">0</span></span><br><span class="line">pyglet                         <span class="number">1</span>.<span class="number">4</span>.<span class="number">5</span></span><br><span class="line">Pygments                       <span class="number">2</span>.<span class="number">13</span>.<span class="number">0</span></span><br><span class="line">pylint                         <span class="number">2</span>.<span class="number">5</span>.<span class="number">2</span></span><br><span class="line">Pympler                        <span class="number">1</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line">pynvml                         <span class="number">8</span>.<span class="number">0</span>.<span class="number">4</span></span><br><span class="line">pyOpenSSL                      <span class="number">22</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">pyparsing                      <span class="number">3</span>.<span class="number">0</span>.<span class="number">9</span></span><br><span class="line">pypmml                         <span class="number">0</span>.<span class="number">9</span>.<span class="number">11</span></span><br><span class="line">pyrsistent                     <span class="number">0</span>.<span class="number">18</span>.<span class="number">1</span></span><br><span class="line">python-dateutil                <span class="number">2</span>.<span class="number">8</span>.<span class="number">2</span></span><br><span class="line">python-<span class="keyword">json-logger </span>            <span class="number">2</span>.<span class="number">0</span>.<span class="number">4</span></span><br><span class="line">python-<span class="keyword">jsonrpc-server </span>         <span class="number">0</span>.<span class="number">3</span>.<span class="number">4</span></span><br><span class="line">python-language-server         <span class="number">0</span>.<span class="number">33</span>.<span class="number">0</span></span><br><span class="line">python-lsp-<span class="keyword">jsonrpc </span>            <span class="number">1</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">python-lsp-server              <span class="number">1</span>.<span class="number">5</span>.<span class="number">0</span></span><br><span class="line">python-<span class="keyword">multipart </span>              <span class="number">0</span>.<span class="number">0</span>.<span class="number">6</span></span><br><span class="line">pytz                           <span class="number">2019</span>.<span class="number">3</span></span><br><span class="line">PyWavelets                     <span class="number">1</span>.<span class="number">4</span>.<span class="number">0</span></span><br><span class="line">PyYAML                         <span class="number">5</span>.<span class="number">1</span>.<span class="number">2</span></span><br><span class="line">pyzmq                          <span class="number">23</span>.<span class="number">2</span>.<span class="number">1</span></span><br><span class="line">rarfile                        <span class="number">3</span>.<span class="number">1</span></span><br><span class="line">recordio                       <span class="number">0</span>.<span class="number">1</span>.<span class="number">7</span></span><br><span class="line">requests                       <span class="number">2</span>.<span class="number">22</span>.<span class="number">0</span></span><br><span class="line">requests-oauthlib              <span class="number">1</span>.<span class="number">3</span>.<span class="number">0</span></span><br><span class="line">resampy                        <span class="number">0</span>.<span class="number">2</span>.<span class="number">2</span></span><br><span class="line">rich                           <span class="number">13</span>.<span class="number">7</span>.<span class="number">0</span></span><br><span class="line">rope                           <span class="number">0</span>.<span class="number">17</span>.<span class="number">0</span></span><br><span class="line">rsa                            <span class="number">4</span>.<span class="number">0</span></span><br><span class="line">ruamel.yaml                    <span class="number">0</span>.<span class="number">17</span>.<span class="number">21</span></span><br><span class="line">ruamel.yaml.clib               <span class="number">0</span>.<span class="number">2</span>.<span class="number">6</span></span><br><span class="line"><span class="keyword">scikit-image </span>                  <span class="number">0</span>.<span class="number">19</span>.<span class="number">3</span></span><br><span class="line"><span class="keyword">scikit-learn </span>                  <span class="number">0</span>.<span class="number">24</span>.<span class="number">2</span></span><br><span class="line"><span class="keyword">scipy </span>                         <span class="number">1</span>.<span class="number">6</span>.<span class="number">3</span></span><br><span class="line">seaborn                        <span class="number">0</span>.<span class="number">10</span>.<span class="number">0</span></span><br><span class="line">semantic-version               <span class="number">2</span>.<span class="number">10</span>.<span class="number">0</span></span><br><span class="line">semver                         <span class="number">3</span>.<span class="number">0</span>.<span class="number">2</span></span><br><span class="line">Send2Trash                     <span class="number">1</span>.<span class="number">8</span>.<span class="number">0</span></span><br><span class="line">sentencepiece                  <span class="number">0</span>.<span class="number">1</span>.<span class="number">85</span></span><br><span class="line">seqeval                        <span class="number">1</span>.<span class="number">2</span>.<span class="number">2</span></span><br><span class="line">setuptools                     <span class="number">56</span>.<span class="number">2</span>.<span class="number">0</span></span><br><span class="line"><span class="keyword">shapely </span>                       <span class="number">2</span>.<span class="number">0</span>.<span class="number">3</span></span><br><span class="line"><span class="keyword">shellcheck-py </span>                 <span class="number">0</span>.<span class="number">7</span>.<span class="number">1</span>.<span class="number">1</span></span><br><span class="line">simplegeneric                  <span class="number">0</span>.<span class="number">8</span>.<span class="number">1</span></span><br><span class="line">six                            <span class="number">1</span>.<span class="number">16</span>.<span class="number">0</span></span><br><span class="line">sklearn                        <span class="number">0</span>.<span class="number">0</span></span><br><span class="line">smmap                          <span class="number">3</span>.<span class="number">0</span>.<span class="number">5</span></span><br><span class="line">sniffio                        <span class="number">1</span>.<span class="number">3</span>.<span class="number">0</span></span><br><span class="line">snowballstemmer                <span class="number">2</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">SoundFile                      <span class="number">0</span>.<span class="number">10</span>.<span class="number">3</span>.post1</span><br><span class="line">soupsieve                      <span class="number">2</span>.<span class="number">3</span>.<span class="number">2</span>.post1</span><br><span class="line">SQLAlchemy                     <span class="number">1</span>.<span class="number">4</span>.<span class="number">41</span></span><br><span class="line">starlette                      <span class="number">0</span>.<span class="number">20</span>.<span class="number">4</span></span><br><span class="line">streamlit                      <span class="number">1</span>.<span class="number">13</span>.<span class="number">0</span></span><br><span class="line">streamlit-image-comparison     <span class="number">0</span>.<span class="number">0</span>.<span class="number">4</span></span><br><span class="line">tabulate                       <span class="number">0</span>.<span class="number">8</span>.<span class="number">3</span></span><br><span class="line">tb-nightly                     <span class="number">1</span>.<span class="number">15</span>.<span class="number">0</span>a20190801</span><br><span class="line">tb-paddle                      <span class="number">0</span>.<span class="number">3</span>.<span class="number">6</span></span><br><span class="line">tenacity                       <span class="number">8</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line">tensorboard                    <span class="number">2</span>.<span class="number">1</span>.<span class="number">0</span></span><br><span class="line">tensorboardX                   <span class="number">1</span>.<span class="number">8</span></span><br><span class="line">termcolor                      <span class="number">1</span>.<span class="number">1</span>.<span class="number">0</span></span><br><span class="line">terminado                      <span class="number">0</span>.<span class="number">15</span>.<span class="number">0</span></span><br><span class="line">testpath                       <span class="number">0</span>.<span class="number">4</span>.<span class="number">2</span></span><br><span class="line">threadpoolctl                  <span class="number">2</span>.<span class="number">1</span>.<span class="number">0</span></span><br><span class="line">tifffile                       <span class="number">2021</span>.<span class="number">11</span>.<span class="number">2</span></span><br><span class="line">tinycss2                       <span class="number">1</span>.<span class="number">1</span>.<span class="number">1</span></span><br><span class="line">toml                           <span class="number">0</span>.<span class="number">10</span>.<span class="number">0</span></span><br><span class="line">toolz                          <span class="number">0</span>.<span class="number">12</span>.<span class="number">0</span></span><br><span class="line">tornado                        <span class="number">6</span>.<span class="number">2</span></span><br><span class="line">tqdm                           <span class="number">4</span>.<span class="number">66</span>.<span class="number">1</span></span><br><span class="line">traitlets                      <span class="number">5</span>.<span class="number">4</span>.<span class="number">0</span></span><br><span class="line">typed-ast                      <span class="number">1</span>.<span class="number">4</span>.<span class="number">1</span></span><br><span class="line">typeguard                      <span class="number">4</span>.<span class="number">1</span>.<span class="number">2</span></span><br><span class="line">typing_extensions              <span class="number">4</span>.<span class="number">7</span>.<span class="number">1</span></span><br><span class="line">tzlocal                        <span class="number">5</span>.<span class="number">1</span></span><br><span class="line">uc-micro-py                    <span class="number">1</span>.<span class="number">0</span>.<span class="number">2</span></span><br><span class="line">ujson                          <span class="number">1</span>.<span class="number">35</span></span><br><span class="line">urllib3                        <span class="number">1</span>.<span class="number">25</span>.<span class="number">6</span></span><br><span class="line">uvicorn                        <span class="number">0</span>.<span class="number">22</span>.<span class="number">0</span></span><br><span class="line">validators                     <span class="number">0</span>.<span class="number">20</span>.<span class="number">0</span></span><br><span class="line">virtualenv                     <span class="number">16</span>.<span class="number">7</span>.<span class="number">9</span></span><br><span class="line">visualdl                       <span class="number">2</span>.<span class="number">2</span>.<span class="number">0</span></span><br><span class="line">watchdog                       <span class="number">3</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">wcwidth                        <span class="number">0</span>.<span class="number">1</span>.<span class="number">7</span></span><br><span class="line">webencodings                   <span class="number">0</span>.<span class="number">5</span>.<span class="number">1</span></span><br><span class="line">websocket-client               <span class="number">1</span>.<span class="number">4</span>.<span class="number">1</span></span><br><span class="line">websockets                     <span class="number">11</span>.<span class="number">0</span>.<span class="number">3</span></span><br><span class="line">Werkzeug                       <span class="number">0</span>.<span class="number">16</span>.<span class="number">0</span></span><br><span class="line">whatthepatch                   <span class="number">1</span>.<span class="number">0</span>.<span class="number">2</span></span><br><span class="line">wheel                          <span class="number">0</span>.<span class="number">36</span>.<span class="number">2</span></span><br><span class="line">widgetsnbextension             <span class="number">3</span>.<span class="number">5</span>.<span class="number">2</span></span><br><span class="line">wrapt                          <span class="number">1</span>.<span class="number">12</span>.<span class="number">1</span></span><br><span class="line">xarray                         <span class="number">0</span>.<span class="number">16</span>.<span class="number">2</span></span><br><span class="line">xgboost                        <span class="number">1</span>.<span class="number">3</span>.<span class="number">3</span></span><br><span class="line">xlrd                           <span class="number">1</span>.<span class="number">2</span>.<span class="number">0</span></span><br><span class="line">xmltodict                      <span class="number">0</span>.<span class="number">13</span>.<span class="number">0</span></span><br><span class="line">yapf                           <span class="number">0</span>.<span class="number">26</span>.<span class="number">0</span></span><br><span class="line">yarl                           <span class="number">1</span>.<span class="number">9</span>.<span class="number">4</span></span><br><span class="line">zipp                           <span class="number">3</span>.<span class="number">8</span>.<span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="ModuleNotFoundError-No-module-named-‘paddle-profiler’"><a href="#ModuleNotFoundError-No-module-named-‘paddle-profiler’" class="headerlink" title="ModuleNotFoundError: No module named ‘paddle.profiler’"></a>ModuleNotFoundError: No module named ‘paddle.profiler’</h2><p>问题：paddlepaddle-gpu版本低，uninstall再install就ok</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> 深度学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> paddlepaddle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>paddle.nn.Layer</title>
      <link href="/2024/03/09/paddle-nn-Layer/"/>
      <url>/2024/03/09/paddle-nn-Layer/</url>
      
        <content type="html"><![CDATA[<p><strong>class paddle.nn.Layer(name_scope&#x3D;None, dtype&#x3D;’float32’)</strong></p><p><a href="https://www.paddlepaddle.org.cn/documentation/docs/zh/api/paddle/nn/Layer_cn.html">https://www.paddlepaddle.org.cn/documentation/docs/zh/api/paddle/nn/Layer_cn.html</a></p><div class="tagLink"><a class="link-card" title="API官方文档" href="https://www.paddlepaddle.org.cn/documentation/docs/zh/api/paddle/nn/Layer_cn.html"><span class="link-card-backdrop" style="background-image: url(https://tumytime.github.io/picx-images-hosting/image.1754pq86xn.webp)"></span><div class="left"><img src="https://tumytime.github.io/picx-images-hosting/image.1754pq86xn.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1754pq86xn.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">API官方文档</p><p class="url">https://www.paddlepaddle.org.cn/documentation/docs/zh/api/paddle/nn/Layer_cn.html</p></div></a></div>]]></content>
      
      
      <categories>
          
          <category> 深度学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> paddlepaddle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>paddle学习笔记</title>
      <link href="/2024/03/08/paddle%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/03/08/paddle%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p>特征选取，避免被不相关的特征干扰：</p><div class="tagLink"><a class="link-card" title="机器学习入门讲解：什么是特征（Feature）和特征选择(Feature Selection)?" href="https://zhuanlan.zhihu.com/p/30404850"><span class="link-card-backdrop" style="background-image: url(https://pic1.zhimg.com/70/v2-9f98ca58f649f01f9bf5739ac0ad8239_1440w.avis?source=172ae18b&biz_tag=Post)"></span><div class="left"><img src="https://pic1.zhimg.com/70/v2-9f98ca58f649f01f9bf5739ac0ad8239_1440w.avis?source=172ae18b&biz_tag=Post" class="lazyload placeholder" data-srcset="https://pic1.zhimg.com/70/v2-9f98ca58f649f01f9bf5739ac0ad8239_1440w.avis?source=172ae18b&biz_tag=Post" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">机器学习入门讲解：什么是特征（Feature）和特征选择(Feature Selection)?</p><p class="url">https://zhuanlan.zhihu.com/p/30404850</p></div></a></div><p>可以明显的看到，不同的特征，结果还是差别很大的，如果我只用选取上图准确率最高的一类特征来训练模型，80.32%测试结果将比使用全部特征作为训练数据71%好不少，这个DWT-Approx(4-14Hz) db2,k&#x3D;1 特征就相当于我们第一个例子中找正方体的‘形状’特征，即主要特征。那么针对未来的训练，我们可以尝试提取表现最好的几个特征就好了；为什么选最好的几个特征，只选最好的那一个不是更高吗</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">在特征选择时，选择几个表现最好的特征通常比只选一个最好的特征更可靠和有效。以下是一些原因：</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> <span class="strong">**信息丰富性**</span>：使用多个好的特征可以提供更多关于数据集的信息，有助于更好地描述数据之间的关系。这可以提高模型的泛化能力。</span><br><span class="line"></span><br><span class="line"><span class="bullet">2.</span> <span class="strong">**冗余性**</span>：有时候一个单一最好的特征可能会包含某些冗余信息，而使用多个表现良好且互补的特征可以帮助消除冗余性，提高模型的鲁棒性。</span><br><span class="line"></span><br><span class="line"><span class="bullet">3.</span> <span class="strong">**模型稳定性**</span>：过于依赖一个最好的特征可能使得模型对于噪声和异常数据更为敏感。多个好的特征可以增加模型的稳定性，降低对噪声的敏感度。</span><br><span class="line"></span><br><span class="line"><span class="bullet">4.</span> <span class="strong">**综合考量**</span>：不同的特征可能会捕捉到数据不同方面的信息，综合利用多个表现良好的特征有利于更全面地学习数据的规律，提高模型的性能。</span><br><span class="line"></span><br><span class="line">因此，一般情况下，选择数个表现良好且互补的特征比单个最好的特征更为合适。当然，具体选择多少个特征取决于实际应用场景和数据集的特点。</span><br></pre></td></tr></table></figure><h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><div class="tagLink"><a class="link-card" title="机器学习入门：重要的概念---信息熵（Shannon’s Entropy Model）" href="https://zhuanlan.zhihu.com/p/30854084"><span class="link-card-backdrop" style="background-image: url(https://pic1.zhimg.com/70/v2-5e7917bb0bf5604630f732379e70c8e3_1440w.avis?source=172ae18b&biz_tag=Post)"></span><div class="left"><img src="https://pic1.zhimg.com/70/v2-5e7917bb0bf5604630f732379e70c8e3_1440w.avis?source=172ae18b&biz_tag=Post" class="lazyload placeholder" data-srcset="https://pic1.zhimg.com/70/v2-5e7917bb0bf5604630f732379e70c8e3_1440w.avis?source=172ae18b&biz_tag=Post" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">机器学习入门：重要的概念---信息熵（Shannon’s Entropy Model）</p><p class="url">https://zhuanlan.zhihu.com/p/30854084</p></div></a></div><h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><div class="tagLink"><a class="link-card" title="CNN 入门讲解：什么是卷积（Convolution）?" href="https://zhuanlan.zhihu.com/p/30994790"><span class="link-card-backdrop" style="background-image: url(https://pic1.zhimg.com/70/v2-5e7917bb0bf5604630f732379e70c8e3_1440w.avis?source=172ae18b&biz_tag=Post)"></span><div class="left"><img src="https://pic1.zhimg.com/70/v2-5e7917bb0bf5604630f732379e70c8e3_1440w.avis?source=172ae18b&biz_tag=Post" class="lazyload placeholder" data-srcset="https://pic1.zhimg.com/70/v2-5e7917bb0bf5604630f732379e70c8e3_1440w.avis?source=172ae18b&biz_tag=Post" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">CNN 入门讲解：什么是卷积（Convolution）?</p><p class="url">https://zhuanlan.zhihu.com/p/30994790</p></div></a></div><h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><div class="tagLink"><a class="link-card" title="CNN入门讲解：如何理解卷积神经网络的结构（Structure）？" href="https://zhuanlan.zhihu.com/p/31249821"><span class="link-card-backdrop" style="background-image: url(https://pica.zhimg.com/70/v2-7a147703c5181ff9737b41afa6ea6bce_1440w.avis?source=172ae18b&biz_tag=Post)"></span><div class="left"><img src="https://pica.zhimg.com/70/v2-7a147703c5181ff9737b41afa6ea6bce_1440w.avis?source=172ae18b&biz_tag=Post" class="lazyload placeholder" data-srcset="https://pica.zhimg.com/70/v2-7a147703c5181ff9737b41afa6ea6bce_1440w.avis?source=172ae18b&biz_tag=Post" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">CNN入门讲解：如何理解卷积神经网络的结构（Structure）？</p><p class="url">https://zhuanlan.zhihu.com/p/31249821</p></div></a></div><div class="tagLink"><a class="link-card" title="10分钟数据降维入门" href="https://zhuanlan.zhihu.com/p/237718243"><span class="link-card-backdrop" style="background-image: url(https://picx.zhimg.com/70/v2-3679db615987147578a84986d7947580_1440w.avis?source=172ae18b&biz_tag=Post)"></span><div class="left"><img src="https://picx.zhimg.com/70/v2-3679db615987147578a84986d7947580_1440w.avis?source=172ae18b&biz_tag=Post" class="lazyload placeholder" data-srcset="https://picx.zhimg.com/70/v2-3679db615987147578a84986d7947580_1440w.avis?source=172ae18b&biz_tag=Post" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">10分钟数据降维入门</p><p class="url">https://zhuanlan.zhihu.com/p/237718243</p></div></a></div><iframe src="//player.bilibili.com/player.html?aid=549558824&bvid=BV1Di4y1o7vX&cid=453635246&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>现在知道乘客每次乘坐出租车的公里数，也知道乘客每次下车的时候支付给出租车司机的总费用。但是并不知道乘车的起步价，以及每公里行驶费用是多少。希望让机器从这些数据当中学习出来计算总费用的规则。</p><p>更具体的，想要让机器学习程序通过数据学习出来下面的公式当中的参数 w 和参数 b（这是一个非常简单的示例，所以w和b都是浮点数，随着对深度学习了解的深入，你将会知道w和b通常情况下会是矩阵和向量）。这样，当下次乘车的时候，知道了行驶里程distance_travelled的时候，就可以估算出来用户的总费用total_fee了。</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">total_fee</span> = w * distance_travelled + b</span><br></pre></td></tr></table></figure><p>在这个机器学习任务中，已经知道了乘客的行驶里程distance_travelled，和对应的，这些乘客的总费用total_fee。</p><p>通常情况下，在机器学习任务中，像distance_travelled这样的输入值，一般被称为x（或者特征feature），像total_fee这样的输出值，一般被称为y（或者标签label)。</p><p>可以用paddle.to_tensor把示例数据转换为paddle的Tensor数据。</p><details open><summary pointer> tensor </summary>              <div class='content'>              <p>飞桨使用张量（Tensor） 来表示神经网络中传递的数据，Tensor 可以理解为多维数组，类似于 Numpy 数组（ndarray） 的概念。与 Numpy 数组相比，Tensor 除了支持运行在 CPU 上，还支持运行在 GPU 及各种 AI 芯片上，以实现计算加速；此外，飞桨基于 Tensor，实现了深度学习所必须的反向传播功能和多种多样的组网算子，从而可更快捷地实现深度学习组网与训练等功能。两者具体异同点可参见下文 Tensor 与 Numpy 数组相互转换。</p><p>在飞桨框架中，神经网络的输入、输出数据，以及网络中的参数均采用 Tensor 数据结构，示例如下：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">model</span>):</span><br><span class="line">    <span class="comment"># 首先定义了一个函数train(model)，该函数的作用是进行神经网络模型的训练。在函数内部，调用了模型的train()方法，将模型设置为训练模式。</span></span><br><span class="line">    model.train()</span><br><span class="line">    <span class="comment"># 设置了训练的轮数epochs为2</span></span><br><span class="line">    epochs = <span class="number">2</span></span><br><span class="line">    <span class="comment"># 初始化了优化器optim，使用了Adam优化器，学习率为0.001，并传入了模型的参数model.parameters()</span></span><br><span class="line">    <span class="comment"># model.parameters()返回一个包含模型所有参数的迭代器或列表，</span></span><br><span class="line">    <span class="comment"># 这些参数是需要根据训练数据进行调整的。</span></span><br><span class="line">    <span class="comment"># 在优化器中，可以将这些参数传递给优化器，使得优化器能够根据损失函数的梯度来更新这些参数，从而不断优化模型以实现更好的性能。</span></span><br><span class="line">    optim = paddle.optimizer.Adam(learning_rate=<span class="number">0.001</span>, parameters=model.parameters())</span><br><span class="line">    <span class="comment"># 模型训练的两层循环</span></span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">        <span class="keyword">for</span> batch_id, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_loader()):</span><br><span class="line">            x_data = data[<span class="number">0</span>]</span><br><span class="line">            y_data = data[<span class="number">1</span>]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;x_data: &quot;</span>, x_data[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]) <span class="comment"># 打印神经网络的输入：批数据中的第一个数据的第一个元素</span></span><br><span class="line">            predicts = model(x_data)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;predicts: &quot;</span>, predicts[<span class="number">0</span>]) <span class="comment"># 打印神经网络的输出：批数据中的第一个数据的第一个元素</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;weight: &quot;</span>, model.linear1.weight[<span class="number">0</span>][<span class="number">0</span>]) <span class="comment"># 打印神经网络的权重：linear1 层的 weight 中的第一个元素</span></span><br><span class="line">            loss = F.cross_entropy(predicts, y_data)</span><br><span class="line">            acc = paddle.metric.accuracy(predicts, y_data)</span><br><span class="line">            loss.backward()</span><br><span class="line">            optim.step()</span><br><span class="line">            optim.clear_grad()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">model = LeNet()</span><br><span class="line">train(model)</span><br></pre></td></tr></table></figure><details ><summary pointer> model.train() </summary>              <div class='content'>              <p>在训练开始之前写上 model.trian() ，在测试时写上 model.eval()。<br>在使用PyTorch构建神经网络进行训练时，我们通常会在训练过程中的代码中添加model.train()这一句，以确保启用Batch Normalization（BN）和Dropout层的功能。</p><details ><summary pointer> 批标准化 (Batch Normalization) </summary>              <div class='content'>              <pre><code>          &lt;/div&gt;        &lt;/details&gt;</code></pre>              </div>            </details>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 深度学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> paddlepaddle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>图像处理笔记</title>
      <link href="/2024/03/05/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/03/05/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<div class="tagLink"><a class="link-card" title="阅读原文" href="https://blog.csdn.net/hello15617900040/article/details/127590000"><span class="link-card-backdrop" style="background-image: url(https://tumytime.github.io/picx-images-hosting/image.70a2w3jj5h.webp)"></span><div class="left"><img src="https://tumytime.github.io/picx-images-hosting/image.70a2w3jj5h.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.70a2w3jj5h.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">阅读原文</p><p class="url">https://blog.csdn.net/hello15617900040/article/details/127590000</p></div></a></div><h2 id="图像统计特征"><a href="#图像统计特征" class="headerlink" title="图像统计特征"></a>图像统计特征</h2><h3 id="熵"><a href="#熵" class="headerlink" title="熵"></a>熵</h3><p>用于度量图像所具有的信息量，它反映了图像中纹理的紊乱度或复杂程度。熵值越大，说明纹理越复杂；熵值越小，说明纹理越平滑。</p><h3 id="均值"><a href="#均值" class="headerlink" title="均值"></a>均值</h3><p>灰度均值是对区域内亮度的一个度量，可以用来反应图像的明暗程度。</p><h3 id="方差"><a href="#方差" class="headerlink" title="方差"></a>方差</h3><p>方差就是数据的分散程度（偏离均值）。</p><h3 id="对比度"><a href="#对比度" class="headerlink" title="对比度"></a>对比度</h3><p>反映了图像的清晰度和纹理沟纹深浅的程度。纹理沟纹越深，其对比度越大，视觉效果越清晰；反之，对比度小，则沟纹浅，效果模糊。</p><h2 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h2><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.70a2w3jj5h.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.70a2w3jj5h.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>测试图片-从均值、方差做对比</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.231m296ifg.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.231m296ifg.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4qr2clzz71.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4qr2clzz71.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>对于第一组六张图片，图片越辆均值越大，但方差不会改变（同一张图片只改变亮度）<br>对于第二组图片，对比度不做调节，只调节亮度的情况下，偏离均值的离散度会变大</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.67x7ed4tb5.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.67x7ed4tb5.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h2 id="测试图片-从对比度出发"><a href="#测试图片-从对比度出发" class="headerlink" title="测试图片-从对比度出发"></a>测试图片-从对比度出发</h2><p>对比度越大 视觉效果越清晰；纹理越深对比度越大</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.58h4173k6m.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.58h4173k6m.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.ibv2scax2.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.ibv2scax2.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h2 id="测试图片-从熵出发"><a href="#测试图片-从熵出发" class="headerlink" title="测试图片-从熵出发"></a>测试图片-从熵出发</h2><p>熵值越大，说明纹理越复杂；熵值越小，说明纹理越平滑。</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3ye6uvmvwg.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3ye6uvmvwg.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.6bgtc318lv.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.6bgtc318lv.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">img_1</span> = cv2.imread(&#x27;office_1.jpg&#x27;)</span><br><span class="line"><span class="attribute">img_2</span> = cv2.imread(&#x27;office_2.jpg&#x27;)</span><br><span class="line"><span class="attribute">img_3</span> = cv2.imread(&#x27;office_3.jpg&#x27;)</span><br><span class="line"><span class="attribute">img_4</span> = cv2.imread(&#x27;office_4.jpg&#x27;)</span><br><span class="line"><span class="attribute">img_5</span> = cv2.imread(&#x27;office_5.jpg&#x27;)</span><br><span class="line"><span class="attribute">img_6</span> = cv2.imread(&#x27;office_6.jpg&#x27;)</span><br><span class="line"><span class="attribute">img_7</span> = cv2.imread(&#x27;dalishi.jpg&#x27;)</span><br><span class="line"><span class="attribute">img_8</span> = cv2.imread(&#x27;wall.jpg&#x27;)</span><br><span class="line"><span class="attribute">img_9</span> = cv2.imread(&#x27;muwen.jpg&#x27;)</span><br><span class="line"><span class="attribute">img_10</span> = cv2.imread(&#x27;shuiniwen.jpg&#x27;)</span><br><span class="line"><span class="attribute">img_11</span> = cv2.imread(&#x27;<span class="number">400</span>x400_zhi_wenli.jpg&#x27;)</span><br><span class="line"><span class="attribute">img_12</span> = cv2.imread(&#x27;<span class="number">400</span>x400_zhi_zhezhouwenli.jpg&#x27;)</span><br><span class="line"><span class="attribute">imgs</span> =<span class="meta"> [img_1,img_2,img_3,img_4,img_5,img_6]</span></span><br><span class="line"><span class="attribute">titles</span> =<span class="meta"> [&#x27;office_1.jpg&#x27;,&#x27;office_2.jpg&#x27;,&#x27;office_3.jpg&#x27;,&#x27;office_4.jpg&#x27;,&#x27;office_5.jpg&#x27;,&#x27;office_6.jpg&#x27;]</span></span><br><span class="line"><span class="attribute">for</span> m in range(<span class="number">6</span>):</span><br><span class="line">    <span class="attribute">plt</span>.subplot(<span class="number">2</span>,<span class="number">3</span>,m + <span class="number">1</span>)</span><br><span class="line">    <span class="attribute">plt</span>.imshow(imgs[m])</span><br><span class="line">    <span class="attribute">plt</span>.title(titles[m])</span><br><span class="line"><span class="attribute">def</span> rgb2gray(img):</span><br><span class="line">    <span class="attribute">h</span> = img.shape[<span class="number">0</span>]</span><br><span class="line">    <span class="attribute">w</span> = img.shape[<span class="number">1</span>]</span><br><span class="line">    <span class="attribute">gray</span> = np.uint8(np.zeros((h,w)))</span><br><span class="line">    <span class="attribute">for</span> i in range(h):</span><br><span class="line">        <span class="attribute">for</span> j in range(w):</span><br><span class="line">            <span class="attribute">gray</span>[i,j] = <span class="number">0</span>.<span class="number">144</span> * img[i,j,<span class="number">0</span>] + <span class="number">0</span>.<span class="number">587</span> * img[i,j,<span class="number">1</span>] + <span class="number">0</span>.<span class="number">299</span> * img[i,j,<span class="number">2</span>]  # BGR</span><br><span class="line">    <span class="attribute">return</span> gray</span><br><span class="line"><span class="attribute">def</span> average(img):</span><br><span class="line">    <span class="attribute">img1</span> = rgb2gray(img)</span><br><span class="line">    <span class="attribute">height</span>,width = img1.shape</span><br><span class="line">    <span class="attribute">size</span> = img1.size</span><br><span class="line">    <span class="attribute">ave</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">for</span> i in range(height):</span><br><span class="line">        <span class="attribute">for</span> j in range(width):</span><br><span class="line">            <span class="attribute">ave</span> += img1[i][j] / size</span><br><span class="line">    <span class="attribute">return</span> ave</span><br><span class="line"><span class="attribute">def</span> contrast(img):</span><br><span class="line">    <span class="attribute">img1</span> = rgb2gray(img)</span><br><span class="line">    <span class="attribute">m</span>,n = img1.shape</span><br><span class="line">    <span class="comment"># 图片矩阵向外扩展一个像素</span></span><br><span class="line">    <span class="attribute">img1_ext</span>=cv2.copyMakeBorder(img1,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,cv2.BORDER_REPLICATE)  # 用边界颜色填充</span><br><span class="line">    <span class="attribute">height</span>,width = img1_ext.shape</span><br><span class="line">    <span class="attribute">b</span> = <span class="number">0</span>.<span class="number">0</span></span><br><span class="line">    <span class="attribute">for</span> i in range(<span class="number">1</span>,height - <span class="number">1</span>):</span><br><span class="line">        <span class="attribute">for</span> j in range(<span class="number">1</span>,width - <span class="number">1</span>):</span><br><span class="line">            <span class="attribute">b</span> += (int((img1_ext[i,j]) - int(img1_ext[i,j + <span class="number">1</span>])) ** <span class="number">2</span> + (</span><br><span class="line">                    <span class="attribute">int</span>(img1_ext[i,j]) - int(img1_ext[i,j - <span class="number">1</span>])) ** <span class="number">2</span> + (</span><br><span class="line">                          <span class="attribute">int</span>(img1_ext[i,j]) - int(img1_ext[i + <span class="number">1</span>,j])) ** <span class="number">2</span> + (</span><br><span class="line">                          <span class="attribute">int</span>(img1_ext[i,j]) - int(img1_ext[i - <span class="number">1</span>,j])) ** <span class="number">2</span>)</span><br><span class="line">    <span class="attribute">cg</span> = b / (<span class="number">4</span> * (m - <span class="number">2</span>) * (n - <span class="number">2</span>) + <span class="number">3</span> * (<span class="number">2</span> * (m - <span class="number">2</span>) + <span class="number">2</span> * (n - <span class="number">2</span>)) + <span class="number">2</span> * <span class="number">4</span>)  #</span><br><span class="line">    <span class="attribute">return</span> cg</span><br><span class="line"><span class="attribute">def</span> variance(img):</span><br><span class="line">    <span class="attribute">img1</span> = rgb2gray(img)</span><br><span class="line">    <span class="attribute">height</span>,width = img1.shape</span><br><span class="line">    <span class="attribute">var</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">size</span> = img1.size</span><br><span class="line">    <span class="attribute">average</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">for</span> i in range(height):</span><br><span class="line">        <span class="attribute">for</span> j in range(width):</span><br><span class="line">            <span class="attribute">average</span> += img1[i][j] / size</span><br><span class="line">    <span class="attribute">for</span> i in range(height):</span><br><span class="line">        <span class="attribute">for</span> j in range(width):</span><br><span class="line">            <span class="attribute">var</span> += img1[i,j] * (i - average) ** <span class="number">2</span></span><br><span class="line">    <span class="attribute">return</span> var</span><br><span class="line"><span class="attribute">def</span> Contrast_and_Brightness(alpha,bete,img):  </span><br><span class="line">    <span class="attribute">blank</span> = np.zeros(img.shape,img.dtype)</span><br><span class="line">    <span class="attribute">dst</span> = cv2.addWeighted(img,alpha,blank,<span class="number">1</span> - alpha,bete)</span><br><span class="line">    <span class="attribute">return</span> dst</span><br><span class="line"><span class="attribute">def</span> dec2bin(p):</span><br><span class="line">    <span class="attribute">floatbinstr</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="attribute">if</span> p == <span class="number">0</span>:</span><br><span class="line">        <span class="attribute">return</span> floatbinstr</span><br><span class="line">    <span class="attribute">for</span> kk in range(len(str(p)) - <span class="number">2</span>):</span><br><span class="line">        <span class="attribute">p</span> *= <span class="number">2</span></span><br><span class="line">        <span class="attribute">if</span> p &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="attribute">floatbinstr</span> += <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="attribute">p</span> = p - int(p)</span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">floatbinstr</span> += <span class="string">&quot;0&quot;</span></span><br><span class="line">        <span class="attribute">if</span> p == <span class="number">0</span>:</span><br><span class="line">            <span class="attribute">break</span></span><br><span class="line">        <span class="attribute">return</span> str(floatbinstr)</span><br><span class="line"><span class="attribute">def</span> total_entropy(img):</span><br><span class="line">    <span class="attribute">n</span> =<span class="meta"> []</span></span><br><span class="line">    <span class="attribute">P</span> =<span class="meta"> []</span></span><br><span class="line">    <span class="attribute">lenavg</span> =<span class="meta"> []</span></span><br><span class="line">    <span class="attribute">avg_sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">grey_lvl</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">k</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">res</span> = <span class="number">0</span></span><br><span class="line">    <span class="comment"># test = [[5,4,3,2,1]]</span></span><br><span class="line">    <span class="attribute">weight</span> = img.shape[<span class="number">0</span>]</span><br><span class="line">    <span class="attribute">height</span> = img.shape[<span class="number">1</span>]</span><br><span class="line">    <span class="attribute">total</span> = weight * height</span><br><span class="line">    <span class="attribute">for</span> i in range(<span class="number">256</span>):</span><br><span class="line">        <span class="attribute">n</span>.append(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">for</span> i in range(weight):</span><br><span class="line">        <span class="attribute">for</span> j in range(height):</span><br><span class="line">            <span class="attribute">grey_lvl</span> = img[i][j]</span><br><span class="line">            <span class="attribute">n</span>[grey_lvl] = float(n[grey_lvl] + <span class="number">1</span>)</span><br><span class="line">            <span class="attribute">k</span> = float(k + <span class="number">1</span>)</span><br><span class="line">    <span class="attribute">for</span> i in range(<span class="number">256</span>):</span><br><span class="line">        <span class="attribute">P</span>.append(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">P</span> = n</span><br><span class="line">    <span class="attribute">for</span> i in range(len(n)):</span><br><span class="line">        <span class="attribute">P</span>[i] = (n[i] / k)</span><br><span class="line">    <span class="attribute">for</span> i in range(<span class="number">256</span>):</span><br><span class="line">        <span class="attribute">lenavg</span>.append(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">lenavg</span> = P</span><br><span class="line">    <span class="attribute">for</span> i in range(len(n)):</span><br><span class="line">        <span class="attribute">if</span> P[i] == <span class="number">0</span>.<span class="number">0</span>:</span><br><span class="line">            <span class="attribute">continue</span></span><br><span class="line">        <span class="attribute">lenavg</span>[i] = lenavg[i] * len(dec2bin(lenavg[i]))</span><br><span class="line">        <span class="attribute">avg_sum</span> = lenavg[i] + avg_sum</span><br><span class="line">    <span class="attribute">for</span> i in range(len(n)):</span><br><span class="line">        <span class="attribute">if</span> (P[i] == <span class="number">0</span>):</span><br><span class="line">            <span class="attribute">res</span> = res</span><br><span class="line">        <span class="attribute">else</span>:</span><br><span class="line">            <span class="attribute">res</span> = float(res - P[i] * (math.log(P[i]) / math.log(<span class="number">2</span>.<span class="number">0</span>)))</span><br><span class="line">    <span class="attribute">return</span> res</span><br><span class="line"><span class="attribute">if</span> __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    <span class="attribute">if</span> input(keyboard.wait(&#x27;A&#x27;)):</span><br><span class="line">        <span class="attribute">for</span> i in range(<span class="number">6</span>):</span><br><span class="line">            <span class="attribute">ave_1</span> = average(imgs[i])</span><br><span class="line">            <span class="attribute">ave_1</span> = Decimal(ave_1).quantize(Decimal(<span class="string">&quot;0.000&quot;</span>))</span><br><span class="line">            <span class="attribute">print</span>(<span class="string">&quot;average_office&quot;</span> + <span class="string">&quot;_&quot;</span> + <span class="string">&quot;123456&quot;</span>[i],ave_1)</span><br><span class="line">            <span class="attribute">with</span> open(&#x27;E:\\untitled12\\image_practice\\entropy.txt&#x27;,&#x27;a&#x27;,encoding=&#x27;utf-<span class="number">8</span>&#x27;) as f:</span><br><span class="line">                <span class="attribute">f</span>.write(&#x27;&#123;:^<span class="number">30</span>&#125;\n&#x27;.format(str(ave_1)))</span><br><span class="line">                <span class="attribute">f</span>.close()</span><br><span class="line">        <span class="attribute">plt</span>.show()</span><br><span class="line">    <span class="attribute">if</span> input(keyboard.wait(&#x27;V&#x27;)):</span><br><span class="line">        <span class="attribute">for</span> i in range(<span class="number">6</span>):</span><br><span class="line">            <span class="attribute">var_1</span> = variance(img_1)</span><br><span class="line">            <span class="attribute">var_1</span> = Decimal(var_1).quantize(Decimal(<span class="string">&quot;0.000&quot;</span>))</span><br><span class="line">            <span class="attribute">print</span>(<span class="string">&quot;variance_office&quot;</span> + <span class="string">&quot;_&quot;</span> + <span class="string">&quot;123456&quot;</span>[i],var_1)</span><br><span class="line">        <span class="attribute">img_contrast</span> = Contrast_and_Brightness(<span class="number">2</span>.<span class="number">0</span>,<span class="number">0</span>,img_1)</span><br><span class="line">        <span class="attribute">var_orign</span> = variance(img_1)</span><br><span class="line">        <span class="attribute">var_con</span> = variance(img_contrast)</span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;原图：       &quot;</span>,var_orign)</span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;原图调节对比：&quot;</span>,var_con)</span><br><span class="line">        <span class="attribute">plt</span>.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>),plt.imshow(img_1),plt.title(&#x27;img_1&#x27;)   plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>),plt.imshow(img_contrast),plt.title(&#x27;img_contrast&#x27;)</span><br><span class="line">    <span class="attribute">plt</span>.show()</span><br><span class="line">    <span class="attribute">if</span> input(keyboard.wait(&#x27;C&#x27;)):</span><br><span class="line">        <span class="attribute">con_1</span> = contrast(img_1)</span><br><span class="line">        <span class="attribute">plt</span>.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>),plt.imshow(img_1),plt.title(&#x27;bangong&#x27;)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">img_GAUSS</span> = cv2.GaussianBlur(img_1,(<span class="number">9</span>,<span class="number">9</span>),<span class="number">0</span>)</span><br><span class="line">        <span class="attribute">con_2</span> = contrast(img_GAUSS)</span><br><span class="line">        <span class="attribute">plt</span>.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>),plt.imshow(img_GAUSS),plt.title(&#x27;bangong_GUSS&#x27;)</span><br><span class="line">        <span class="attribute">con_3</span> = contrast(img_9)</span><br><span class="line">        <span class="attribute">plt</span>.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>),plt.imshow(img_9),plt.title(&#x27;mu_wen&#x27;)</span><br><span class="line">        <span class="attribute">con_4</span> = contrast(img_10)</span><br><span class="line">        <span class="attribute">plt</span>.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>),plt.imshow(img_10),plt.title(&#x27;shui_ni_wen&#x27;)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">con_1</span> = Decimal(con_1).quantize(Decimal(<span class="string">&quot;0.000&quot;</span>))</span><br><span class="line">        <span class="attribute">con_2</span> = Decimal(con_2).quantize(Decimal(<span class="string">&quot;0.000&quot;</span>))</span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;contrast_office&quot;</span> + <span class="string">&quot;_oringel&quot;</span>,con_1)</span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;contrast_office&quot;</span> + <span class="string">&quot;_GAUSS  &quot;</span>,con_2)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">con_3</span> = Decimal(con_3).quantize(Decimal(<span class="string">&quot;0.000&quot;</span>))</span><br><span class="line">        <span class="attribute">con_4</span> = Decimal(con_4).quantize(Decimal(<span class="string">&quot;0.000&quot;</span>))</span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;木纹  &quot;</span>,con_3)</span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;水泥纹&quot;</span>,con_4)</span><br><span class="line">    <span class="attribute">plt</span>.show()</span><br><span class="line"></span><br><span class="line">    <span class="attribute">if</span> input(keyboard.wait(&#x27;E&#x27;)):</span><br><span class="line">        <span class="attribute">img_grey</span> = cv2.imread(&#x27;dalishi.jpg&#x27;,cv2.IMREAD_GRAYSCALE)</span><br><span class="line">        <span class="attribute">img_grey1</span> = cv2.imread(&#x27;wall.jpg&#x27;,cv2.IMREAD_GRAYSCALE)</span><br><span class="line">        <span class="attribute">img_grey2</span> = cv2.imread(&#x27;muwen.jpg&#x27;,cv2.IMREAD_GRAYSCALE)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">img_wenli</span> = cv2.imread(&#x27;<span class="number">400</span>x400_zhi_wenli.jpg&#x27;,cv2.IMREAD_GRAYSCALE)</span><br><span class="line">        <span class="attribute">img_wenli1</span> = cv2.imread(&#x27;<span class="number">400</span>x400_zhi_zhezhouwenli.jpg&#x27;,cv2.IMREAD_GRAYSCALE)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">ent_dalishi</span> = total_entropy(img_grey)</span><br><span class="line">        <span class="attribute">plt</span>.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>),plt.imshow(img_7)</span><br><span class="line">        <span class="attribute">ent_wall</span> = total_entropy(img_grey1)</span><br><span class="line">        <span class="attribute">plt</span>.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>),plt.imshow(img_8)</span><br><span class="line">        <span class="attribute">ent_muwen</span> = total_entropy(img_grey2)</span><br><span class="line">        <span class="attribute">plt</span>.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>),plt.imshow(img_9)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">ent_wenli</span> = total_entropy(img_wenli)</span><br><span class="line">        <span class="attribute">plt</span>.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>),plt.imshow(img_11),plt.title(&#x27;junyun_weli&#x27;)</span><br><span class="line">        <span class="attribute">ent_wenli1</span> = total_entropy(img_wenli1)</span><br><span class="line">        <span class="attribute">plt</span>.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>),plt.imshow(img_12),plt.title(&#x27;not_junrun_wen&#x27;)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;entropy_dalishi&quot;</span>,ent_dalishi)</span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;entropy_wall   &quot;</span>,ent_wall)</span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;entrop_muwen   &quot;</span>,ent_muwen)</span><br><span class="line"></span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;E_junrun_wenli:        &quot;</span>,ent_wenli)</span><br><span class="line">        <span class="attribute">print</span>(<span class="string">&quot;E_NOT_junrun_wenli1:   &quot;</span>,ent_wenli1)</span><br><span class="line">    <span class="attribute">plt</span>.show()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 图像处理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 图像处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python笔记</title>
      <link href="/2024/03/05/Python%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/03/05/Python%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7p19dmlpe.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7p19dmlpe.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1lbkdf1q74.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1lbkdf1q74.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3uukwwo6om.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3uukwwo6om.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2a4txfsd0n.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2a4txfsd0n.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="tagLink"><a class="link-card" title="阅读原文" href="https://zhuanlan.zhihu.com/p/91461612"><span class="link-card-backdrop" style="background-image: url(https://pic2.zhimg.com/80/v2-be27f2479a3249ad8c4fa17ff9973e2d_720w.webp)"></span><div class="left"><img src="https://pic2.zhimg.com/80/v2-be27f2479a3249ad8c4fa17ff9973e2d_720w.webp" class="lazyload placeholder" data-srcset="https://pic2.zhimg.com/80/v2-be27f2479a3249ad8c4fa17ff9973e2d_720w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">阅读原文</p><p class="url">https://zhuanlan.zhihu.com/p/91461612</p></div></a></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1ses8v0ra9.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1ses8v0ra9.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.pf2xz6qp7.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.pf2xz6qp7.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7p3cfvjxuh.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7p3cfvjxuh.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.60tziov27k.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.60tziov27k.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8vmnohcwpq.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8vmnohcwpq.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.32hpf6r2w7.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.32hpf6r2w7.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3uukwx9tfw.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3uukwx9tfw.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.6f0f9kbvqh.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.6f0f9kbvqh.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8hg7xmcmik.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8hg7xmcmik.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>在Python中，对象和属性之间有着密切的关系。对象是类的实例，可以包含数据（属性）和方法。属性是与对象相关联的变量，用于存储对象的状态或特征。</p><p>具体来说，对象是类的实例化，可以访问类的属性和方法。属性是对象内部的变量，用于存储对象的状态信息。在Python中，可以通过点号<code>.</code>来访问对象的属性。</p><p>定义一个类并创建对象的示例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">greet</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Hello, my name is <span class="subst">&#123;self.name&#125;</span> and I am <span class="subst">&#123;self.age&#125;</span> years old.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Person类的实例</span></span><br><span class="line">person1 = Person(<span class="string">&quot;Alice&quot;</span>, <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问对象的属性</span></span><br><span class="line"><span class="built_in">print</span>(person1.name)  <span class="comment"># 输出：Alice</span></span><br><span class="line"><span class="built_in">print</span>(person1.age)   <span class="comment"># 输出：30</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用对象的方法</span></span><br><span class="line">person1.greet()  <span class="comment"># 输出：Hello, my name is Alice and I am 30 years old.</span></span><br></pre></td></tr></table></figure><p>在这个示例中，<code>name</code>和<code>age</code>就是对象<code>person1</code>的属性，而<code>Person</code>类是对象<code>person1</code>的模板。通过访问对象的属性和方法，可以操作对象的状态和行为。</p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>线性代数</title>
      <link href="/2024/03/02/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"/>
      <url>/2024/03/02/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<iframe src="//player.bilibili.com/player.html?aid=19844108&bvid=BV1sW411775X&cid=32363257&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><iframe src="//player.bilibili.com/player.html?aid=6731067&bvid=BV1ys411472E&cid=10959715&p=5" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2yy3deimon.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2yy3deimon.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.5j3xq1squd.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.5j3xq1squd.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3go51zvwgn.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3go51zvwgn.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.es90rvvkp.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.es90rvvkp.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3nrcyr5i7a.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3nrcyr5i7a.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.73toquhuk4.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.73toquhuk4.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>]]></content>
      
      
      <categories>
          
          <category> 线性代数 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 高等数学 </tag>
            
            <tag> 线性代数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>零基础实践深度学习(一):波士顿房价预测问题</title>
      <link href="/2024/03/02/%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%AE%9E%E8%B7%B5%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-%E4%B8%80-%E6%B3%A2%E5%A3%AB%E9%A1%BF%E6%88%BF%E4%BB%B7%E9%A2%84%E6%B5%8B%E9%97%AE%E9%A2%98/"/>
      <url>/2024/03/02/%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%AE%9E%E8%B7%B5%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-%E4%B8%80-%E6%B3%A2%E5%A3%AB%E9%A1%BF%E6%88%BF%E4%BB%B7%E9%A2%84%E6%B5%8B%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="波士顿房价预测问题"><a href="#波士顿房价预测问题" class="headerlink" title="波士顿房价预测问题"></a>波士顿房价预测问题</h1><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.67x79lupri.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.67x79lupri.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h2 id="线性回归模型"><a href="#线性回归模型" class="headerlink" title="线性回归模型"></a>线性回归模型</h2><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.45f75utlc.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.45f75utlc.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h2 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h2><h3 id="读入数据"><a href="#读入数据" class="headerlink" title="读入数据"></a>读入数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入需要用到的package</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="comment"># 读入训练数据</span></span><br><span class="line">datafile = <span class="string">&#x27;./work/housing.data&#x27;</span></span><br><span class="line">data = np.fromfile(datafile, sep=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">data</span><br></pre></td></tr></table></figure><p>（我不知道为什么最后一行要加一个data）(好像他加一个data就不用print了？)<br>data &#x3D; np.fromfile(datafile, sep&#x3D;’ ‘):</p><ul><li>使用NumPy的 <code>fromfile</code> 函数来读取文件中的数据。<ul><li><code>datafile</code> 参数指定了要读取的数据文件的路径。</li><li><code>sep=&#39; &#39;</code> 参数表示数据在文件中是由空格分隔的。这意味着文件 <code>housing.data</code> 中的每一行都应该是由一系列由空格分隔的数值。</li><li>读取的数据将被存储在一个NumPy数组中，并且赋值给变量 <code>data</code>。<br>最后加上<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>在anaconda里运行一下：<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(Paddle_Py3.9) C:\Users\lxcqm&gt;python &quot;D:\opencv_test\demo\PythonApplication1\PythonApplication1\housing.py&quot;</span><br><span class="line">[6.320e<span class="string">-03</span> 1.800e<span class="string">+01</span> 2.310e<span class="string">+00</span> ... 3.969e<span class="string">+02</span> 7.880e<span class="string">+00</span> 1.190e<span class="string">+01</span>]</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="数据形状变换"><a href="#数据形状变换" class="headerlink" title="数据形状变换"></a>数据形状变换</h3><p>由于读入的原始数据是1维的，所有数据都连在一起。因此需要我们将数据的形状进行变换，形成一个2维的矩阵，每行为一个数据样本（14个值），每个数据样本包含13个X（影响房价的特征）和一个Y（该类型房屋的均价）。</p><ul><li>读入之后的数据被转化成1维array，其中array的第0-13项是第一条数据，第14-27项是第二条数据，以此类推…. </li><li>这里对原始数据做reshape，变成N x 14的形式<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">feature_names = [ <span class="string">&#x27;CRIM&#x27;</span>, <span class="string">&#x27;ZN&#x27;</span>, <span class="string">&#x27;INDUS&#x27;</span>, <span class="string">&#x27;CHAS&#x27;</span>, <span class="string">&#x27;NOX&#x27;</span>, <span class="string">&#x27;RM&#x27;</span>, <span class="string">&#x27;AGE&#x27;</span>,<span class="string">&#x27;DIS&#x27;</span>, </span><br><span class="line">                 <span class="string">&#x27;RAD&#x27;</span>, <span class="string">&#x27;TAX&#x27;</span>, <span class="string">&#x27;PTRATIO&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;LSTAT&#x27;</span>, <span class="string">&#x27;MEDV&#x27;</span> ]</span><br><span class="line">feature_num = <span class="built_in">len</span>(feature_names)</span><br><span class="line">data = data.reshape([data.shape[<span class="number">0</span>] // feature_num, feature_num])</span><br></pre></td></tr></table></figure><strong>data &#x3D; data.reshape([data.shape[0] &#x2F;&#x2F; feature_num, feature_num]):</strong></li></ul><ol><li><p><code>data.shape[0]</code>：这个部分是获取原始数据<code>data</code>的第一个维度的长度(获取行数)(当我们谈到数据集的长度时，我们通常指的是数据集中各个元素的数量，而不是字符的总数或字符字数)，也就是数据中元素的总数。[data.shape[1] 是用来获取数据集中的列数]对于一维数组（也称为向量），shape返回的是一个包含一个元素的元组，指示数组中元素的数量。这个值就是一维数组的长度。</p></li><li><p><code>//</code>：这是整数除法操作符，将两个数相除并返回整数部分，舍弃小数部分。此处是将数据总数除以特征数量，得到可以分成多少完整的样本集合。</p></li><li><p><code>feature_num</code>：这个值代表每个样本的特征数量，本例中是14个。</p></li><li><p><code>[data.shape[0] // feature_num, feature_num]</code>：这个部分定义了新的形状，将原始数据<code>data</code>重新组织为一个二维数组([行数，列数])，行数表示可以容纳完整样本集的数量，列数表示每个样本具有的特征数量。[] 中括号内的内容 [data.shape[0] &#x2F;&#x2F; feature_num, feature_num] 表示的是一个包含两个值的列表</p></li><li><p>最终，<code>data.reshape([data.shape[0] // feature_num, feature_num])</code>通过这行代码将原始数据<code>data</code>按照新的形状重塑，每行包含一个完整的14个特征的样本数据，确保了数据集的完整性和规范性。</p></li></ol><p>查看数据:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = data[<span class="number">0</span>]     //数据集的第一个样本</span><br><span class="line"><span class="built_in">print</span>(x.shape)  </span><br><span class="line"><span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure><p>运行结果:</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(Paddle_Py3.9) C:\Users\lxcqm&gt;python &quot;D:\opencv_test\demo\PythonApplication1\PythonApplication1\housing.py&quot;</span><br><span class="line">[6.320e<span class="string">-03</span> 1.800e<span class="string">+01</span> 2.310e<span class="string">+00</span> ... 3.969e<span class="string">+02</span> 7.880e<span class="string">+00</span> 1.190e<span class="string">+01</span>]</span><br><span class="line">(14,)</span><br><span class="line">[6.320e<span class="string">-03</span> 1.800e<span class="string">+01</span> 2.310e<span class="string">+00</span> 0.000e<span class="string">+00</span> 5.380e<span class="string">-01</span> 6.575e<span class="string">+00</span> 6.520e<span class="string">+01</span></span><br><span class="line"> 4.090e<span class="string">+00</span> 1.000e<span class="string">+00</span> 2.960e<span class="string">+02</span> 1.530e<span class="string">+01</span> 3.969e<span class="string">+02</span> 4.980e<span class="string">+00</span> 2.400e<span class="string">+01</span>]</span><br></pre></td></tr></table></figure><p><code>(14,)</code> 这样的形状表示一个包含一个元素的元组，该元素的值为 14。在这种情况下，这个元组表示的是一个一维数组，其长度为 14。这意味着样本或数组具有 14 个元素或特征。形状的表示方式是最后面一个’,’前面的数字，表明数组的维度。<br>因此，<code>(14,)</code> 表示数组是一个包含 14 个元素的一维数组。</p><div class="note info"><p><code>(14,)</code> 和 <code>(14,1)</code> 所表示的含义有些微妙的区别。 - <code>(14,)</code> 表示一个包含 14 个元素的一维数组，此时该数组是一个一维数组，维度为 1。 - <code>(14,1)</code> 表示一个包含 14 行、1 列的二维数组，因此该数组是一个二维数组，维度为 2，每行只有一个元素。 在数学表示和编程中，维度的不同有时会影响一些运算和处理，因此在处理数据时需要注意区分它们的含义。</p></div><h3 id="数据集划分"><a href="#数据集划分" class="headerlink" title="数据集划分"></a>数据集划分</h3><p>将数据集划分成训练集和测试集，其中训练集用于确定模型的参数，测试集用于评判模型的效果。<br>在本案例中，我们将80%的数据用作训练集，20%用作测试集，实现代码如下。通过打印训练集的形状，可以发现共有404个样本，每个样本含有13个特征和1个预测值。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ratio = <span class="number">0.8</span></span><br><span class="line">offset = <span class="built_in">int</span>(data.shape[<span class="number">0</span>] * ratio)</span><br><span class="line">training_data = data[:offset]</span><br><span class="line">training_data.shape</span><br></pre></td></tr></table></figure><p>使用int()函数是为了确保offset是一个整数值<br>data[:offset]:</p><div class="note info"><p>在Python中，冒号<code>:</code>通常用于切片（slice）操作，用来指定要从列表、字符串、元组等序列类型中提取的部分数据范围。在这种情况下，<code>data[:offset]</code>表示从序列<code>data</code>的开头开始一直切片直到<code>offset</code>之前的位置（不包括<code>offset</code>位置），即取出索引从0到<code>offset-1</code>的元素。这个操作可以用来生成一个新的子序列，其中包含了原始数据序列中从0到<code>offset-1</code>位置的元素。</p></div><p>运行结果:</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(Paddle_Py3.9) C:\Users\lxcqm&gt;python &quot;D:\opencv_test\demo\PythonApplication1\PythonApplication1\housing.py&quot;</span><br><span class="line">[[6.32000e<span class="string">-03</span> 1.80000e<span class="string">+01</span> 2.31000e<span class="string">+00</span> ... 3.96900e<span class="string">+02</span> 4.98000e<span class="string">+00</span></span><br><span class="line">  2.40000e<span class="string">+01</span>]</span><br><span class="line"> [2.73100e<span class="string">-02</span> 0.00000e<span class="string">+00</span> 7.07000e<span class="string">+00</span> ... 3.96900e<span class="string">+02</span> 9.14000e<span class="string">+00</span></span><br><span class="line">  2.16000e<span class="string">+01</span>]</span><br><span class="line"> [2.72900e<span class="string">-02</span> 0.00000e<span class="string">+00</span> 7.07000e<span class="string">+00</span> ... 3.92830e<span class="string">+02</span> 4.03000e<span class="string">+00</span></span><br><span class="line">  3.47000e<span class="string">+01</span>]</span><br><span class="line"> ...</span><br><span class="line"> [1.42362e<span class="string">+01</span> 0.00000e<span class="string">+00</span> 1.81000e<span class="string">+01</span> ... 3.96900e<span class="string">+02</span> 2.03200e<span class="string">+01</span></span><br><span class="line">  7.20000e<span class="string">+00</span>]</span><br><span class="line"> [9.59571e<span class="string">+00</span> 0.00000e<span class="string">+00</span> 1.81000e<span class="string">+01</span> ... 3.76110e<span class="string">+02</span> 2.03100e<span class="string">+01</span></span><br><span class="line">  1.21000e<span class="string">+01</span>]</span><br><span class="line"> [2.48017e<span class="string">+01</span> 0.00000e<span class="string">+00</span> 1.81000e<span class="string">+01</span> ... 3.96900e<span class="string">+02</span> 1.97700e<span class="string">+01</span></span><br><span class="line">  8.30000e<span class="string">+00</span>]]</span><br><span class="line">(404, 14)</span><br></pre></td></tr></table></figure><h3 id="数据归一化处理"><a href="#数据归一化处理" class="headerlink" title="数据归一化处理"></a>数据归一化处理</h3><p>对每个特征进行归一化处理，使得每个特征的取值缩放到0~1之间。这样做有两个好处：一是模型训练更高效，在本节的后半部分会详细说明；二是特征前的权重大小可以代表该变量对预测结果的贡献度（因为每个特征值本身的范围相同）。</p><div class="note info"><p>测试样本归一化时用的是训练样本的最大值、最小值</p></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算train数据集的最大值，最小值</span></span><br><span class="line"><span class="comment"># axis=0:列（同类数据）</span></span><br><span class="line">maximums, minimums = \</span><br><span class="line">                     training_data.<span class="built_in">max</span>(axis=<span class="number">0</span>), \   </span><br><span class="line">                     training_data.<span class="built_in">min</span>(axis=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 对数据进行归一化处理</span></span><br><span class="line"><span class="comment"># 像方差一样的思想，都对等到0-1之间的数（最大值是1，最小值是0）</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(feature_num):</span><br><span class="line">    data[:, i] = (data[:, i] - minimums[i]) / (maximums[i] - minimums[i])</span><br></pre></td></tr></table></figure><details open><summary pointer> \ </summary>              <div class='content'>              <p>在代码片段中，maximums, minimums &#x3D; training_data.max(axis&#x3D;0), training_data.min(axis&#x3D;0) 这行代码使用了反斜杠 \ 作为换行符使用。这种方式在Python中被称为行连接符，它可以将一行代码分成多行来提高可读性。<br>在Python中，反斜杠 \ 通常用于指示语句在下一行继续。在这个例子中，maximums, minimums &#x3D; \ 是从下一行的training_data.max(axis&#x3D;0), \继续的开始。整行代码被分为两行写入，但解释器会将这两行连接在一起执行，就好像是单行代码一样。</p><details open><summary pointer> axis </summary>              <div class='content'>              <p>training_data.max(axis&#x3D;0)是Pandas库中DataFrame对象的函数调用方法，用于计算DataFrame中每列的最大值。参数 axis&#x3D;0 指定了沿着列的方向进行操作，也就是计算每列的最大值。这个方法会返回一个包含每列最大值的Series对象。<br>如果使用axis&#x3D;1参数调用 training_data.max(axis&#x3D;1)，那么是在DataFrame中沿着行的方向计算每行的最大值。这将返回一个包含每行最大值的Series对象。通过这种方法，可以找到每行数据中的最大值。</p>              </div>            </details>              </div>            </details><details open><summary pointer> python中for循环 </summary>              <div class='content'>              <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line"><span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(i)</span><br><span class="line">...</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure><p>当代码 for i in a: 执行时，它实际上是在遍历列表 a 中的每个元素，并将每个元素的值依次赋给变量 i，然后执行循环体中的代码</p>              </div>            </details><details open><summary pointer> python中range()函数 </summary>              <div class='content'>              <ul><li><p>函数作用<br>  range() 函数可创建一个整数列表，一般用在 for 循环中。</p>  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(i)</span><br><span class="line">...</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure></li><li><p>函数语法<br>  <span class='pbg info'>range(start，stop[，step])</span> </p><p>  参数说明：</p><ul><li>start: 计数从 start 开始。默认是从 0 开始。例如range（5）等价于range（0， 5）;</li><li>stop: 计数到 stop 结束，但不包括 stop。例如：range（0， 5） 是[0, 1, 2, 3, 4]没有5</li><li>step：步长，默认为1。例如：range（0， 5） 等价于 range(0, 5, 1)</li></ul></li></ul>              </div>            </details><details open><summary pointer> data[:i]和data[i:]和data[:，i]和data[i， :] </summary>              <div class='content'>              <ul><li><code>data[:i]</code>：获取前i行的所有数据</li><li><code>data[i:]</code>: 获取从i位置到末尾的所有数据</li><li><code>data[:, i]</code>：获取第i列的所有数据（列号从第0列开始）</li><li><code>data[i, :]</code>：获取第i行的所有数据（行号从第0行开始）<br>data[:i]:第0行到第i-1行（不包括第i行）<br>data[i:]:第i行到最后一行（包括第i行）</li></ul>              </div>            </details><h3 id="封装成load-data函数"><a href="#封装成load-data函数" class="headerlink" title="封装成load data函数"></a>封装成load data函数</h3><p>将上述几个数据处理操作封装成load data函数，以便下一步模型的调用</p><details open><summary pointer> python中定义函数 </summary>              <div class='content'>              <p>不用声明~</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">function_name</span>(<span class="params">arguments</span>):</span><br><span class="line">    <span class="comment"># 函数体，包括代码块</span></span><br><span class="line">    <span class="comment"># 可能包括返回语句</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用函数</span></span><br><span class="line">result = function_name(argument_values)</span><br></pre></td></tr></table></figure>              </div>            </details><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_data</span>():</span><br><span class="line">    <span class="comment"># 导入数据</span></span><br><span class="line">    datafile = <span class="string">&quot;D:/paddlepaddle/housing/housing.data&quot;</span></span><br><span class="line">    data = np.fromfile(datafile, sep=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 每条数据包括14项，其中前面13项是影响因素，第14项是相应的房屋价格中位数</span></span><br><span class="line">    feature_names = [<span class="string">&#x27;CRIM&#x27;</span>, <span class="string">&#x27;ZN&#x27;</span>, <span class="string">&#x27;INDUS&#x27;</span>, <span class="string">&#x27;CHAS&#x27;</span>, <span class="string">&#x27;NOX&#x27;</span>,</span><br><span class="line">                     <span class="string">&#x27;RM&#x27;</span>, <span class="string">&#x27;AGE&#x27;</span>, <span class="string">&#x27;DIS&#x27;</span>, <span class="string">&#x27;RAD&#x27;</span>, <span class="string">&#x27;TAX&#x27;</span>, <span class="string">&#x27;PTRATIO&#x27;</span>,</span><br><span class="line">                     <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;LSTAT&#x27;</span>, <span class="string">&#x27;MEDV&#x27;</span>]</span><br><span class="line">    feature_num = <span class="built_in">len</span>(feature_names)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将原始数据进行Reshape，变成[N, 14]这样的形状</span></span><br><span class="line">    data = data.reshape([data.shape[<span class="number">0</span>] // feature_num, feature_num])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将原始数据集拆成训练集和数据集</span></span><br><span class="line">    <span class="comment"># 这里使用80%的数据做训练，20%的数据做测试</span></span><br><span class="line">    <span class="comment"># 测试集和训练集必须是没有交集的</span></span><br><span class="line">    ratio = <span class="number">0.8</span></span><br><span class="line">    offset = <span class="built_in">int</span>(data.shape[<span class="number">0</span>] * ratio)</span><br><span class="line">    training_data = data[:offset]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算训练集每一列的最大值、最小值</span></span><br><span class="line">    maximums, minimums = training_data.<span class="built_in">max</span>(axis=<span class="number">0</span>), training_data.<span class="built_in">min</span>(axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对数据进行归一化处理</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(feature_num):</span><br><span class="line">        data[:, i] = (data[:, i] - minimums[i]) / (maximums[i] - minimums[i])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 训练集和测试集的划分比例</span></span><br><span class="line">    test_data = data[offset:]</span><br><span class="line">    <span class="keyword">return</span> training_data, test_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">training_data, test_data = load_data()</span><br><span class="line">x = training_data[:, :-<span class="number">1</span>]</span><br><span class="line">y = training_data[:, -<span class="number">1</span>:]</span><br><span class="line"><span class="built_in">print</span>(x[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(y[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><ol><li><p><code>x = training_data[:, :-1]</code>：<br>这行代码会将 <code>training_data</code> 中所有行的除了最后一列（即特征变量）之外的所有列切片提取出来，赋值给变量 <code>x</code>。这意味着 <code>x</code> 包含了所有的特征变量。</p></li><li><p><code>y = training_data[:, -1:]</code>：<br>这行代码会将 <code>training_data</code> 中所有行的最后一列（即目标变量）提取出来，赋值给变量 <code>y</code>。这意味着 <code>y</code> 包含了所有的目标变量。</p></li></ol><p>教程写了两遍training_data &#x3D; data[:offset]？不懂为什么<br>输出:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(Paddle_Py3<span class="number">.9</span>) C:\Users\lxcqm&gt;python <span class="string">&quot;D:\opencv_test\demo\PythonApplication1\PythonApplication1\housing.py&quot;</span></span><br><span class="line">[<span class="number">0.</span>         <span class="number">0.18</span>       <span class="number">0.07344184</span> <span class="number">0.</span>         <span class="number">0.31481481</span> <span class="number">0.57750527</span></span><br><span class="line"> <span class="number">0.64160659</span> <span class="number">0.26920314</span> <span class="number">0.</span>         <span class="number">0.22755741</span> <span class="number">0.28723404</span> <span class="number">1.</span></span><br><span class="line"> <span class="number">0.08967991</span>]</span><br><span class="line">[<span class="number">0.42222222</span>]</span><br></pre></td></tr></table></figure><h2 id="模型设计"><a href="#模型设计" class="headerlink" title="模型设计"></a>模型设计</h2><p>模型设计是深度学习模型关键要素之一，也称为网络结构设计，相当于模型的假设空间，即实现模型“前向计算”（从输入到输出）的过程。<br>如果将输入特征和输出预测值均以向量表示，输入特征x有13个分量，y有1个分量，那么参数权重的形状(shape)是13×1。假设我们以如下任意数字赋值参数做初始化：<br>w&#x3D;[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,-0.1,-0.2,-0.3,-0.4,0.0]</p><details open><summary pointer> 详细解释 </summary>              <div class='content'>              <p>这些数字表示了初始化时每个输入特征对应的权重值。例如，第一个特征的权重是0.1，第二个特征的权重是0.2，以此类推。最后一个数字0.0是偏置项（bias），通常用来调整模型对数据的拟合情况。<br>在线性回归模型中，通过对输入特征和权重进行加权求和，并加上偏置项，来预测输出值。具体地，对于给定的输入特征向量x，输出值y可以通过以下方式计算得到：<br>y &#x3D; w1x1 + w2x2 + … + w13*x13 + bias<br>将权重参数w与输入特征向量x的对应分量相乘并求和，再加上偏置项，就可以得到模型的预测输出值。</p><details open><summary pointer> 偏置项(bias) </summary>              <div class='content'>              <p>偏置项（bias）在机器学习中是模型中的一个重要参数，通常用来在模型中引入偏移量，帮助模型更好地拟合数据。偏置项可以理解为模型中的截距，用来调整模型预测的基准值，即在没有输入特征时模型预测的值。</p><p>在线性回归模型中，偏置项可以帮助模型更好地拟合数据的整体偏移。考虑一个简单的二维线性回归模型，假设没有偏置项，模型预测是通过输入特征的加权和来计算的。如果数据在原点附近分布，模型可能能够较好地拟合数据。但如果数据出现偏移（即不再经过原点），没有偏置项的模型可能无法很好地捕捉到这种整体偏移。</p><p>通过引入偏置项，模型获得了一个额外的参数来平移整个预测结果，使其更贴合数据的整体分布情况。偏置项允许模型在不依赖输入特征的情况下做出一定的预测，从而更灵活地适应不同的数据集。</p>              </div>            </details>              </div>            </details><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">w = [<span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.3</span>, <span class="number">0.4</span>, <span class="number">0.5</span>, <span class="number">0.6</span>, <span class="number">0.7</span>, <span class="number">0.8</span>, -<span class="number">0.1</span>, -<span class="number">0.2</span>, -<span class="number">0.3</span>, -<span class="number">0.4</span>, <span class="number">0.0</span>]</span><br><span class="line">w = np.array(w).reshape([<span class="number">13</span>, <span class="number">1</span>])</span><br></pre></td></tr></table></figure><details open><summary pointer> np.array(w).reshape([13 </summary>              <div class='content'>              <p>和开始的data.reshape的区别：</p><ol><li><p><code>data.reshape</code>:</p><ul><li><code>data.reshape</code> 是对已经存在的数组 <code>data</code> 进行形状改变的操作，返回一个新的数组，原始数组 <code>data</code> 的形状并不会发生改变。这个方法适用于NumPy数组对象。</li><li>示例：<code>data = data.reshape([num_rows, num_cols])</code></li></ul></li><li><p><code>np.array(w).reshape</code>:</p><ul><li><code>np.array(w).reshape</code> 则是将一个列表或其他类似对象 <code>w</code> 转换为NumPy数组，然后再对其进行形状改变操作。这个函数没有副作用，仅在返回新的数组时改变形状。</li><li>示例：<code>w = np.array(w).reshape([num_rows, num_cols])</code></li></ul></li></ol><p>如果已经有一个NumPy数组对象，且只需改变其形状而不需要创建新数组，可以直接使用 <code>data.reshape</code>。如果想将一个列表或其他类型对象转换为NumPy数组并改变其形状，则需要使用 <code>np.array(w).reshape</code>。</p>              </div>            </details><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x1 = x[<span class="number">0</span>]</span><br><span class="line">t = np.dot(x1, w)</span><br><span class="line"><span class="built_in">print</span>(x1)</span><br><span class="line"><span class="built_in">print</span>(w)</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p> <code>t = np.dot(x1, w)</code>：</p><ul><li>这行代码将两个数组 <code>x1</code> 和 <code>w</code> 进行矩阵乘法运算，并将结果存储在变量 <code>t</code> 中。</li><li><code>np.dot</code> 是 NumPy 提供的矩阵乘法函数，可以用于计算两个数组的点积（内积）。<br>输出:<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">[0.         0.18       0.07344184 0.         0.31481481 0.57750527</span></span><br><span class="line"><span class="comment"> 0.64160659 0.26920314 0.         0.22755741 0.28723404 1.</span></span><br><span class="line"><span class="comment"> 0.08967991]</span></span><br><span class="line"><span class="comment">[<span class="comment">[ 0.1]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[ 0.2]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[ 0.3]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[ 0.4]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[ 0.5]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[ 0.6]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[ 0.7]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[ 0.8]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[-0.1]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[-0.2]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[-0.3]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[-0.4]</span></span></span><br><span class="line"><span class="comment"> <span class="comment">[ 0. ]</span>]</span></span><br><span class="line"><span class="comment">[0.69474855]</span></span><br></pre></td></tr></table></figure><details open><summary pointer> 行向量乘列向量 </summary>              <div class='content'>              <p>行向量乘以列向量是一种矩阵乘法操作。具体来说，如果有一个行向量（1 x n）和一个列向量（n x 1），它们的维数在矩阵乘法中是匹配的，可以进行相乘操作。结果将会是一个标量（1 x 1 矩阵），即一个单独的数值。<br>例如，如果有一个行向量 a &#x3D; [a1, a2, …, an]（1 x n）和一个列向量 b &#x3D; [b1, b2, …, bn]（n x 1），它们的乘积为：<br>a * b &#x3D; a1b1 + a2b2 + … + anbn<br>因此，行向量乘以列向量的结果是这两个向量对应位置元素的乘积的和。希望这样的解释能够帮助你理解矩阵乘法的操作。如果还有其他问题，请随时告诉我。</p>              </div>            </details></li></ul><p>完整的线性回归公式，还需要初始化偏移量b，同样随意赋初值-0.2。那么，线性回归模型的完整输出是z&#x3D;t+b，这个从特征和参数计算输出值的过程称为“前向计算”。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d = -<span class="number">0.2</span></span><br><span class="line">z = t + d</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(z)</span></span></span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[0.49474855]</span></span><br></pre></td></tr></table></figure><p>将上述计算预测输出的过程以“类和对象”的方式来描述，类成员变量有参数w和b。通过写一个forward函数（代表“前向计算”）完成上述从特征和参数到输出预测值的计算过程，代码如下所示。</p><details open><summary pointer> 类和对象 </summary>              <div class='content'>              <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">greet</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Hello, my name is <span class="subst">&#123;self.name&#125;</span> and I am <span class="subst">&#123;self.age&#125;</span> years old.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建对象实例</span></span><br><span class="line">person1 = Person(<span class="string">&quot;Alice&quot;</span>, <span class="number">30</span>)</span><br><span class="line">person2 = Person(<span class="string">&quot;Bob&quot;</span>, <span class="number">25</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问属性并调用方法</span></span><br><span class="line"><span class="built_in">print</span>(person1.name)  <span class="comment"># 输出: Alice</span></span><br><span class="line">person2.greet()  <span class="comment"># 输出: Hello, my name is Bob and I am 25 years old.</span></span><br></pre></td></tr></table></figure><p>print后的f:<br>在Python中，f 字符串（格式化字符串）是在字符串前缀加上f的一种特殊方法，称为 f-string。它允许在字符串中嵌入表达式，可以在大括号 {} 内部直接引用变量或表达式的值。<br>输出：</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(Paddle_Py3.<span class="number">9</span>) C:\Users\lxcqm&gt;<span class="keyword">python</span> D:\opencv_test\demo\PythonApplication1\PythonApplication1\testtttt.<span class="keyword">py</span></span><br><span class="line">Alice</span><br><span class="line">Hello, my name <span class="keyword">is</span> Bob <span class="built_in">and</span> I <span class="keyword">am</span> <span class="number">25</span> years old.</span><br></pre></td></tr></table></figure><p><span class='pbg info'><strong>init</strong>:</span><br>在Python中，<code>__init__</code> 是一个特殊的方法，用于在创建一个新对象时进行初始化操作。这个方法也被称为构造函数，负责初始化对象的属性。在类的定义中，如果你定义了 <code>__init__</code> 方法，那么在实例化类时会自动调用这个方法。</p><p>下面是 <code>__init__</code> 方法的详细解释：</p><ul><li><code>self</code>：<code>self</code> 是一个指向对象本身的引用。在类中的方法定义中，第一个参数通常为 <code>self</code>，用于表示类的实例。</li><li><code>name</code> 和 <code>age</code>：这两个参数是在创建对象时传入的参数，用于初始化对象的属性。</li><li><code>self.name = name</code>：这行代码将传入的 <code>name</code> 参数赋值给对象的 <code>name</code> 属性。通过这种方式，可以为每个对象设置不同的姓名。</li><li><code>self.age = age</code>：这行代码将传入的 <code>age</code> 参数赋值给对象的 <code>age</code> 属性。同样，通过这种方式，可以为每个对象设置不同的年龄。</li></ul><p>在上面的例子中， <code>__init__</code> 方法负责初始化 <code>Person</code> 类的对象的 <code>name</code> 和 <code>age</code> 属性。当创建 <code>Person</code> 类的实例时，传入的 <code>name</code> 和 <code>age</code> 参数会被用来初始化对象的属性值。例如，<code>person1 = Person(&quot;Alice&quot;, 30)</code> 这行代码就创建了一个名为 “Alice”，年龄为 30 的 <code>Person</code> 类的实例。</p>              </div>            </details><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Network</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, num_of_weights</span>):</span><br><span class="line">        <span class="comment"># 随机产生w的初始值</span></span><br><span class="line">        <span class="comment"># 为了保持程序每次运行结果的一致性，</span></span><br><span class="line">        <span class="comment"># 此处设置固定的随机数种子</span></span><br><span class="line">        np.random.seed(<span class="number">0</span>)</span><br><span class="line">        self.w = np.random.randn(num_of_weights, <span class="number">1</span>)</span><br><span class="line">        self.b = <span class="number">0.</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        z = np.dot(x, self.w) + self.b</span><br><span class="line">        <span class="keyword">return</span> z</span><br></pre></td></tr></table></figure><ol><li><p><code>class Network(object)</code>：在 class Network(object): 中，object 表示 Network 类继承自 object 类，使得 Network 类是一个新式类。在 Python 3 中，可以简写为 class Network:，这样也会默认继承自 object 类</p></li><li><p><code>np.random.seed(0)</code>：设置随机数种子为0，这样可以保证每次运行程序得到的随机数是一样的，有助于结果的可重现性。</p></li><li><p><code>self.w = np.random.randn(num_of_weights, 1)</code>：利用Numpy的<code>randn</code>函数生成一个服从标准正态分布的随机数数组，形状为<code>(num_of_weights, 1)</code>，其中<code>num_of_weights</code> 是传入的参数，代表权重的数量。这些随机数将作为神经网络的权重参数，用于神经网络的学习和预测过程。</p></li><li><p><code>self.b = 0.</code>：将偏置参数<code>b</code>初始化为0，这个参数也将在网络的运算中起着重要的作用，用于调整模型的输出。</p></li></ol><p>基于Network类的定义，模型的计算过程如下所示:</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">net</span> <span class="operator">=</span> Network(<span class="number">13</span>)</span><br><span class="line"><span class="attribute">x1</span> <span class="operator">=</span> x[<span class="number">0</span>]</span><br><span class="line"><span class="attribute">y1</span> <span class="operator">=</span> y[<span class="number">0</span>]</span><br><span class="line"><span class="attribute">z</span> <span class="operator">=</span> net.forward(x1)</span><br><span class="line">print(z)</span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(Paddle_Py3<span class="number">.9</span>) <span class="name">C</span>:\Users\lxcqm&gt;python <span class="name">D</span>:\opencv_test\demo\PythonApplication1\PythonApplication1\housing.py</span><br><span class="line">[<span class="number">2.39362982</span>]</span><br></pre></td></tr></table></figure><p>从上述前向计算的过程可见，线性回归也可以表示成一种简单的神经网络（只有一个神经元，且激活函数为恒等式）。这也是机器学习模型普遍为深度学习模型替代的原因：由于深度学习网络强大的表示能力，很多传统机器学习模型的学习能力等同于相对简单的深度学习模型。</p><h2 id="训练配置"><a href="#训练配置" class="headerlink" title="训练配置"></a>训练配置</h2><p>模型设计完成后，需要通过训练配置寻找模型的最优值，即通过损失函数来衡量模型的好坏。训练配置也是深度学习模型关键要素之一。</p><p>通过模型计算$x_1$表示的影响因素所对应的房价应该是$z$, 但实际数据告诉我们房价是$y$。这时我们需要有某种指标来衡量预测值$z$跟真实值$y$之间的差距。对于回归问题，最常采用的衡量方法是使用均方误差作为评价模型好坏的指标，具体定义如下：</p><p>$$Loss &#x3D; (y - z)^2 (公式3)$$</p><p>上式中的$Loss$（简记为: $L$）通常也被称作损失函数，它是衡量模型好坏的指标。读者可能会奇怪：如果要衡量预测房价和真实房价之间的差距，是否将每一个样本的差距的绝对值加和即可？差距绝对值加和是更加直观和朴素的思路，为何要平方加和？ 损失函数的设计不仅要考虑准确衡量问题的“合理性”，通常还要考虑“易于优化求解”。至于这个问题的答案，在介绍完优化算法后再揭示。</p><p>在回归问题中，均方误差是一种比较常见的形式，分类问题中通常会采用交叉熵作为损失函数，在后续的章节中会更详细的介绍。对一个样本计算损失函数值的实现如下。</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Loss = (<span class="name">y1</span> - z)*(<span class="name">y1</span> - z)</span><br><span class="line">print(<span class="name">Loss</span>)</span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[3.88644793]</span></span><br></pre></td></tr></table></figure><p>因为计算损失函数时需要把每个样本的损失函数值都考虑到，所以我们需要对单个样本的损失函数进行求和，并除以样本总数$N$。<br>$$L&#x3D; \frac{1}{N}\sum_{i&#x3D;1}^N{(y_i - z_i)^2} (公式4)$$<br>在Network类下面添加损失函数的计算过程如下。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Network</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, num_of_weights</span>):</span><br><span class="line">        <span class="comment"># 随机产生w的初始值</span></span><br><span class="line">        <span class="comment"># 为了保持程序每次运行结果的一致性，此处设置固定的随机数种子</span></span><br><span class="line">        np.random.seed(<span class="number">0</span>)</span><br><span class="line">        self.w = np.random.randn(num_of_weights, <span class="number">1</span>)</span><br><span class="line">        self.b = <span class="number">0.</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        z = np.dot(x, self.w) + self.b</span><br><span class="line">        <span class="keyword">return</span> z</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">loss</span>(<span class="params">self, z, y</span>):</span><br><span class="line">        error = z - y</span><br><span class="line">        cost = error * error</span><br><span class="line">        cost = np.mean(cost)</span><br><span class="line">        <span class="keyword">return</span> cost</span><br></pre></td></tr></table></figure><p><strong>cost &#x3D; np.mean(cost):</strong><br>np.mean(cost) 使用NumPy库中的 mean() 函数计算 cost 中所有元素的平均值，然后将这个平均值赋给 cost 变量<br>使用定义的Network类，可以方便的计算预测值和损失函数。需要注意的是，类中的变量x,w,b,z，error等均是向量。以变量x为例，共有两个维度，一个代表特征数量（值为13），一个代表样本数量，代码如下所示。</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">net = Network(13)</span><br><span class="line"><span class="comment"># 此处可以一次性计算多个样本的预测值和损失函数</span></span><br><span class="line">x1 = x[0:3]</span><br><span class="line">y1 = y[0:3]</span><br><span class="line">z = net.forward(x1)</span><br><span class="line"><span class="section">print(&#x27;predict: &#x27;, z)</span></span><br><span class="line">loss = net.loss(z, y1)</span><br><span class="line"><span class="section">print(&#x27;loss:&#x27;, loss)</span></span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">predict:  <span class="string">[[2.39362982]</span></span><br><span class="line"><span class="string"> [2.46752393]</span></span><br><span class="line"><span class="string"> [2.02483479]]</span></span><br><span class="line">loss: <span class="number">3.384496992612791</span></span><br></pre></td></tr></table></figure><h2 id="训练过程"><a href="#训练过程" class="headerlink" title="训练过程"></a>训练过程</h2><p>上述计算过程描述了如何构建神经网络，通过神经网络完成预测值和损失函数的计算。接下来介绍如何求解参数$w$和$b$的数值，这个过程也称为模型训练过程。训练过程是深度学习模型的关键要素之一，其目标是让定义的损失函数$Loss$尽可能的小，也就是说找到一个参数解$w$和$b$，使得损失函数取得极小值。</p><iframe src="//player.bilibili.com/player.html?aid=19844108&bvid=BV1sW411775X&cid=32363257&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p>我们先做一个小测试：如 <strong>图5</strong> 所示，基于微积分知识，求一条曲线在某个点的斜率等于函数在该点的导数值。那么大家思考下，当处于曲线的极值点时，该点的斜率是多少？</p><center><img src="https://ai-studio-static-online.cdn.bcebos.com/94f0437e6a454a0682f3b831c96a62bdaf40898af25145ec9b5b50bc80391f5c" class="lazyload placeholder" data-srcset="https://ai-studio-static-online.cdn.bcebos.com/94f0437e6a454a0682f3b831c96a62bdaf40898af25145ec9b5b50bc80391f5c" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" width="300" hegiht="" ></center><center><br>图5：曲线斜率等于导数值</br></center><br></br><p>这个问题并不难回答，处于曲线极值点时的斜率为0，即函数在极值点的导数为0。那么，让损失函数取极小值的$w$和$b$应该是下述方程组的解：<br>$$\frac{\partial{L}}{\partial{\boldsymbol{w}}}&#x3D;0,(公式5)$$<br>$$\frac{\partial{L}}{\partial{b}}&#x3D;0,(公式6)$$</p><p>其中$L$表示的是损失函数的值，$\boldsymbol{w}$为模型权重，$b$为偏置项。$\boldsymbol{w}$和$b$均为要学习的模型参数。</p><p>把损失函数表示成矩阵的形式为</p><p>$$<br>L&#x3D;\frac{1}{N}||\boldsymbol{y}-(\boldsymbol{X}\boldsymbol{w}+\boldsymbol{b})||^2, (公式7)<br>$$</p><div class="note info"><p>在公式中使用两个竖线 $|| \cdot ||$ 表示向量的范数（norm），具体来说，$||\boldsymbol{v}||$ 表示向量 $\boldsymbol{v}$ 的范数。在这个公式中，公式7中的 $||\boldsymbol{y} - (\boldsymbol{X}\boldsymbol{w} + \boldsymbol{b})||^2$ 表示向量 $\boldsymbol{y} - (\boldsymbol{X}\boldsymbol{w} + \boldsymbol{b})$ 的二范数的平方(二范数的平方等于内积)。二范数的计算方式是将向量中每个元素的平方相加，然后再开平方，而在这个公式中，我们直接对每个元素平方，即 $||\boldsymbol{v}||^2 &#x3D; \sum_{i} v_i^2$。这个二范数的平方在线性回归中被用作损失函数的一部分，用来度量预测值和观测值之间的误差。</p></div><p>其中$\boldsymbol{y}$为$N$个样本的标签值构成的向量，形状为$N\times 1$；$\boldsymbol{X}$为$N$个样本特征向量构成的矩阵，形状为$N\times D$，$D$为数据特征长度；$\boldsymbol{w}$为权重向量，形状为$D\times 1$；$\boldsymbol{b}$为所有元素都为$b$的向量，形状为$N\times 1$。</p><p>计算公式7对参数$b$的偏导数<br>$$<br>\frac{\partial L}{\partial b} &#x3D; \boldsymbol{1}^T(\boldsymbol{y}-(\boldsymbol{X}\boldsymbol{w}+\boldsymbol{b})), (公式8)<br>$$<br>请注意，上述公式忽略了系数$\frac{2}{N}$，并不影响最后结果。其中$\boldsymbol{1}$为$N$维的全1向量。</p><p>令公式8等于0，得到<br>$$<br>b^* &#x3D; \boldsymbol{\bar{x}}^T\boldsymbol{w}-\bar{y}(公式9)<br>$$<br>其中$\bar{y}&#x3D;\frac{1}{N}\boldsymbol{1}^T\boldsymbol{y}$为所有标签的平均值，$\boldsymbol{\bar{x}}&#x3D;\frac{1}{N}(\boldsymbol{1}^T\boldsymbol{X})^T$为所有特征向量的平均值。将$b^*$带入公式7中并对参数$\boldsymbol{w}$求偏导得到</p><p>$$<br>\frac{\partial L}{\partial \boldsymbol{w}} &#x3D; (\boldsymbol{X}-\boldsymbol{\bar{x}}^T)^T((\boldsymbol{y}-\bar{y})-(\boldsymbol{X}-\boldsymbol{\bar{x}}^T)\boldsymbol{w}) (公式10)<br>$$</p><p>令公式10等于0，得到最优参数</p><p>$$<br>\boldsymbol{w}^*&#x3D;((\boldsymbol{X}-\boldsymbol{\bar{x}}^T)^T(\boldsymbol{X}-\boldsymbol{\bar{x}}^T))^{-1}(\boldsymbol{X}-\boldsymbol{\bar{x}}^T)^T(\boldsymbol{y}-\bar{y})(公式11) \<br>b^* &#x3D; \boldsymbol{\bar{x}}^T\boldsymbol{w}^*-\bar{y}(公式12)<br>$$</p><p>将样本数据$(x, y)$带入上面的公式11和公式12中即可求解出$w$和$b$的值，但是这种方法只对线性回归这样简单的任务有效。如果模型中含有非线性变换，或者损失函数不是均方差这种简单的形式，则很难通过上式求解。为了解决这个问题，下面我们将引入更加普适的数值求解方法：梯度下降法。</p><h3 id="梯度下降法"><a href="#梯度下降法" class="headerlink" title="梯度下降法"></a>梯度下降法</h3><p>在现实中存在大量的函数正向求解容易，但反向求解较难，被称为单向函数，这种函数在密码学中有大量的应用。密码锁的特点是可以迅速判断一个密钥是否是正确的(已知$x$，求$y$很容易)，但是即使获取到密码锁系统，也无法破解出正确得密钥（已知$y$，求$x$很难）。</p><p>这种情况特别类似于一位想从山峰走到坡谷的盲人，他看不见坡谷在哪（无法逆向求解出$Loss$导数为0时的参数值），但可以伸脚探索身边的坡度（当前点的导数值，也称为梯度）。那么，求解Loss函数最小值可以这样实现：从当前的参数取值，一步步的按照下坡的方向下降，直到走到最低点。这种方法笔者称它为“盲人下坡法”。哦不，有个更正式的说法“梯度下降法”。</p><p>训练的关键是找到一组$(w, b)$，使得损失函数$L$取极小值。我们先看一下损失函数$L$只随两个参数$w_5$、$w_9$变化时的简单情形，启发下寻解的思路。<br>$$L&#x3D;L(w_5, w_9) (公式13)$$<br>这里将$w_0, w_1, …, w_{12}$中除$w_5, w_9$之外的参数和$b$都固定下来，可以用图画出$L(w_5, w_9)$的形式，并在三维空间中画出损失函数随参数变化的曲面图。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">net = Network(<span class="number">13</span>)</span><br><span class="line">losses = []</span><br><span class="line"><span class="comment"># 只画出参数w5和w9在区间[-160, 160]的曲线部分，以及包含损失函数的极值</span></span><br><span class="line">w5 = np.arange(-<span class="number">160.0</span>, <span class="number">160.0</span>, <span class="number">1.0</span>)</span><br><span class="line">w9 = np.arange(-<span class="number">160.0</span>, <span class="number">160.0</span>, <span class="number">1.0</span>)</span><br><span class="line">losses = np.zeros([<span class="built_in">len</span>(w5), <span class="built_in">len</span>(w9)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算设定区域内每个参数取值所对应的Loss</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(w5)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(w9)):</span><br><span class="line">        net.w[<span class="number">5</span>] = w5[i]</span><br><span class="line">        net.w[<span class="number">9</span>] = w9[j]</span><br><span class="line">        z = net.forward(x)</span><br><span class="line">        loss = net.loss(z, y)</span><br><span class="line">        losses[i, j] = loss</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用matplotlib将两个变量和对应的Loss作3D图</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果您使用较新版本的matplotlib无法出图，可以替换为ax = fig.add_axes(Axes3D(fig))</span></span><br><span class="line">ax = fig.add_axes(Axes3D(fig))</span><br><span class="line"></span><br><span class="line">w5, w9 = np.meshgrid(w5, w9)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 我加的，可以看出哪个轴对应哪个变量</span></span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;w5&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;w9&#x27;</span>)</span><br><span class="line">ax.set_zlabel(<span class="string">&#x27;Loss&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax.plot_surface(w5, w9, losses, rstride=<span class="number">1</span>, cstride=<span class="number">1</span>, cmap=<span class="string">&#x27;rainbow&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>输出:</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1e8cfkaufh.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1e8cfkaufh.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>从图中可以明显观察到有些区域的函数值比周围的点小。需要说明的是：为什么选择$w_5$和$w_9$来画图呢？这是因为选择这两个参数的时候，可比较直观的从损失函数的曲面图上发现极值点的存在。其他参数组合，从图形上观测损失函数的极值点不够直观。</p><p>观察上述曲线呈现出“圆滑”的坡度，这正是我们选择以均方误差作为损失函数的原因之一。<strong>图6</strong> 呈现了只有一个参数维度时，均方误差和绝对值误差（只将每个样本的误差累加，不做平方处理）的损失函数曲线图。</p><center><img src="https://ai-studio-static-online.cdn.bcebos.com/99487dca6520441db5073d1c154b5d2fb1174b5cf4d946c29f9d80a209bc2687" class="lazyload placeholder" data-srcset="https://ai-studio-static-online.cdn.bcebos.com/99487dca6520441db5073d1c154b5d2fb1174b5cf4d946c29f9d80a209bc2687" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" width="700" hegiht="40" ></center><center><br>图6：均方误差和绝对值误差损失函数曲线图</br></center><br></br><p>由此可见，均方误差表现的“圆滑”的坡度有两个好处：</p><ul><li>曲线的最低点是可导的。</li><li>越接近最低点，曲线的坡度逐渐放缓，有助于通过当前的梯度来判断接近最低点的程度（是否逐渐减少步长，以免错过最低点）。</li></ul><p>而绝对值误差是不具备这两个特性的，这也是损失函数的设计不仅仅要考虑“合理性”，还要追求“易解性”的原因。</p><p>现在我们要找出一组$[w_5, w_9]$的值，使得损失函数最小，实现梯度下降法的方案如下：</p><ul><li>步骤1：随机的选一组初始值，例如：$[w_5, w_9] &#x3D; [-100.0, -100.0]$</li><li>步骤2：选取下一个点$[w_5^{‘} , w_9^{‘}]$，使得$L(w_5^{‘} , w_9^{‘}) &lt; L(w_5, w_9)$</li><li>步骤3：重复步骤2，直到损失函数几乎不再下降。</li></ul><p>如何选择$[w_5^{‘} , w_9^{‘}]$是至关重要的，第一要保证$L$是下降的，第二要使得下降的趋势尽可能的快。微积分的基础知识告诉我们：沿着梯度的反方向，是函数值下降最快的方向，如 <strong>图7</strong> 所示。简单理解，函数在某一个点的梯度方向是曲线斜率最大的方向，但梯度方向是向上的，所以下降最快的是梯度的反方向。</p><center><img src="https://ai-studio-static-online.cdn.bcebos.com/5f8322f6172542dab0f78684b70efe45d819895332af4cabb7c536217ab0bb26" class="lazyload placeholder" data-srcset="https://ai-studio-static-online.cdn.bcebos.com/5f8322f6172542dab0f78684b70efe45d819895332af4cabb7c536217ab0bb26" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" width="400" hegiht="40" ></center><center><br>图7：梯度下降方向示意图</br></center><br></br><h3 id="梯度计算"><a href="#梯度计算" class="headerlink" title="梯度计算"></a>梯度计算</h3><p>上文已经介绍了损失函数的计算方法，这里稍微改写。为了使梯度计算更加简洁，引入因子$\frac{1}{2}$，定义损失函数如下：</p><p>$$L&#x3D; \frac{1}{2N}\sum_{i&#x3D;1}^N{(y_i - z_i)^2} (公式14)$$</p><p>其中$z_i$是网络对第$i$个样本的预测值：</p><p>$$z_i &#x3D; \sum_{j&#x3D;0}^{12}{x_i^{j}\cdot w_j} + b (公式15)$$</p><p>在公式中，$(x_i^j)$ 中的 $(j)$ 表示输入样本的特征的索引。对于每个样本 $(i)$，有多个特征，其中特征索引为$(j)$ 从 0 到 12。这意味着每个样本 $(i)$ 包含了 13 个特征，用来描述或表示该样本的各个方面。因此，$(x_i^0, x_i^1, x_i^2, \ldots, x_i^{12})$ 分别表示第 $(i)$ 个样本的这 13 个特征的取值。在神经网络中，这些特征会与权重 $(w_j)$ 相乘，然后相加起来，从而得到对该样本的预测值 $(z_i)$</p><p>梯度的定义：</p><p>$$𝑔𝑟𝑎𝑑𝑖𝑒𝑛𝑡 &#x3D; (\frac{\partial{L}}{\partial{w_0}},\frac{\partial{L}}{\partial{w_1}}, … ,\frac{\partial{L}}{\partial{w_{12}}} ,\frac{\partial{L}}{\partial{b}}) (公式16)$$</p><p>可以计算出$L$对$w$和$b$的偏导数：</p><p>$$\frac{\partial{L}}{\partial{w_j}} &#x3D; \frac{1}{N}\sum_{i&#x3D;1}^N{(z_i - y_i)\frac{\partial{z_i}}{\partial{w_j}}} &#x3D; \frac{1}{N}\sum_{i&#x3D;1}^N{(z_i - y_i)x_i^{j}} (公式17)$$</p><p>$$\frac{\partial{L}}{\partial{b}} &#x3D; \frac{1}{N}\sum_{i&#x3D;1}^N{(z_i - y_i)\frac{\partial{z_i}}{\partial{b}}} &#x3D; \frac{1}{N}\sum_{i&#x3D;1}^N{(z_i - y_i)} (公式18)$$</p><p>从导数的计算过程可以看出，因子$\frac{1}{2}$被消掉了，这是因为二次函数求导的时候会产生因子$2$，这也是我们将损失函数改写的原因。</p><p>下面我们考虑只有一个样本的情况下，计算梯度：</p><p>$$L&#x3D; \frac{1}{2}{(y_i - z_i)^2} (公式19)$$</p><p>$$z_1 &#x3D; {x_1^{0}\cdot w_0} + {x_1^{1}\cdot w_1} + …  + {x_1^{12}\cdot w_{12}} + b (公式20)$$</p><p>可以计算出：</p><p>$$L&#x3D; \frac{1}{2}{({x_1^{0}\cdot w_0} + {x_1^{1}\cdot w_1} + …  + {x_1^{12}\cdot w_{12}} + b - y_1)^2} (公式21)$$</p><p>可以计算出$L$对$w$和$b$的偏导数：</p><p>$$\frac{\partial{L}}{\partial{w_0}} &#x3D; ({x_1^{0}\cdot w_0} + {x_1^{1}\cdot w_1} + …  + {x_1^{12}\cdot w_{12}} + b - y_1)\cdot x_1^{0}&#x3D;({z_1} - {y_1})\cdot x_1^{0} (公式22)$$</p><p>$$\frac{\partial{L}}{\partial{b}} &#x3D; ({x_1^{0}\cdot w_0} + {x_1^{1}\cdot w_1} + …  + {x_1^{12}\cdot w_{12}} + b - y_1)\cdot 1 &#x3D; ({z_1} - {y_1}) (公式23)$$</p><p>可以通过具体的程序查看每个变量的数据和维度。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x1 = x[<span class="number">0</span>]</span><br><span class="line">y1 = y[<span class="number">0</span>]</span><br><span class="line">z1 = net.forward(x1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;x1 &#123;&#125;, shape &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(x1, x1.shape))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;y1 &#123;&#125;, shape &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(y1, y1.shape))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;z1 &#123;&#125;, shape &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(z1, z1.shape))</span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x1 [<span class="number">0.</span>         <span class="number">0.18</span>       <span class="number">0.07344184</span> <span class="number">0.</span>         <span class="number">0.31481481</span> <span class="number">0.57750527</span></span><br><span class="line"> <span class="number">0.64160659</span> <span class="number">0.26920314</span> <span class="number">0.</span>         <span class="number">0.22755741</span> <span class="number">0.28723404</span> <span class="number">1.</span></span><br><span class="line"> <span class="number">0.08967991</span>], shape (<span class="number">13</span>,)</span><br><span class="line">y1 [<span class="number">0.42222222</span>], shape (<span class="number">1</span>,)</span><br><span class="line">z1 [<span class="number">130.86954441</span>], shape (<span class="number">1</span>,)</span><br></pre></td></tr></table></figure><p>按上面的公式，当只有一个样本时，可以计算某个$w_j$，比如$w_0$的梯度。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gradient_w0 = (z1 - y1) * x1[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;gradient_w0 &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(gradient_w0))</span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">gradient_w0</span><span class="meta"> [0.]</span></span><br></pre></td></tr></table></figure><p>同样我们可以计算$w_1$的梯度。</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">gradient_w1</span> = (<span class="variable">z1</span> - <span class="variable">y1</span>) * <span class="variable">x1</span>[<span class="number">1</span>]</span><br><span class="line"><span class="function"><span class="title">print</span>(<span class="string">&#x27;gradient_w1 &#123;&#125;&#x27;</span>.format(<span class="variable">gradient_w1</span>))</span></span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gradient_w1 [<span class="number">23.48051799</span>]</span><br></pre></td></tr></table></figure><p>依次计算$w_2$的梯度。</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">gradient_w2</span>= (<span class="variable">z1</span> - <span class="variable">y1</span>) * <span class="variable">x1</span>[<span class="number">2</span>]</span><br><span class="line"><span class="function"><span class="title">print</span>(<span class="string">&#x27;gradient_w1 &#123;&#125;&#x27;</span>.format(<span class="variable">gradient_w2</span>))</span></span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gradient_w1 <span class="string">[9.58029163]</span></span><br></pre></td></tr></table></figure><p>聪明的读者可能已经想到，写一个for循环即可计算从$w_0$到$w_{12}$的所有权重的梯度，该方法读者可以自行实现。<br>我写哒-&gt;</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>):</span><br><span class="line">    gradient_wi = (z1 - y1) * x1[i]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;gradient_w&#123;&#125; &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(i, gradient_wi))</span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(Paddle_Py3.<span class="number">9</span>) C:\Users\lxcqm&gt;python D:\opencv_test\demo\PythonApplication1\PythonApplication1\housing<span class="selector-class">.py</span></span><br><span class="line">gradient_w0 <span class="selector-attr">[0.]</span></span><br><span class="line">gradient_w1 <span class="selector-attr">[0.35485337]</span></span><br><span class="line">gradient_w2 <span class="selector-attr">[0.14478381]</span></span><br><span class="line">gradient_w3 <span class="selector-attr">[0.]</span></span><br><span class="line">gradient_w4 <span class="selector-attr">[0.62062832]</span></span><br><span class="line">gradient_w5 <span class="selector-attr">[1.13849828]</span></span><br><span class="line">gradient_w6 <span class="selector-attr">[1.26486811]</span></span><br><span class="line">gradient_w7 <span class="selector-attr">[0.53070911]</span></span><br><span class="line">gradient_w8 <span class="selector-attr">[0.]</span></span><br><span class="line">gradient_w9 <span class="selector-attr">[0.44860841]</span></span><br><span class="line">gradient_w10 <span class="selector-attr">[0.56625537]</span></span><br><span class="line">gradient_w11 <span class="selector-attr">[1.9714076]</span></span><br><span class="line">gradient_w12 <span class="selector-attr">[0.17679566]</span></span><br></pre></td></tr></table></figure><h3 id="使用Numpy进行梯度计算"><a href="#使用Numpy进行梯度计算" class="headerlink" title="使用Numpy进行梯度计算"></a>使用Numpy进行梯度计算</h3><p>基于NumPy广播机制（对向量和矩阵计算如同对1个单一变量计算一样），可以更快速的实现梯度计算。计算梯度的代码中直接用$(z_1 - y_1) \cdot x_1$，得到的是一个13维的向量，每个分量分别代表该维度的梯度。</p><details open><summary pointer> NumPy广播机制 </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7ljqfs5pd7.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7ljqfs5pd7.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4uao7pjyfb.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4uao7pjyfb.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 深度学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> paddlepaddle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蓝桥杯stm32学习笔记(四)：LCD液晶屏显示</title>
      <link href="/2024/02/29/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%9B%9B-%EF%BC%9ALCD%E6%B6%B2%E6%99%B6%E5%B1%8F%E6%98%BE%E7%A4%BA/"/>
      <url>/2024/02/29/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%9B%9B-%EF%BC%9ALCD%E6%B6%B2%E6%99%B6%E5%B1%8F%E6%98%BE%E7%A4%BA/</url>
      
        <content type="html"><![CDATA[<div class="note info"><p>开发板芯片：STM32G431RBT6;HAL库开发</p></div><span class='pbg info'>比赛的时候资料包里会有LCD驱动例程，可以直接在他的MX文件里配置，注意把时钟树里改为外部时钟（例程里是内部时钟）</span> <!--我们先来研究一下官方LCD例程吧~<details open><summary pointer> main.c </summary>              <div class='content'>              <details ><summary pointer> 源码(点击打开) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* USER CODE BEGIN Header */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  * @file           : main.c</span></span><br><span class="line"><span class="comment">  * @brief          : Main program body</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  * @attention</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * &lt;h2&gt;&lt;center&gt;&amp;copy; Copyright (c) 2021 STMicroelectronics.</span></span><br><span class="line"><span class="comment">  * All rights reserved.&lt;/center&gt;&lt;/h2&gt;</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * This software component is licensed by ST under BSD 3-Clause license,</span></span><br><span class="line"><span class="comment">  * the &quot;License&quot;; You may not use this file except in compliance with the</span></span><br><span class="line"><span class="comment">  * License. You may obtain a copy of the License at:</span></span><br><span class="line"><span class="comment">  *                        opensource.org/licenses/BSD-3-Clause</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="comment">/* USER CODE END Header */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Includes ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private includes ----------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* USER CODE BEGIN Includes */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END Includes */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private typedef -----------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* USER CODE BEGIN PTD */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END PTD */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private define ------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* USER CODE BEGIN PD */</span></span><br><span class="line"><span class="comment">/* USER CODE END PD */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private macro -------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* USER CODE BEGIN PM */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END PM */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private variables ---------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE BEGIN PV */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END PV */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private function prototypes -----------------------------------------------*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">SystemClock_Config</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">MX_GPIO_Init</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="comment">/* USER CODE BEGIN PFP */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END PFP */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private user code ---------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* USER CODE BEGIN 0 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END 0 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  The application entry point.</span></span><br><span class="line"><span class="comment">  * @retval int</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* USER CODE BEGIN 1 */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE END 1 */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* MCU Configuration--------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Reset of all peripherals, Initializes the Flash interface and the Systick. */</span></span><br><span class="line">    HAL_Init();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE BEGIN Init */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE END Init */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Configure the system clock */</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE BEGIN SysInit */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE END SysInit */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Initialize all configured peripherals */</span></span><br><span class="line">    MX_GPIO_Init();</span><br><span class="line">    <span class="comment">/* USER CODE BEGIN 2 */</span></span><br><span class="line"></span><br><span class="line">    LCD_Init();</span><br><span class="line">    <span class="comment">/* USER CODE END 2 */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Infinite loop */</span></span><br><span class="line">    <span class="comment">/* USER CODE BEGIN WHILE */</span></span><br><span class="line"></span><br><span class="line">    LCD_Clear(Blue);</span><br><span class="line">    LCD_SetBackColor(Blue);</span><br><span class="line">    LCD_SetTextColor(White);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    LCD_DrawLine(<span class="number">120</span>, <span class="number">0</span>, <span class="number">320</span>, Horizontal);</span><br><span class="line">    LCD_DrawLine(<span class="number">0</span>, <span class="number">160</span>, <span class="number">240</span>, Vertical);</span><br><span class="line">    HAL_Delay(<span class="number">1000</span>);</span><br><span class="line">    LCD_Clear(Blue);</span><br><span class="line"></span><br><span class="line">    LCD_DrawRect(<span class="number">70</span>, <span class="number">210</span>, <span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line">    HAL_Delay(<span class="number">1000</span>);</span><br><span class="line">    LCD_Clear(Blue);</span><br><span class="line"></span><br><span class="line">    LCD_DrawCircle(<span class="number">120</span>, <span class="number">160</span>, <span class="number">50</span>);</span><br><span class="line">    HAL_Delay(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    LCD_Clear(Blue);</span><br><span class="line">    LCD_DisplayStringLine(Line4, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;    Hello,world.   &quot;</span>);</span><br><span class="line">    HAL_Delay(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    LCD_SetBackColor(White);</span><br><span class="line">    LCD_DisplayStringLine(Line0, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Black);</span><br><span class="line">    LCD_DisplayStringLine(Line1, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Grey);</span><br><span class="line">    LCD_DisplayStringLine(Line2, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Blue);</span><br><span class="line">    LCD_DisplayStringLine(Line3, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Blue2);</span><br><span class="line">    LCD_DisplayStringLine(Line4, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Red);</span><br><span class="line">    LCD_DisplayStringLine(Line5, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Magenta);</span><br><span class="line">    LCD_DisplayStringLine(Line6, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Green);</span><br><span class="line">    LCD_DisplayStringLine(Line7, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Cyan);</span><br><span class="line">    LCD_DisplayStringLine(Line8, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Yellow);</span><br><span class="line">    LCD_DisplayStringLine(Line9, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* USER CODE END WHILE */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* USER CODE BEGIN 3 */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* USER CODE END 3 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief System Clock Configuration</span></span><br><span class="line"><span class="comment">  * @retval None</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">SystemClock_Config</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    RCC_OscInitTypeDef RCC_OscInitStruct = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    RCC_ClkInitTypeDef RCC_ClkInitStruct = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Configure the main internal regulator output voltage</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    HAL_PWREx_ControlVoltageScaling(PWR_REGULATOR_VOLTAGE_SCALE1);</span><br><span class="line">    <span class="comment">/** Initializes the CPU, AHB and APB busses clocks</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSI;</span><br><span class="line">    RCC_OscInitStruct.HSIState = RCC_HSI_ON;</span><br><span class="line">    RCC_OscInitStruct.HSICalibrationValue = RCC_HSICALIBRATION_DEFAULT;</span><br><span class="line">    RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;</span><br><span class="line">    RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSI;</span><br><span class="line">    RCC_OscInitStruct.PLL.PLLM = RCC_PLLM_DIV2;</span><br><span class="line">    RCC_OscInitStruct.PLL.PLLN = <span class="number">20</span>;</span><br><span class="line">    RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;</span><br><span class="line">    RCC_OscInitStruct.PLL.PLLQ = RCC_PLLQ_DIV2;</span><br><span class="line">    RCC_OscInitStruct.PLL.PLLR = RCC_PLLR_DIV2;</span><br><span class="line">    <span class="keyword">if</span> (HAL_RCC_OscConfig(&amp;RCC_OscInitStruct) != HAL_OK)</span><br><span class="line">    &#123;</span><br><span class="line">        Error_Handler();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/** Initializes the CPU, AHB and APB busses clocks</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK | RCC_CLOCKTYPE_SYSCLK</span><br><span class="line">                                  | RCC_CLOCKTYPE_PCLK1 | RCC_CLOCKTYPE_PCLK2;</span><br><span class="line">    RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;</span><br><span class="line">    RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;</span><br><span class="line">    RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV1;</span><br><span class="line">    RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV1;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (HAL_RCC_ClockConfig(&amp;RCC_ClkInitStruct, FLASH_LATENCY_3) != HAL_OK)</span><br><span class="line">    &#123;</span><br><span class="line">        Error_Handler();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief GPIO Initialization Function</span></span><br><span class="line"><span class="comment">  * @param None</span></span><br><span class="line"><span class="comment">  * @retval None</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">MX_GPIO_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    GPIO_InitTypeDef GPIO_InitStruct = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* GPIO Ports Clock Enable */</span></span><br><span class="line">    __HAL_RCC_GPIOC_CLK_ENABLE();</span><br><span class="line">    __HAL_RCC_GPIOF_CLK_ENABLE();</span><br><span class="line">    __HAL_RCC_GPIOA_CLK_ENABLE();</span><br><span class="line">    __HAL_RCC_GPIOB_CLK_ENABLE();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*Configure GPIO pin Output Level */</span></span><br><span class="line">    HAL_GPIO_WritePin(GPIOC, GPIO_PIN_13 | GPIO_PIN_14 | GPIO_PIN_15 | GPIO_PIN_0</span><br><span class="line">                      | GPIO_PIN_1 | GPIO_PIN_2 | GPIO_PIN_3 | GPIO_PIN_4</span><br><span class="line">                      | GPIO_PIN_5 | GPIO_PIN_6 | GPIO_PIN_7 | GPIO_PIN_8</span><br><span class="line">                      | GPIO_PIN_9 | GPIO_PIN_10 | GPIO_PIN_11 | GPIO_PIN_12, GPIO_PIN_RESET);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*Configure GPIO pin Output Level */</span></span><br><span class="line">    HAL_GPIO_WritePin(GPIOA, GPIO_PIN_8, GPIO_PIN_RESET);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*Configure GPIO pin Output Level */</span></span><br><span class="line">    HAL_GPIO_WritePin(GPIOB, GPIO_PIN_5 | GPIO_PIN_8 | GPIO_PIN_9, GPIO_PIN_RESET);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*Configure GPIO pins : PC13 PC14 PC15 PC0</span></span><br><span class="line"><span class="comment">                             PC1 PC2 PC3 PC4</span></span><br><span class="line"><span class="comment">                             PC5 PC6 PC7 PC8</span></span><br><span class="line"><span class="comment">                             PC9 PC10 PC11 PC12 */</span></span><br><span class="line">    GPIO_InitStruct.Pin = GPIO_PIN_13 | GPIO_PIN_14 | GPIO_PIN_15 | GPIO_PIN_0</span><br><span class="line">                          | GPIO_PIN_1 | GPIO_PIN_2 | GPIO_PIN_3 | GPIO_PIN_4</span><br><span class="line">                          | GPIO_PIN_5 | GPIO_PIN_6 | GPIO_PIN_7 | GPIO_PIN_8</span><br><span class="line">                          | GPIO_PIN_9 | GPIO_PIN_10 | GPIO_PIN_11 | GPIO_PIN_12;</span><br><span class="line">    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;</span><br><span class="line">    GPIO_InitStruct.Pull = GPIO_NOPULL;</span><br><span class="line">    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;</span><br><span class="line">    HAL_GPIO_Init(GPIOC, &amp;GPIO_InitStruct);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*Configure GPIO pin : PA8 */</span></span><br><span class="line">    GPIO_InitStruct.Pin = GPIO_PIN_8;</span><br><span class="line">    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;</span><br><span class="line">    GPIO_InitStruct.Pull = GPIO_NOPULL;</span><br><span class="line">    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;</span><br><span class="line">    HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*Configure GPIO pins : PB5 PB8 PB9 */</span></span><br><span class="line">    GPIO_InitStruct.Pin = GPIO_PIN_5 | GPIO_PIN_8 | GPIO_PIN_9;</span><br><span class="line">    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;</span><br><span class="line">    GPIO_InitStruct.Pull = GPIO_NOPULL;</span><br><span class="line">    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;</span><br><span class="line">    HAL_GPIO_Init(GPIOB, &amp;GPIO_InitStruct);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE BEGIN 4 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END 4 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  This function is executed in case of error occurrence.</span></span><br><span class="line"><span class="comment">  * @retval None</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Error_Handler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* USER CODE BEGIN Error_Handler_Debug */</span></span><br><span class="line">    <span class="comment">/* User can add his own implementation to report the HAL error return state */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE END Error_Handler_Debug */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span>  USE_FULL_ASSERT</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  Reports the name of the source file and the source line number</span></span><br><span class="line"><span class="comment">  *         where the assert_param error has occurred.</span></span><br><span class="line"><span class="comment">  * @param  file: pointer to the source file name</span></span><br><span class="line"><span class="comment">  * @param  line: assert_param error line source number</span></span><br><span class="line"><span class="comment">  * @retval None</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">assert_failed</span><span class="params">(<span class="type">uint8_t</span> *file, <span class="type">uint32_t</span> line)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* USER CODE BEGIN 6 */</span></span><br><span class="line">    <span class="comment">/* User can add his own implementation to report the file name and line number,</span></span><br><span class="line"><span class="comment">       tex: printf(&quot;Wrong parameters value: file %s on line %d\r\n&quot;, file, line) */</span></span><br><span class="line">    <span class="comment">/* USER CODE END 6 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">/* USE_FULL_ASSERT */</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">SystemClock_Config</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">MX_GPIO_Init</span><span class="params">(<span class="type">void</span>)</span>;</span><br></pre></td></tr></table></figure><p>声明初始化系统时钟，初始化GPIO(在CubeMX里配置的)函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">HAL_Init();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE BEGIN Init */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END Init */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Configure the system clock */</span></span><br><span class="line">SystemClock_Config();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE BEGIN SysInit */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END SysInit */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Initialize all configured peripherals */</span></span><br><span class="line">MX_GPIO_Init();</span><br><span class="line"><span class="comment">/* USER CODE BEGIN 2 */</span></span><br><span class="line"></span><br><span class="line">LCD_Init();</span><br></pre></td></tr></table></figure><p>这段代码片段展示了一段初始化代码，主要包括以下步骤：</p><ol><li><p><code>HAL_Init();</code>：进行HAL库的初始化。HAL（Hardware Abstraction Layer，硬件抽象层）是一种抽象层，用于封装底层硬件操作，提供统一的接口供上层应用使用。</p></li><li><p><code>SystemClock_Config();</code>：调用了之前提到的<code>SystemClock_Config()</code>函数，用于配置系统时钟。</p></li><li><p><code>MX_GPIO_Init();</code>：初始化GPIO模块，调用了之前提到的<code>MX_GPIO_Init()</code>函数。</p></li><li><p><code>LCD_Init();</code>：初始化液晶显示屏。</p></li></ol><details open><summary pointer> LCD_Init() </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">HAL_StatusTypeDef <span class="title function_">HAL_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    HAL_StatusTypeDef  status = HAL_OK;</span><br><span class="line">    <span class="comment">/* Configure Flash prefetch, Instruction cache, Data cache */</span></span><br><span class="line">    <span class="comment">/* Default configuration at reset is:                      */</span></span><br><span class="line">    <span class="comment">/* - Prefetch disabled                                     */</span></span><br><span class="line">    <span class="comment">/* - Instruction cache enabled                             */</span></span><br><span class="line">    <span class="comment">/* - Data cache enabled                                    */</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> (INSTRUCTION_CACHE_ENABLE == 0U)</span></span><br><span class="line">    __HAL_FLASH_INSTRUCTION_CACHE_DISABLE();</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">/* INSTRUCTION_CACHE_ENABLE */</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> (DATA_CACHE_ENABLE == 0U)</span></span><br><span class="line">    __HAL_FLASH_DATA_CACHE_DISABLE();</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">/* DATA_CACHE_ENABLE */</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> (PREFETCH_ENABLE != 0U)</span></span><br><span class="line">    __HAL_FLASH_PREFETCH_BUFFER_ENABLE();</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">/* PREFETCH_ENABLE */</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Set Interrupt Group Priority */</span></span><br><span class="line">    HAL_NVIC_SetPriorityGrouping(NVIC_PRIORITYGROUP_4);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Use SysTick as time base source and configure 1ms tick (default clock after Reset is HSI) */</span></span><br><span class="line">    <span class="keyword">if</span> (HAL_InitTick(TICK_INT_PRIORITY) != HAL_OK)</span><br><span class="line">    &#123;</span><br><span class="line">        status = HAL_ERROR;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* Init the low level hardware */</span></span><br><span class="line">        HAL_MspInit();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Return function status */</span></span><br><span class="line">    <span class="keyword">return</span> status;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LCD_Clear(Blue);</span><br><span class="line">LCD_SetBackColor(Blue);</span><br><span class="line">LCD_SetTextColor(White);</span><br></pre></td></tr></table></figure><ol><li><p><code>LCD_Clear(Blue);</code></p><ul><li>这行代码的作用是清除LCD屏幕上的内容，并将整个屏幕填充为蓝色（Blue）。</li></ul></li><li><p><code>LCD_SetBackColor(Blue);</code></p><ul><li>这行代码的作用是设置LCD屏幕的背景颜色为蓝色（Blue）。</li></ul></li><li><p><code>LCD_SetTextColor(White);</code></p><ul><li>这行代码的作用是设置LCD屏幕上文本的颜色为白色（White）。</li></ul></li></ol>              </div>            </details>    --><h2 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h2><h3 id="配置引脚"><a href="#配置引脚" class="headerlink" title="配置引脚"></a>配置引脚</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.77db74j2r0.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.77db74j2r0.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>把图片中的引脚配置为<code>GPIO_Output</code>模式</p><h3 id="复制官方头文件"><a href="#复制官方头文件" class="headerlink" title="复制官方头文件"></a>复制官方头文件</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.45frim9vd.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.45frim9vd.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><ol><li>复制官方项目<code>Inc</code>文件夹中的<code>fonts.h</code>和<code>lcd.h</code>到自己根目录的bsp文件夹</li><li>复制<code>Src</code>文件夹中的<code>lcd.c</code>文件到bsp文件夹中</li></ol><h3 id="添加lcd-c"><a href="#添加lcd-c" class="headerlink" title="添加lcd.c"></a>添加lcd.c</h3><p>添加lcd.c到工程bsp文件夹里</p><h3 id="添加头文件"><a href="#添加头文件" class="headerlink" title="添加头文件"></a>添加头文件</h3><p>在<code>main.c</code>中添加<code>#include &quot;lcd.h&quot;</code>和<code>#include &quot;stdio.h&quot;</code></p><h3 id="查看官方main-c"><a href="#查看官方main-c" class="headerlink" title="查看官方main.c"></a>查看官方main.c</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* USER CODE BEGIN 1 */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE END 1 */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* MCU Configuration--------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Reset of all peripherals, Initializes the Flash interface and the Systick. */</span></span><br><span class="line">    HAL_Init();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE BEGIN Init */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE END Init */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Configure the system clock */</span></span><br><span class="line">    SystemClock_Config();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE BEGIN SysInit */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE END SysInit */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Initialize all configured peripherals */</span></span><br><span class="line">    MX_GPIO_Init();</span><br><span class="line">    <span class="comment">/* USER CODE BEGIN 2 */</span></span><br><span class="line"></span><br><span class="line">    LCD_Init();</span><br><span class="line">    <span class="comment">/* USER CODE END 2 */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Infinite loop */</span></span><br><span class="line">    <span class="comment">/* USER CODE BEGIN WHILE */</span></span><br><span class="line"></span><br><span class="line">    LCD_Clear(Blue);</span><br><span class="line">    LCD_SetBackColor(Blue);</span><br><span class="line">    LCD_SetTextColor(White);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    LCD_DrawLine(<span class="number">120</span>, <span class="number">0</span>, <span class="number">320</span>, Horizontal);</span><br><span class="line">    LCD_DrawLine(<span class="number">0</span>, <span class="number">160</span>, <span class="number">240</span>, Vertical);</span><br><span class="line">    HAL_Delay(<span class="number">1000</span>);</span><br><span class="line">    LCD_Clear(Blue);</span><br><span class="line"></span><br><span class="line">    LCD_DrawRect(<span class="number">70</span>, <span class="number">210</span>, <span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line">    HAL_Delay(<span class="number">1000</span>);</span><br><span class="line">    LCD_Clear(Blue);</span><br><span class="line"></span><br><span class="line">    LCD_DrawCircle(<span class="number">120</span>, <span class="number">160</span>, <span class="number">50</span>);</span><br><span class="line">    HAL_Delay(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    LCD_Clear(Blue);</span><br><span class="line">    LCD_DisplayStringLine(Line4, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;    Hello,world.   &quot;</span>);</span><br><span class="line">    HAL_Delay(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    LCD_SetBackColor(White);</span><br><span class="line">    LCD_DisplayStringLine(Line0, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Black);</span><br><span class="line">    LCD_DisplayStringLine(Line1, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Grey);</span><br><span class="line">    LCD_DisplayStringLine(Line2, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Blue);</span><br><span class="line">    LCD_DisplayStringLine(Line3, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Blue2);</span><br><span class="line">    LCD_DisplayStringLine(Line4, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Red);</span><br><span class="line">    LCD_DisplayStringLine(Line5, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Magenta);</span><br><span class="line">    LCD_DisplayStringLine(Line6, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Green);</span><br><span class="line">    LCD_DisplayStringLine(Line7, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Cyan);</span><br><span class="line">    LCD_DisplayStringLine(Line8, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line">    LCD_SetBackColor(Yellow);</span><br><span class="line">    LCD_DisplayStringLine(Line9, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;                    &quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* USER CODE END WHILE */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* USER CODE BEGIN 3 */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* USER CODE END 3 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>复制<code>LCD_Init();</code>和后面的lcd显示代码到自己的<code>main.c</code>中</p><h2 id="设置屏幕颜色"><a href="#设置屏幕颜色" class="headerlink" title="设置屏幕颜色"></a>设置屏幕颜色</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LCD_Clear(Blue);</span><br><span class="line">LCD_SetBackColor(Blue);</span><br><span class="line">LCD_SetTextColor(White);</span><br></pre></td></tr></table></figure><ol><li><p><code>LCD_Clear(Blue);</code></p><ul><li>这行代码的作用是清除LCD屏幕上的内容，并将整个屏幕填充为蓝色（Blue）。</li></ul></li><li><p><code>LCD_SetBackColor(Blue);</code></p><ul><li>这行代码的作用是设置LCD屏幕的背景颜色为蓝色（Blue）。</li></ul></li><li><p><code>LCD_SetTextColor(White);</code></p><ul><li>这行代码的作用是设置LCD屏幕上文本的颜色为白色（White）。</li></ul></li></ol><h2 id="在屏幕上打印"><a href="#在屏幕上打印" class="headerlink" title="在屏幕上打印"></a>在屏幕上打印</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> text[<span class="number">30</span>];</span><br><span class="line">uint i=<span class="number">5</span>;</span><br><span class="line"><span class="built_in">sprintf</span>(text,<span class="string">&quot;  CNBR:%d      &quot;</span>,i);</span><br><span class="line">LCD_DisplayStringLine(Line9, (<span class="type">uint8_t</span> *)text);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式 </tag>
            
            <tag> stm32 </tag>
            
            <tag> 蓝桥杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python深度学习及智能车竞赛实践(一):Python 基础知识体系</title>
      <link href="/2024/02/28/Python%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%99%BA%E8%83%BD%E8%BD%A6%E7%AB%9E%E8%B5%9B%E5%AE%9E%E8%B7%B5-%E4%B8%80-Python%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E4%BE%8B/"/>
      <url>/2024/02/28/Python%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%99%BA%E8%83%BD%E8%BD%A6%E7%AB%9E%E8%B5%9B%E5%AE%9E%E8%B7%B5-%E4%B8%80-Python%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<!-- # 第1章 绪论 ## 1.1 人工智能的发展及基本概念### 1.1.1 人工智能的起源与发展 ### 1.1.2 中国人工智能技术的发展### 1.1.3 人工智能的基本概念## 1.2 智能汽车及全国大学生智能汽车竞赛### 1.2.1 智能汽车技术概述### 1.2.2 全国大学生智能汽车竞赛简介## 1.3 程序设计语言及Python语言简介### 1.3.1 低级语言和高级语言 ### 1.3.2 结构化语言和面向对象语言### 1.3.3 Python语言特点### 1.3.4 Python开发环境及小实例# 第2章 Python基本语法元素及数据类型 --><h2 id="求平方"><a href="#求平方" class="headerlink" title="求平方"></a>求平方</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">squard_numbers = [num**<span class="number">2</span> <span class="keyword">for</span> num <span class="keyword">in</span> numbers]</span><br><span class="line"><span class="built_in">print</span>(squard_numbers)</span><br></pre></td></tr></table></figure><h2 id="绘制同心圆"><a href="#绘制同心圆" class="headerlink" title="绘制同心圆"></a>绘制同心圆</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> turtle</span><br><span class="line"></span><br><span class="line">turtle.circle(<span class="number">50</span>)   <span class="comment">#画一个圆</span></span><br><span class="line">turtle.penup()  <span class="comment">#画笔悬空</span></span><br><span class="line">turtle.goto(<span class="number">0</span>, -<span class="number">50</span>) <span class="comment">#画笔移动（由于悬空，没有移动痕迹）</span></span><br><span class="line">turtle.pendown()    <span class="comment">#画笔放下</span></span><br><span class="line"></span><br><span class="line">turtle.circle(<span class="number">100</span>)</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(<span class="number">0</span>, -<span class="number">100</span>)</span><br><span class="line">turtle.pendown()</span><br><span class="line"></span><br><span class="line">turtle.circle(<span class="number">150</span>)</span><br></pre></td></tr></table></figure><p>只画一个圆时，不需要</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(<span class="number">0</span>, -<span class="number">50</span>)</span><br><span class="line">turtle.pendown()</span><br></pre></td></tr></table></figure><p>为了实现同心圆，需要加上。<br>** 不加后果 **</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> turtle</span><br><span class="line"></span><br><span class="line">turtle.circle(<span class="number">50</span>)</span><br><span class="line"><span class="comment"># turtle.penup()</span></span><br><span class="line"><span class="comment"># turtle.goto(0, -50)</span></span><br><span class="line"><span class="comment"># turtle.pendown()</span></span><br><span class="line"></span><br><span class="line">turtle.circle(<span class="number">100</span>)</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(<span class="number">0</span>, -<span class="number">100</span>)</span><br><span class="line">turtle.pendown()</span><br><span class="line"></span><br><span class="line">turtle.circle(<span class="number">150</span>)</span><br></pre></td></tr></table></figure><p>输出：</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7zq6f14hkr.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7zq6f14hkr.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> turtle</span><br><span class="line"></span><br><span class="line">turtle.circle(<span class="number">50</span>)</span><br><span class="line"><span class="comment"># turtle.penup()</span></span><br><span class="line"><span class="comment"># turtle.goto(0, -50)</span></span><br><span class="line"><span class="comment"># turtle.pendown()</span></span><br><span class="line"></span><br><span class="line">turtle.circle(<span class="number">100</span>)</span><br><span class="line"><span class="comment"># turtle.penup()</span></span><br><span class="line"><span class="comment"># turtle.goto(0, -100)</span></span><br><span class="line"><span class="comment"># turtle.pendown()</span></span><br><span class="line"></span><br><span class="line">turtle.circle(<span class="number">150</span>)</span><br></pre></td></tr></table></figure><p>输出：</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3d4jec7wzp.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3d4jec7wzp.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>]]></content>
      
      
      <categories>
          
          <category> 智能车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 深度学习 </tag>
            
            <tag> 智能车 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>STM32考核作业</title>
      <link href="/2024/02/28/STM32%E8%80%83%E6%A0%B8%E4%BD%9C%E4%B8%9A/"/>
      <url>/2024/02/28/STM32%E8%80%83%E6%A0%B8%E4%BD%9C%E4%B8%9A/</url>
      
        <content type="html"><![CDATA[<div class="note info"><p>开发板芯片：stm32g4rbt6;HAL库开发</p></div><details open><summary pointer> 题目 </summary>              <div class='content'>              <ol><li>   定义一个按键1，切换屏幕显示模式，屏幕有三种模式，第一个显示当前呼吸灯的占空比的值，第二个显示用电位器R37调节输出信号占空比的值，第三个是记录状态：显示呼吸灯和电位器记录时的pwm值，处于记录状态时，电位器的输出信号不会被改变</li><li>   切换led模式，<ol><li>LD1:处于呼吸灯pwm界面，指示灯LD1点亮，否则熄灭。</li><li>LD2: 处于电位器pwm界面，指示灯LD2以0.5秒为间隔切换亮、灭状态。</li><li>LD3:处于记录状态时，指示灯LD3点亮，否则熄灭。</li><li>LD4-LD8指示灯始终处于熄灭状态。</li></ol></li><li>   定义一个按键2，可以记录当前pwm值，记录当前时间的呼吸灯和电位器的值，在记录状态时会将记录的值显示在屏幕上</li><li>   接通电源后呼吸灯亮灭循环三个次，以后呼吸灯不需要亮，但是要可以正常读到呼吸灯的pwm值</li></ol>              </div>            </details><div class="video"><video controls preload><source src='/video/6FE627A7523A362DFBDAFF2659AAA047.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><details open><summary pointer> 我的解答（反正都实现了） </summary>              <div class='content'>              <p>目录</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.92pvbkg3ve.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.92pvbkg3ve.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><details open><summary pointer> main.c </summary>              <div class='content'>              <figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* USER CODE BEGIN Header */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  * @file           : main.c</span></span><br><span class="line"><span class="comment">  * @brief          : Main program body</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  * @attention</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * Copyright (c) 2023 STMicroelectronics.</span></span><br><span class="line"><span class="comment">  * All rights reserved.</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * This software is licensed under terms that can be found in the LICENSE file</span></span><br><span class="line"><span class="comment">  * in the root directory of this software component.</span></span><br><span class="line"><span class="comment">  * If no LICENSE file comes with this software, it is provided AS-IS.</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  ******************************************************************************</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="comment">/* USER CODE END Header */</span></span><br><span class="line"><span class="comment">/* Includes ------------------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;adc.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;tim.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;gpio.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private includes ----------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* USER CODE BEGIN Includes */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;lcd.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;led.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;interrupt.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;aadc.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;string.h&quot;</span></span></span><br><span class="line"><span class="comment">/* USER CODE END Includes */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private typedef -----------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* USER CODE BEGIN PTD */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">struct</span> <span class="title class_">keys</span> key[];</span><br><span class="line"><span class="comment">//extern unsigned int ccrl_val1,ccrl_val2,frq1, frq2;</span></span><br><span class="line"><span class="type">int</span> DutyCycle2,DutyCycle3;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span>  view=<span class="number">0</span>;</span><br><span class="line"><span class="type">uint32_t</span>tempCnt=<span class="number">0</span>;</span><br><span class="line"><span class="comment">/* USER CODE END PTD */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private define ------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* USER CODE BEGIN PD */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END PD */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private macro -------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* USER CODE BEGIN PM */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END PM */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private variables ---------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE BEGIN PV */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END PV */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private function prototypes -----------------------------------------------*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SystemClock_Config</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="comment">/* USER CODE BEGIN PFP */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">key_proc</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">disp_proc</span><span class="params">(<span class="type">uint32_t</span> i)</span></span>;</span><br><span class="line"><span class="comment">/* USER CODE END PFP */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Private user code ---------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* USER CODE BEGIN 0 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END 0 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  The application entry point.</span></span><br><span class="line"><span class="comment">  * @retval int</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">/* USER CODE BEGIN 1 */</span></span><br><span class="line"><span class="type">uint32_t</span> temp_pwm,i;</span><br><span class="line"><span class="comment">//uint32_ttempCnt=0;</span></span><br><span class="line">  <span class="comment">/* USER CODE END 1 */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* MCU Configuration--------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Reset of all peripherals, Initializes the Flash interface and the Systick. */</span></span><br><span class="line">  <span class="built_in">HAL_Init</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* USER CODE BEGIN Init */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* USER CODE END Init */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Configure the system clock */</span></span><br><span class="line">  <span class="built_in">SystemClock_Config</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* USER CODE BEGIN SysInit */</span></span><br><span class="line"><span class="built_in">HAL_SYSTICK_Config</span>(<span class="number">80000000</span>/<span class="number">1000</span>);</span><br><span class="line">  <span class="comment">/* USER CODE END SysInit */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Initialize all configured peripherals */</span></span><br><span class="line">  <span class="built_in">MX_GPIO_Init</span>();</span><br><span class="line">  <span class="built_in">MX_TIM3_Init</span>();</span><br><span class="line">  <span class="built_in">MX_TIM4_Init</span>();</span><br><span class="line">  <span class="built_in">MX_ADC2_Init</span>();</span><br><span class="line">  <span class="built_in">MX_TIM16_Init</span>();</span><br><span class="line">  <span class="built_in">MX_TIM8_Init</span>();</span><br><span class="line">  <span class="comment">/* USER CODE BEGIN 2 */</span></span><br><span class="line"><span class="comment">/**********初始化**********/</span></span><br><span class="line"><span class="comment">//LED_Disp(0x00);//LED的初始化</span></span><br><span class="line"><span class="comment">//LCD_Init();//LCD屏的初始化</span></span><br><span class="line"><span class="comment">/**********初始化**********/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**********LED颜色**********/</span></span><br><span class="line"><span class="built_in">LCD_SetBackColor</span>(Black );</span><br><span class="line"><span class="built_in">LCD_SetTextColor</span>(White);</span><br><span class="line"><span class="comment">/**********LED颜色**********/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">HAL_TIM_PWM_Start_IT</span>(&amp;htim3,TIM_CHANNEL_3);</span><br><span class="line"><span class="built_in">HAL_TIM_PWM_Start_IT</span>(&amp;htim16,TIM_CHANNEL_1);</span><br><span class="line"></span><br><span class="line"><span class="comment">//HAL_TIM_Base_Start_IT(&amp;htim3 );</span></span><br><span class="line"><span class="built_in">HAL_TIM_Base_Start_IT</span>(&amp;htim4 );</span><br><span class="line"></span><br><span class="line"><span class="built_in">HAL_TIM_IC_Start_IT</span> (&amp;htim3,TIM_CHANNEL_1);</span><br><span class="line"><span class="built_in">HAL_TIM_IC_Start_IT</span> (&amp;htim8,TIM_CHANNEL_1);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> w;</span><br><span class="line"><span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* USER CODE END 2 */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Infinite loop */</span></span><br><span class="line">  <span class="comment">/* USER CODE BEGIN WHILE */</span></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">/* USER CODE END WHILE */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* USER CODE BEGIN 3 */</span></span><br><span class="line"><span class="comment">//LED_Disp(0x00);//LED的初始化</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">count++;</span><br><span class="line"><span class="keyword">if</span>(count==<span class="number">4</span>) &#123;</span><br><span class="line"><span class="built_in">LCD_Init</span>();<span class="comment">//LCD屏的初始化</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(w=<span class="number">0</span>; w&lt;<span class="number">1000</span>; w+=<span class="number">1</span>) &#123;</span><br><span class="line"></span><br><span class="line">TIM3-&gt;CCR3 = w;</span><br><span class="line"><span class="built_in">key_proc</span>();</span><br><span class="line"><span class="comment">//if(key[2].single_flag==0) &#123;</span></span><br><span class="line"><span class="built_in">disp_proc</span>(w);</span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="built_in">HAL_Delay</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (w=<span class="number">1000</span>; w&gt;<span class="number">0</span>; w-=<span class="number">1</span>) &#123;</span><br><span class="line">TIM3-&gt;CCR3 = w;</span><br><span class="line"><span class="built_in">key_proc</span>();</span><br><span class="line"><span class="comment">//if(key[2].single_flag==0) &#123;</span></span><br><span class="line"><span class="built_in">disp_proc</span>(w);</span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="built_in">HAL_Delay</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">  <span class="comment">/* USER CODE END 3 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief System Clock Configuration</span></span><br><span class="line"><span class="comment">  * @retval None</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SystemClock_Config</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  RCC_OscInitTypeDef RCC_OscInitStruct = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">  RCC_ClkInitTypeDef RCC_ClkInitStruct = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** Configure the main internal regulator output voltage</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="built_in">HAL_PWREx_ControlVoltageScaling</span>(PWR_REGULATOR_VOLTAGE_SCALE1);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** Initializes the RCC Oscillators according to the specified parameters</span></span><br><span class="line"><span class="comment">  * in the RCC_OscInitTypeDef structure.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSE;</span><br><span class="line">  RCC_OscInitStruct.HSEState = RCC_HSE_ON;</span><br><span class="line">  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;</span><br><span class="line">  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSE;</span><br><span class="line">  RCC_OscInitStruct.PLL.PLLM = RCC_PLLM_DIV3;</span><br><span class="line">  RCC_OscInitStruct.PLL.PLLN = <span class="number">20</span>;</span><br><span class="line">  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;</span><br><span class="line">  RCC_OscInitStruct.PLL.PLLQ = RCC_PLLQ_DIV2;</span><br><span class="line">  RCC_OscInitStruct.PLL.PLLR = RCC_PLLR_DIV2;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">HAL_RCC_OscConfig</span>(&amp;RCC_OscInitStruct) != HAL_OK)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">Error_Handler</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** Initializes the CPU, AHB and APB buses clocks</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK</span><br><span class="line">                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;</span><br><span class="line">  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;</span><br><span class="line">  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;</span><br><span class="line">  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV1;</span><br><span class="line">  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV1;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">HAL_RCC_ClockConfig</span>(&amp;RCC_ClkInitStruct, FLASH_LATENCY_2) != HAL_OK)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">Error_Handler</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE BEGIN 4 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**********按键1切换屏幕显示模式**********/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">key_proc</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span>(key[<span class="number">0</span>].single_flag==<span class="number">1</span>) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(view==<span class="number">3</span>) &#123;</span><br><span class="line">view=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">view++;</span><br><span class="line"><span class="built_in">LCD_Init</span>();<span class="comment">//LCD屏的初始化</span></span><br><span class="line"><span class="built_in">LCD_Clear</span>(Black );</span><br><span class="line"></span><br><span class="line">key[<span class="number">0</span>].single_flag=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(key[<span class="number">1</span>].single_flag==<span class="number">1</span>) &#123;</span><br><span class="line">DutyCycle2 = (TIM3-&gt;CCR3+<span class="number">1</span>)/(TIM3-&gt;CCR4 + <span class="number">1</span>)<span class="number">-1</span>;</span><br><span class="line">DutyCycle3 = (TIM16-&gt;CCR1+<span class="number">1</span>)/(TIM16-&gt;CCR2 + <span class="number">1</span>)<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key[<span class="number">1</span>].single_flag=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">disp_proc</span><span class="params">(<span class="type">uint32_t</span> i)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span>(view==<span class="number">1</span>) &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//LCD_Init();//LCD屏的初始化</span></span><br><span class="line"><span class="comment">//LED_Disp(0x00);//LED的初始化</span></span><br><span class="line"><span class="comment">//LCD_Clear(Black);</span></span><br><span class="line"><span class="built_in">led</span>(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="built_in">led</span>(<span class="number">3</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> DutyCycle = (TIM3-&gt;CCR3+<span class="number">1</span>)/(TIM3-&gt;CCR4 + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> m=i/<span class="number">10</span>;</span><br><span class="line"><span class="type">char</span> text1[<span class="number">30</span>];</span><br><span class="line"><span class="built_in">snprintf</span>(text1,<span class="number">30</span>,<span class="string">&quot;       Breath       &quot;</span>);</span><br><span class="line"><span class="built_in">LCD_DisplayStringLine</span>(Line1,(<span class="type">uint8_t</span> *)text1);</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> texta[<span class="number">30</span>];</span><br><span class="line"><span class="built_in">snprintf</span>(texta,<span class="number">30</span>,<span class="string">&quot;   Duty_ratio:%d%%   &quot;</span>,DutyCycle/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">LCD_DisplayStringLine</span>(Line5,(<span class="type">uint8_t</span> *)texta);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(view==<span class="number">2</span>) &#123;</span><br><span class="line"><span class="comment">//LED_Disp(0x00);//LED的初始化</span></span><br><span class="line"><span class="comment">//HAL_StatusTypeDef HAL_TIM_PWM_Stop_IT(&amp;htim3,TIM_CHANNEL_3);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//LCD_Clear(Black);</span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> text2[<span class="number">30</span>];</span><br><span class="line"><span class="built_in">snprintf</span>(text2,<span class="number">30</span>,<span class="string">&quot;         R37        &quot;</span>);</span><br><span class="line"><span class="built_in">LCD_DisplayStringLine</span>(Line1,(<span class="type">uint8_t</span> *)text2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n=<span class="number">100</span>*(<span class="number">1</span>-(<span class="built_in">getADC</span> (&amp;hadc2)/<span class="number">3.25</span>));</span><br><span class="line">TIM16-&gt;CCR1 = n;</span><br><span class="line"><span class="type">int</span> DutyCycle = (TIM16-&gt;CCR1+<span class="number">1</span>)/(TIM16-&gt;CCR2 + <span class="number">1</span>)<span class="number">-1</span>;</span><br><span class="line"><span class="type">char</span> textb[<span class="number">30</span>];</span><br><span class="line"><span class="built_in">snprintf</span>(textb,<span class="number">30</span>,<span class="string">&quot;   Duty_ratio:%d%%  &quot;</span>,DutyCycle);</span><br><span class="line"><span class="built_in">LCD_DisplayStringLine</span>(Line5,(<span class="type">uint8_t</span> *)textb);</span><br><span class="line"><span class="comment">/**********led闪烁**********/</span></span><br><span class="line"><span class="built_in">led</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">HAL_GetTick</span>()-tempCnt&gt;<span class="number">500</span>) &#123;</span><br><span class="line"><span class="built_in">HAL_GPIO_TogglePin</span> (GPIOC,GPIO_PIN_9);</span><br><span class="line">tempCnt =<span class="built_in">HAL_GetTick</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**********led闪烁**********/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(view==<span class="number">3</span>) &#123;</span><br><span class="line"><span class="comment">//LED_Disp(0x00);//LED的初始化</span></span><br><span class="line"><span class="built_in">led</span>(<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">led</span>(<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> text2[<span class="number">30</span>];</span><br><span class="line"><span class="built_in">snprintf</span>(text2,<span class="number">30</span>,<span class="string">&quot;       Record       &quot;</span>);</span><br><span class="line"><span class="built_in">LCD_DisplayStringLine</span> (Line1,(<span class="type">uint8_t</span> *)text2);</span><br><span class="line"></span><br><span class="line"><span class="comment">//int DutyCycle1 = (TIM16-&gt;CCR1+1)/(TIM16-&gt;CCR2 + 1)-1;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//int m=i/10;</span></span><br><span class="line"><span class="comment">//LCD_Clear(Black);</span></span><br><span class="line"><span class="type">char</span> textb[<span class="number">30</span>];</span><br><span class="line"><span class="built_in">snprintf</span>(textb,<span class="number">30</span>,<span class="string">&quot;      Breath:%d%%     &quot;</span>,DutyCycle2/<span class="number">10</span> );</span><br><span class="line"><span class="built_in">LCD_DisplayStringLine</span>(Line4,(<span class="type">uint8_t</span> *)textb);</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> textc[<span class="number">30</span>];</span><br><span class="line"><span class="built_in">snprintf</span>(textc,<span class="number">30</span>,<span class="string">&quot;       R37:%d%%       &quot;</span>,DutyCycle3 );</span><br><span class="line"><span class="built_in">LCD_DisplayStringLine</span>(Line6,(<span class="type">uint8_t</span> *)textc);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* USER CODE END 4 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  This function is executed in case of error occurrence.</span></span><br><span class="line"><span class="comment">  * @retval None</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Error_Handler</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">/* USER CODE BEGIN Error_Handler_Debug */</span></span><br><span class="line"><span class="comment">/* User can add his own implementation to report the HAL error return state */</span></span><br><span class="line">__disable_irq();</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">&#125;</span><br><span class="line">  <span class="comment">/* USER CODE END Error_Handler_Debug */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span>  USE_FULL_ASSERT</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  Reports the name of the source file and the source line number</span></span><br><span class="line"><span class="comment">  *         where the assert_param error has occurred.</span></span><br><span class="line"><span class="comment">  * @param  file: pointer to the source file name</span></span><br><span class="line"><span class="comment">  * @param  line: assert_param error line source number</span></span><br><span class="line"><span class="comment">  * @retval None</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">assert_failed</span><span class="params">(<span class="type">uint8_t</span> *file, <span class="type">uint32_t</span> line)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">/* USER CODE BEGIN 6 */</span></span><br><span class="line"><span class="comment">/* User can add his own implementation to report the file name and line number,</span></span><br><span class="line"><span class="comment">   ex: printf(&quot;Wrong parameters value: file %s on line %d\r\n&quot;, file, line) */</span></span><br><span class="line">  <span class="comment">/* USER CODE END 6 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">/* USE_FULL_ASSERT */</span></span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details open><summary pointer> led </summary>              <div class='content'>              <details open><summary pointer> led.h </summary>              <div class='content'>              <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _LED_H_</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _LED_H_</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">led</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> a)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">LED_Disp</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> dsLED)</span></span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>              </div>            </details><details open><summary pointer> led.c </summary>              <div class='content'>              <figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#include</span> &quot;led<span class="selector-class">.h</span>&quot;</span><br><span class="line"></span><br><span class="line">void <span class="built_in">led</span>(int x,int a)</span><br><span class="line">&#123;</span><br><span class="line">int pin;</span><br><span class="line"><span class="built_in">switch</span>(x)</span><br><span class="line">&#123;</span><br><span class="line">case <span class="number">1</span>:pin=GPIO_PIN_8;break;</span><br><span class="line">case <span class="number">2</span>:pin=GPIO_PIN_9;break;</span><br><span class="line">case <span class="number">3</span>:pin=GPIO_PIN_10;break;</span><br><span class="line">case <span class="number">4</span>:pin=GPIO_PIN_11;break;</span><br><span class="line">case <span class="number">5</span>:pin=GPIO_PIN_12;break;</span><br><span class="line">case <span class="number">6</span>:pin=GPIO_PIN_13;break;</span><br><span class="line">case <span class="number">7</span>:pin=GPIO_PIN_14;break;</span><br><span class="line">case <span class="number">8</span>:pin=GPIO_PIN_15;break;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">if</span>(a==<span class="number">0</span>)<span class="built_in">HAL_GPIO_WritePin</span>(GPIOC,pin,GPIO_PIN_SET);</span><br><span class="line"><span class="built_in">if</span>(a==<span class="number">1</span>)<span class="built_in">HAL_GPIO_WritePin</span>(GPIOC,pin,GPIO_PIN_RESET);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">HAL_GPIO_WritePin</span>(GPIOD,GPIO_PIN_2,GPIO_PIN_SET);</span><br><span class="line"><span class="built_in">HAL_GPIO_WritePin</span>(GPIOD,GPIO_PIN_2,GPIO_PIN_RESET);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">void <span class="built_in">LED_Disp</span>(unsigned char dsLED)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">HAL_GPIO_WritePin</span>(GPIOC,GPIO_PIN_8,GPIO_PIN_SET );</span><br><span class="line">  <span class="built_in">HAL_GPIO_WritePin</span>(GPIOC,GPIO_PIN_9,GPIO_PIN_SET );</span><br><span class="line"><span class="built_in">HAL_GPIO_WritePin</span>(GPIOC,GPIO_PIN_10,GPIO_PIN_SET );</span><br><span class="line"><span class="built_in">HAL_GPIO_WritePin</span>(GPIOC,GPIO_PIN_11,GPIO_PIN_SET );</span><br><span class="line"><span class="built_in">HAL_GPIO_WritePin</span>(GPIOC,GPIO_PIN_12,GPIO_PIN_SET );</span><br><span class="line"><span class="built_in">HAL_GPIO_WritePin</span>(GPIOC,GPIO_PIN_13,GPIO_PIN_SET );</span><br><span class="line"><span class="built_in">HAL_GPIO_WritePin</span>(GPIOC,GPIO_PIN_14,GPIO_PIN_SET );</span><br><span class="line"><span class="built_in">HAL_GPIO_WritePin</span>(GPIOC,GPIO_PIN_15,GPIO_PIN_SET );</span><br><span class="line"></span><br><span class="line"><span class="built_in">HAL_GPIO_WritePin</span>(GPIOC,dsLED&lt;&lt;<span class="number">8</span>,GPIO_PIN_RESET );</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  led(2,0);</span></span><br><span class="line"><span class="comment">//led(3,0);</span></span><br><span class="line"><span class="comment">//led(4,0);</span></span><br><span class="line"><span class="comment">//led(5,0);</span></span><br><span class="line"><span class="comment">//  led(6,0);</span></span><br><span class="line"><span class="comment">//led(7,0);</span></span><br><span class="line"><span class="comment">//led(8,0);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_RESET );</span></span><br><span class="line"><span class="comment">//HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_SET );</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details>              </div>            </details><details open><summary pointer> lcd </summary>              <div class='content'>              <p>比赛资源包里自带</p>              </div>            </details><details open><summary pointer> interrupt </summary>              <div class='content'>              <details open><summary pointer> interrupt.h </summary>              <div class='content'>              <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _INTERRUPT_H_</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _INTERRUPT_H_</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdbool.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">HAL_TIM_PeriodElapsedCallback</span><span class="params">(TIM_HandleTypeDef *htim)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">keys</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> judge_sta;</span><br><span class="line"><span class="type">bool</span> key_sta;</span><br><span class="line"><span class="type">bool</span>  single_flag;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>              </div>            </details><details open><summary pointer> interrupt.c </summary>              <div class='content'>              <figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#include <span class="string">&quot;interrupt.h&quot;</span></span><br><span class="line"></span><br><span class="line">struct keys <span class="built_in">key</span>[<span class="number">4</span>] = &#123;&#123;<span class="number">0</span>, <span class="literal">false</span>,<span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="literal">false</span>, <span class="number">0</span>&#125;,&#123;<span class="number">0</span>, <span class="literal">false</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="literal">false</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line"><span class="comment">//case0判断按钮有没有按下，case1消抖功能，case2判断按钮已经松开</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">HAL_TIM_PeriodElapsedCallback</span>(TIM_HandleTypeDef *htim)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(htim-&gt;Instance==TIM4)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">key</span>[<span class="number">0</span>].<span class="property">key_sta</span>=<span class="title function_">HAL_GPIO_ReadPin</span> (GPIOB,GPIO_PIN_0 );</span><br><span class="line"><span class="built_in">key</span>[<span class="number">1</span>].<span class="property">key_sta</span>=<span class="title function_">HAL_GPIO_ReadPin</span> (GPIOB,GPIO_PIN_1 );</span><br><span class="line"><span class="built_in">key</span>[<span class="number">2</span>].<span class="property">key_sta</span>=<span class="title function_">HAL_GPIO_ReadPin</span> (GPIOB,GPIO_PIN_2 );</span><br><span class="line"><span class="built_in">key</span>[<span class="number">3</span>].<span class="property">key_sta</span>=<span class="title function_">HAL_GPIO_ReadPin</span> (GPIOB,GPIO_PIN_3 );</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="title function_">switch</span> (<span class="built_in">key</span>[i].<span class="property">judge_sta</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">key</span>[i].<span class="property">key_sta</span>==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="built_in">key</span>[i].<span class="property">judge_sta</span>=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">key</span>[i].<span class="property">key_sta</span>==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">key</span>[i].<span class="property">judge_sta</span>=<span class="number">2</span>;</span><br><span class="line"><span class="built_in">key</span>[i].<span class="property">single_flag</span>=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="built_in">key</span>[i].<span class="property">judge_sta</span>=<span class="number">0</span>;</span><br><span class="line">&#125;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">key</span>[i].<span class="property">key_sta</span>==<span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">key</span>[i].<span class="property">judge_sta</span>=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details>              </div>            </details><details open><summary pointer> ADC </summary>              <div class='content'>              <details open><summary pointer> aadc.h </summary>              <div class='content'>              <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">getADC</span><span class="params">(ADC_HandleTypeDef *pin)</span></span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details open><summary pointer> aadc.c </summary>              <div class='content'>              <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;aadc.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">getADC</span><span class="params">(ADC_HandleTypeDef *pin)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> adc;</span><br><span class="line"><span class="built_in">HAL_ADC_Start</span>(pin);</span><br><span class="line">adc=<span class="built_in">HAL_ADC_GetValue</span>(pin);</span><br><span class="line"><span class="keyword">return</span> adc*<span class="number">3.3</span>/<span class="number">4096</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details>              </div>            </details>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式 </tag>
            
            <tag> stm32 </tag>
            
            <tag> 蓝桥杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蓝桥杯stm32学习笔记(三):点亮LED</title>
      <link href="/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%89-%E7%82%B9%E4%BA%AELED/"/>
      <url>/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%89-%E7%82%B9%E4%BA%AELED/</url>
      
        <content type="html"><![CDATA[<div class="note info"><p>开发板芯片：stm32g4rbt6;HAL库开发</p></div><p>接着用(二)中配置好的工程模板</p><h1 id="LED"><a href="#LED" class="headerlink" title="LED"></a>LED</h1><span class='pbg info'>LED电路</span><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7zq60sv69o.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7zq60sv69o.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>LED引脚:<code>PC8-PC15</code><br><code>PD2</code>:锁存器的控制端口</p><h2 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h2><h3 id="使能需要的端口"><a href="#使能需要的端口" class="headerlink" title="使能需要的端口"></a>使能需要的端口</h3><p>依次使能<code>PC8-PC15</code>为<code>GPIO_Output</code></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4ckmdaj16i.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4ckmdaj16i.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>使能<code>PD2</code>为<code>GPIO_Output</code></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1lbk57zxpl.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1lbk57zxpl.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="配置初始引脚电平"><a href="#配置初始引脚电平" class="headerlink" title="配置初始引脚电平"></a>配置初始引脚电平</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.9dcp4v1p14.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.9dcp4v1p14.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>把<code>PC8-PC15</code>的<code>GPIO output level</code>设置为<code>High</code></p><details open><summary pointer> WHY </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.lvgt2uwod.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.lvgt2uwod.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>左边是拉高的（高电平）（（一）中有VDD的介绍）所以当右边是低电平时，有电流通过，LED被点亮。为了初始时是LED是熄灭状态，我们这里把引脚设置成高电平（High）              </div>            </details><span class='pbg info'>PD2:高电平使能，低电平关闭</span><details open><summary pointer> 选项解释 </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.8s31jlgtbg.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.8s31jlgtbg.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><ul><li>Pin Name（引脚名称）: 引脚的标识符，用于区分不同的 GPIO 引脚。</li><li>Signal on Pin（引脚的信号）: 描述该引脚的信号状态，如高电平或低电平。</li><li>GPIO output level（GPIO 输出电平）: GPIO 引脚的输出电平，即引脚输出的信号状态。</li><li>GPIO mode（GPIO 模式）: GPIO 引脚的模式描述，如输入模式或输出模式。</li><li>GPIO Pull-up&#x2F;Pull-down（GPIO 上拉&#x2F;下拉）: 描述是否启用了引脚的上拉或下拉电阻。</li><li>Maximum output speed（最大输出速度）: GPIO 引脚的最大输出速度。</li><li>Fast Mode（快速模式）: 是否启用了 GPIO 的快速模式。</li><li>User Label（用户标签）: 用户自定义的引脚标签。</li><li>Modified（修改）: 描述引脚是否被修改过。</li></ul>              </div>            </details><h3 id="生成工程"><a href="#生成工程" class="headerlink" title="生成工程"></a>生成工程</h3><p><strong>点击右上角”GENERATE CODE”,生成工程</strong></p><h3 id="新建文件"><a href="#新建文件" class="headerlink" title="新建文件"></a>新建文件</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.5tqrg3tfdf.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.5tqrg3tfdf.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p><strong>新建两个文件</strong></p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.73tomfdt6w.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.73tomfdt6w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>保存为<code>led.c</code>和<code>led.h</code>到根目录<code>bsp</code>文件夹中</p><h3 id="添加led-c到项目bsp文件夹中"><a href="#添加led-c到项目bsp文件夹中" class="headerlink" title="添加led.c到项目bsp文件夹中"></a>添加led.c到项目bsp文件夹中</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7i04daq5g5.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7i04daq5g5.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="添加led-h到Include-Paths中"><a href="#添加led-h到Include-Paths中" class="headerlink" title="添加led.h到Include Paths中"></a>添加led.h到Include Paths中</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.lvgt7me5l.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.lvgt7me5l.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h3 id="在main-h里定义类型简写"><a href="#在main-h里定义类型简写" class="headerlink" title="在main.h里定义类型简写"></a>在main.h里定义类型简写</h3><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7smy6kj9gd.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7smy6kj9gd.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><h2 id="LED驱动代码"><a href="#LED驱动代码" class="headerlink" title="LED驱动代码"></a>LED驱动代码</h2><h3 id="led-h"><a href="#led-h" class="headerlink" title="led.h"></a>led.h</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _LED_H_</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _LED_H_</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LED_Disp</span><span class="params">(uchar dsLED)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><details open><summary pointer> 详细解释 </summary>              <div class='content'>              <p>这段代码是 C&#x2F;C++ 中的预处理器指令，用于条件编译。在这段代码中：</p><ul><li><code>#ifndef _LED_H</code>_ 表示如果 <code>_LED_H_</code> 这个宏未定义，则执行下面的代码。在这里，通常用来防止头文件的重复包含，确保头文件只被包含一次。</li><li><code>#define _LED_H_</code> 定义了宏 <code>_LED_H_</code>，用来标识这个头文件已经被包含。</li><li><code>#endif</code> 表示条件编译的结束。<br>下划线（<code>_</code>）在 C&#x2F;C++ 中表示前缀保留给编译器和标准库来使用的标识符。在这里的 <code>_LED_H_</code> 用来表示这个头文件的宏定义，以避免可能的命名冲突。</li></ul><p>具体来讲，当第一次包含头文件时，该宏会被定义，防止再次包含；后续再次尝试包含同一头文件时，在文件一开始检查该宏是否已经定义，如果已经定义了，就不再进行实际的代码包含，从而避免了头文件的重复定义和引用。这是一种常见的防止头文件重复包含的做法，通常称为“头文件保护”，也可以使用其他形式的宏标识来实现同样的效果。</p>              </div>            </details><h3 id="led-c"><a href="#led-c" class="headerlink" title="led.c"></a>led.c</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;led.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LED_Disp</span><span class="params">(uchar dsLED)</span></span><br><span class="line">&#123;</span><br><span class="line">HAL_GPIO_WritePin(GPIOC,GPIO_PIN_All,GPIO_PIN_SET);</span><br><span class="line">HAL_GPIO_WritePin(GPIOC,dsLED&lt;&lt;<span class="number">8</span>,GPIO_PIN_RESET);</span><br><span class="line">HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_SET);</span><br><span class="line">HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_RESET);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><details open><summary pointer> HAL_GPIO_WritePin </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.67x774nyem.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.67x774nyem.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><ul><li><details open><summary pointer> ①GPIO_TypeDef </summary>            <div class='content'>            <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.51dvyj4mt8.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.51dvyj4mt8.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><span class='pbg info'>类型定义结构体，定义了一些寄存器的名称</span><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.45f4pqkpy.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.45f4pqkpy.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class="lazyload placeholder" data-srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>这段代码使用了宏定义来定义了一系列的GPIO端口，将它们映射到对应的基地址上，并将其类型转换为GPIO_TypeDef*类型。<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">WHY转换为GPIO_TypeDef*类型:</span></span><br><span class="line">每个GPIO端口在微控制器中都有与之相关联的寄存器。这些寄存器通常用于</span><br><span class="line">配置和控制对应的GPIO端口，包括设置引脚的输入/输出状态、设置引脚的</span><br><span class="line">电平状态、配置引脚的中断等功能。</span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.45hej3wglg.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.45hej3wglg.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><span class='pbg info'>AHB和APB</span><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">AHB(Advanced High-performance <span class="keyword">Bus), </span>高速总线，用来接高速外设的。</span><br><span class="line">APB (Advanced Peripheral <span class="keyword">Bus) </span>低速总线，用来接低速外设的。</span><br><span class="line">总线（<span class="keyword">Bus） </span></span><br><span class="line">是计算机各种功能部件之间传送信息的 公共通信干线</span><br><span class="line">如果说 主板（Mother <span class="keyword">Board）是一座城市，那么 </span>总线 </span><br><span class="line">就像是城市里的公共汽车（<span class="keyword">bus），</span></span><br><span class="line"><span class="keyword"></span>能按照固定行车路线，传输来回不停运作的比特（<span class="keyword">bit）</span></span><br><span class="line"><span class="keyword"></span>按照计算机所传输的 信息种类，计算机的总线</span><br><span class="line">可以划分为 数据总线、地址总线 和 控制总线，</span><br><span class="line">分别用来传输数据、数据地址和控制信号</span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.lttrcyxg.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.lttrcyxg.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>                </div>          </details></li></ul><ul><li><details open><summary pointer> uint16_t </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1aoqdb3yi7.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1aoqdb3yi7.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>无符号短整型，占用16位（即2个字节）的内存空间。在C和C++中，uint16_t通常用来表示无符号的16位整数。这样定义便于代码的可读性和移植性，因为不同平台下这样的数据类型大小可能会有所不同，这样可以确保uint16_t始终表示一个16位的无符号整数。              </div>            </details></li><li><details open><summary pointer> ③ GPIO_PinState </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @brief  GPIO Bit SET and Bit RESET enumeration</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">GPIO_PIN_RESET = <span class="number">0U</span>,</span><br><span class="line">GPIO_PIN_SET</span><br><span class="line">&#125; GPIO_PinState;</span><br></pre></td></tr></table></figure><p>这段代码定义了一个枚举类型<code>GPIO_PinState</code>，其中包含了两个枚举常量<code>GPIO_PIN_RESET</code>和<code>GPIO_PIN_SET</code>。在这个枚举类型中，<code>GPIO_PIN_RESET</code>被赋值为0，而<code>GPIO_PIN_SET</code>未被显式赋值，它将自动被赋值为上一个枚举常量的值加1，即为1。这种简单的枚举类型通常用于表示开关状态、传感器状态等具有两种状态的情况。<code>GPIO_PIN_RESET</code>表示GPIO引脚复位状态，<code>GPIO_PIN_SET</code>表示GPIO引脚设置状态。</p>              </div>            </details></li><li><details open><summary pointer> ④ assert_param(IS_GPIO_PIN(GPIO_Pin)); </summary>              <div class='content'>              <p><strong>IS_GPIO_PIN()</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> IS_GPIO_PIN(__PIN__)        ((((uint32_t)(__PIN__) &amp; GPIO_PIN_MASK) != 0x00U) &amp;&amp;\</span></span><br><span class="line"><span class="meta">                             (((uint32_t)(__PIN__) &amp; ~GPIO_PIN_MASK) == 0x00U))</span></span><br></pre></td></tr></table></figure><p>这段代码片段是用于定义一个宏（macro），用于验证给定的GPIO引脚<br>是否有效。让我们来解释一下这段代码的含义：</p><ol><li><code>#define IS_GPIO_PIN(__PIN__)</code>：这里定义了一个名为<br><code>IS_GPIO_PIN</code>的宏，用于判断给定的GPIO引脚是否有效。</li><li><code>((((uint32_t)(__PIN__) &amp; GPIO_PIN_MASK) != 0x00U)</code>：<br>这部分代码是对给定引脚进行位运算，通过AND操作符<code>&amp;</code>与<br><code>GPIO_PIN_MASK</code>进行比较，判断是否至少有一个位与操作结果不为0。</li><li><code>&amp;&amp;</code>：这里使用逻辑与运算符，确保两个条件都满足。</li><li><code>(((uint32_t)(__PIN__) &amp; ~GPIO_PIN_MASK) == 0x00U))</code>：<br>这部分代码将给定的引脚与取反的<code>GPIO_PIN_MASK</code>进行AND操作，<br>判断是否所有位均为0。<br><strong>assert_param()</strong><br> 简单地讲，断言就是对某种假设条件进行检查。 在 C 语言中，断言被定义<br>为宏的形式（assert(expression)），而不是函数，其原型定义在<br>&lt;assert.h&gt; 文件中。其中，assert 将通过检查表达式 expression<br>的值来决定是否需要终止执行程序。也就是说，如果表达式 expression<br>的值为假（即为 0），那么它将首先向标准错误流 stderr打印一条<br>出错信息，然后再通过调用 abort 函数终止程序运行；否则，assert<br>无任何作用。<div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.60tzbrj4hl.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.60tzbrj4hl.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li></ol>              </div>            </details></li><li><details open><summary pointer> ⑤ GPIO_PIN_RESET </summary>              <div class='content'>              <p>GPIO_PinState里的一个枚举常量：GPIO_PIN_RESET被赋值为0，表示GPIO引脚复位状态</p>              </div>            </details></li><li><details open><summary pointer> ⑥ GPIOx->BSRR </summary>              <div class='content'>              <blockquote><p>点运算符( . )的左边操作数是一个结果为结构的表达式;箭头运算符( -&gt; )的左边的操作数是一个指向结构体的指针。<br>ORD,BSRR,BRR寄存器的作用是对已经初始化后的 IO 口输出高、低电平。</p></blockquote><p>ODR寄存器可读可写，32位，既能控制管脚为高电平，也能控制管脚为低电平。GPIO管脚对于位写1为高电平，写 0 为低电平。（低 16 位用于设置 GPIO 口对应位输出高&#x2F;低电平。高 16 位保留地址，读写无效。）</p><p>BSRR寄存器 称为端口位设置&#x2F;清除寄存器，只写寄存器，32位,既能控制管脚为高电平，也能控制管脚为低电平 ，对寄存器高 16位 写1 对应管脚为低电平，对寄存器低16位写1对应管脚为高电平。写 0 ,无动作</p><p>BRR寄存器称为端口位清除寄存器，只写寄存器，32位,只能改变管脚状态为低电平 ，寄存器管脚对应位写 1 相应管脚会变为低电平。写 0 无动作。（BRR低 16 位用于设置 GPIO 口对应位输出低电平。高 16 位保留地址，读写无效。）</p><p>所以理论上来讲，BRR 寄存器的功能（低16位）和 BSRR 寄存器高 16 位的功能是一样的。<br>(未完待续)等这些弄完了系统学习一下stm32g431的寄存器什么的</p>              </div>            </details></li><li><details open><summary pointer> ⑦ GPIO_PIN_RESET </summary>              <div class='content'>              <p>这段代码片段看起来是在STM32的嵌入式程序中用来控制GPIO引脚输出状态的。让我来解释一下这段代码的功能：</p><p>PinState !&#x3D; GPIO_PIN_RESET: 这个条件判断语句检查了一个名为PinState的变量是否不等于GPIO_PIN_RESET。这里预期PinState是一个表示 GPIO 引脚状态（高电平或低电平）的变量。</p><p>如果PinState不等于GPIO_PIN_RESET，则执行下面的代码块：<br>GPIOx-&gt;BSRR &#x3D; (uint32_t)GPIO_Pin;：这行代码是在将指定的GPIO引脚置高。 BSRR（Bit Set Reset Register）是一个寄存器，通过写入相应的引脚位来将指定的引脚置高。</p><p>如果PinState等于GPIO_PIN_RESET，则执行下面的代码块：<br>GPIOx-&gt;BRR &#x3D; (uint32_t)GPIO_Pin;：这行代码是在将指定的GPIO引脚置低。BRR（Bit Reset Register）是一个寄存器，通过写入相应的引脚位来将指定的引脚置低。</p>              </div>            </details></li></ul>              </div>            </details><p>BTW,上面那个led.c代码是课里写的，我不太喜欢用，感觉不太好用，我就用我学51的时候用的led函数思想写了一个（我考核的时候就用的自己的，很直观，而且没出什么问题）</p><details open><summary pointer> led.c </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">led</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> a)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> pin;</span><br><span class="line">HAL_GPIO_WritePin(GPIOC,GPIO_PIN_All,GPIO_PIN_SET);</span><br><span class="line"><span class="keyword">switch</span>(x)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:pin=GPIO_PIN_8;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:pin=GPIO_PIN_9;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:pin=GPIO_PIN_10;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:pin=GPIO_PIN_11;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:pin=GPIO_PIN_12;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span>:pin=GPIO_PIN_13;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">7</span>:pin=GPIO_PIN_14;<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">8</span>:pin=GPIO_PIN_15;<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(a==<span class="number">0</span>)HAL_GPIO_WritePin(GPIOC,pin,GPIO_PIN_SET);</span><br><span class="line"><span class="keyword">if</span>(a==<span class="number">1</span>)HAL_GPIO_WritePin(GPIOC,pin,GPIO_PIN_RESET);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_SET);</span><br><span class="line">HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,GPIO_PIN_RESET);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>就是八个led，第一个参是led代号（1-8），第二个是开或关（0关，1开）;<br>最后两行要开关寄存器，开了之后一瞬间就过去了，然后关上就行了（不细说了，没时间了）</p>              </div>            </details><p><strong>led闪烁(引脚状态反转)：</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(HAL_GetTick()-tempCnt&gt;<span class="number">500</span>) &#123;</span><br><span class="line">HAL_GPIO_TogglePin (GPIOC,GPIO_PIN_9);</span><br><span class="line">tempCnt =HAL_GetTick();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式 </tag>
            
            <tag> stm32 </tag>
            
            <tag> 蓝桥杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蓝桥杯stm32学习笔记(二):工程模板建立</title>
      <link href="/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/"/>
      <url>/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/</url>
      
        <content type="html"><![CDATA[<div class="note info"><p>开发板芯片：stm32g4rbt6;HAL库开发</p></div><div class="timeline"><div class="timenode"><div class="meta"><p><p>第一步 <a href="https://tumytime.space/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/">新建工程</a></p></p></div><div class="body"><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3ye6m3fcyj.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3ye6m3fcyj.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></div></div><div class="timenode"><div class="meta"><p><p>第二步 <a href="https://tumytime.space/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/">选择芯片</a></p></p></div><div class="body"><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7w6k2rzwfo.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7w6k2rzwfo.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>然后右上角"Start Project"</div></div><div class="timenode"><div class="meta"><p><p>第三步 <a href="https://tumytime.space/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/">打开高速外部时钟</a></p></p></div><div class="body"><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2krni340qq.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2krni340qq.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><details open><summary pointer> 详细介绍 </summary>              <div class='content'>              <details ><summary pointer> System Core </summary>              <div class='content'>              <p>“System Core”（系统核心）是指计算机系统或嵌入式系统中的主要核心部分，负责执行系统的基本功能和控制整体系统的运行。在嵌入式系统中，System Core通常是指主控制器或主处理器（MCU&#x2F;Microcontroller、CPU）以及与之相关的关键功能模块，如时钟系统、存储器管理、中断控制、通信接口等。</p><ol><li><p><strong>DMA (Direct Memory Access)</strong>:</p><ul><li><strong>作用</strong>：DMA是一种数据传输技术，允许外设在不干扰CPU的情况下直接访问系统内存。</li></ul></li><li><p><strong>GPIO (General Purpose Input&#x2F;Output)</strong>:</p><ul><li><strong>作用</strong>：GPIO是通用输入输出，用于连接和控制外部设备，例如传感器、执行器等。</li></ul></li><li><p><strong>IWDG (Independent Watchdog)</strong>:</p><ul><li><strong>作用</strong>：IWDG是一个独立的看门狗定时器，用于监控系统崩溃或卡死的情况，并在检测到问题时采取相应的措施。</li></ul></li><li><p><strong>NVIC (Nested Vector Interrupt Controller)</strong>:</p><ul><li><strong>作用</strong>：NVIC是用于管理中断请求及优先级的控制器，负责处理系统中的各种中断事件。</li></ul></li><li><p><strong>RCC (Reset and Clock Control)</strong>:</p><ul><li><strong>作用</strong>：RCC用于控制系统的复位和<span class='pbg info'>时钟设置</span>，包括配置处理器的工作频率和外设时钟等。</li></ul></li><li><p><strong>SYS（System）</strong>:</p><ul><li><strong>作用</strong>：系统核心，通常指嵌入式系统中的主要功能模块，包括系统时钟、复位、中断控制等核心功能。</li></ul></li><li><p><strong>WWDG (Window Watchdog)</strong>:</p><ul><li><strong>作用</strong>：WWDG是一种看门狗定时器，专用于监测特定时间范围内的系统操作，确保系统在规定的时间内正常运行。</li></ul></li></ol><p>RCC和SYS里都有时钟，他们的区别：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">在嵌入式系统中，RCC（Reset and Clock Control）和SYS（System）这</span><br><span class="line">两个模块通常负责系统的时钟控制和核心功能管理，它们之间的主要区别在</span><br><span class="line">于功能和职责上的不同：</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> RCC（Reset and Clock Control）：</span><br><span class="line"><span class="bullet">   -</span> RCC模块主要负责系统的时钟控制和管理，包括配置各种时钟源、设置</span><br><span class="line">   时钟分频器、选择系统时钟源、控制时钟输出等功能。</span><br><span class="line"><span class="bullet">   -</span> RCC模块的重点在于处理系统的时钟信号，确保系统各个部分按时钟信</span><br><span class="line">   号同步工作，保证系统的稳定性和性能。</span><br><span class="line"><span class="bullet">   -</span> RCC通常用于对系统的时钟进行配置和管理，以确保系统各个模块能够</span><br><span class="line">   按照正确的时钟信号工作。</span><br><span class="line"></span><br><span class="line"><span class="bullet">2.</span> SYS（System）：</span><br><span class="line"><span class="bullet">   -</span> SYS模块通常是指嵌入式系统中的主要功能模块，包括系统核心功能、</span><br><span class="line">   复位控制、中断处理、时钟初始化等。</span><br><span class="line"><span class="bullet">   -</span> SYS模块的职责更多是系统的整体管理和控制，包括处理系统级的复位</span><br><span class="line">   请求、配置系统核心功能模块、管理中断控制器等。</span><br><span class="line"><span class="bullet">   -</span> SYS模块通常负责系统的初始化和管理工作，确保系统各个模块正常工</span><br><span class="line">   作，实现系统的整体功能。</span><br><span class="line"></span><br><span class="line">总的来说，RCC（时钟控制）主要处理系统的时钟信号，而SYS（系统）则更</span><br><span class="line">多涉及系统的核心功能和整体管理。在系统设计和开发中，这两个模块通常</span><br><span class="line">需要协同工作，以确保系统的时钟正常运行并管理系统的核心功能模块。</span><br></pre></td></tr></table></figure>              </div>            </details><details ><summary pointer> 时钟选择原因 </summary>              <div class='content'>              <p>高速时钟(HSE和HSI)提供给芯片主体的主时钟.低速时钟(LSE和LSI)只是提供给芯片中的RTC(实时时钟)及独立看门狗使用</p><ul><li><p>选择High Speed Clock (HSE) 作为单片机的时钟源有以下几个常见原因：</p><ol><li><p>高性能：High Speed Clock (HSE) 具有较高的时钟频率，适用于需要高性能处理的应用，例如高速数据处理、高速通信等。高速时钟可以提高系统的运行速度和响应能力。</p></li><li><p>灵活性：HSE 可以提供多种可选择的时钟频率，用户可以根据实际应用的需要进行灵活配置。通过选择适合的时钟频率，可以更好地优化系统性能。</p></li><li><p>高精度：HSE 通常具有较高的时钟精度和稳定性，适用于对时钟要求严格的应用，例如需要高精度测量或同步的系统。</p></li><li><p>外设兼容性：一些外部设备或模块可能要求使用高速时钟，因此选择HSE 可以更好地与这些外设兼容，确保系统稳定运行。</p></li><li><p>高速通信：在需要进行高速数据传输或通信的场景中，选择HSE 可以更好地满足通信的需求，确保数据传输的稳定性和速度。</p></li></ol></li><li><p>选择Crystal&#x2F;Ceramic Resonator的原因：</p><ol><li><p>稳定性：Crystal&#x2F;Ceramic Resonator 提供了比普通晶体振荡器更高的稳定性和精度。这对于需要精确时钟的应用非常重要，如通讯系统、精密测量仪器等。</p></li><li><p>抗干扰性：Crystal&#x2F;Ceramic Resonator 在晶体振荡器中包裹了陶瓷封装，可以有效地抵抗外部干扰和振荡器的温度变化。这使得它在工作时更加稳定可靠。</p></li><li><p>频率精度：Crystal&#x2F;Ceramic Resonator 可以提供非常精确的频率输出，通常具有很小的频率误差，满足一些对时钟频率要求非常高的应用。</p></li><li><p>适用范围广：Crystal&#x2F;Ceramic Resonator 可以满足多种时钟频率的需求，可以选择不同的晶振频率来适应不同的应用场景。</p></li></ol></li></ul>              </div>            </details><details ><summary pointer> 配置完后右边两个引脚自动使能 </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7p10w38yw.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7p10w38yw.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p>在这里，RCC_OSC_IN 和 RCC_OSC_OUT 是指单片机（通常是指的STM32系列单片机）的时钟源输入和输出引脚。这两个引脚通常用于连接外部晶振或者外部时钟源，以提供系统的时钟。</p><ul><li><p>RCC_OSC_IN 是指单片机的外部时钟源输入引脚，用于连接外部晶振或者外部时钟源。这个引脚接收外部时钟信号，将其传递给单片机的时钟模块，用作系统时钟源。</p></li><li><p>RCC_OSC_OUT 是指单片机的外部时钟源输出引脚，通常在使用外部晶振时，此引脚为晶振输出引脚。通过此引脚可以输出晶振的时钟信号，连接到其他外部设备或者模块中。</p></li></ul><p>“OSC”通常是“oscillator（振荡器）”的缩写。在电子领域，振荡器是一种电路或设备，用于在没有外部激励的情况下产生周期性的信号或波形。这种周期性的信号通常用于驱动其他电路或设备，例如用作时钟信号或者同步信号。</p><p>振荡器在电子设备中起到非常重要的作用，特别是在数字系统中，振荡器通常用来提供系统时钟。一些常见的振荡器类型包括晶体振荡器（Crystal oscillator）、陶瓷谐振器（Ceramic resonator）、RC振荡器（RC oscillator）等。</p><p>晶体振荡器是最常见的一种振荡器，使用晶体作为振荡元件，提供高精度和稳定的时钟信号。陶瓷谐振器通常比晶体振荡器便宜，但精度和稳定性可能没有晶体振荡器好。而RC振荡器则使用电阻和电容构成简单的振荡电路，适用于一些低要求的应用。</p><p>因此，当提到“OSC”时，通常是指一个振荡器或者相关的振荡器电路。</p>              </div>            </details>              </div>            </details></div></div><div class="timenode"><div class="meta"><p><p>第四步 <a href="https://tumytime.space/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/">配置时钟树</a></p></p></div><div class="body"><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1754e4p6ge.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1754e4p6ge.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>第④步写入80后按回车键，其他项自动配置<details open><summary pointer> 详细介绍 </summary>              <div class='content'>              <div class="tagLink"><a class="link-card" title="STM32的5个时钟源知识" href="https://zhuanlan.zhihu.com/p/138661512"><span class="link-card-backdrop" style="background-image: url(https://pic1.zhimg.com/80/v2-0ba05516dcec7c23fc5365e31015a938_720w.webp)"></span><div class="left"><img src="https://pic1.zhimg.com/80/v2-0ba05516dcec7c23fc5365e31015a938_720w.webp" class="lazyload placeholder" data-srcset="https://pic1.zhimg.com/80/v2-0ba05516dcec7c23fc5365e31015a938_720w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">STM32的5个时钟源知识</p><p class="url">https://zhuanlan.zhihu.com/p/138661512</p></div></a></div>众所周知STM32有5个时钟源HSI、HSE、LSI、LSE、PLL，其实他只有四个，因为从上图中可以看到PLL都是由HSI或HSE提供的。<p>　　其中，高速时钟(HSE和HSI)提供给芯片主体的主时钟.低速时钟(LSE和LSI)只是提供给芯片中的RTC(实时时钟)及独立看门狗使用，图中可以看出高速时钟也可以提供给RTC。</p><p>　　内部时钟是在芯片内部RC振荡器产生的，起振较快，所以时钟在芯片刚上电的时候，默认使用内部高速时钟。而外部时钟信号是由外部的晶振输入的，在精度和稳定性上都有很大优势，所以上电之后我们再通过软件配置，转而采用外部时钟信号.</p><details ><summary pointer> ① Input frequency </summary>              <div class='content'>              <p><span class='pbg info'>就是（一）中写到的晶振频率（24MHz）</span><br>在单片机或微控制器的时钟树中，input frequency指的是作为时钟源输入到微控制器的时钟信号的频率。这个输入频率通常是外部提供的，并且可以是一个稳定的振荡器输出，比如晶体振荡器或者陶瓷谐振器输出的频率。</p><p>时钟信号的频率对于单片机的正常运行非常重要，因为它们用来控制单片机内部各个模块的操作和时序。单片机的内部时钟系统会通过时钟树将外部输入的时钟信号进行分频、倍频等处理，以产生用于不同模块的时钟信号。</p><p>在设计单片机系统时，需要根据单片机器件规格书提供的要求来选择适合的input frequency。不同的单片机可能对时钟信号的输入频率有不同的要求，一般会有最小和最大的输入频率范围。选择恰当的输入频率可以确保单片机正常运行并获得最佳性能。</p>              </div>            </details><details ><summary pointer> ② PLL Source Mux </summary>              <div class='content'>              <ul><li>PLL source Mux是指在一些带有PLL（Phase-Locked Loop，相位锁定环）的芯片中的一个功能模块。PLL source Mux通常是一个用于选择PLL输入源的多路复用器（Mux，Multiplexer），允许用户从多个不同的时钟源中选择一个作为PLL的输入源。</li></ul><p>在数字电路设计中，PLL被用来产生一个稳定的、精确的时钟信号。通过调节PLL的反馈回路，可以使得PLL的输出时钟频率与输入时钟频率保持精确的整数倍关系。PLL source Mux的作用是允许用户选择不同的输入时钟源，这样可以在不同的工作模式下选择最适合的时钟源，从而调整PLL的工作频率或者其他参数。</p><p>通过PLL source Mux，用户可以灵活地选择外部时钟源、内部时钟源或者其他信号源作为PLL的输入信号，以满足不同的应用需求。这样就实现了在同一芯片内部对时钟输入源进行切换和选择的功能。</p><ul><li>HSI振荡器与HSE的区别就在于一个是内部的时钟源，一个是外部的时钟源，Inside与External。</li></ul>              </div>            </details><details ><summary pointer> ③ System Clock Mux </summary>              <div class='content'>              <p>在选择时钟源时需要考虑系统的性能需求和功耗优化等因素。在HSI（High-Speed Internal），HSE（High-Speed External），和PLLCLK（Phase-Locked Loop Clock）这三个选项中选择PLLCLK的原因可以包括以下几点：</p><ol><li><p>高性能：PLLCLK通过锁相环技术可以生成高频率的稳定时钟信号，通常可以提供比HSI和HSE更高的时钟频率。这在一些高性能需求的系统中是非常重要的。</p></li><li><p>灵活性：选择PLLCLK作为系统时钟源可以提供更大的灵活性，可以通过设置PLL的分频器和倍频器来满足系统对时钟频率的特定需求，从而在不同场景下灵活调整系统的性能指标。</p></li><li><p>容错性：PLLCLK可以通过外部时钟源（如晶振）提供更好的抗干扰性能，因此在一些对系统稳定性有要求的场合，选择PLLCLK作为时钟源可能更为合适。</p></li></ol>              </div>            </details><details ><summary pointer> ④ HCLK </summary>              <div class='content'>              <p><span class='pbg info'>范围内都可以，但是蓝桥杯官方例程中一般设为80</span><br>HCLK是嵌入式系统中常见的一个术语，指的是主系统时钟（Master Clock），也称为主总线时钟（Master Bus Clock）。HCLK是处理器核心和大多数系统总线和外设的主要工作时钟，控制系统中大多数部件的操作，用于同步各个部件的工作。在嵌入式系统中，HCLK的频率通常是其他外设时钟频率的倍数。</p>              </div>            </details>              </div>            </details></div></div><div class="timenode"><div class="meta"><p><p>第五步 <a href="https://tumytime.space/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/">调试接口选择</a></p></p></div><div class="body"><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.lvgru965c.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.lvgru965c.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><details open><summary pointer> 详细介绍 </summary>              <div class='content'>              <p>在单片机的系统配置中，选择使用Serial Wire（串行线）进行调试有以下几个主要原因：</p><ol><li><p><strong>简化连接</strong>: Serial Wire Debug（SWD）是一种只需使用两根线（SWDIO和SWCLK）即可进行调试的接口，相比于JTAG接口需要更多的引脚和连接线，使用Serial Wire可以减少连接布线的复杂性。</p></li><li><p><strong>性能优势</strong>: 由于JTAG接口需要更多的引脚和数据线，可能会产生一些性能瓶颈。相比之下，Serial Wire接口更为简单，可以提供更高的性能。</p></li><li><p><strong>低功耗</strong>: Serial Wire接口通常比JTAG接口消耗更少的功耗，这对于嵌入式系统中对功耗要求较高的场景非常重要。</p></li><li><p><strong>占用资源少</strong>: Serial Wire接口占用的资源较少，对于一些资源受限的嵌入式系统来说，这是一个重要考虑因素。</p></li></ol><p>综上所述，选择在单片机系统配置中使用Serial Wire接口进行调试，可以提供更简单、高效、低功耗的调试方案，同时避免了一些潜在的问题和限制。</p>              </div>            </details></div></div><div class="timenode"><div class="meta"><p><p>第六步 <a href="https://tumytime.space/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/">保存工程</a></p></p></div><div class="body"><ul><li><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7egieb8qmz.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7egieb8qmz.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li><li><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.92pvbi2i5d.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.92pvbi2i5d.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li></ul></div></div><div class="timenode"><div class="meta"><p><p>第七步 <a href="https://tumytime.space/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/">生成工程</a></p></p></div><div class="body"><p>点击右上角”GENERATE CODE”,生成工程</p></div></div></div><p>打开文件：</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.7zq60mkhq1.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.7zq60mkhq1.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="timeline"><div class="timenode"><div class="meta"><p><p>第一步 <a href="https://tumytime.space/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/">编译文件</a></p></p></div><div class="body"><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3uukois684.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3uukois684.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="note warning"><p>你的代码一定要写在”begin”和”end”之间，不然下一次生成工程会被覆盖掉</p></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1zhzvwjff4.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1zhzvwjff4.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></div></div><div class="timenode"><div class="meta"><p><p>第二步 <a href="https://tumytime.space/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/">选择调试器</a></p></p></div><div class="body"><p>选择的就是板载调试器</p><ul><li><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.ibuu5mnx2.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.ibuu5mnx2.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li><li><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.2vehbd3ej7.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.2vehbd3ej7.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li></ul></div></div><div class="timenode"><div class="meta"><p><p>第三步 <a href="https://tumytime.space/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/">根目录新建bsp文件夹</a></p></p></div><div class="body"><p>放自己写的文件(bsp:板载支持包，代码在这块板子使用)</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.32hp6st6bo.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.32hp6st6bo.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></div></div><div class="timenode"><div class="meta"><p><p>第四步 <a href="https://tumytime.space/2024/02/28/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C-%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E5%BB%BA%E7%AB%8B/">工程目录新建bsp文件夹</a></p></p></div><div class="body"><ul><li><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.1ses0hevyf.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.1ses0hevyf.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li><li><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3rayqtnetn.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3rayqtnetn.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div></li></ul></div></div></div><p>完结撒花~</p>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式 </tag>
            
            <tag> stm32 </tag>
            
            <tag> 蓝桥杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蓝桥杯stm32学习笔记(一)：相关元件/配置</title>
      <link href="/2024/02/27/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/02/27/%E8%93%9D%E6%A1%A5%E6%9D%AFstm32%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<details ><summary pointer> 碎碎念 </summary>              <div class='content'>              <p>离蓝桥杯还有45天，我的32总共才学了四五天&#x2F;(ㄒoㄒ)&#x2F;~~<br>虽然考核作业做完了但是都是现学现弄的，不能做到独立系统地完成<br>最近事情好多，这几天赶紧先学一遍<br>2.27-3.1</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.4n7g52t9ay.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.4n7g52t9ay.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>              </div>            </details><div class="note info"><p>开发板芯片：stm32g4rbt6;HAL库开发</p></div><h1 id="产品手册"><a href="#产品手册" class="headerlink" title="产品手册"></a>产品手册</h1><details open><summary pointer> 产品手册 </summary>              <div class='content'>              <p>这个电子书有bug。。。如果有人想看的话直接点一下这个封面。或者往下翻一点，有一个乱跑的灰色和蓝色的书籍图标，点开是电子书<br><input type="hidden" id="input_pop_1709042415128" value='<iframe id="iframe_pop_1709042415128"  src="https://book.baige.me/view/cwU" style="width:100%;height:100%;background:#eee" frameborder=0 seamless="seamless"  allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true" ></iframe>'><a href="#" style="position: relative;display:inline-block;"  onclick="document.querySelector('body').style.overflow='hidden';document.querySelector('#pop_1709042415128').style.display='block';var value=document.getElementById('input_pop_1709042415128').value; var div = document.createElement('div'); div.innerHTML=value;div.setAttribute('style','width:100%;height:100%');document.querySelector('#pop_1709042415128').appendChild(div)" title="CT117E-M4产品手册"><img style='width: 100%;height:100%;object-fit:contain;padding: 80px;' src='https://book-png-1251142715.cos.ap-shanghai.myqcloud.com/427c4137-291d-40fc-b5ae-d816aeca6931/cover.jpg' style='height: 100%;width: 100%;object-fit: contain;' /><div onmouseout='this.style.background="rgba(85, 134, 224 ,.8)"' onmouseover='this.style.background="rgba(46, 109, 224, .8)"' style='position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:60px;height:60px;padding:10px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:rgba(85, 134 ,224, .8)'><svg xmlns='https://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' t='1632813159349' class='icon' viewBox='0 0 1024 1024' version='1.1' p-id='2458' width='200' height='200'><path d='M924.2624 142.1824h-255.42656c-48.4096 0-93.9008 17.88416-128.19456 50.47808-11.6736 11.06944-20.79744 23.83872-28.70272 37.0944-7.9104-13.25568-17.02912-25.9072-28.8256-37.0944-34.304-32.59392-79.79008-50.47296-128.19968-50.47296H99.7376c-13.49632 0-24.44288 10.33216-24.44288 23.22944V807.3728c0 12.89216 10.94656 23.22944 24.448 23.22944h229.75488c9.61024 0 19.34336 0.73216 29.07136 2.54976 9.85088 1.83296 19.21536 4.38272 28.09344 7.79264l116.4032 43.05408c0.24064 0.11776 0.4864 0 0.72704 0.11776 2.67776 0.85504 5.35552 1.4592 8.15104 1.4592 2.80064 0 5.46816-0.48128 8.15104-1.4592 0.11776-0.11776 0.4864-0.11776 0.60928-0.11776l111.77472-41.35424a203.5456 203.5456 0 0 1 32.96256-9.00096 197.7344 197.7344 0 0 1 34.048-3.04128h224.77312c13.50656 0 24.45312-10.46016 24.45312-23.22944V165.29408c0-12.7744-10.94656-23.10656-24.45312-23.10656zM367.4368 787.43552a220.9792 220.9792 0 0 0-37.94944-3.28704H124.06272V188.5184h230.97344c35.38944 0 68.72064 13.13792 93.7728 37.09952 25.05728 23.83872 38.92224 55.45984 38.92224 89.27744v513.39776l-83.31776-30.77632a232.15616 232.15616 0 0 0-36.97152-10.09152z m532.49536-3.28704h-200.33024c-14.592 0-29.18912 1.21344-43.04896 3.77344-14.11072 2.67264-28.22144 6.44096-41.6 11.43296l-78.57152 28.94848V314.7776c0-33.6896 13.74208-65.4336 38.79936-89.27744 25.05216-23.83872 58.38336-37.0944 93.7728-37.0944h231.09632v595.7376h-0.11776z' p-id='2459' fill='#dbdbdb'></path></svg></div></a><div id="pop_1709042415128" style="display: none; position: fixed;width: 100%; height: 100%; padding: 20px; background: rgba(0, 0, 0, 0.6);box-sizing: border-box; top: 0; left: 0; z-index: 99999; "><a href="#" title="关闭" onclick="document.querySelector('body').style.overflow='auto';document.querySelector('#pop_1709042415128').style.display='none';var rm=document.getElementById('iframe_pop_1709042415128');rm.parentNode.parentNode.parentNode.removeChild(rm.parentNode);" style="top:0;right:0;position:absolute;width:32px;height:32px;"><span style="position: absolute;cursor: pointer; background-color: #000;border: 2px solid #fff;width: 24px;height: 24px;border-radius: 12px;top: 5px;padding-bottom:4px;right: 5px;color:white;line-height:24px;box-shadow: 0 0 3px #000;text-align: center;display: flex;justify-content: center;align-items: center;">x</span></a></div></p>              </div>            </details><h2 id="晶振"><a href="#晶振" class="headerlink" title="晶振"></a>晶振</h2><details open><summary pointer> 晶振 </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.lt4che7r.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.lt4che7r.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>这个单片机内部晶振是24MHz<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">晶振（Crystal Oscillator）在单片机（Microcontroller）中起着非常重要的作用，</span><br><span class="line">主要包括以下几个方面：</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> <span class="strong">**提供时钟信号**</span>：晶振在单片机中作为一个时钟源，为微处理器提供稳定的时钟信</span><br><span class="line">号，控制着单片机内部各个模块的运行节奏。时钟信号的频率决定了单片机的运行速度和</span><br><span class="line">性能。</span><br><span class="line"></span><br><span class="line"><span class="bullet">2.</span> <span class="strong">**保持精确的时钟速率**</span>：晶振的振荡频率十分稳定，并具有较高的准确性，可提供</span><br><span class="line">微处理器所需的精确时钟速率，确保程序运行的稳定性和准确性。</span><br><span class="line"></span><br><span class="line"><span class="bullet">3.</span> <span class="strong">**同步外部设备**</span>：通过晶振提供的时钟信号，单片机可以与外部设备进行数据交换</span><br><span class="line">和通信，保证数据传输的准确性和稳定性。</span><br><span class="line"></span><br><span class="line"><span class="bullet">4.</span> <span class="strong">**实现定时与计数**</span>：晶振可以用于实现定时器和计数器功能，例如在单片机中实现</span><br><span class="line">延时控制、PWM输出等功能。</span><br><span class="line"></span><br><span class="line"><span class="bullet">5.</span> <span class="strong">**协助实现串行通信**</span>：晶振通常与串行通信模块（如UART、SPI、I2C）结合使用，</span><br><span class="line">提供准确的时钟信号来同步数据传输。</span><br><span class="line"></span><br><span class="line">总的来说，晶振在单片机中扮演着提供稳定时钟信号、确保程序稳定性和准确性、实现计</span><br><span class="line">时计数等关键作用。在单片机设计和应用中，选择适合的晶振频率和类型是非常重要</span><br></pre></td></tr></table></figure><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">晶振在单片机中通常被用作外部时钟（<span class="keyword">External </span><span class="keyword">Clock）。外部时钟是由外部晶振提供</span></span><br><span class="line"><span class="keyword"></span>的时钟信号，通过单片机引脚连接到晶振的输入端。单片机根据外部晶振提供的信号来同</span><br><span class="line">步其内部的操作，确保各个部件按照规定的频率和时序进行工作。</span><br><span class="line"></span><br><span class="line">相比之下，内部时钟（Internal <span class="keyword">Clock）是由单片机内部的时钟发生器产生的时钟信号。</span></span><br><span class="line"><span class="keyword"></span>在一些单片机中，内部时钟可以被选择为系统时钟，但通常外部晶振更常用，因为它提供了</span><br><span class="line">更高的时钟稳定性和精度。</span><br><span class="line"></span><br><span class="line">因此，晶振在单片机中通常是作为外部时钟使用的，用来提供稳定的时钟信号以同步单片机</span><br><span class="line">的各个部件。</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="信号发生器"><a href="#信号发生器" class="headerlink" title="信号发生器"></a>信号发生器</h2><details open><summary pointer> 信号发生器 </summary>              <div class='content'>              <p>里面有555定时器</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">信号发生器可以通过它的输出引脚来产生各种类型的信号。这些信号可以是正弦波、方波、</span><br><span class="line">脉冲波等不同波形的信号，也可以是具有不同幅度、频率和相位的信号。通过调节信号发生</span><br><span class="line">器的设置，可以控制所输出信号的特性，将其接入电路的输入端，从而测试、校准电路的性</span><br><span class="line">能或进行各种实验。因此，信号发生器在实际工程中常被用来驱动电路、模拟不同信号条件</span><br><span class="line">下的工作状态，并对电路进行性能评估和确认。</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">在电路设计和测试中，信号发生器扮演着非常重要的角色，其作用包括但不限于以下几个方</span><br><span class="line">面：</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> <span class="strong">**信号源测试与校准**</span>：用信号发生器来测试电路的输入和输出响应，以验证电路的性</span><br><span class="line">能和正确性。信号发生器可以提供各种类型的标准信号，用于与待测试的电路进行比较，确</span><br><span class="line">保电路正常工作。</span><br><span class="line"></span><br><span class="line"><span class="bullet">2.</span> <span class="strong">**频率响应测试**</span>：信号发生器可以生成不同频率的信号，用于测试电路的频率响应特</span><br><span class="line">性。通过改变信号发生器的频率，可以检验电路在不同频率下的表现，找出频率响应范围和</span><br><span class="line">特性。</span><br><span class="line"></span><br><span class="line"><span class="bullet">3.</span> <span class="strong">**幅度测量**</span>：通过调节信号发生器的输出幅度，可以模拟不同幅度的输入信号，以测</span><br><span class="line">试电路在不同输入幅度下的响应。</span><br><span class="line"></span><br><span class="line"><span class="bullet">4.</span> <span class="strong">**相位测试**</span>：信号发生器可以生成具有可调节相位的信号，用于测试电路的相位特性。</span><br><span class="line">相位测试对于时序要求严格的电路设计非常重要。</span><br><span class="line"></span><br><span class="line"><span class="bullet">5.</span> <span class="strong">**脉冲测试**</span>：信号发生器可以生成脉冲信号，用于测试电路对脉冲信号的响应速度和</span><br><span class="line">稳定性，验证电路在脉冲信号条件下的工作状态。</span><br><span class="line"></span><br><span class="line"><span class="bullet">6.</span> <span class="strong">**调制和解调**</span>：信号发生器可以生成各种调制信号（如调幅、调频、调相信号），用</span><br><span class="line">于测试和验证调制解调器等通讯设备的性能。</span><br><span class="line"></span><br><span class="line">总的来说，信号发生器在电路中的作用是提供标准化的各种类型信号，帮助工程师进行电路</span><br><span class="line">设计、测试和调试工作，确保电路正常工作并符合设计要求。信号发生器是电子工程师和技</span><br><span class="line">术人员在实验室和工程现场中必不可少的工具之一。</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="模拟输出"><a href="#模拟输出" class="headerlink" title="模拟输出"></a>模拟输出</h2><details open><summary pointer> 模拟输出 </summary>              <div class='content'>              <p>板子上的两个可调电阻（R37和R38）<br><span class='pbg info'>另外两个可调电阻呢？</span></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">单片机的模拟输出通常是通过数字到模拟转换器（DAC，Digital-to-Analog Converter）</span><br><span class="line">实现的。DAC将单片机内部的数字信号转换为模拟信号，从而可以控制外部模拟设备或传感器。</span><br><span class="line"></span><br><span class="line">一般来说，单片机的模拟输出具有以下特点：</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> <span class="strong">**精度和分辨率**</span>：DAC的精度和分辨率决定模拟输出信号的质量和精度。高精度的DAC</span><br><span class="line">能够输出更准确的模拟信号。</span><br><span class="line"></span><br><span class="line"><span class="bullet">2.</span> <span class="strong">**输出范围**</span>：DAC的输出范围决定了模拟信号可以达到的最大和最小电压值。一些DAC</span><br><span class="line">具有可编程的输出范围，使用户能够灵活控制输出信号的范围。</span><br><span class="line"></span><br><span class="line"><span class="bullet">3.</span> <span class="strong">**输出稳定性**</span>：DAC的输出应具有稳定性，以确保模拟信号的稳定性和准确性。因此，</span><br><span class="line">DAC应具有良好的温度稳定性和供电稳定性。</span><br><span class="line"></span><br><span class="line"><span class="bullet">4.</span> <span class="strong">**输出驱动能力**</span>：DAC的输出驱动能力决定了其能够驱动的负载的大小。较高的输出驱</span><br><span class="line">动能力意味着DAC可以连接到较大电阻或容性负载而不影响输出信号的质量。</span><br><span class="line"></span><br><span class="line">在单片机应用中，模拟输出通常用于控制电压或电流，以输出需要的模拟信号。通过DAC转换</span><br><span class="line">数字信号为模拟信号，单片机可以与模拟电路或传感器进行有效的通信和控制。</span><br></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">单片机的模拟输出通常是通过数字到模拟转换器（DAC，Digital-<span class="keyword">to</span>-Analog Converter）</span><br><span class="line">实现的。DAC将单片机内部的数字信号转换为模拟信号，从而可以控制外部模拟设备或传感器。</span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在开发板上通常会配备可调电阻（也称为电位器），用于调节模拟输出信号的电压水平。结</span><br><span class="line">合可调电阻，单片机的模拟输出可以更加灵活地进行调节和控制，以适应不同的应用需求。</span><br><span class="line"></span><br><span class="line">通过调节可调电阻的阻值，可以改变模拟输出电路中的电阻值，从而影响模拟输出信号的电</span><br><span class="line">压水平。这种方式可以实现对模拟输出信号的精细调节，使得单片机可以输出各种不同范围</span><br><span class="line">和精度的模拟信号。</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="LED指示灯"><a href="#LED指示灯" class="headerlink" title="LED指示灯"></a>LED指示灯</h2><details open><summary pointer> LED指示灯 </summary>              <div class='content'>              <p><span class='pbg info'>led引脚和lcd屏一些引脚共用（PC8-15），所以加了锁存器</span></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">当LED引脚和LCD屏引脚共用同一个引脚时，可能会出现信号冲突的问题。为了解决这个问题，</span><br><span class="line">可以使用锁存器（Latch）来进行信号切换和时序控制。锁存器是一种逻辑电路元件，可以存</span><br><span class="line">储输入信号的状态，并在时钟信号下将其输出。</span><br><span class="line"></span><br><span class="line">在这种情况下，LED引脚和LCD引脚可以通过锁存器分时共享同一个引脚。当需要控制LED时，</span><br><span class="line">将LED信号输入锁存器并锁定状态，此时锁存器会将LED信号保持在输出端口。当需要控制LCD</span><br><span class="line">屏时，将LCD信号输入锁存器并锁定状态，锁存器会将LCD信号保持在输出端口。这样就实现了</span><br><span class="line">LED引脚和LCD引脚在同一个引脚上的分时共享。</span><br><span class="line"></span><br><span class="line">通过引入锁存器，可以有效地控制LED和LCD信号的输出时序，避免信号冲突和干扰。这种设计</span><br><span class="line">能够提高系统的稳定性和灵活性，同时减少硬件设计的复杂度。在实际电路设计中，锁存器通</span><br><span class="line">常被用于控制信号的时序和切换，确保不同信号之间的正常传输和处理。</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="按键"><a href="#按键" class="headerlink" title="按键"></a>按键</h2><details open><summary pointer> 按键 </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.45f32xi2l.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.45f32xi2l.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><p><span class='pbg info'>按前高电平，按后接地-&gt;低电平</span></p>              </div>            </details><h3 id="VCC和VDD"><a href="#VCC和VDD" class="headerlink" title="VCC和VDD"></a>VCC和VDD</h3><details open><summary pointer> VCC和VDD </summary>              <div class='content'>              <p>在单片机中，VDD和VCC都是指供电电压，但在不同的情况下，它们有着不同的含义和应用。</p><p>一、VCC<br>VCC（Voltage at the Common Collector）是指芯片的电源电压，通常是5V或3.3V，<br>用于为芯片提供工作电压。</p><p>这里有必要先强调下电源电压。</p><p>电源电压是指电源输出的电压，它是为电路中的各个元器件和子系统(比如单片机)提供<br>供电电压的电源电压。</p><p>电源电压通常由电源模块提供，它可以是交流电、直流电或者其他形式的电源信号。</p><p>比如说这个BUCK电源电路，输出的VCC 3.3V就属于电源电压。</p><p>VCC通常连接到芯片的正极电源，也就是芯片的电源输入端。</p><p>二、VDD<br>VDD（Voltage Drain-to-Drain）是指MOSFET场效应管的漏极电压，也成为供电电压。</p><p>供电电压通常是由电源电压提供，一般是指电路中某个元器件或子系统所需要的电压，它<br>是该元器件或子系统正常工作所必需的电压。</p><p>比如说单片机里面有很多模块，比如GPIO、定时器、USART、ADC等等，这些模块都是属<br>于单片机的子系统。</p><p>VDD通常连接到芯片的电源引脚，然后给内部各个模块供电，它是单片机电源电压的一种<br>定义方式。</p><p>比如我们单片机的供电电压引脚就是用VDD表示。</p><p>这个VDD是可以直接接到电源电压VCC 3.3V的。</p><p>总的来说，VCC和VDD都是单片机中的电源电压，一般来说不用太刻意去区分，一般设计硬<br>件的时候也没这么讲究。</p><p>最重要的是，在设计单片机电路时，需要仔细理解芯片手册中对供电电压的需求说明，以保<br>证正确的供电和工作。</p>              </div>            </details><h2 id="I2C总线"><a href="#I2C总线" class="headerlink" title="I2C总线"></a>I2C总线</h2><details open><summary pointer> I2C总线 </summary>              <div class='content'>              <div class="tagLink"><a class="link-card" title="阅读原文" href="https://zhuanlan.zhihu.com/p/282949543"><span class="link-card-backdrop" style="background-image: url(https://pic1.zhimg.com/70/v2-cebf666f5a59f3a5ce835dbf63ebe934_1440w.avis?source=172ae18b&biz_tag=Post)"></span><div class="left"><img src="https://pic1.zhimg.com/70/v2-cebf666f5a59f3a5ce835dbf63ebe934_1440w.avis?source=172ae18b&biz_tag=Post" class="lazyload placeholder" data-srcset="https://pic1.zhimg.com/70/v2-cebf666f5a59f3a5ce835dbf63ebe934_1440w.avis?source=172ae18b&biz_tag=Post" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">阅读原文</p><p class="url">https://zhuanlan.zhihu.com/p/282949543</p></div></a></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/image.3nrcswwn45.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/image.3nrcswwn45.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><details open><summary pointer> U2(EEPROM) </summary>              <div class='content'>              <p>EEPROM是可擦除可编程只读存储器（Electrically Erasable Programmable Read-Only Memory）的缩写，是一种用于存储数据的非易失性存储器。在单片机中，EEPROM通常被用来存储需要长期保留的数据，例如配置参数、校准数据、用户设置等。以下是关于EEPROM的一些详细解释：</p><ol><li><p><strong>可擦除性</strong>：EEPROM可以通过电气方式进行擦除，而无需额外的设备或光源。这意味着存储在EEPROM中的数据可以被擦除并重新写入，而不会损坏芯片。</p></li><li><p><strong>可编程性</strong>：EEPROM允许将数据写入其中，并且可以通过单片机或其他设备来编程。这使得用户可以随时更新或更改存储在EEPROM中的数据。</p></li><li><p><strong>只读特性</strong>：尽管EEPROM是可编程存储器，但在正常操作期间，存储在其中的数据是只读的，即在不经过明确的擦除和编程操作时，数据是持久的。</p></li><li><p><strong>非易失性</strong>：与随机存储器（RAM）不同，EEPROM是非易失性存储器，这意味着即使在断电情况下，数据也会被保留。因此，EEPROM常被用来保存需要长期存储的关键数据。</p></li><li><p><strong>寿命</strong>：EEPROM存储器可以被擦除和写入的次数通常受限，每个存储单元的擦除和写入次数有一定的寿命。因此，在使用EEPROM时需要注意避免频繁擦除和写入操作，以延长其使用寿命。</p></li></ol><p>总的来说，EEPROM在单片机和其他嵌入式系统中被广泛应用，用于保存需要长期保留的数据。它提供了一种高度可靠、耐用且非易失的数据存储解决方案。希望这些解释对您有帮助。如果您有任何其他问题，欢迎继续提问。</p>              </div>            </details><details open><summary pointer> U3(数字电位器) </summary>              <div class='content'>              <ol><li><p><strong>数字电位器</strong>：</p><ul><li>数字电位器是一种电阻器，它通过数字信号来控制电阻值，实现对电路中某些元件的调节和控制。</li><li>数字电位器通常由多个电阻单元组成，通过切换这些电阻单元，可以调节整体的电阻值。</li><li>单片机可以使用数字电位器来模拟可变电阻的功能，例如用于调节模拟信号的增益、亮度控制、音量控制等。</li></ul></li><li><p><strong>使用I2C总线控制数字电位器</strong>：</p><ul><li>在单片机系统中，可以通过I2C总线来与数字电位器通信，发送相应的命令以调节电位器的电阻值。</li><li>通过向数字电位器发送控制命令，单片机可以实现对电路中数字电位器的远程控制。</li><li>通过这种方式，单片机可以实现对电路中各种参数的动态调节，使系统更加灵活和智能化。</li></ul></li></ol>              </div>            </details>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式 </tag>
            
            <tag> stm32 </tag>
            
            <tag> 蓝桥杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>电路游戏：Turing Complete</title>
      <link href="/2024/02/11/%E7%94%B5%E8%B7%AF%E6%B8%B8%E6%88%8F%EF%BC%9ATuring-Complete/"/>
      <url>/2024/02/11/%E7%94%B5%E8%B7%AF%E6%B8%B8%E6%88%8F%EF%BC%9ATuring-Complete/</url>
      
        <content type="html"><![CDATA[<p>非常好游戏，这使我的大脑运动</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/20240211/电路1.3rtcfnar8b80.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/20240211/电路1.3rtcfnar8b80.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt=" 德·摩根定律"/></div><span class="image-caption"> 德·摩根定律</span></div><details open><summary pointer> 袜子配对 </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/20240211/电路2.2sqqoyj7pvc0.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/20240211/电路2.2sqqoyj7pvc0.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/20240211/电路3.6gayi9ytjw00.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/20240211/电路3.6gayi9ytjw00.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/20240211/电路4.63k46pi5wb80.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/20240211/电路4.63k46pi5wb80.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt=" 我的解答"/></div><span class="image-caption"> 我的解答</span></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/20240211/电路5.2twsa5gbl340.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/20240211/电路5.2twsa5gbl340.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt=" 官方解答，好漂亮的排线"/></div><span class="image-caption"> 官方解答，好漂亮的排线</span></div>              </div>            </details><details open><summary pointer> 奇数个信号 </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/20240211/电路6.65srarkamuw0.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/20240211/电路6.65srarkamuw0.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/20240211/电路7.2bjw874mwg74.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/20240211/电路7.2bjw874mwg74.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div></div>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 电路 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 游戏 </tag>
            
            <tag> Turing Complete </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>给网站加一个倒数日卡片~（成功啦~）</title>
      <link href="/2024/02/07/%E7%BB%99%E7%BD%91%E7%AB%99%E5%8A%A0%E4%B8%80%E4%B8%AA%E5%80%92%E6%95%B0%E6%97%A5%E5%8D%A1%E7%89%87/"/>
      <url>/2024/02/07/%E7%BB%99%E7%BD%91%E7%AB%99%E5%8A%A0%E4%B8%80%E4%B8%AA%E5%80%92%E6%95%B0%E6%97%A5%E5%8D%A1%E7%89%87/</url>
      
        <content type="html"><![CDATA[<p>想给网站加一个倒数日卡片<br>但是主题里没有相关配置<br>因为对网站之类的完全零基础，看了一圈感觉自己想要的效果跟网站上已有的”座右铭”卡片的实现很像<br>准备学习借用一下~</p><details open><summary pointer> motto.ejs（座右铭卡片） </summary>              <div class='content'>              <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;% if (theme.motto.on &amp;&amp; page.current === 1) &#123; %&gt;</span></span><br><span class="line">  <span class="section">&lt;div class=<span class="string">&quot;motto&quot;</span>&gt;</span></span><br><span class="line">      <span class="section">&lt;h3 class=<span class="string">&quot;motto-title&quot;</span>&gt;</span><span class="section">&lt;%= theme.motto.title %&gt;</span><span class="section">&lt;/h3&gt;</span></span><br><span class="line">      <span class="section">&lt;div class=<span class="string">&quot;motto-content&quot;</span>&gt;</span></span><br><span class="line">        <span class="section">&lt;p&gt;</span></span><br><span class="line">          <span class="section">&lt;%= theme.motto.content %&gt;</span>  </span><br><span class="line">        <span class="section">&lt;/p&gt;</span> </span><br><span class="line">      <span class="section">&lt;/div&gt;</span></span><br><span class="line">  <span class="section">&lt;/div&gt;</span></span><br><span class="line"><span class="section">&lt;% &#125; %&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><span class='pbg info'>theme.motto.on</span>？感觉好像懂了什么<details open><summary pointer> 主题配置文件新增： </summary>              <div class='content'>              <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首页倒数日</span></span><br><span class="line"><span class="attr">countdown:</span></span><br><span class="line">  <span class="attr">on:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>              </div>            </details><p>刚刚还在想卡片的样式是在哪里定义的，然后想起来还有ccs</p><details open><summary pointer> motto.styl </summary>              <div class='content'>              <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.motto</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">20px</span> -<span class="number">6px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">convert</span>(<span class="built_in">hexo-config</span>(<span class="string">&#x27;motto.background&#x27;</span>));</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.motto-title</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.motto-content</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">15px</span> <span class="number">20%</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#34495e</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">551px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.motto</span> &#123;</span><br><span class="line">    <span class="selector-class">.motto-content</span> &#123;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">15px</span> <span class="number">10%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p>感觉设置多个平行内容跟公告有点像，看看去</p><details open><summary pointer> 主题配置文件 </summary>              <div class='content'>              <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list: # list相当于数组对象，[&#123;title:<span class="string">&#x27;xx&#x27;</span>,date: <span class="string">&#x27;xx&#x27;</span>, url: <span class="string">&#x27;xxx&#x27;</span>, color: <span class="string">&#x27;red&#x27;</span>&#125;]根据自己实际情况，增加或者删除</span><br></pre></td></tr></table></figure>              </div>            </details><p>我也储存一下</p><details open><summary pointer> countdown.ejs新增： </summary>              <div class='content'>              <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> listData = [</span></span><br><span class="line"><span class="language-javascript">  &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">title</span>: <span class="string">&quot;计算机二级&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-03-23&quot;</span>, <span class="comment">// 目标日期</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">title</span>: <span class="string">&quot;蓝桥杯省赛&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-04-13&quot;</span>, <span class="comment">// 目标日期</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">];</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><details open><summary pointer> countdown.ejs新增倒数日函数： </summary>              <div class='content'>              <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">countdown</span>(<span class="params">targetDate, callback</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 将目标日期和当前日期转换为时间戳（毫秒）</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> targetTime = <span class="keyword">new</span> <span class="title class_">Date</span>(targetDate).<span class="title function_">getTime</span>();</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> currentTime = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 计算剩余时间（毫秒）</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> remainingTime = targetTime - currentTime;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 如果剩余时间小于等于0</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (remainingTime &lt;= <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="string">&#x27;倒计时结束&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 将剩余时间转换为天、小时、分钟和秒</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> days = <span class="title class_">Math</span>.<span class="title function_">floor</span>(remainingTime / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>));</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> hours = <span class="title class_">Math</span>.<span class="title function_">floor</span>(</span></span><br><span class="line"><span class="language-javascript">    (remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>)) / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)</span></span><br><span class="line"><span class="language-javascript">  );</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> minutes = <span class="title class_">Math</span>.<span class="title function_">floor</span>(</span></span><br><span class="line"><span class="language-javascript">    (remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)) / (<span class="number">1000</span> * <span class="number">60</span>)</span></span><br><span class="line"><span class="language-javascript">  );</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> seconds = <span class="title class_">Math</span>.<span class="title function_">floor</span>((remainingTime % (<span class="number">1000</span> * <span class="number">60</span>)) / <span class="number">1000</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 返回剩余时间的字符串格式</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;days&#125;</span>天 <span class="subst">$&#123;hours&#125;</span>小时 <span class="subst">$&#123;minutes&#125;</span>分钟 <span class="subst">$&#123;seconds&#125;</span>秒`</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><p>现在countdown.ejs是这样的：</p><details open><summary pointer> countdown.ejs </summary>              <div class='content'>              <figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-vbscript">&lt;%<span class="keyword">if</span> (theme.countdown.<span class="keyword">on</span> &amp;&amp; page.current === <span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-vbscript"> listData.forEach(<span class="keyword">function</span>(item) &#123; %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;index-notice&quot;</span> <span class="attr">id</span>=<span class="string">&quot;appIndexNotice&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-bullhorn index-notice-icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><span class="language-vbscript">&lt;%= item.title %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;index-notice-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      </span><span class="language-vbscript">&lt;% item.listData.forEach(<span class="keyword">function</span>(data) &#123; %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;countdown-card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h4</span>&gt;</span></span><span class="language-vbscript">&lt;%= data.title %&gt;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>目标日期: </span><span class="language-vbscript">&lt;%= data.targetDate %&gt;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>剩余时间: </span><span class="language-vbscript">&lt;%= countdown(data.targetDate) %&gt;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      </span><span class="language-vbscript">&lt;% &#125;); %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="language-vbscript">&lt;% &#125;); &#125;%&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">function</span> <span class="title function_">countdown</span>(<span class="params">targetDate</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 将目标日期和当前日期转换为时间戳（毫秒）</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> targetTime = <span class="keyword">new</span> <span class="title class_">Date</span>(targetDate).<span class="title function_">getTime</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> currentTime = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 计算剩余时间（毫秒）</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> remainingTime = targetTime - currentTime;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 如果剩余时间小于等于0，则执行回调函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">if</span> (remainingTime &lt;= <span class="number">0</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> <span class="string">&#x27;倒计时结束&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 将剩余时间转换为天、小时、分钟和秒</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> days = <span class="title class_">Math</span>.<span class="title function_">floor</span>(remainingTime / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> hours = <span class="title class_">Math</span>.<span class="title function_">floor</span>(</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    (remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>)) / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  );</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> minutes = <span class="title class_">Math</span>.<span class="title function_">floor</span>(</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    (remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)) / (<span class="number">1000</span> * <span class="number">60</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  );</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> seconds = <span class="title class_">Math</span>.<span class="title function_">floor</span>((remainingTime % (<span class="number">1000</span> * <span class="number">60</span>)) / <span class="number">1000</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 返回剩余时间的字符串格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;days&#125;</span>天 <span class="subst">$&#123;hours&#125;</span>小时 <span class="subst">$&#123;minutes&#125;</span>分钟 <span class="subst">$&#123;seconds&#125;</span>秒`</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">let</span> listData = [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">title</span>: <span class="string">&quot;计算机二级&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-03-23&quot;</span>, <span class="comment">// 目标日期</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">title</span>: <span class="string">&quot;蓝桥杯省赛&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-04-13&quot;</span>, <span class="comment">// 目标日期</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure>              </div>            </details><p>现在新建countdown.styl<br>（我现在还不太清楚要不要定义卡片放在页面哪个位置，到最后再说吧）</p><p>找到一个东西：</p><details open><summary pointer> motto.ejs： </summary>              <div class='content'>              <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">551px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.motto</span> &#123;</span><br><span class="line">    <span class="selector-class">.motto-content</span> &#123;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">15px</span> <span class="number">10%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p>感觉是卡片排列的底层逻辑，由于这里是屏幕宽度小于等于 551px 时，于是要找一个总的默认的.styl文件看一看<br>找到一个感觉很像的：</p><details open><summary pointer> home.styl： </summary>              <div class='content'>              <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">  <span class="selector-class">.widget</span> &#123;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">20px</span> -<span class="number">6px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.content</span> &#123;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">8px</span> <span class="number">16px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1200px</span>) &#123;</span><br><span class="line">  &amp; &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">80%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">992px</span>) &#123;</span><br><span class="line">  &amp; &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">95%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">992px</span>) &#123;</span><br><span class="line">  &amp; &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">95%</span>;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.l_content</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p>刚刚发现.styl文件里还要一个这个属性</p><details open><summary pointer> motto.styl： </summary>              <div class='content'>              <figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">position: relative</span><br></pre></td></tr></table></figure>              </div>            </details><p>总之总之卡片&#x2F;组件位置应该不用我准确定义了</p><details open><summary pointer> 主题配置文件新增： </summary>              <div class='content'>              <figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 首页倒数日</span></span><br><span class="line"><span class="symbol">countdown:</span></span><br><span class="line"><span class="symbol">  on:</span> true</span><br><span class="line"><span class="symbol">  background:</span> blue<span class="comment">//新增</span></span><br></pre></td></tr></table></figure>              </div>            </details><p>最后的countdown.styl（太晚了，具体的没细改，主打的一个出现了就是最好的！）</p><details open><summary pointer> countdown.styl： </summary>              <div class='content'>              <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.index-notice</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">20px</span> -<span class="number">6px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">convert</span>(<span class="built_in">hexo-config</span>(<span class="string">&#x27;countdown.background&#x27;</span>));</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.index-notice-icon</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.index-notice-content</span>&#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.countdown-card</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">15px</span> <span class="number">20%</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#34495e</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">551px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.motto</span> &#123;</span><br><span class="line">    <span class="selector-class">.motto-content</span> &#123;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">15px</span> <span class="number">10%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p>countdown.ejs和countdown.styl都备份好了，开始第一次测试~</p><p>发现没成功，但是我又发现了一个需要配置的文件：</p><details open><summary pointer> index.ejs： </summary>              <div class='content'>              <figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">&lt;%</span><span class="language-ruby"> <span class="keyword">if</span>(theme.swiper.on ) &#123; </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- 首页轮播 --&gt;</span></span></span><br><span class="line"><span class="language-xml">  &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/swiper&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">&lt;%</span><span class="language-ruby"> &#125; </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;l_main&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;l_content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 自定义的内容 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/home_widget&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 首页座右铭 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/motto&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 首页公告 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/notice&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 首页文章置顶 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/topArticle&#x27;</span>, &#123;<span class="symbol">page:</span> page&#125;) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bg-floor&quot;</span> <span class="attr">id</span>=<span class="string">&quot;home-bg-floor&quot;</span> <span class="attr">style</span>=<span class="string">&quot;position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -2;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 每一篇文章卡片 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/card/post&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 翻页 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/paginator&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/side&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- 花瓣和雪花飘落 --&gt;</span></span></span><br><span class="line"><span class="language-xml">&lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/scripts/falling&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- 灯笼 --&gt;</span></span></span><br><span class="line"><span class="language-xml">&lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/lantern&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure>              </div>            </details><p>然后照葫芦画瓢：</p><details open><summary pointer> index.ejs新增： </summary>              <div class='content'>              <figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">&lt;%</span><span class="language-ruby"> <span class="keyword">if</span>(theme.swiper.on ) &#123; </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- 首页轮播 --&gt;</span></span></span><br><span class="line"><span class="language-xml">  &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/swiper&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">&lt;%</span><span class="language-ruby"> &#125; </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;l_main&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;l_content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 自定义的内容 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/home_widget&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 首页倒数日 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/countdown&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 首页座右铭 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/motto&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 首页公告 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/notice&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 首页文章置顶 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/topArticle&#x27;</span>, &#123;<span class="symbol">page:</span> page&#125;) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bg-floor&quot;</span> <span class="attr">id</span>=<span class="string">&quot;home-bg-floor&quot;</span> <span class="attr">style</span>=<span class="string">&quot;position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -2;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 每一篇文章卡片 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/card/post&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 翻页 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/paginator&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  &lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/side&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- 花瓣和雪花飘落 --&gt;</span></span></span><br><span class="line"><span class="language-xml">&lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/scripts/falling&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- 灯笼 --&gt;</span></span></span><br><span class="line"><span class="language-xml">&lt;%-</span><span class="language-ruby"> partial(<span class="string">&#x27;_partial/lantern&#x27;</span>) </span><span class="language-xml">%&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><p>第二次测试~<br>私密马赛，报bug了：</p><details open><summary pointer> bug： </summary>              <div class='content'>              <figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">D:\github_code\blog\themes\hexo-theme-bamboo\layout\_partial\countdown.ejs:<span class="number">1</span></span><br><span class="line"> &gt;&gt; <span class="number">1</span>| &lt;%<span class="keyword">if</span> (theme.countdown.<span class="keyword">on</span> &amp;&amp; page.current === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="number">2</span>|  listData.forEach(function(<span class="built_in">item</span>) &#123; %&gt;</span><br><span class="line">    <span class="number">3</span>|   &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">&quot;index-notice&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;appIndexNotice&quot;</span>&gt;</span><br><span class="line">    <span class="number">4</span>|     &lt;h3&gt;</span><br><span class="line"></span><br><span class="line">listData <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br></pre></td></tr></table></figure>              </div>            </details><p>修改了一下countdown.ejs:</p><details open><summary pointer> index.ejs新增： </summary>              <div class='content'>              <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="keyword">if</span> (theme.<span class="property">countdown</span>.<span class="property">on</span> &amp;&amp; page.<span class="property">current</span> === <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> listData = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;计算机二级&quot;</span>,</span><br><span class="line">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-03-23&quot;</span>, <span class="comment">// 目标日期</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;蓝桥杯省赛&quot;</span>,</span><br><span class="line">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-04-13&quot;</span>, <span class="comment">// 目标日期</span></span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"> listData.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">item</span>) &#123; %&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;index-notice&quot;</span> <span class="attr">id</span>=<span class="string">&quot;appIndexNotice&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-bullhorn index-notice-icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>&lt;%= item.title %&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;index-notice-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &lt;% item.listData.forEach(function(data) &#123; %&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;countdown-card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h4</span>&gt;</span>&lt;%= data.title %&gt;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>目标日期: &lt;%= data.targetDate %&gt;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>剩余时间: &lt;%= countdown(data.targetDate) %&gt;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &lt;% &#125;); %&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;% &#125;); &#125;%&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">let</span> listData = [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">title</span>: <span class="string">&quot;计算机二级&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-03-23&quot;</span>, <span class="comment">// 目标日期</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">title</span>: <span class="string">&quot;蓝桥杯省赛&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-04-13&quot;</span>, <span class="comment">// 目标日期</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">function</span> <span class="title function_">countdown</span>(<span class="params">targetDate</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 将目标日期和当前日期转换为时间戳（毫秒）</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> targetTime = <span class="keyword">new</span> <span class="title class_">Date</span>(targetDate).<span class="title function_">getTime</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> currentTime = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 计算剩余时间（毫秒）</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> remainingTime = targetTime - currentTime;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 如果剩余时间小于等于0，则执行回调函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">if</span> (remainingTime &lt;= <span class="number">0</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> <span class="string">&#x27;倒计时结束&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 将剩余时间转换为天、小时、分钟和秒</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> days = <span class="title class_">Math</span>.<span class="title function_">floor</span>(remainingTime / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> hours = <span class="title class_">Math</span>.<span class="title function_">floor</span>(</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    (remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>)) / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  );</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> minutes = <span class="title class_">Math</span>.<span class="title function_">floor</span>(</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    (remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)) / (<span class="number">1000</span> * <span class="number">60</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  );</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> seconds = <span class="title class_">Math</span>.<span class="title function_">floor</span>((remainingTime % (<span class="number">1000</span> * <span class="number">60</span>)) / <span class="number">1000</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 返回剩余时间的字符串格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;days&#125;</span>天 <span class="subst">$&#123;hours&#125;</span>小时 <span class="subst">$&#123;minutes&#125;</span>分钟 <span class="subst">$&#123;seconds&#125;</span>秒`</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><p>变量名错了&#x2F;(ㄒoㄒ)&#x2F;~~再改一下：</p><details open><summary pointer> countdown.ejs新增： </summary>              <div class='content'>              <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="keyword">if</span> (theme.<span class="property">countdown</span>.<span class="property">on</span> &amp;&amp; page.<span class="property">current</span> === <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> listData = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;计算机二级&quot;</span>,</span><br><span class="line">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-03-23&quot;</span>, <span class="comment">// 目标日期</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;蓝桥杯省赛&quot;</span>,</span><br><span class="line">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-04-13&quot;</span>, <span class="comment">// 目标日期</span></span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"> listData.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">item</span>) &#123; %&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;index-notice&quot;</span> <span class="attr">id</span>=<span class="string">&quot;appIndexNotice&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-bullhorn index-notice-icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>&lt;%= item.title %&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;index-notice-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;countdown-card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h4</span>&gt;</span>&lt;%= item.title %&gt;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>目标日期: &lt;%= item.targetDate %&gt;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>剩余时间: &lt;%= countdown(item.targetDate) %&gt;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;% &#125;); &#125;%&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">let</span> listData = [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">title</span>: <span class="string">&quot;计算机二级&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-03-23&quot;</span>, <span class="comment">// 目标日期</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">title</span>: <span class="string">&quot;蓝桥杯省赛&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">targetDate</span>: <span class="string">&quot;2024-04-13&quot;</span>, <span class="comment">// 目标日期</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">function</span> <span class="title function_">countdown</span>(<span class="params">targetDate</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 将目标日期和当前日期转换为时间戳（毫秒）</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> targetTime = <span class="keyword">new</span> <span class="title class_">Date</span>(targetDate).<span class="title function_">getTime</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> currentTime = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 计算剩余时间（毫秒）</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> remainingTime = targetTime - currentTime;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 如果剩余时间小于等于0，则执行回调函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">if</span> (remainingTime &lt;= <span class="number">0</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> <span class="string">&#x27;倒计时结束&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 将剩余时间转换为天、小时、分钟和秒</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> days = <span class="title class_">Math</span>.<span class="title function_">floor</span>(remainingTime / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> hours = <span class="title class_">Math</span>.<span class="title function_">floor</span>(</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    (remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>)) / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  );</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> minutes = <span class="title class_">Math</span>.<span class="title function_">floor</span>(</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    (remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)) / (<span class="number">1000</span> * <span class="number">60</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  );</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> seconds = <span class="title class_">Math</span>.<span class="title function_">floor</span>((remainingTime % (<span class="number">1000</span> * <span class="number">60</span>)) / <span class="number">1000</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 返回剩余时间的字符串格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;days&#125;</span>天 <span class="subst">$&#123;hours&#125;</span>小时 <span class="subst">$&#123;minutes&#125;</span>分钟 <span class="subst">$&#123;seconds&#125;</span>秒`</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><p>又报错啦<del>被自己蠢笑啦</del></p><details open><summary pointer> countdown.ejs： </summary>              <div class='content'>              <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="keyword">if</span> (theme.<span class="property">countdown</span>.<span class="property">on</span> &amp;&amp; page.<span class="property">current</span> === <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> listData = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&quot;计算机二级&quot;</span>,</span><br><span class="line">      <span class="attr">targetDate</span>: <span class="string">&quot;2024-03-23&quot;</span>, <span class="comment">// 目标日期</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&quot;蓝桥杯省赛&quot;</span>,</span><br><span class="line">      <span class="attr">targetDate</span>: <span class="string">&quot;2024-04-13&quot;</span>, <span class="comment">// 目标日期</span></span><br><span class="line">    &#125;</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">countdown</span>(<span class="params">targetDate</span>) &#123;</span><br><span class="line">    <span class="comment">// 将目标日期和当前日期转换为时间戳（毫秒）</span></span><br><span class="line">    <span class="keyword">const</span> targetTime = <span class="keyword">new</span> <span class="title class_">Date</span>(targetDate).<span class="title function_">getTime</span>();</span><br><span class="line">    <span class="keyword">const</span> currentTime = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算剩余时间（毫秒）</span></span><br><span class="line">    <span class="keyword">const</span> remainingTime = targetTime - currentTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果剩余时间小于等于0，则执行回调函数</span></span><br><span class="line">    <span class="keyword">if</span> (remainingTime &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;倒计时结束&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将剩余时间转换为天、小时、分钟和秒</span></span><br><span class="line">    <span class="keyword">const</span> days = <span class="title class_">Math</span>.<span class="title function_">floor</span>(remainingTime / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>));</span><br><span class="line">    <span class="keyword">const</span> hours = <span class="title class_">Math</span>.<span class="title function_">floor</span>(</span><br><span class="line">      (remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>)) / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">const</span> minutes = <span class="title class_">Math</span>.<span class="title function_">floor</span>(</span><br><span class="line">      (remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)) / (<span class="number">1000</span> * <span class="number">60</span>)</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">const</span> seconds = <span class="title class_">Math</span>.<span class="title function_">floor</span>((remainingTime % (<span class="number">1000</span> * <span class="number">60</span>)) / <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回剩余时间的字符串格式</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;days&#125;</span>天 <span class="subst">$&#123;hours&#125;</span>小时 <span class="subst">$&#123;minutes&#125;</span>分钟 <span class="subst">$&#123;seconds&#125;</span>秒`</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  listData.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">item</span>) &#123; %&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;index-notice&quot;</span> <span class="attr">id</span>=<span class="string">&quot;appIndexNotice&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-bullhorn index-notice-icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>&lt;%= item.title %&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;index-notice-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;countdown-card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h4</span>&gt;</span>&lt;%= item.title %&gt;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>目标日期: &lt;%= item.targetDate %&gt;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>剩余时间: &lt;%= countdown(item.targetDate) %&gt;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &lt;% &#125;); &#125;%&gt;</span><br></pre></td></tr></table></figure>              </div>            </details><p>第三次测试~(给代码磕个头&#x2F;(ㄒoㄒ)&#x2F;~~)<br>成功了！！！！！！</p><div class="img-wrap"><div class="img-bg"><img class="img lazyload placeholder" src="https://tumytime.github.io/picx-images-hosting/20240206/countdown.47klh3scjmy0.webp" class="lazyload placeholder" data-srcset="https://tumytime.github.io/picx-images-hosting/20240206/countdown.47klh3scjmy0.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="哈哈哈哈哈哈"/></div><span class="image-caption">哈哈哈哈哈哈</span></div><p>等会。。。。&#x2F;(ㄒoㄒ)&#x2F;~~<br>两个bug：<br>1.看起来用的不是我现在的时间呀，像是我上传的时间，因为怎么样他都不变<br>2.我公告栏怎么不滚动了？？？？Orz</p><p>第一个bug，突然想起来这个网站是静态，请教了GPT老师：</p><details open><summary pointer> GPT老师 </summary>              <div class='content'>              <p>是的，这段代码获取的是客户端的当前日期和时间，而不是服务器的日期和时间。如果你的网站是静态的，即没有与服务器进行交互更新页面内容的能力，那么 <code>new Date().getTime()</code> 获取的时间将始终是用户打开网页时的时间，不会实时更新。</p><p>如果你想要在静态网站中实现实时倒计时功能，你可以考虑使用 JavaScript 配合客户端的时区偏移来获取当前时间。以下是一个示例实现：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getCurrentTime</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">  <span class="keyword">var</span> offset = date.<span class="title function_">getTimezoneOffset</span>() * <span class="number">60</span> * <span class="number">1000</span>; <span class="comment">// 获取客户端时区偏移（以毫秒为单位）</span></span><br><span class="line">  <span class="keyword">var</span> currentTime = date.<span class="title function_">getTime</span>() - offset; <span class="comment">// 当前时间减去时区偏移得到客户端时间</span></span><br><span class="line">  <span class="keyword">return</span> currentTime;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> targetTime = <span class="keyword">new</span> <span class="title class_">Date</span>(targetDate).<span class="title function_">getTime</span>();</span><br><span class="line"><span class="keyword">var</span> currentTime = <span class="title function_">getCurrentTime</span>();</span><br></pre></td></tr></table></figure><p>在这个示例中，<code>getCurrentTime</code> 函数通过获取客户端的时区偏移，将客户端时间与服务器时间进行同步。这样就能在静态网站中实现实时的倒计时功能。请注意，这种方法仍然依赖于客户端的时间，因此可能会受到用户设备时间不准确或篡改的影响。</p>              </div>            </details><p>然后又加了实时滚动功能：</p><details ><summary pointer> countdown.ejs </summary>              <div class='content'>              <figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>实时倒计时<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.countdown-card</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">font-size</span>: <span class="number">20px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">text-align</span>: center;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;countdown-container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    </span><span class="language-vbscript">&lt;% <span class="keyword">let</span> listData = [</span></span><br><span class="line"><span class="language-vbscript">        &#123;</span></span><br><span class="line"><span class="language-vbscript">          title: <span class="string">&quot;计算机二级&quot;</span>,</span></span><br><span class="line"><span class="language-vbscript">          targetDate: <span class="string">&quot;2024-03-23&quot;</span>, // 目标日期</span></span><br><span class="line"><span class="language-vbscript">        &#125;,</span></span><br><span class="line"><span class="language-vbscript">        &#123;</span></span><br><span class="line"><span class="language-vbscript">          title: <span class="string">&quot;蓝桥杯省赛&quot;</span>,</span></span><br><span class="line"><span class="language-vbscript">          targetDate: <span class="string">&quot;2024-04-13&quot;</span>, // 目标日期</span></span><br><span class="line"><span class="language-vbscript">        &#125;</span></span><br><span class="line"><span class="language-vbscript">      ];</span></span><br><span class="line"><span class="language-vbscript"></span></span><br><span class="line"><span class="language-vbscript">      listData.forEach(<span class="keyword">function</span>(item) &#123; %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;index-notice&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-bullhorn index-notice-icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> </span><span class="language-vbscript">&lt;%= item.title %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;index-notice-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;countdown-card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">h4</span>&gt;</span></span><span class="language-vbscript">&lt;%= item.title %&gt;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>目标日期: </span><span class="language-vbscript">&lt;%= item.targetDate %&gt;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>剩余时间: <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;countdown-</span></span></span><span class="language-vbscript">&lt;%= item.title %&gt;</span><span class="language-xml"><span class="tag"><span class="string">&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      </span><span class="language-vbscript">&lt;% &#125;) %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">getCurrentTime</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> offset = date.<span class="title function_">getTimezoneOffset</span>() * <span class="number">60</span> * <span class="number">1000</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> currentTime = date.<span class="title function_">getTime</span>() - offset;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> currentTime;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">updateCountdown</span>(<span class="params">id, remainingTime</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> days = <span class="title class_">Math</span>.<span class="title function_">floor</span>(remainingTime / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> hours = <span class="title class_">Math</span>.<span class="title function_">floor</span>((remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>)) / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> minutes = <span class="title class_">Math</span>.<span class="title function_">floor</span>((remainingTime % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)) / (<span class="number">1000</span> * <span class="number">60</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> seconds = <span class="title class_">Math</span>.<span class="title function_">floor</span>((remainingTime % (<span class="number">1000</span> * <span class="number">60</span>)) / <span class="number">1000</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      obj.<span class="property">textContent</span> = <span class="string">`<span class="subst">$&#123;days&#125;</span>天 <span class="subst">$&#123;hours&#125;</span>小时 <span class="subst">$&#123;minutes&#125;</span>分钟 <span class="subst">$&#123;seconds&#125;</span>秒`</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (remainingTime &lt;= <span class="number">0</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="built_in">clearInterval</span>(timer);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        obj.<span class="property">textContent</span> = <span class="string">&#x27;倒计时结束&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">countdown</span>(<span class="params">targetDate, id</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> targetTime = <span class="keyword">new</span> <span class="title class_">Date</span>(targetDate).<span class="title function_">getTime</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> currentTime = <span class="title function_">getCurrentTime</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> remainingTime = targetTime - currentTime;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (remainingTime &lt;= <span class="number">0</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id).<span class="property">textContent</span> = <span class="string">&#x27;倒计时结束&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> timer = <span class="built_in">setInterval</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        remainingTime -= <span class="number">1000</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title function_">updateCountdown</span>(id, remainingTime);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;, <span class="number">1000</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      </span></span><span class="language-vbscript">&lt;% listData.forEach(<span class="keyword">function</span>(item) &#123; %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        countdown(&quot;</span><span class="language-vbscript">&lt;%= item.targetDate %&gt;</span><span class="language-xml">&quot;, &#x27;countdown-</span><span class="language-vbscript">&lt;%= item.title %&gt;</span><span class="language-xml">&#x27;);</span></span><br><span class="line"><span class="language-xml">      </span><span class="language-vbscript">&lt;% &#125;) %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    &#125;);</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>              </div>            </details><p>02：37了。我去睡觉了~（第二个bug自己好了。。。）</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 主题配置 </tag>
            
            <tag> 倒数日卡片 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test</title>
      <link href="/2024/02/04/test/"/>
      <url>/2024/02/04/test/</url>
      
        <content type="html"><![CDATA[<details ><summary pointer> 查看默认打开的折叠框 </summary>              <div class='content'>              <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello, World!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">sayHello</span>();</span><br></pre></td></tr></table></figure>              </div>            </details><div class="link-group"><div class="tagLink"><a class="link-card" no-pjax target="_blank" title="编码：隐匿在计算机软硬件背后的语言.pdf" href="/pdf/编码：隐匿在计算机软硬件背后的语言.pdf"><span class="link-card-backdrop" style="background-image: url(https://cdn.pixabay.com/photo/2018/12/05/13/41/panda-3857754__340.jpg)"></span><div class="left"><img src="https://img.51miz.com/Element/00/37/79/59/10df0417_E377959_b7bb9dfa.png" class="lazyload placeholder" data-srcset="https://img.51miz.com/Element/00/37/79/59/10df0417_E377959_b7bb9dfa.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">编码：隐匿在计算机软硬件背后的语言.pdf</p><p class="url">/pdf/编码：隐匿在计算机软硬件背后的语言.pdf</p></div></a></div></div><p><input type="hidden" id="input_pop_1708758433861" value='<iframe id="iframe_pop_1708758433861"  src="https://book.baige.me/view/cvx" style="width:100%;height:100%;background:#eee" frameborder=0 seamless="seamless"  allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true" ></iframe>'><a href="#" style="position: relative;display:inline-block;"  onclick="document.querySelector('body').style.overflow='hidden';document.querySelector('#pop_1708758433861').style.display='block';var value=document.getElementById('input_pop_1708758433861').value; var div = document.createElement('div'); div.innerHTML=value;div.setAttribute('style','width:100%;height:100%');document.querySelector('#pop_1708758433861').appendChild(div)" title="编码：隐匿在计算机软硬件背后的语言（上）"><img style='width: 100%;height:100%;object-fit:contain;padding: 80px;' src='https://book-png-1251142715.cos.ap-shanghai.myqcloud.com/840e47ec-c673-4ccf-955a-02a3ad12ec4a/cover.jpg' style='height: 100%;width: 100%;object-fit: contain;' /><div onmouseout='this.style.background="rgba(85, 134, 224 ,.8)"' onmouseover='this.style.background="rgba(46, 109, 224, .8)"' style='position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:60px;height:60px;padding:10px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:rgba(85, 134 ,224, .8)'><svg xmlns='https://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' t='1632813159349' class='icon' viewBox='0 0 1024 1024' version='1.1' p-id='2458' width='200' height='200'><path d='M924.2624 142.1824h-255.42656c-48.4096 0-93.9008 17.88416-128.19456 50.47808-11.6736 11.06944-20.79744 23.83872-28.70272 37.0944-7.9104-13.25568-17.02912-25.9072-28.8256-37.0944-34.304-32.59392-79.79008-50.47296-128.19968-50.47296H99.7376c-13.49632 0-24.44288 10.33216-24.44288 23.22944V807.3728c0 12.89216 10.94656 23.22944 24.448 23.22944h229.75488c9.61024 0 19.34336 0.73216 29.07136 2.54976 9.85088 1.83296 19.21536 4.38272 28.09344 7.79264l116.4032 43.05408c0.24064 0.11776 0.4864 0 0.72704 0.11776 2.67776 0.85504 5.35552 1.4592 8.15104 1.4592 2.80064 0 5.46816-0.48128 8.15104-1.4592 0.11776-0.11776 0.4864-0.11776 0.60928-0.11776l111.77472-41.35424a203.5456 203.5456 0 0 1 32.96256-9.00096 197.7344 197.7344 0 0 1 34.048-3.04128h224.77312c13.50656 0 24.45312-10.46016 24.45312-23.22944V165.29408c0-12.7744-10.94656-23.10656-24.45312-23.10656zM367.4368 787.43552a220.9792 220.9792 0 0 0-37.94944-3.28704H124.06272V188.5184h230.97344c35.38944 0 68.72064 13.13792 93.7728 37.09952 25.05728 23.83872 38.92224 55.45984 38.92224 89.27744v513.39776l-83.31776-30.77632a232.15616 232.15616 0 0 0-36.97152-10.09152z m532.49536-3.28704h-200.33024c-14.592 0-29.18912 1.21344-43.04896 3.77344-14.11072 2.67264-28.22144 6.44096-41.6 11.43296l-78.57152 28.94848V314.7776c0-33.6896 13.74208-65.4336 38.79936-89.27744 25.05216-23.83872 58.38336-37.0944 93.7728-37.0944h231.09632v595.7376h-0.11776z' p-id='2459' fill='#dbdbdb'></path></svg></div></a><div id="pop_1708758433861" style="display: none; position: fixed;width: 100%; height: 100%; padding: 20px; background: rgba(0, 0, 0, 0.6);box-sizing: border-box; top: 0; left: 0; z-index: 99999; "><a href="#" title="关闭" onclick="document.querySelector('body').style.overflow='auto';document.querySelector('#pop_1708758433861').style.display='none';var rm=document.getElementById('iframe_pop_1708758433861');rm.parentNode.parentNode.parentNode.removeChild(rm.parentNode);" style="top:0;right:0;position:absolute;width:32px;height:32px;"><span style="position: absolute;cursor: pointer; background-color: #000;border: 2px solid #fff;width: 24px;height: 24px;border-radius: 12px;top: 5px;padding-bottom:4px;right: 5px;color:white;line-height:24px;box-shadow: 0 0 3px #000;text-align: center;display: flex;justify-content: center;align-items: center;">x</span></a></div></p><span class='btn center large round solid'><a class="button" href='https://baidu.com' title='开始使用'><i class='fa fa-download'></i>开始使用</a></span><p>testestest</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello, World!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">sayHello</span>();</span><br></pre></td></tr></table></figure><pre><code class="language-javascript">function sayHello() &#123;console.log("Hello, World!");&#125;sayHello();</code></pre><details ><summary pointer> 查看默认打开的折叠框 </summary>              <div class='content'>              <pre><code class="language-javascript">function sayHello() &#123;console.log("Hello, World!");&#125;sayHello();</code></pre>              </div>            </details><div class="video"><video controls preload><source src='/video/conan.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><p>::: danger<br>This is a dangerous warning.<br>:::</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>我的第一篇文章</title>
      <link href="/2024/02/01/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/"/>
      <url>/2024/02/01/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/</url>
      
        <content type="html"><![CDATA[<p>我的第一篇文章！终于把网站建好了！开心开心</p>]]></content>
      
      
      
        <tags>
            
            <tag> 碎碎念 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2024/02/01/hello-world/"/>
      <url>/2024/02/01/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> hello </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
